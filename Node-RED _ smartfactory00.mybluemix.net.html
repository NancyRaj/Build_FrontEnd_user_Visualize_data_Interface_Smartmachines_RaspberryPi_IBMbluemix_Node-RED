<!DOCTYPE html>
<!-- saved from url=(0061)https://smartfactory00.mybluemix.net/red/#flow/d4b7ecff.30a16 -->
<html class="gr__smartfactory00_mybluemix_net"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<title>Node-RED : smartfactory00.mybluemix.net</title>
<link rel="icon" type="image/png" href="https://smartfactory00.mybluemix.net/red/favicon.ico">
<link rel="mask-icon" href="https://smartfactory00.mybluemix.net/red/red/images/node-red-icon-black.svg" color="#8f0000">
<link href="./Node-RED _ smartfactory00.mybluemix.net_files/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="./Node-RED _ smartfactory00.mybluemix.net_files/jquery-ui-1.10.3.custom.min.css" rel="stylesheet" media="screen">
<link rel="stylesheet" href="./Node-RED _ smartfactory00.mybluemix.net_files/font-awesome.min.css">
<link rel="stylesheet" href="./Node-RED _ smartfactory00.mybluemix.net_files/vendor.css">
<link rel="stylesheet" href="./Node-RED _ smartfactory00.mybluemix.net_files/style.min.css">

<style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_text-input-ios {position: absolute !important;top: -100000px !important;left: -100000px !important;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style><style>.ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}</style><style>.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}</style><script src="./Node-RED _ smartfactory00.mybluemix.net_files/theme-tomorrow.js.download"></script><script src="./Node-RED _ smartfactory00.mybluemix.net_files/mode-javascript.js.download"></script><script src="./Node-RED _ smartfactory00.mybluemix.net_files/text.js.download"></script><style id="ace-tomorrow">.ace-tomorrow .ace_gutter {background: #f6f6f6;color: #4D4D4C}.ace-tomorrow .ace_print-margin {width: 1px;background: #f6f6f6}.ace-tomorrow {background-color: #FFFFFF;color: #4D4D4C}.ace-tomorrow .ace_cursor {color: #AEAFAD}.ace-tomorrow .ace_marker-layer .ace_selection {background: #D6D6D6}.ace-tomorrow.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #FFFFFF;}.ace-tomorrow .ace_marker-layer .ace_step {background: rgb(255, 255, 0)}.ace-tomorrow .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #D1D1D1}.ace-tomorrow .ace_marker-layer .ace_active-line {background: #EFEFEF}.ace-tomorrow .ace_gutter-active-line {background-color : #dcdcdc}.ace-tomorrow .ace_marker-layer .ace_selected-word {border: 1px solid #D6D6D6}.ace-tomorrow .ace_invisible {color: #D1D1D1}.ace-tomorrow .ace_keyword,.ace-tomorrow .ace_meta,.ace-tomorrow .ace_storage,.ace-tomorrow .ace_storage.ace_type,.ace-tomorrow .ace_support.ace_type {color: #8959A8}.ace-tomorrow .ace_keyword.ace_operator {color: #3E999F}.ace-tomorrow .ace_constant.ace_character,.ace-tomorrow .ace_constant.ace_language,.ace-tomorrow .ace_constant.ace_numeric,.ace-tomorrow .ace_keyword.ace_other.ace_unit,.ace-tomorrow .ace_support.ace_constant,.ace-tomorrow .ace_variable.ace_parameter {color: #F5871F}.ace-tomorrow .ace_constant.ace_other {color: #666969}.ace-tomorrow .ace_invalid {color: #FFFFFF;background-color: #C82829}.ace-tomorrow .ace_invalid.ace_deprecated {color: #FFFFFF;background-color: #8959A8}.ace-tomorrow .ace_fold {background-color: #4271AE;border-color: #4D4D4C}.ace-tomorrow .ace_entity.ace_name.ace_function,.ace-tomorrow .ace_support.ace_function,.ace-tomorrow .ace_variable {color: #4271AE}.ace-tomorrow .ace_support.ace_class,.ace-tomorrow .ace_support.ace_type {color: #C99E00}.ace-tomorrow .ace_heading,.ace-tomorrow .ace_markup.ace_heading,.ace-tomorrow .ace_string {color: #718C00}.ace-tomorrow .ace_entity.ace_name.ace_tag,.ace-tomorrow .ace_entity.ace_other.ace_attribute-name,.ace-tomorrow .ace_meta.ace_tag,.ace-tomorrow .ace_string.ace_regexp,.ace-tomorrow .ace_variable {color: #C82829}.ace-tomorrow .ace_comment {color: #8E908C}.ace-tomorrow .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bdu3f/BwAlfgctduB85QAAAABJRU5ErkJggg==) right repeat-y}
/*# sourceURL=ace/css/ace-tomorrow */</style><script src="./Node-RED _ smartfactory00.mybluemix.net_files/javascript.js.download"></script></head>
<body spellcheck="false" data-gr-c-s-loaded="true" style="">
<div id="header">
    <span class="logo"><img src="./Node-RED _ smartfactory00.mybluemix.net_files/node-red.png" title="0.18.7"> <span>Node-RED</span></span>
    <ul class="header-toolbar hide" style="display: block;"><li style="display: none;"><a id="btn-notifications" class="button" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-warning"></i></a></li><li><span class="deploy-button-group button-group"><a id="btn-deploy" class="deploy-button disabled" href="https://smartfactory00.mybluemix.net/red/#"><span class="deploy-button-content" style="opacity: 1;"><img id="btn-deploy-icon" src="./Node-RED _ smartfactory00.mybluemix.net_files/deploy-full-o.png"> <span>Deploy</span></span><span class="deploy-button-spinner hide" style="display: none;"><img src="./Node-RED _ smartfactory00.mybluemix.net_files/spin.svg"></span></a><a id="btn-deploy-options" data-toggle="dropdown" class="deploy-button" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-caret-down"></i></a><ul id="btn-deploy-options-submenu" class="dropdown-menu pull-right"><li><a id="deploymenu-item-full" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#" class="active"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ smartfactory00.mybluemix.net_files/deploy-full.png"> <span class="menu-label-container"><span class="menu-label">Full</span><span class="menu-sublabel">Deploys everything in the workspace</span></span></a></li><li><a id="deploymenu-item-flow" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ smartfactory00.mybluemix.net_files/deploy-flows.png"> <span class="menu-label-container"><span class="menu-label">Modified Flows</span><span class="menu-sublabel">Only deploys flows that contain changed nodes</span></span></a></li><li><a id="deploymenu-item-node" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><img src="./Node-RED _ smartfactory00.mybluemix.net_files/deploy-nodes.png"> <span class="menu-label-container"><span class="menu-label">Modified Nodes</span><span class="menu-sublabel">Only deploys nodes that have changed</span></span></a></li></ul></span></li><li><a id="btn-usermenu" class="button hide" data-toggle="dropdown" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-user"></i></a><ul id="btn-usermenu-submenu" class="dropdown-menu pull-right"><li class="disabled"><a id="usermenu-item-username" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label"><b>nancyraj16</b></span></a></li><li><a id="usermenu-item-logout" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Logout</span></a></li></ul></li>
        <li><a id="btn-sidemenu" class="button" data-toggle="dropdown" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-bars"></i></a><ul id="btn-sidemenu-submenu" class="dropdown-menu pull-right"><li class="dropdown-submenu pull-left"><a id="menu-item-view-menu" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">View</span></a><ul id="menu-item-view-menu-submenu" class="dropdown-menu"><li><a id="menu-item-sidebar" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#" class="active"><i class="fa fa-square pull-left"></i><i class="fa fa-check-square pull-left"></i><span class="menu-label">Show sidebar</span></a></li><li class="divider"></li><li class="menu-group-sidebar-tabs"><a id="menu-item-view-menu-dashboard" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Dashboard</span></a></li><li class="menu-group-sidebar-tabs"><a id="menu-item-view-menu-debug" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Debug messages</span></a></li></ul></li><li class="divider"></li><li class="dropdown-submenu pull-left"><a id="menu-item-import" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Import</span></a><ul id="menu-item-import-submenu" class="dropdown-menu"><li><a id="menu-item-import-clipboard" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Clipboard</span></a></li><li class="dropdown-submenu pull-left"><a id="menu-item-import-library" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Library</span></a><ul id="menu-item-import-library-submenu" class="dropdown-menu"></ul></li></ul></li><li class="dropdown-submenu pull-left disabled"><a id="menu-item-export" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Export</span></a><ul id="menu-item-export-submenu" class="dropdown-menu"><li class="disabled"><a id="menu-item-export-clipboard" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Clipboard</span></a></li><li class="disabled"><a id="menu-item-export-library" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Library</span></a></li></ul></li><li class="divider"></li><li><a id="menu-item-search" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Search flows</span></a></li><li class="divider"></li><li><a id="menu-item-config-nodes" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Configuration nodes</span></a></li><li class="dropdown-submenu pull-left"><a id="menu-item-workspace" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Flows</span></a><ul id="menu-item-workspace-submenu" class="dropdown-menu"><li><a id="menu-item-workspace-add" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Add</span></a></li><li><a id="menu-item-workspace-edit" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Rename</span></a></li><li class="disabled"><a id="menu-item-workspace-delete" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Delete</span></a></li></ul></li><li class="dropdown-submenu pull-left"><a id="menu-item-subflow" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Subflows</span></a><ul id="menu-item-subflow-submenu" class="dropdown-menu"><li><a id="menu-item-subflow-create" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Create Subflow</span></a></li><li class="disabled"><a id="menu-item-subflow-convert" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Selection to Subflow</span></a></li></ul></li><li class="divider"></li><li><a id="menu-item-edit-palette" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Manage palette</span></a></li><li class="divider"></li><li><a id="menu-item-user-settings" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Settings</span></a></li><li class="divider"></li><li><a id="menu-item-keyboard-shortcuts" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">Keyboard shortcuts</span></a></li><li><a id="menu-item-help" tabindex="-1" href="http://nodered.org/docs" target="_blank"><span class="menu-label">Node-RED website</span></a></li><li><a id="menu-item-node-red-version" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#"><span class="menu-label">v0.18.7</span></a></li></ul></li>
    </ul>
    <div id="header-shade" class="hide" style="display: none;"></div>
</div>
<div id="main-container" class="hide" style="display: block;">
    <div id="workspace">
        <div class="red-ui-tabs red-ui-tabs-add red-ui-tabs-scrollable" style="display: block;"><div class="red-ui-tabs-scroll-container"><ul id="workspace-tabs" style="width: 783px;" class=""><li class="red-ui-tab active ui-draggable" id="red-ui-tab-d4b7ecff-30a16" style="width: 765px;"><a href="https://smartfactory00.mybluemix.net/red/#d4b7ecff.30a16" class="red-ui-tab-label" title="Flow 1"><span class="workspace-disabled-icon"><i class="fa fa-ban"></i> </span><span class="bidiAware" dir="">Flow 1</span></a></li></ul></div><div class="red-ui-tab-button"><a href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-plus"></i></a></div><div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-left"><a href="https://smartfactory00.mybluemix.net/red/#" style="display:none;"><i class="fa fa-caret-left"></i></a></div><div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-right"><a href="https://smartfactory00.mybluemix.net/red/#" style="display: none;"><i class="fa fa-caret-right"></i></a></div></div>
        <div id="chart" tabindex="1" class="ui-droppable" style="display: block; margin-top: 0px;"><svg width="5000" height="5000" pointer-events="all" style="cursor: crosshair;"><g><g class="innerCanvas" transform="scale(1)"><rect width="5000" height="5000" fill="#fff"></rect><g style="visibility: hidden;"><line class="horizontal" x1="0" x2="5000" y1="0" y2="0" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="5" y2="5" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="10" y2="10" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="15" y2="15" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="20" y2="20" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="25" y2="25" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="30" y2="30" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="35" y2="35" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="40" y2="40" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="45" y2="45" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="50" y2="50" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="55" y2="55" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="60" y2="60" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="65" y2="65" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="70" y2="70" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="75" y2="75" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="80" y2="80" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="85" y2="85" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="90" y2="90" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="95" y2="95" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="100" y2="100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="105" y2="105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="110" y2="110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="115" y2="115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="120" y2="120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="125" y2="125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="130" y2="130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="135" y2="135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="140" y2="140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="145" y2="145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="150" y2="150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="155" y2="155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="160" y2="160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="165" y2="165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="170" y2="170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="175" y2="175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="180" y2="180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="185" y2="185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="190" y2="190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="195" y2="195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="200" y2="200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="205" y2="205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="210" y2="210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="215" y2="215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="220" y2="220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="225" y2="225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="230" y2="230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="235" y2="235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="240" y2="240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="245" y2="245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="250" y2="250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="255" y2="255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="260" y2="260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="265" y2="265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="270" y2="270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="275" y2="275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="280" y2="280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="285" y2="285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="290" y2="290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="295" y2="295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="300" y2="300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="305" y2="305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="310" y2="310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="315" y2="315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="320" y2="320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="325" y2="325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="330" y2="330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="335" y2="335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="340" y2="340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="345" y2="345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="350" y2="350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="355" y2="355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="360" y2="360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="365" y2="365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="370" y2="370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="375" y2="375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="380" y2="380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="385" y2="385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="390" y2="390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="395" y2="395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="400" y2="400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="405" y2="405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="410" y2="410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="415" y2="415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="420" y2="420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="425" y2="425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="430" y2="430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="435" y2="435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="440" y2="440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="445" y2="445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="450" y2="450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="455" y2="455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="460" y2="460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="465" y2="465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="470" y2="470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="475" y2="475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="480" y2="480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="485" y2="485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="490" y2="490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="495" y2="495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="500" y2="500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="505" y2="505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="510" y2="510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="515" y2="515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="520" y2="520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="525" y2="525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="530" y2="530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="535" y2="535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="540" y2="540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="545" y2="545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="550" y2="550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="555" y2="555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="560" y2="560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="565" y2="565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="570" y2="570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="575" y2="575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="580" y2="580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="585" y2="585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="590" y2="590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="595" y2="595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="600" y2="600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="605" y2="605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="610" y2="610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="615" y2="615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="620" y2="620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="625" y2="625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="630" y2="630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="635" y2="635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="640" y2="640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="645" y2="645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="650" y2="650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="655" y2="655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="660" y2="660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="665" y2="665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="670" y2="670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="675" y2="675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="680" y2="680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="685" y2="685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="690" y2="690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="695" y2="695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="700" y2="700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="705" y2="705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="710" y2="710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="715" y2="715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="720" y2="720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="725" y2="725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="730" y2="730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="735" y2="735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="740" y2="740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="745" y2="745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="750" y2="750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="755" y2="755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="760" y2="760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="765" y2="765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="770" y2="770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="775" y2="775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="780" y2="780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="785" y2="785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="790" y2="790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="795" y2="795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="800" y2="800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="805" y2="805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="810" y2="810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="815" y2="815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="820" y2="820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="825" y2="825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="830" y2="830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="835" y2="835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="840" y2="840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="845" y2="845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="850" y2="850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="855" y2="855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="860" y2="860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="865" y2="865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="870" y2="870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="875" y2="875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="880" y2="880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="885" y2="885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="890" y2="890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="895" y2="895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="900" y2="900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="905" y2="905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="910" y2="910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="915" y2="915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="920" y2="920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="925" y2="925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="930" y2="930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="935" y2="935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="940" y2="940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="945" y2="945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="950" y2="950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="955" y2="955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="960" y2="960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="965" y2="965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="970" y2="970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="975" y2="975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="980" y2="980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="985" y2="985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="990" y2="990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="995" y2="995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1000" y2="1000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1005" y2="1005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1010" y2="1010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1015" y2="1015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1020" y2="1020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1025" y2="1025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1030" y2="1030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1035" y2="1035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1040" y2="1040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1045" y2="1045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1050" y2="1050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1055" y2="1055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1060" y2="1060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1065" y2="1065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1070" y2="1070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1075" y2="1075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1080" y2="1080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1085" y2="1085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1090" y2="1090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1095" y2="1095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1100" y2="1100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1105" y2="1105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1110" y2="1110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1115" y2="1115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1120" y2="1120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1125" y2="1125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1130" y2="1130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1135" y2="1135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1140" y2="1140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1145" y2="1145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1150" y2="1150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1155" y2="1155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1160" y2="1160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1165" y2="1165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1170" y2="1170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1175" y2="1175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1180" y2="1180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1185" y2="1185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1190" y2="1190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1195" y2="1195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1200" y2="1200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1205" y2="1205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1210" y2="1210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1215" y2="1215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1220" y2="1220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1225" y2="1225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1230" y2="1230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1235" y2="1235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1240" y2="1240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1245" y2="1245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1250" y2="1250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1255" y2="1255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1260" y2="1260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1265" y2="1265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1270" y2="1270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1275" y2="1275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1280" y2="1280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1285" y2="1285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1290" y2="1290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1295" y2="1295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1300" y2="1300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1305" y2="1305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1310" y2="1310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1315" y2="1315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1320" y2="1320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1325" y2="1325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1330" y2="1330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1335" y2="1335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1340" y2="1340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1345" y2="1345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1350" y2="1350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1355" y2="1355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1360" y2="1360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1365" y2="1365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1370" y2="1370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1375" y2="1375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1380" y2="1380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1385" y2="1385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1390" y2="1390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1395" y2="1395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1400" y2="1400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1405" y2="1405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1410" y2="1410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1415" y2="1415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1420" y2="1420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1425" y2="1425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1430" y2="1430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1435" y2="1435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1440" y2="1440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1445" y2="1445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1450" y2="1450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1455" y2="1455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1460" y2="1460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1465" y2="1465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1470" y2="1470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1475" y2="1475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1480" y2="1480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1485" y2="1485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1490" y2="1490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1495" y2="1495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1500" y2="1500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1505" y2="1505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1510" y2="1510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1515" y2="1515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1520" y2="1520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1525" y2="1525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1530" y2="1530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1535" y2="1535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1540" y2="1540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1545" y2="1545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1550" y2="1550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1555" y2="1555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1560" y2="1560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1565" y2="1565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1570" y2="1570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1575" y2="1575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1580" y2="1580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1585" y2="1585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1590" y2="1590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1595" y2="1595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1600" y2="1600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1605" y2="1605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1610" y2="1610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1615" y2="1615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1620" y2="1620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1625" y2="1625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1630" y2="1630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1635" y2="1635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1640" y2="1640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1645" y2="1645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1650" y2="1650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1655" y2="1655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1660" y2="1660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1665" y2="1665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1670" y2="1670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1675" y2="1675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1680" y2="1680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1685" y2="1685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1690" y2="1690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1695" y2="1695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1700" y2="1700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1705" y2="1705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1710" y2="1710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1715" y2="1715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1720" y2="1720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1725" y2="1725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1730" y2="1730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1735" y2="1735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1740" y2="1740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1745" y2="1745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1750" y2="1750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1755" y2="1755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1760" y2="1760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1765" y2="1765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1770" y2="1770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1775" y2="1775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1780" y2="1780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1785" y2="1785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1790" y2="1790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1795" y2="1795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1800" y2="1800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1805" y2="1805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1810" y2="1810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1815" y2="1815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1820" y2="1820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1825" y2="1825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1830" y2="1830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1835" y2="1835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1840" y2="1840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1845" y2="1845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1850" y2="1850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1855" y2="1855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1860" y2="1860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1865" y2="1865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1870" y2="1870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1875" y2="1875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1880" y2="1880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1885" y2="1885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1890" y2="1890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1895" y2="1895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1900" y2="1900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1905" y2="1905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1910" y2="1910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1915" y2="1915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1920" y2="1920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1925" y2="1925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1930" y2="1930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1935" y2="1935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1940" y2="1940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1945" y2="1945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1950" y2="1950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1955" y2="1955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1960" y2="1960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1965" y2="1965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1970" y2="1970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1975" y2="1975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1980" y2="1980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1985" y2="1985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1990" y2="1990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="1995" y2="1995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2000" y2="2000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2005" y2="2005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2010" y2="2010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2015" y2="2015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2020" y2="2020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2025" y2="2025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2030" y2="2030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2035" y2="2035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2040" y2="2040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2045" y2="2045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2050" y2="2050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2055" y2="2055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2060" y2="2060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2065" y2="2065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2070" y2="2070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2075" y2="2075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2080" y2="2080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2085" y2="2085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2090" y2="2090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2095" y2="2095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2100" y2="2100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2105" y2="2105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2110" y2="2110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2115" y2="2115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2120" y2="2120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2125" y2="2125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2130" y2="2130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2135" y2="2135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2140" y2="2140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2145" y2="2145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2150" y2="2150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2155" y2="2155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2160" y2="2160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2165" y2="2165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2170" y2="2170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2175" y2="2175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2180" y2="2180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2185" y2="2185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2190" y2="2190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2195" y2="2195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2200" y2="2200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2205" y2="2205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2210" y2="2210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2215" y2="2215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2220" y2="2220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2225" y2="2225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2230" y2="2230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2235" y2="2235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2240" y2="2240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2245" y2="2245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2250" y2="2250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2255" y2="2255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2260" y2="2260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2265" y2="2265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2270" y2="2270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2275" y2="2275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2280" y2="2280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2285" y2="2285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2290" y2="2290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2295" y2="2295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2300" y2="2300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2305" y2="2305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2310" y2="2310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2315" y2="2315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2320" y2="2320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2325" y2="2325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2330" y2="2330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2335" y2="2335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2340" y2="2340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2345" y2="2345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2350" y2="2350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2355" y2="2355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2360" y2="2360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2365" y2="2365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2370" y2="2370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2375" y2="2375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2380" y2="2380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2385" y2="2385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2390" y2="2390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2395" y2="2395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2400" y2="2400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2405" y2="2405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2410" y2="2410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2415" y2="2415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2420" y2="2420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2425" y2="2425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2430" y2="2430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2435" y2="2435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2440" y2="2440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2445" y2="2445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2450" y2="2450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2455" y2="2455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2460" y2="2460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2465" y2="2465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2470" y2="2470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2475" y2="2475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2480" y2="2480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2485" y2="2485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2490" y2="2490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2495" y2="2495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2500" y2="2500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2505" y2="2505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2510" y2="2510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2515" y2="2515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2520" y2="2520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2525" y2="2525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2530" y2="2530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2535" y2="2535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2540" y2="2540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2545" y2="2545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2550" y2="2550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2555" y2="2555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2560" y2="2560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2565" y2="2565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2570" y2="2570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2575" y2="2575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2580" y2="2580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2585" y2="2585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2590" y2="2590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2595" y2="2595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2600" y2="2600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2605" y2="2605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2610" y2="2610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2615" y2="2615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2620" y2="2620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2625" y2="2625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2630" y2="2630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2635" y2="2635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2640" y2="2640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2645" y2="2645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2650" y2="2650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2655" y2="2655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2660" y2="2660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2665" y2="2665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2670" y2="2670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2675" y2="2675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2680" y2="2680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2685" y2="2685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2690" y2="2690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2695" y2="2695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2700" y2="2700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2705" y2="2705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2710" y2="2710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2715" y2="2715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2720" y2="2720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2725" y2="2725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2730" y2="2730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2735" y2="2735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2740" y2="2740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2745" y2="2745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2750" y2="2750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2755" y2="2755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2760" y2="2760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2765" y2="2765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2770" y2="2770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2775" y2="2775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2780" y2="2780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2785" y2="2785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2790" y2="2790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2795" y2="2795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2800" y2="2800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2805" y2="2805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2810" y2="2810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2815" y2="2815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2820" y2="2820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2825" y2="2825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2830" y2="2830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2835" y2="2835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2840" y2="2840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2845" y2="2845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2850" y2="2850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2855" y2="2855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2860" y2="2860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2865" y2="2865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2870" y2="2870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2875" y2="2875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2880" y2="2880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2885" y2="2885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2890" y2="2890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2895" y2="2895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2900" y2="2900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2905" y2="2905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2910" y2="2910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2915" y2="2915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2920" y2="2920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2925" y2="2925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2930" y2="2930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2935" y2="2935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2940" y2="2940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2945" y2="2945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2950" y2="2950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2955" y2="2955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2960" y2="2960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2965" y2="2965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2970" y2="2970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2975" y2="2975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2980" y2="2980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2985" y2="2985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2990" y2="2990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="2995" y2="2995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3000" y2="3000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3005" y2="3005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3010" y2="3010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3015" y2="3015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3020" y2="3020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3025" y2="3025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3030" y2="3030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3035" y2="3035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3040" y2="3040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3045" y2="3045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3050" y2="3050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3055" y2="3055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3060" y2="3060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3065" y2="3065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3070" y2="3070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3075" y2="3075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3080" y2="3080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3085" y2="3085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3090" y2="3090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3095" y2="3095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3100" y2="3100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3105" y2="3105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3110" y2="3110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3115" y2="3115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3120" y2="3120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3125" y2="3125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3130" y2="3130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3135" y2="3135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3140" y2="3140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3145" y2="3145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3150" y2="3150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3155" y2="3155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3160" y2="3160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3165" y2="3165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3170" y2="3170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3175" y2="3175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3180" y2="3180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3185" y2="3185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3190" y2="3190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3195" y2="3195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3200" y2="3200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3205" y2="3205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3210" y2="3210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3215" y2="3215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3220" y2="3220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3225" y2="3225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3230" y2="3230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3235" y2="3235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3240" y2="3240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3245" y2="3245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3250" y2="3250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3255" y2="3255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3260" y2="3260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3265" y2="3265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3270" y2="3270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3275" y2="3275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3280" y2="3280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3285" y2="3285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3290" y2="3290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3295" y2="3295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3300" y2="3300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3305" y2="3305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3310" y2="3310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3315" y2="3315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3320" y2="3320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3325" y2="3325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3330" y2="3330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3335" y2="3335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3340" y2="3340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3345" y2="3345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3350" y2="3350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3355" y2="3355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3360" y2="3360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3365" y2="3365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3370" y2="3370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3375" y2="3375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3380" y2="3380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3385" y2="3385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3390" y2="3390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3395" y2="3395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3400" y2="3400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3405" y2="3405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3410" y2="3410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3415" y2="3415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3420" y2="3420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3425" y2="3425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3430" y2="3430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3435" y2="3435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3440" y2="3440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3445" y2="3445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3450" y2="3450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3455" y2="3455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3460" y2="3460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3465" y2="3465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3470" y2="3470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3475" y2="3475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3480" y2="3480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3485" y2="3485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3490" y2="3490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3495" y2="3495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3500" y2="3500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3505" y2="3505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3510" y2="3510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3515" y2="3515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3520" y2="3520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3525" y2="3525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3530" y2="3530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3535" y2="3535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3540" y2="3540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3545" y2="3545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3550" y2="3550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3555" y2="3555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3560" y2="3560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3565" y2="3565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3570" y2="3570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3575" y2="3575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3580" y2="3580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3585" y2="3585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3590" y2="3590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3595" y2="3595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3600" y2="3600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3605" y2="3605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3610" y2="3610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3615" y2="3615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3620" y2="3620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3625" y2="3625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3630" y2="3630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3635" y2="3635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3640" y2="3640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3645" y2="3645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3650" y2="3650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3655" y2="3655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3660" y2="3660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3665" y2="3665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3670" y2="3670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3675" y2="3675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3680" y2="3680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3685" y2="3685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3690" y2="3690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3695" y2="3695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3700" y2="3700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3705" y2="3705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3710" y2="3710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3715" y2="3715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3720" y2="3720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3725" y2="3725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3730" y2="3730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3735" y2="3735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3740" y2="3740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3745" y2="3745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3750" y2="3750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3755" y2="3755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3760" y2="3760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3765" y2="3765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3770" y2="3770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3775" y2="3775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3780" y2="3780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3785" y2="3785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3790" y2="3790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3795" y2="3795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3800" y2="3800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3805" y2="3805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3810" y2="3810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3815" y2="3815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3820" y2="3820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3825" y2="3825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3830" y2="3830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3835" y2="3835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3840" y2="3840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3845" y2="3845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3850" y2="3850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3855" y2="3855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3860" y2="3860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3865" y2="3865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3870" y2="3870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3875" y2="3875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3880" y2="3880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3885" y2="3885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3890" y2="3890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3895" y2="3895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3900" y2="3900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3905" y2="3905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3910" y2="3910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3915" y2="3915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3920" y2="3920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3925" y2="3925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3930" y2="3930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3935" y2="3935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3940" y2="3940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3945" y2="3945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3950" y2="3950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3955" y2="3955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3960" y2="3960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3965" y2="3965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3970" y2="3970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3975" y2="3975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3980" y2="3980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3985" y2="3985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3990" y2="3990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="3995" y2="3995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4000" y2="4000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4005" y2="4005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4010" y2="4010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4015" y2="4015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4020" y2="4020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4025" y2="4025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4030" y2="4030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4035" y2="4035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4040" y2="4040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4045" y2="4045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4050" y2="4050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4055" y2="4055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4060" y2="4060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4065" y2="4065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4070" y2="4070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4075" y2="4075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4080" y2="4080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4085" y2="4085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4090" y2="4090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4095" y2="4095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4100" y2="4100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4105" y2="4105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4110" y2="4110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4115" y2="4115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4120" y2="4120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4125" y2="4125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4130" y2="4130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4135" y2="4135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4140" y2="4140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4145" y2="4145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4150" y2="4150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4155" y2="4155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4160" y2="4160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4165" y2="4165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4170" y2="4170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4175" y2="4175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4180" y2="4180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4185" y2="4185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4190" y2="4190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4195" y2="4195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4200" y2="4200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4205" y2="4205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4210" y2="4210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4215" y2="4215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4220" y2="4220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4225" y2="4225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4230" y2="4230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4235" y2="4235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4240" y2="4240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4245" y2="4245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4250" y2="4250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4255" y2="4255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4260" y2="4260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4265" y2="4265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4270" y2="4270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4275" y2="4275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4280" y2="4280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4285" y2="4285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4290" y2="4290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4295" y2="4295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4300" y2="4300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4305" y2="4305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4310" y2="4310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4315" y2="4315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4320" y2="4320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4325" y2="4325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4330" y2="4330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4335" y2="4335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4340" y2="4340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4345" y2="4345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4350" y2="4350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4355" y2="4355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4360" y2="4360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4365" y2="4365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4370" y2="4370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4375" y2="4375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4380" y2="4380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4385" y2="4385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4390" y2="4390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4395" y2="4395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4400" y2="4400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4405" y2="4405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4410" y2="4410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4415" y2="4415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4420" y2="4420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4425" y2="4425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4430" y2="4430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4435" y2="4435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4440" y2="4440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4445" y2="4445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4450" y2="4450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4455" y2="4455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4460" y2="4460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4465" y2="4465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4470" y2="4470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4475" y2="4475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4480" y2="4480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4485" y2="4485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4490" y2="4490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4495" y2="4495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4500" y2="4500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4505" y2="4505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4510" y2="4510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4515" y2="4515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4520" y2="4520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4525" y2="4525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4530" y2="4530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4535" y2="4535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4540" y2="4540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4545" y2="4545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4550" y2="4550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4555" y2="4555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4560" y2="4560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4565" y2="4565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4570" y2="4570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4575" y2="4575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4580" y2="4580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4585" y2="4585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4590" y2="4590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4595" y2="4595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4600" y2="4600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4605" y2="4605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4610" y2="4610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4615" y2="4615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4620" y2="4620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4625" y2="4625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4630" y2="4630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4635" y2="4635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4640" y2="4640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4645" y2="4645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4650" y2="4650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4655" y2="4655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4660" y2="4660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4665" y2="4665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4670" y2="4670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4675" y2="4675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4680" y2="4680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4685" y2="4685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4690" y2="4690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4695" y2="4695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4700" y2="4700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4705" y2="4705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4710" y2="4710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4715" y2="4715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4720" y2="4720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4725" y2="4725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4730" y2="4730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4735" y2="4735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4740" y2="4740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4745" y2="4745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4750" y2="4750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4755" y2="4755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4760" y2="4760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4765" y2="4765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4770" y2="4770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4775" y2="4775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4780" y2="4780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4785" y2="4785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4790" y2="4790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4795" y2="4795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4800" y2="4800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4805" y2="4805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4810" y2="4810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4815" y2="4815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4820" y2="4820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4825" y2="4825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4830" y2="4830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4835" y2="4835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4840" y2="4840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4845" y2="4845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4850" y2="4850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4855" y2="4855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4860" y2="4860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4865" y2="4865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4870" y2="4870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4875" y2="4875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4880" y2="4880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4885" y2="4885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4890" y2="4890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4895" y2="4895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4900" y2="4900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4905" y2="4905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4910" y2="4910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4915" y2="4915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4920" y2="4920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4925" y2="4925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4930" y2="4930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4935" y2="4935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4940" y2="4940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4945" y2="4945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4950" y2="4950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4955" y2="4955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4960" y2="4960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4965" y2="4965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4970" y2="4970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4975" y2="4975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4980" y2="4980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4985" y2="4985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4990" y2="4990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="horizontal" x1="0" x2="5000" y1="4995" y2="4995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="0" x2="0" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="5" x2="5" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="10" x2="10" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="15" x2="15" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="20" x2="20" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="25" x2="25" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="30" x2="30" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="35" x2="35" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="40" x2="40" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="45" x2="45" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="50" x2="50" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="55" x2="55" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="60" x2="60" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="65" x2="65" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="70" x2="70" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="75" x2="75" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="80" x2="80" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="85" x2="85" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="90" x2="90" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="95" x2="95" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="100" x2="100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="105" x2="105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="110" x2="110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="115" x2="115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="120" x2="120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="125" x2="125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="130" x2="130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="135" x2="135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="140" x2="140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="145" x2="145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="150" x2="150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="155" x2="155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="160" x2="160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="165" x2="165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="170" x2="170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="175" x2="175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="180" x2="180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="185" x2="185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="190" x2="190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="195" x2="195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="200" x2="200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="205" x2="205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="210" x2="210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="215" x2="215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="220" x2="220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="225" x2="225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="230" x2="230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="235" x2="235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="240" x2="240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="245" x2="245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="250" x2="250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="255" x2="255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="260" x2="260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="265" x2="265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="270" x2="270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="275" x2="275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="280" x2="280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="285" x2="285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="290" x2="290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="295" x2="295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="300" x2="300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="305" x2="305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="310" x2="310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="315" x2="315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="320" x2="320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="325" x2="325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="330" x2="330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="335" x2="335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="340" x2="340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="345" x2="345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="350" x2="350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="355" x2="355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="360" x2="360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="365" x2="365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="370" x2="370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="375" x2="375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="380" x2="380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="385" x2="385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="390" x2="390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="395" x2="395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="400" x2="400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="405" x2="405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="410" x2="410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="415" x2="415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="420" x2="420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="425" x2="425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="430" x2="430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="435" x2="435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="440" x2="440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="445" x2="445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="450" x2="450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="455" x2="455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="460" x2="460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="465" x2="465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="470" x2="470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="475" x2="475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="480" x2="480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="485" x2="485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="490" x2="490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="495" x2="495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="500" x2="500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="505" x2="505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="510" x2="510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="515" x2="515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="520" x2="520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="525" x2="525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="530" x2="530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="535" x2="535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="540" x2="540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="545" x2="545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="550" x2="550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="555" x2="555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="560" x2="560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="565" x2="565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="570" x2="570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="575" x2="575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="580" x2="580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="585" x2="585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="590" x2="590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="595" x2="595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="600" x2="600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="605" x2="605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="610" x2="610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="615" x2="615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="620" x2="620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="625" x2="625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="630" x2="630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="635" x2="635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="640" x2="640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="645" x2="645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="650" x2="650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="655" x2="655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="660" x2="660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="665" x2="665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="670" x2="670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="675" x2="675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="680" x2="680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="685" x2="685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="690" x2="690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="695" x2="695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="700" x2="700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="705" x2="705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="710" x2="710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="715" x2="715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="720" x2="720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="725" x2="725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="730" x2="730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="735" x2="735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="740" x2="740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="745" x2="745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="750" x2="750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="755" x2="755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="760" x2="760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="765" x2="765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="770" x2="770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="775" x2="775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="780" x2="780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="785" x2="785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="790" x2="790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="795" x2="795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="800" x2="800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="805" x2="805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="810" x2="810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="815" x2="815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="820" x2="820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="825" x2="825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="830" x2="830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="835" x2="835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="840" x2="840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="845" x2="845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="850" x2="850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="855" x2="855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="860" x2="860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="865" x2="865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="870" x2="870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="875" x2="875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="880" x2="880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="885" x2="885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="890" x2="890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="895" x2="895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="900" x2="900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="905" x2="905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="910" x2="910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="915" x2="915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="920" x2="920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="925" x2="925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="930" x2="930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="935" x2="935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="940" x2="940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="945" x2="945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="950" x2="950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="955" x2="955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="960" x2="960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="965" x2="965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="970" x2="970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="975" x2="975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="980" x2="980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="985" x2="985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="990" x2="990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="995" x2="995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1000" x2="1000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1005" x2="1005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1010" x2="1010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1015" x2="1015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1020" x2="1020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1025" x2="1025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1030" x2="1030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1035" x2="1035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1040" x2="1040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1045" x2="1045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1050" x2="1050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1055" x2="1055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1060" x2="1060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1065" x2="1065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1070" x2="1070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1075" x2="1075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1080" x2="1080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1085" x2="1085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1090" x2="1090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1095" x2="1095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1100" x2="1100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1105" x2="1105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1110" x2="1110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1115" x2="1115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1120" x2="1120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1125" x2="1125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1130" x2="1130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1135" x2="1135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1140" x2="1140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1145" x2="1145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1150" x2="1150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1155" x2="1155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1160" x2="1160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1165" x2="1165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1170" x2="1170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1175" x2="1175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1180" x2="1180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1185" x2="1185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1190" x2="1190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1195" x2="1195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1200" x2="1200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1205" x2="1205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1210" x2="1210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1215" x2="1215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1220" x2="1220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1225" x2="1225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1230" x2="1230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1235" x2="1235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1240" x2="1240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1245" x2="1245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1250" x2="1250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1255" x2="1255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1260" x2="1260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1265" x2="1265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1270" x2="1270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1275" x2="1275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1280" x2="1280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1285" x2="1285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1290" x2="1290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1295" x2="1295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1300" x2="1300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1305" x2="1305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1310" x2="1310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1315" x2="1315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1320" x2="1320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1325" x2="1325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1330" x2="1330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1335" x2="1335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1340" x2="1340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1345" x2="1345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1350" x2="1350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1355" x2="1355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1360" x2="1360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1365" x2="1365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1370" x2="1370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1375" x2="1375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1380" x2="1380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1385" x2="1385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1390" x2="1390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1395" x2="1395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1400" x2="1400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1405" x2="1405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1410" x2="1410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1415" x2="1415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1420" x2="1420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1425" x2="1425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1430" x2="1430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1435" x2="1435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1440" x2="1440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1445" x2="1445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1450" x2="1450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1455" x2="1455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1460" x2="1460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1465" x2="1465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1470" x2="1470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1475" x2="1475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1480" x2="1480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1485" x2="1485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1490" x2="1490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1495" x2="1495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1500" x2="1500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1505" x2="1505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1510" x2="1510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1515" x2="1515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1520" x2="1520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1525" x2="1525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1530" x2="1530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1535" x2="1535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1540" x2="1540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1545" x2="1545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1550" x2="1550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1555" x2="1555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1560" x2="1560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1565" x2="1565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1570" x2="1570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1575" x2="1575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1580" x2="1580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1585" x2="1585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1590" x2="1590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1595" x2="1595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1600" x2="1600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1605" x2="1605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1610" x2="1610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1615" x2="1615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1620" x2="1620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1625" x2="1625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1630" x2="1630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1635" x2="1635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1640" x2="1640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1645" x2="1645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1650" x2="1650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1655" x2="1655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1660" x2="1660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1665" x2="1665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1670" x2="1670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1675" x2="1675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1680" x2="1680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1685" x2="1685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1690" x2="1690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1695" x2="1695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1700" x2="1700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1705" x2="1705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1710" x2="1710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1715" x2="1715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1720" x2="1720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1725" x2="1725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1730" x2="1730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1735" x2="1735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1740" x2="1740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1745" x2="1745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1750" x2="1750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1755" x2="1755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1760" x2="1760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1765" x2="1765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1770" x2="1770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1775" x2="1775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1780" x2="1780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1785" x2="1785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1790" x2="1790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1795" x2="1795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1800" x2="1800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1805" x2="1805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1810" x2="1810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1815" x2="1815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1820" x2="1820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1825" x2="1825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1830" x2="1830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1835" x2="1835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1840" x2="1840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1845" x2="1845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1850" x2="1850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1855" x2="1855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1860" x2="1860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1865" x2="1865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1870" x2="1870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1875" x2="1875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1880" x2="1880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1885" x2="1885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1890" x2="1890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1895" x2="1895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1900" x2="1900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1905" x2="1905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1910" x2="1910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1915" x2="1915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1920" x2="1920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1925" x2="1925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1930" x2="1930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1935" x2="1935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1940" x2="1940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1945" x2="1945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1950" x2="1950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1955" x2="1955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1960" x2="1960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1965" x2="1965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1970" x2="1970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1975" x2="1975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1980" x2="1980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1985" x2="1985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1990" x2="1990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="1995" x2="1995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2000" x2="2000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2005" x2="2005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2010" x2="2010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2015" x2="2015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2020" x2="2020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2025" x2="2025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2030" x2="2030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2035" x2="2035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2040" x2="2040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2045" x2="2045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2050" x2="2050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2055" x2="2055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2060" x2="2060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2065" x2="2065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2070" x2="2070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2075" x2="2075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2080" x2="2080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2085" x2="2085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2090" x2="2090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2095" x2="2095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2100" x2="2100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2105" x2="2105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2110" x2="2110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2115" x2="2115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2120" x2="2120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2125" x2="2125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2130" x2="2130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2135" x2="2135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2140" x2="2140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2145" x2="2145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2150" x2="2150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2155" x2="2155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2160" x2="2160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2165" x2="2165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2170" x2="2170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2175" x2="2175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2180" x2="2180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2185" x2="2185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2190" x2="2190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2195" x2="2195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2200" x2="2200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2205" x2="2205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2210" x2="2210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2215" x2="2215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2220" x2="2220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2225" x2="2225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2230" x2="2230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2235" x2="2235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2240" x2="2240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2245" x2="2245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2250" x2="2250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2255" x2="2255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2260" x2="2260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2265" x2="2265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2270" x2="2270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2275" x2="2275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2280" x2="2280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2285" x2="2285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2290" x2="2290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2295" x2="2295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2300" x2="2300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2305" x2="2305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2310" x2="2310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2315" x2="2315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2320" x2="2320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2325" x2="2325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2330" x2="2330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2335" x2="2335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2340" x2="2340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2345" x2="2345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2350" x2="2350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2355" x2="2355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2360" x2="2360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2365" x2="2365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2370" x2="2370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2375" x2="2375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2380" x2="2380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2385" x2="2385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2390" x2="2390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2395" x2="2395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2400" x2="2400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2405" x2="2405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2410" x2="2410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2415" x2="2415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2420" x2="2420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2425" x2="2425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2430" x2="2430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2435" x2="2435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2440" x2="2440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2445" x2="2445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2450" x2="2450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2455" x2="2455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2460" x2="2460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2465" x2="2465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2470" x2="2470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2475" x2="2475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2480" x2="2480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2485" x2="2485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2490" x2="2490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2495" x2="2495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2500" x2="2500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2505" x2="2505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2510" x2="2510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2515" x2="2515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2520" x2="2520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2525" x2="2525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2530" x2="2530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2535" x2="2535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2540" x2="2540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2545" x2="2545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2550" x2="2550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2555" x2="2555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2560" x2="2560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2565" x2="2565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2570" x2="2570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2575" x2="2575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2580" x2="2580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2585" x2="2585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2590" x2="2590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2595" x2="2595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2600" x2="2600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2605" x2="2605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2610" x2="2610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2615" x2="2615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2620" x2="2620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2625" x2="2625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2630" x2="2630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2635" x2="2635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2640" x2="2640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2645" x2="2645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2650" x2="2650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2655" x2="2655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2660" x2="2660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2665" x2="2665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2670" x2="2670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2675" x2="2675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2680" x2="2680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2685" x2="2685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2690" x2="2690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2695" x2="2695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2700" x2="2700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2705" x2="2705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2710" x2="2710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2715" x2="2715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2720" x2="2720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2725" x2="2725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2730" x2="2730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2735" x2="2735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2740" x2="2740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2745" x2="2745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2750" x2="2750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2755" x2="2755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2760" x2="2760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2765" x2="2765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2770" x2="2770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2775" x2="2775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2780" x2="2780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2785" x2="2785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2790" x2="2790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2795" x2="2795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2800" x2="2800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2805" x2="2805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2810" x2="2810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2815" x2="2815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2820" x2="2820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2825" x2="2825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2830" x2="2830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2835" x2="2835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2840" x2="2840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2845" x2="2845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2850" x2="2850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2855" x2="2855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2860" x2="2860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2865" x2="2865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2870" x2="2870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2875" x2="2875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2880" x2="2880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2885" x2="2885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2890" x2="2890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2895" x2="2895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2900" x2="2900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2905" x2="2905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2910" x2="2910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2915" x2="2915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2920" x2="2920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2925" x2="2925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2930" x2="2930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2935" x2="2935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2940" x2="2940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2945" x2="2945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2950" x2="2950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2955" x2="2955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2960" x2="2960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2965" x2="2965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2970" x2="2970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2975" x2="2975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2980" x2="2980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2985" x2="2985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2990" x2="2990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="2995" x2="2995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3000" x2="3000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3005" x2="3005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3010" x2="3010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3015" x2="3015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3020" x2="3020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3025" x2="3025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3030" x2="3030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3035" x2="3035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3040" x2="3040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3045" x2="3045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3050" x2="3050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3055" x2="3055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3060" x2="3060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3065" x2="3065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3070" x2="3070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3075" x2="3075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3080" x2="3080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3085" x2="3085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3090" x2="3090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3095" x2="3095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3100" x2="3100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3105" x2="3105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3110" x2="3110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3115" x2="3115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3120" x2="3120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3125" x2="3125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3130" x2="3130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3135" x2="3135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3140" x2="3140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3145" x2="3145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3150" x2="3150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3155" x2="3155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3160" x2="3160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3165" x2="3165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3170" x2="3170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3175" x2="3175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3180" x2="3180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3185" x2="3185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3190" x2="3190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3195" x2="3195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3200" x2="3200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3205" x2="3205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3210" x2="3210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3215" x2="3215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3220" x2="3220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3225" x2="3225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3230" x2="3230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3235" x2="3235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3240" x2="3240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3245" x2="3245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3250" x2="3250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3255" x2="3255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3260" x2="3260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3265" x2="3265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3270" x2="3270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3275" x2="3275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3280" x2="3280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3285" x2="3285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3290" x2="3290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3295" x2="3295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3300" x2="3300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3305" x2="3305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3310" x2="3310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3315" x2="3315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3320" x2="3320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3325" x2="3325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3330" x2="3330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3335" x2="3335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3340" x2="3340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3345" x2="3345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3350" x2="3350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3355" x2="3355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3360" x2="3360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3365" x2="3365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3370" x2="3370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3375" x2="3375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3380" x2="3380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3385" x2="3385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3390" x2="3390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3395" x2="3395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3400" x2="3400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3405" x2="3405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3410" x2="3410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3415" x2="3415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3420" x2="3420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3425" x2="3425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3430" x2="3430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3435" x2="3435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3440" x2="3440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3445" x2="3445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3450" x2="3450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3455" x2="3455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3460" x2="3460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3465" x2="3465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3470" x2="3470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3475" x2="3475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3480" x2="3480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3485" x2="3485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3490" x2="3490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3495" x2="3495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3500" x2="3500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3505" x2="3505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3510" x2="3510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3515" x2="3515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3520" x2="3520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3525" x2="3525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3530" x2="3530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3535" x2="3535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3540" x2="3540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3545" x2="3545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3550" x2="3550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3555" x2="3555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3560" x2="3560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3565" x2="3565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3570" x2="3570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3575" x2="3575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3580" x2="3580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3585" x2="3585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3590" x2="3590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3595" x2="3595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3600" x2="3600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3605" x2="3605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3610" x2="3610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3615" x2="3615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3620" x2="3620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3625" x2="3625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3630" x2="3630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3635" x2="3635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3640" x2="3640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3645" x2="3645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3650" x2="3650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3655" x2="3655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3660" x2="3660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3665" x2="3665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3670" x2="3670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3675" x2="3675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3680" x2="3680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3685" x2="3685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3690" x2="3690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3695" x2="3695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3700" x2="3700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3705" x2="3705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3710" x2="3710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3715" x2="3715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3720" x2="3720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3725" x2="3725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3730" x2="3730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3735" x2="3735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3740" x2="3740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3745" x2="3745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3750" x2="3750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3755" x2="3755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3760" x2="3760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3765" x2="3765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3770" x2="3770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3775" x2="3775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3780" x2="3780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3785" x2="3785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3790" x2="3790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3795" x2="3795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3800" x2="3800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3805" x2="3805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3810" x2="3810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3815" x2="3815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3820" x2="3820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3825" x2="3825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3830" x2="3830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3835" x2="3835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3840" x2="3840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3845" x2="3845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3850" x2="3850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3855" x2="3855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3860" x2="3860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3865" x2="3865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3870" x2="3870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3875" x2="3875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3880" x2="3880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3885" x2="3885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3890" x2="3890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3895" x2="3895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3900" x2="3900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3905" x2="3905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3910" x2="3910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3915" x2="3915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3920" x2="3920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3925" x2="3925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3930" x2="3930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3935" x2="3935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3940" x2="3940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3945" x2="3945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3950" x2="3950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3955" x2="3955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3960" x2="3960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3965" x2="3965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3970" x2="3970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3975" x2="3975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3980" x2="3980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3985" x2="3985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3990" x2="3990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="3995" x2="3995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4000" x2="4000" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4005" x2="4005" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4010" x2="4010" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4015" x2="4015" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4020" x2="4020" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4025" x2="4025" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4030" x2="4030" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4035" x2="4035" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4040" x2="4040" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4045" x2="4045" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4050" x2="4050" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4055" x2="4055" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4060" x2="4060" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4065" x2="4065" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4070" x2="4070" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4075" x2="4075" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4080" x2="4080" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4085" x2="4085" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4090" x2="4090" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4095" x2="4095" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4100" x2="4100" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4105" x2="4105" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4110" x2="4110" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4115" x2="4115" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4120" x2="4120" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4125" x2="4125" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4130" x2="4130" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4135" x2="4135" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4140" x2="4140" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4145" x2="4145" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4150" x2="4150" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4155" x2="4155" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4160" x2="4160" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4165" x2="4165" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4170" x2="4170" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4175" x2="4175" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4180" x2="4180" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4185" x2="4185" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4190" x2="4190" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4195" x2="4195" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4200" x2="4200" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4205" x2="4205" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4210" x2="4210" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4215" x2="4215" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4220" x2="4220" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4225" x2="4225" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4230" x2="4230" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4235" x2="4235" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4240" x2="4240" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4245" x2="4245" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4250" x2="4250" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4255" x2="4255" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4260" x2="4260" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4265" x2="4265" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4270" x2="4270" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4275" x2="4275" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4280" x2="4280" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4285" x2="4285" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4290" x2="4290" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4295" x2="4295" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4300" x2="4300" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4305" x2="4305" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4310" x2="4310" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4315" x2="4315" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4320" x2="4320" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4325" x2="4325" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4330" x2="4330" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4335" x2="4335" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4340" x2="4340" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4345" x2="4345" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4350" x2="4350" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4355" x2="4355" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4360" x2="4360" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4365" x2="4365" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4370" x2="4370" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4375" x2="4375" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4380" x2="4380" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4385" x2="4385" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4390" x2="4390" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4395" x2="4395" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4400" x2="4400" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4405" x2="4405" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4410" x2="4410" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4415" x2="4415" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4420" x2="4420" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4425" x2="4425" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4430" x2="4430" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4435" x2="4435" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4440" x2="4440" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4445" x2="4445" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4450" x2="4450" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4455" x2="4455" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4460" x2="4460" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4465" x2="4465" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4470" x2="4470" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4475" x2="4475" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4480" x2="4480" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4485" x2="4485" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4490" x2="4490" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4495" x2="4495" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4500" x2="4500" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4505" x2="4505" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4510" x2="4510" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4515" x2="4515" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4520" x2="4520" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4525" x2="4525" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4530" x2="4530" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4535" x2="4535" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4540" x2="4540" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4545" x2="4545" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4550" x2="4550" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4555" x2="4555" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4560" x2="4560" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4565" x2="4565" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4570" x2="4570" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4575" x2="4575" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4580" x2="4580" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4585" x2="4585" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4590" x2="4590" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4595" x2="4595" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4600" x2="4600" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4605" x2="4605" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4610" x2="4610" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4615" x2="4615" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4620" x2="4620" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4625" x2="4625" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4630" x2="4630" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4635" x2="4635" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4640" x2="4640" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4645" x2="4645" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4650" x2="4650" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4655" x2="4655" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4660" x2="4660" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4665" x2="4665" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4670" x2="4670" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4675" x2="4675" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4680" x2="4680" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4685" x2="4685" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4690" x2="4690" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4695" x2="4695" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4700" x2="4700" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4705" x2="4705" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4710" x2="4710" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4715" x2="4715" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4720" x2="4720" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4725" x2="4725" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4730" x2="4730" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4735" x2="4735" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4740" x2="4740" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4745" x2="4745" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4750" x2="4750" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4755" x2="4755" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4760" x2="4760" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4765" x2="4765" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4770" x2="4770" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4775" x2="4775" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4780" x2="4780" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4785" x2="4785" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4790" x2="4790" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4795" x2="4795" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4800" x2="4800" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4805" x2="4805" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4810" x2="4810" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4815" x2="4815" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4820" x2="4820" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4825" x2="4825" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4830" x2="4830" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4835" x2="4835" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4840" x2="4840" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4845" x2="4845" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4850" x2="4850" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4855" x2="4855" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4860" x2="4860" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4865" x2="4865" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4870" x2="4870" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4875" x2="4875" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4880" x2="4880" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4885" x2="4885" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4890" x2="4890" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4895" x2="4895" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4900" x2="4900" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4905" x2="4905" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4910" x2="4910" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4915" x2="4915" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4920" x2="4920" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4925" x2="4925" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4930" x2="4930" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4935" x2="4935" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4940" x2="4940" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4945" x2="4945" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4950" x2="4950" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4955" x2="4955" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4960" x2="4960" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4965" x2="4965" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4970" x2="4970" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4975" x2="4975" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4980" x2="4980" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4985" x2="4985" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4990" x2="4990" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line><line class="vertical" y1="0" y2="5000" x1="4995" x2="4995" fill="none" shape-rendering="crispEdges" stroke="#eee" stroke-width="1px"></line></g><g></g><g class="link"><path class="link_background link_path" d="M 314 107 C 389 107 363 102 438 102"></path><path class="link_outline link_path" d="M 314 107 C 389 107 363 102 438 102"></path><path class="link_line link_path" d="M 314 107 C 389 107 363 102 438 102"></path></g><g class="link"><path class="link_background link_path" d="M 325 168 C 400 168 354 172 429 172"></path><path class="link_outline link_path" d="M 325 168 C 400 168 354 172 429 172"></path><path class="link_line link_path" d="M 325 168 C 400 168 354 172 429 172"></path></g><g class="link"><path class="link_background link_path" d="M 328 297 C 403 297 358 289 433 289"></path><path class="link_outline link_path" d="M 328 297 C 403 297 358 289 433 289"></path><path class="link_line link_path" d="M 328 297 C 403 297 358 289 433 289"></path></g><g class="link"><path class="link_background link_path" d="M 302 358 C 377 358 355 366 430 366"></path><path class="link_outline link_path" d="M 302 358 C 377 358 355 366 430 366"></path><path class="link_line link_path" d="M 302 358 C 377 358 355 366 430 366"></path></g><g class="node nodegroup" id="e7314328.e889a" transform="translate(114,92)"><rect class="node" rx="5" ry="5" fill="#d8bfd8" width="200" height="30"></rect><g class="node_icon_group" x="0" y="0" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/bridge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label " x="38" dy=".35em" text-anchor="start" y="14">smartfactory001/temp</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="190" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="190" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(195,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="5216ab93.c56264" transform="translate(105,153)"><rect class="node" rx="5" ry="5" fill="#d8bfd8" width="220" height="30"></rect><g class="node_icon_group" x="0" y="0" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/bridge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label " x="38" dy=".35em" text-anchor="start" y="14">smartfactory001/proximity</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="210" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="210" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(215,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="89e65cbe.49bd6" transform="translate(108,282)"><rect class="node node_hovered" rx="5" ry="5" fill="#d8bfd8" width="220" height="30"></rect><g class="node_icon_group" x="0" y="0" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/bridge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label " x="38" dy=".35em" text-anchor="start" y="14">smartfactory001/proximity</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="210" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="210" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(215,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="b4a97500.dc1458" transform="translate(102,343)"><rect class="node" rx="5" ry="5" fill="#d8bfd8" width="200" height="30"></rect><g class="node_icon_group" x="0" y="0" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red/bridge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 30 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label " x="38" dy=".35em" text-anchor="start" y="14">smartfactory001/temp</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="190" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="190" y="-6" width="10" height="10"></image><g class="port_output" transform="translate(195,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="85e79ce.0e0ab6" transform="translate(438,87)"><rect class="node" rx="5" ry="5" fill="rgb(119, 198, 204)" width="100" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(70,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red-dashboard/ui_gauge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="62" dy=".35em" text-anchor="end" y="14">temp</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="90" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="90" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="bbd10acd.513e38" transform="translate(433,274)"><rect class="node" rx="5" ry="5" fill="rgb(119, 198, 204)" width="120" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(90,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red-dashboard/ui_gauge.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="82" dy=".35em" text-anchor="end" y="14">proximity</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="110" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="110" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="de52c3a1.2d89d" transform="translate(429,157)"><rect class="node" rx="5" ry="5" fill="rgb(119, 198, 204)" width="120" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(90,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red-dashboard/ui_chart.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="82" dy=".35em" text-anchor="end" y="14">proximity</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="110" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="110" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(115,3.5)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(115,16.5)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g><g class="node nodegroup" id="6cba6a6d.f73044" transform="translate(430,351)"><rect class="node" rx="5" ry="5" fill="rgb(119, 198, 204)" width="100" height="30"></rect><g class="node_icon_group node_icon_group_right" x="0" y="0" transform="translate(70,0)" style="pointer-events: none;"><rect x="0" y="0" class="node_icon_shade" width="30" stroke="none" fill="#000" fill-opacity="0.05" height="30"></rect><image href="icons/node-red-dashboard/ui_chart.png" class="node_icon" x="5" width="20" height="30" y="0"></image><path d="M 0 1 l 0 28" class="node_icon_shade_border" stroke-opacity="0.1" stroke="#000" stroke-width="1"></path></g><text class="node_label node_label_right" x="62" dy=".35em" text-anchor="end" y="14">temp</text><g class="node_status_group" style="display: none;"><rect class="node_status" x="6" y="1" width="9" height="9" rx="2" ry="2" stroke-width="3"></rect><text class="node_status_label" x="20" y="9"></text></g><image class="node_error hidden" href="icons/node-red/node-error.png" x="90" y="-6" width="10" height="9"></image><image class="node_changed hidden" href="icons/node-red/node-changed.png" x="90" y="-6" width="10" height="10"></image><g class="port_input" transform="translate(-5,10)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(95,3.5)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g><g class="port_output" transform="translate(95,16.5)"><rect class="port" rx="3" ry="3" width="10" height="10"></rect></g></g></g></g></svg></div>
        <div id="workspace-toolbar" style="display: none;"></div>
        <div id="workspace-footer">
            <a class="workspace-footer-button" id="btn-zoom-out" href="https://smartfactory00.mybluemix.net/red/#" style="display: inline-block;"><i class="fa fa-minus"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-zero" href="https://smartfactory00.mybluemix.net/red/#" style="display: inline-block;"><i class="fa fa-circle-o"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-in" href="https://smartfactory00.mybluemix.net/red/#" style="display: inline-block;"><i class="fa fa-plus"></i></a>
        </div>
        <div id="editor-shade" class="hide" style="display: none;"></div>
    </div>
    <div id="editor-stack"></div>
    <div id="palette">
        <img src="./Node-RED _ smartfactory00.mybluemix.net_files/spin.svg" class="palette-spinner hide" style="display: none;">
        <div id="palette-search" class="palette-search">
            <div class="red-ui-searchBox-container"><i class="fa fa-search"></i><input type="text" data-i18n="[placeholder]palette.filter" placeholder="filter nodes"><a href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-times"></i></a><span class="red-ui-searchBox-resultCount hide"></span></div>
        </div>
        <div id="palette-container" class="palette-scroll"><div id="palette-container-subflows" class="palette-category palette-close hide"><div id="palette-header-subflows" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>subflows</span></div><div class="palette-content" id="palette-base-category-subflows"><div id="palette-subflows-input"></div><div id="palette-subflows-output"></div><div id="palette-subflows-function"></div></div></div><div id="palette-container-input" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-input" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>input</span></div><div class="palette-content" id="palette-base-category-input" style=""><div id="palette-input-input"></div><div id="palette-input-output"></div><div id="palette-input-function"></div><div id="palette-input"><div id="palette_node_inject" class="palette_node ui-draggable" style="background-color: rgb(166, 187, 207); height: 28px;"><div class="palette_label" dir="">inject</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/inject.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_catch" class="palette_node ui-draggable" style="background-color: rgb(228, 145, 145); height: 28px;"><div class="palette_label" dir="">catch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/alert.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_status" class="palette_node ui-draggable" style="background-color: rgb(192, 237, 192); height: 28px;"><div class="palette_label" dir="">status</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/alert.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_link_in" class="palette_node ui-draggable" style="background-color: rgb(221, 221, 221); height: 28px;"><div class="palette_label" dir="">link</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/link-out.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_mqtt_in" class="palette_node ui-draggable" style="background-color: rgb(216, 191, 216); height: 28px;"><div class="palette_label" dir="">mqtt</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/bridge.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_http_in" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label" dir="">http</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_websocket_in" class="palette_node ui-draggable" style="background-color: rgb(215, 215, 160); height: 28px;"><div class="palette_label" dir="">websocket</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_tcp_in" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label" dir="">tcp</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_mqlight_in" class="palette_node ui-draggable" style="background-color: rgb(109, 167, 209); height: 28px;"><div class="palette_label" dir="">mqlight</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mqlightin.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_ibmiot_in" class="palette_node ui-draggable" style="background-color: rgb(0, 155, 255); height: 28px;"><div class="palette_label" dir="">ibmiot</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-contrib-scx-ibmiotapp/iotcloud-icon.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div></div></div><div id="palette-container-output" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-output" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>output</span></div><div class="palette-content" id="palette-base-category-output" style=""><div id="palette-output-input"></div><div id="palette-output-output"></div><div id="palette-output-function"></div><div id="palette-output"><div id="palette_node_debug" class="palette_node ui-draggable" style="background-color: rgb(135, 169, 128); height: 28px;"><div class="palette_label palette_label_right" dir="">debug</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red/debug.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_link_out" class="palette_node ui-draggable" style="background-color: rgb(221, 221, 221); height: 28px;"><div class="palette_label palette_label_right" dir="">link</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red/link-out.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_mqtt_out" class="palette_node ui-draggable" style="background-color: rgb(216, 191, 216); height: 28px;"><div class="palette_label palette_label_right" dir="">mqtt</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red/bridge.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_http_response" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label palette_label_right" dir="">http response</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_websocket_out" class="palette_node ui-draggable" style="background-color: rgb(215, 215, 160); height: 28px;"><div class="palette_label palette_label_right" dir="">websocket</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_tcp_out" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label palette_label_right" dir="">tcp</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_udp_out" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label palette_label_right" dir="">udp</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_mqlight_out" class="palette_node ui-draggable" style="background-color: rgb(109, 167, 209); height: 28px;"><div class="palette_label palette_label_right" dir="">mqlight</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mqlightin.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_twilio_out" class="palette_node ui-draggable" style="background-color: rgb(255, 89, 95); height: 28px;"><div class="palette_label palette_label_right" dir="">twilio</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/twilio.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ibmiot_out" class="palette_node ui-draggable" style="background-color: rgb(0, 155, 255); height: 28px;"><div class="palette_label palette_label_right" dir="">ibmiot</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-contrib-scx-ibmiotapp/iotcloud-icon.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_openwhisk-trigger" class="palette_node ui-draggable" style="background-color: rgb(108, 159, 195); height: 28px;"><div class="palette_label palette_label_right" dir="">OpenWhisk</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-node-openwhisk/openwhisk.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-function" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-function" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>function</span></div><div class="palette-content" id="palette-base-category-function" style=""><div id="palette-function-input"></div><div id="palette-function-output"></div><div id="palette-function-function"></div><div id="palette-function"><div id="palette_node_function" class="palette_node ui-draggable" style="background-color: rgb(253, 208, 162); height: 28px;"><div class="palette_label" dir="">function</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/function.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_template" class="palette_node ui-draggable" style="background-color: rgb(243, 181, 103); height: 28px;"><div class="palette_label" dir="">template</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/template.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_delay" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">delay</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/timer.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_trigger" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">trigger</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/trigger.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_comment" class="palette_node ui-draggable" style="background-color: rgb(255, 255, 255); height: 28px;"><div class="palette_label" dir="">comment</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/comment.png)"></div></div></div><div id="palette_node_http_request" class="palette_node ui-draggable" style="background-color: rgb(231, 231, 174); height: 28px;"><div class="palette_label" dir="">http request</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_switch" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">switch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/switch.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_change" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">change</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/swap.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_range" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">range</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/range.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_split" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">split</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/split.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_join" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">join</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/join.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_sort" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">sort</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/sort.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_batch" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">batch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/batch.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_csv" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">csv</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-csv.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_html" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">html</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-html.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_json" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">json</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-json.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_xml" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">xml</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-xml.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_yaml" class="palette_node ui-draggable" style="background-color: rgb(222, 189, 92); height: 28px;"><div class="palette_label" dir="">yaml</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-yaml.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_tcp_request" class="palette_node ui-draggable" style="background-color: silver; height: 28px;"><div class="palette_label" dir="">tcp request</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_openwhisk-action" class="palette_node ui-draggable" style="background-color: rgb(108, 159, 195); height: 28px;"><div class="palette_label" dir="">OpenWhisk</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-openwhisk/openwhisk.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_rbe" class="palette_node ui-draggable" style="background-color: rgb(226, 217, 110); height: 28px;"><div class="palette_label" dir="">rbe</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-rbe/rbe.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div><div id="palette-container-social" class="palette-category palette-close hide" style="display: block;"><div id="palette-header-social" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>social</span></div><div class="palette-content" id="palette-base-category-social"><div id="palette-social-input"><div id="palette_node_e-mail_in" class="palette_node ui-draggable" style="background-color: rgb(199, 233, 192); height: 28px;"><div class="palette_label" dir="">email</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-email/envelope.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_twitter_in" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label" dir="">twitter</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-twitter/twitter.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div><div id="palette-social-output"><div id="palette_node_e-mail" class="palette_node ui-draggable" style="background-color: rgb(199, 233, 192); height: 28px;"><div class="palette_label palette_label_right" dir="">email</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-node-email/envelope.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_twitter_out" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label palette_label_right" dir="">twitter</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-node-twitter/twitter.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-social-function"></div></div></div><div id="palette-container-mobile" class="palette-category palette-close hide"><div id="palette-header-mobile" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>mobile</span></div><div class="palette-content" id="palette-base-category-mobile"><div id="palette-mobile-input"></div><div id="palette-mobile-output"></div><div id="palette-mobile-function"></div></div></div><div id="palette-container-storage" class="palette-category palette-close hide" style="display: block;"><div id="palette-header-storage" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>storage</span></div><div class="palette-content" id="palette-base-category-storage"><div id="palette-storage-input"><div id="palette_node_mongodb_in" class="palette_node ui-draggable" style="background-color: rgb(218, 196, 180); height: 28px;"><div class="palette_label" dir="">mongodb</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mongodb.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_cloudant_in" class="palette_node ui-draggable" style="background-color: rgb(114, 199, 231); height: 28px;"><div class="palette_label" dir="">cloudant</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-cf-cloudant/cloudant.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_dashDB_in" class="palette_node ui-draggable" style="background-color: rgb(153, 204, 153); height: 28px;"><div class="palette_label" dir="">dashDB</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-nodes-cf-sqldb-dashdb/dashDB.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-storage-output"><div id="palette_node_mongodb_out" class="palette_node ui-draggable" style="background-color: rgb(218, 196, 180); height: 28px;"><div class="palette_label palette_label_right" dir="">mongodb</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mongodb.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_cloudant_out" class="palette_node ui-draggable" style="background-color: rgb(114, 199, 231); height: 28px;"><div class="palette_label palette_label_right" dir="">cloudant</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-node-cf-cloudant/cloudant.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_dashDB_out" class="palette_node ui-draggable" style="background-color: rgb(153, 204, 153); height: 28px;"><div class="palette_label palette_label_right" dir="">dashDB</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-nodes-cf-sqldb-dashdb/dashDB.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-storage-function"></div></div></div><div id="palette-container-analysis" class="palette-category palette-close hide" style="display: block;"><div id="palette-header-analysis" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>analysis</span></div><div class="palette-content" id="palette-base-category-analysis"><div id="palette-analysis-input"></div><div id="palette-analysis-output"></div><div id="palette-analysis-function"><div id="palette_node_sentiment" class="palette_node ui-draggable" style="background-color: rgb(230, 224, 248); height: 28px;"><div class="palette_label" dir="">sentiment</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/arrow-in.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div><div id="palette-analysis"><div id="palette_node_predictive_analytics" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 48px;"><div class="palette_label" dir="">predictive<br>analytics</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/spss.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div></div></div></div><div id="palette-container-advanced" class="palette-category palette-close hide" style="display: block;"><div id="palette-header-advanced" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>advanced</span></div><div class="palette-content" id="palette-base-category-advanced"><div id="palette-advanced-input"><div id="palette_node_feedparse" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 28px;"><div class="palette_label" dir="">feedparse</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-feedparser/feed.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div></div><div id="palette-advanced-output"></div><div id="palette-advanced-function"></div></div></div><div id="palette-container-weather" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-weather" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>weather</span></div><div class="palette-content" id="palette-base-category-weather" style=""><div id="palette-weather-input"></div><div id="palette-weather-output"></div><div id="palette-weather-function"></div><div id="palette-weather"><div id="palette_node_weather_insights" class="palette_node ui-draggable" style="background-color: rgb(192, 222, 237); height: 48px;"><div class="palette_label" dir="">weather<br>insights</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/weather.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div></div></div></div><div id="palette-container-Smarter_Process" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-Smarter_Process" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>Smarter Process</span></div><div class="palette-content" id="palette-base-category-Smarter_Process" style=""><div id="palette-Smarter_Process-input"></div><div id="palette-Smarter_Process-output"></div><div id="palette-Smarter_Process-function"></div><div id="palette-Smarter_Process"><div id="palette_node_business-rules" class="palette_node ui-draggable" style="background-color: rgb(255, 255, 255); height: 48px;"><div class="palette_label" dir="">business<br>rules</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/businessrules-icon25x25.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div></div></div></div><div id="palette-container-IBM_Watson" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-IBM_Watson" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>IBM Watson</span></div><div class="palette-content" id="palette-base-category-IBM_Watson" style=""><div id="palette-IBM_Watson-input"></div><div id="palette-IBM_Watson-output"></div><div id="palette-IBM_Watson-function"></div><div id="palette-IBM_Watson"><div id="palette_node_watson-conversation-v1" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 230); height: 28px;"><div class="palette_label" dir="">assistant</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/conversation-v1-25x25.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_watson-conversation-v1-workspace-manager" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 180); height: 68px;"><div class="palette_label" dir="">assistant<br>workspace<br>manager</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/conversation-v1-25x25.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_watson-discovery-v1" class="palette_node ui-draggable" style="background-color: rgb(230, 140, 80); height: 28px;"><div class="palette_label" dir="">discovery</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_watson-discovery-v1-document-loader" class="palette_node ui-draggable" style="background-color: rgb(230, 140, 10); height: 68px;"><div class="palette_label" dir="">discovery<br>document<br>loader</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_watson-discovery-v1-query-builder" class="palette_node ui-draggable" style="background-color: rgb(200, 140, 80); height: 48px;"><div class="palette_label" dir="">discovery<br>query builder</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_watson-translator" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 230); height: 48px;"><div class="palette_label" dir="">language<br>translator</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/LanguageTranslator25x25.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_watson-language-translator-identify" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 230); height: 48px;"><div class="palette_label" dir="">language<br>identify</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/LanguageTranslator25x25.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_watson-translator-util" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 230); height: 48px;"><div class="palette_label" dir="">language<br>translator util</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/languageid.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_watson-natural-language-classifier" class="palette_node ui-draggable" style="background-color: rgb(140, 198, 63); height: 68px;"><div class="palette_label" dir="">natural<br>language<br>classifier</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/NLClassifier.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_natural-language-understanding" class="palette_node ui-draggable" style="background-color: rgb(0, 162, 255); height: 68px;"><div class="palette_label" dir="">Natural<br>Language<br>Understanding</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/NaturalLanguageUnderstanding.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_watson-personality-insights-v3" class="palette_node ui-draggable" style="background-color: rgb(0, 150, 200); height: 48px;"><div class="palette_label" dir="">personality<br>insights</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/personality_insights.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_watson-speech-to-text" class="palette_node ui-draggable" style="background-color: rgb(140, 198, 63); height: 28px;"><div class="palette_label" dir="">speech to text</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/speech_to_text.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_watson-speech-to-text-v1-query-builder" class="palette_node ui-draggable" style="background-color: rgb(100, 120, 50); height: 68px;"><div class="palette_label" dir="">speech to text<br>custom<br>builder</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/speech_to_text.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_watson-text-to-speech" class="palette_node ui-draggable" style="background-color: rgb(140, 198, 63); height: 28px;"><div class="palette_label" dir="">text to speech</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/text_to_speech.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_watson-text-to-speech-v1-query-builder" class="palette_node ui-draggable" style="background-color: rgb(100, 120, 50); height: 68px;"><div class="palette_label" dir="">text to speech<br>custom<br>builder</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/text_to_speech.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div><div id="palette_node_watson-tone-analyzer-v3" class="palette_node ui-draggable" style="background-color: rgb(84, 149, 230); height: 48px;"><div class="palette_label" dir="">tone analyzer<br>v3</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/tone_analyzer.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_visual-recognition-v3" class="palette_node ui-draggable" style="background-color: rgb(228, 189, 255); height: 48px;"><div class="palette_label" dir="">visual<br>recognition</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/VR-v3-pink.png)"></div></div><div class="palette_port palette_port_output" style="top: 19px;"></div><div class="palette_port palette_port_input" style="top: 19px;"></div></div><div id="palette_node_visual-recognition-util-v3" class="palette_node ui-draggable" style="background-color: rgb(228, 189, 255); height: 68px;"><div class="palette_label" dir="">visual<br>recognition<br>util</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/VR-v3-pink.png)"></div></div><div class="palette_port palette_port_output" style="top: 29px;"></div><div class="palette_port palette_port_input" style="top: 29px;"></div></div></div></div></div><div id="palette-container-dashboard" class="palette-category palette-close hide palette-open" style="display: block;"><div id="palette-header-dashboard" class="palette-header"><i class="expanded fa fa-angle-down"></i><span>dashboard</span></div><div class="palette-content" id="palette-base-category-dashboard" style=""><div id="palette-dashboard-input"></div><div id="palette-dashboard-output"></div><div id="palette-dashboard-function"></div><div id="palette-dashboard"><div id="palette_node_ui_button" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">button</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_button.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_dropdown" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">dropdown</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_dropdown.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_switch" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">switch</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_switch.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_slider" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">slider</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_slider.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_numeric" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">numeric</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_numeric.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_text_input" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">text input</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_text.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_date_picker" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">date picker</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_date_picker.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_colour_picker" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">colour picker</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_colour_picker.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_form" class="palette_node ui-draggable" style="background-color: rgb(176, 223, 227); height: 28px;"><div class="palette_label" dir="">form</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_form.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div></div><div id="palette_node_ui_text" class="palette_node ui-draggable" style="background-color: rgb(119, 198, 204); height: 28px;"><div class="palette_label palette_label_right" dir="">text</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_text.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_gauge" class="palette_node ui-draggable" style="background-color: rgb(119, 198, 204); height: 28px;"><div class="palette_label palette_label_right" dir="">gauge</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_gauge.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_chart" class="palette_node ui-draggable" style="background-color: rgb(119, 198, 204); height: 28px;"><div class="palette_label palette_label_right" dir="">chart</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_chart.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_audio" class="palette_node ui-draggable" style="background-color: rgb(119, 198, 204); height: 28px;"><div class="palette_label palette_label_right" dir="">audio out</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/feed.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_toast" class="palette_node ui-draggable" style="background-color: rgb(119, 198, 204); height: 28px;"><div class="palette_label palette_label_right" dir="">notification</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_toast.png)"></div></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_ui_control" class="palette_node ui-draggable" style="background-color: rgb(63, 173, 181); height: 28px;"><div class="palette_label palette_label_right" dir="">ui control</div><div class="palette_icon_container palette_icon_container_right"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_link.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div><div id="palette_node_ui_template" class="palette_node ui-draggable" style="background-color: rgb(63, 173, 181); height: 28px;"><div class="palette_label" dir="">template</div><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_template.png)"></div></div><div class="palette_port palette_port_output" style="top: 9px;"></div><div class="palette_port palette_port_input" style="top: 9px;"></div></div></div></div></div></div>
        <div id="palette-footer">
            <a class="palette-button" id="palette-collapse-all" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-angle-double-up"></i></a>
            <a class="palette-button" id="palette-expand-all" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-angle-double-down"></i></a>
        </div>
        <div id="palette-shade" class="hide" style="display: none;"></div>
    </div><!-- /palette -->
    <div id="sidebar">
        <div class="red-ui-tabs"><div><ul id="sidebar-tabs"><li class="red-ui-tab" id="red-ui-tab-info" style="width: 30.1384%;"><a href="https://smartfactory00.mybluemix.net/red/#info" class="red-ui-tab-label" title="info" style=""><span class="bidiAware" dir="">info</span></a></li><li class="red-ui-tab" id="red-ui-tab-debug" style="width: 30.1384%;"><a href="https://smartfactory00.mybluemix.net/red/#debug" class="red-ui-tab-label" title="debug"><span class="bidiAware" dir="">debug</span></a></li><li class="red-ui-tab active" id="red-ui-tab-dashboard" style="width: 30.1384%;"><a href="https://smartfactory00.mybluemix.net/red/#dashboard" class="red-ui-tab-label" title="dashboard"><span class="bidiAware" dir="">dashboard</span></a><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-tab-close"><i class="fa fa-times"></i></a></li></ul></div></div>
        <div id="sidebar-content"><div style="height: 100%; display: none;"><div class="sidebar-node-info"><div class="sidebar-node-info-stack red-ui-stack"><div class="palette-category palette-category-expanded" style=""><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Information</span></div><div style="position: relative; display: block;"><div><table class="node-info"><tbody><tr class="node-info-node-row"><td>Flow</td><td><span class="debug-message-element debug-message-top-level"><span class="debug-message-row"><span class="debug-message-object-value"><span class="debug-message-type-string debug-message-object-header">"d4b7ecff.30a16"</span></span></span></span></td></tr><tr class="node-info-node-row"><td>Name</td><td>Flow 1</td></tr><tr class="node-info-node-row"><td>Status</td><td>Enabled</td></tr></tbody></table></div></div></div><div class="palette-category palette-category-expanded" style="border-bottom: none;"><div class="palette-header"><i class="fa fa-angle-down expanded"></i><span>Flow Description</span></div><div style="position: relative; display: block;"><div style="padding: 6px;"><div class="node-help"><span class="bidiAware" dir=""><span class="node-info-none">None</span></span></div></div></div></div></div><div class="node-info-tips"><div class="node-info-tip"></div><div class="node-info-tips-buttons"><a href="https://smartfactory00.mybluemix.net/red/#" class="workspace-footer-button"><i class="fa fa-refresh"></i></a><a href="https://smartfactory00.mybluemix.net/red/#" class="workspace-footer-button"><i class="fa fa-times"></i></a></div></div></div></div><div style="height: 100%; display: none;"><div class="sidebar-node-config"><div class="button-group sidebar-header"><a class="sidebar-header-button-toggle selected" id="workspace-config-node-filter-all" href="https://smartfactory00.mybluemix.net/red/#"><span data-i18n="sidebar.config.filterAll">all</span></a><a class="sidebar-header-button-toggle" id="workspace-config-node-filter-unused" href="https://smartfactory00.mybluemix.net/red/#"><span data-i18n="sidebar.config.filterUnused">unused</span></a> </div><div><div class="palette-category workspace-config-node-category" id="workspace-config-node-category-global"><div class="workspace-config-node-tray-header palette-header"><i class="fa fa-angle-down expanded"></i><span class="config-node-label" data-i18n="sidebar.config.global">On all flows</span><span class="config-node-filter-info" style="display: none;"></span></div><ul class="palette-content config-node-list" style="display: block;"><li class="config_node_type">mqtt-broker</li><li class="palette_node config_node palette_node_id_202e41f3-ceec5e"><div class="palette_label">iot.eclipse.org:1883</div><div class="palette_icon_container  palette_icon_container_right">4</div></li><li class="config_node_type">ui_base</li><li class="palette_node config_node palette_node_id_2c0860df-849bb"><div class="palette_label">Node-RED Dashboard</div></li><li class="config_node_type">ui_group</li><li class="palette_node config_node palette_node_id_c457764f-1fe788"><div class="palette_label">machine1 [sensor data]</div><div class="palette_icon_container  palette_icon_container_right">2</div></li><li class="palette_node config_node palette_node_id_c7af8d5c-c8983"><div class="palette_label">machine2 [sensor data]</div><div class="palette_icon_container  palette_icon_container_right">2</div></li><li class="config_node_type">ui_tab</li><li class="palette_node config_node palette_node_id_3cf7ef56-8455d"><div class="palette_label">sensor data</div><div class="palette_icon_container  palette_icon_container_right">2</div></li></ul></div></div><div><div class="palette-category workspace-config-node-category" id="workspace-config-node-category-d4b7ecff-30a16"><div class="workspace-config-node-tray-header palette-header"><i class="fa fa-angle-down"></i><span class="config-node-label">Flow 1</span><span class="config-node-filter-info" style="display: none;"></span></div><ul class="palette-content config-node-list" style="display: none;"><li class="config_node_none" data-i18n="sidebar.config.none">none</li></ul></div></div><div></div></div><div class="sidebar-shade hide" style="display: none;"></div></div><div style="height: 100%; display: none;"><div style="position: relative; height: 100%;"><div class="sidebar-header"><span class="button-group"><a id="debug-tab-filter" class="sidebar-header-button" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-filter"></i> <span>all nodes</span></a></span><span class="button-group"><a id="debug-tab-clear" class="sidebar-header-button" href="https://smartfactory00.mybluemix.net/red/#" data-i18n="[title]node-red:debug.sidebar.clearLog" title="clear log"><i class="fa fa-trash"></i></a></span><div class="debug-filter-box hide"><div class="debug-filter-row"><span class="button-group"><a class="sidebar-header-button-toggle debug-tab-filter-option selected" id="debug-tab-filterAll" href="https://smartfactory00.mybluemix.net/red/#"><span data-i18n="node-red:debug.sidebar.filterAll">all nodes</span></a><a class="sidebar-header-button-toggle debug-tab-filter-option" id="debug-tab-filterSelected" href="https://smartfactory00.mybluemix.net/red/#"><span data-i18n="node-red:debug.sidebar.filterSelected">selected nodes</span></a><a class="sidebar-header-button-toggle debug-tab-filter-option" id="debug-tab-filterCurrent" href="https://smartfactory00.mybluemix.net/red/#"><span data-i18n="node-red:debug.sidebar.filterCurrent">current flow</span></a> </span></div><div class="debug-filter-row hide" id="debug-filter-node-list-row"><div class="red-ui-editableList red-ui-nodeList"><div class="red-ui-editableList-border"><div class="red-ui-editableList-header"><span data-i18n="node-red:debug.sidebar.debugNodes">Debug nodes</span><span><span class="red-ui-checkboxSet"><input type="checkbox"><span class="red-ui-checkboxSet-option hide" style="display: inline;"><i class="fa fa-square-o"></i></span><span class="red-ui-checkboxSet-option hide"><i class="fa fa-check-square-o"></i></span><span class="red-ui-checkboxSet-option hide"><i class="fa fa-minus-square-o"></i></span></span></span></div><div class="red-ui-editableList-container" style="min-height: 250px; max-height: 250px; overflow-y: scroll;"><ol style="text-align: left; min-height: 0px; max-height: 250px; height: auto;" class="red-ui-editableList-list"></ol></div></div></div></div></div></div><div class="debug-content debug-content-list"></div><div class="debug-content  debug-content-table hide"></div></div></div><div style="height: 100%; display: block;"><div style="position: relative; height: 100%;"><div class="nr-db-sb"><form class="dialog-form"><div class="red-ui-tabs"><ul id="dashboard-tabs-list"><li class="red-ui-tab active" style="width:70px;"><a class="red-ui-tab-label" title="Layout"><span>Layout</span></a></li><li class="red-ui-tab" style="width:70px;"><a class="red-ui-tab-label" title="Theme" style="width:80px;"><span>Theme</span></a></li><li class="red-ui-tab" style="width:70px;"><a class="red-ui-tab-label" title="Site" style="width:60px;"><span>Site</span></a></li><span id="dash-link-button" class="editor-button" style="position:absolute; right:0px;"><i class="fa fa-external-link"></i></span></ul></div><div id="dashboard-layout" style="height:calc(100% - 48px)"><div class="form-row" style="position:relative"><label><b>Tabs &amp; Links</b></label><div class="nr-db-sb-list-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-angle-double-up"></i></a><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-angle-double-down"></i></a><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> tab</a><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> link</a></div><div class="red-ui-editableList"><div class="red-ui-editableList-border red-ui-editableList-container" style="overflow-y: scroll;"><ol class="nr-db-sb-tab-list red-ui-editableList-list ui-sortable" style="min-height: 0px; height: auto;"><li><div class="red-ui-editableList-item-content nr-db-sb-tab-list-item"><div class="nr-db-sb-list-header nr-db-sb-tab-list-header"><i class="nr-db-sb-list-handle nr-db-sb-tab-list-handle fa fa-bars"></i><i class="fa fa-angle-down nr-db-sb-list-chevron"></i><i class="nr-db-sb-icon nr-db-sb-tab-icon fa fa-file-o"></i><span class="nr-db-sb-title">sensor data</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> group</a><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div><div class="nr-db-sb-group-list-container"><div class="red-ui-editableList"><div class="red-ui-editableList-border red-ui-editableList-container" style="min-height: 10px; max-height: none;"><ol class="nr-db-sb-group-list red-ui-editableList-list ui-sortable" style="min-height: 0px; height: auto;"><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-group-list-header"><i class="nr-db-sb-list-handle nr-db-sb-group-list-handle fa fa-bars"></i><i class="fa fa-angle-down nr-db-sb-list-chevron" style="transform: rotate(-90deg);"></i><i class="nr-db-sb-icon nr-db-sb-group-icon fa fa-table"></i><span class="nr-db-sb-title">machine1</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div><div class="nr-db-sb-widget-list-container nr-db-sb-collapsed" style="display: none;"><div class="red-ui-editableList"><div class="red-ui-editableList-border red-ui-editableList-container" style="max-height: none;"><ol class="nr-db-sb-widget-list red-ui-editableList-list ui-sortable" style="height: auto; min-height: 5px;"><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-widget-list-header"><i class="nr-db-sb-list-handle nr-db-sb-widget-list-handle fa fa-bars"></i><i class="nr-db-sb-icon nr-db-sb-widget-icon fa fa-picture-o"></i><span class="nr-db-sb-title">temp</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div></div></li><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-widget-list-header"><i class="nr-db-sb-list-handle nr-db-sb-widget-list-handle fa fa-bars"></i><i class="nr-db-sb-icon nr-db-sb-widget-icon fa fa-picture-o"></i><span class="nr-db-sb-title">proximity</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div></div></li></ol></div></div></div></div></li><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-group-list-header"><i class="nr-db-sb-list-handle nr-db-sb-group-list-handle fa fa-bars"></i><i class="fa fa-angle-down nr-db-sb-list-chevron" style="transform: rotate(-90deg);"></i><i class="nr-db-sb-icon nr-db-sb-group-icon fa fa-table"></i><span class="nr-db-sb-title">machine2</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div><div class="nr-db-sb-widget-list-container nr-db-sb-collapsed" style="display: none;"><div class="red-ui-editableList"><div class="red-ui-editableList-border red-ui-editableList-container" style="max-height: none;"><ol class="nr-db-sb-widget-list red-ui-editableList-list ui-sortable" style="height: auto; min-height: 5px;"><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-widget-list-header"><i class="nr-db-sb-list-handle nr-db-sb-widget-list-handle fa fa-bars"></i><i class="nr-db-sb-icon nr-db-sb-widget-icon fa fa-picture-o"></i><span class="nr-db-sb-title">proximity</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div></div></li><li><div class="red-ui-editableList-item-content"><div class="nr-db-sb-list-header nr-db-sb-widget-list-header"><i class="nr-db-sb-list-handle nr-db-sb-widget-list-handle fa fa-bars"></i><i class="nr-db-sb-icon nr-db-sb-widget-icon fa fa-picture-o"></i><span class="nr-db-sb-title">temp</span><div class="nr-db-sb-list-header-button-group"><a href="https://smartfactory00.mybluemix.net/red/#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> edit</a></div></div></div></li></ol></div></div></div></div></li></ol></div></div></div></div></li></ol></div></div></div><div class="form-row" style="display: none;"><span><i class="fa fa-info-circle"></i> There <span id="nr-db-missing-group-count"></span> not in a group. Click <a id="nr-db-add-missing-groups" href="https://smartfactory00.mybluemix.net/red/#">here</a> to create the missing groups</span></div></div><div id="dashboard-theme" style="display:none;"><div class="form-row"><label class="nr-db-theme-label">Style</label><select id="nr-db-field-theme" style="width: 100%;"><option value="theme-light">Light (default)</option><option value="theme-dark">Dark</option><option value="theme-custom">Custom</option></select></div><div id="custom-theme-library-container" style="display: none;"><label class="nr-db-theme-label">Custom Profile</label><input type="text" id="ui-sidebar-name" placeholder="profile name (not blank)" style="width: calc(100% - 52px);"><div class="btn-group" style="margin-left:5px;"><a id="node-input-theme-lookup" class="editor-button" data-toggle="dropdown"><i class="fa fa-book"></i> <i class="fa fa-caret-down"></i></a><ul class="dropdown-menu pull-right" role="menu"><li><a id="node-input-theme-menu-open-library" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#">Open Library...</a></li><li><a id="node-input-theme-menu-save-library" tabindex="-1" href="https://smartfactory00.mybluemix.net/red/#">Save to Library...</a></li></ul></div><input type="hidden" id="nr-db-field-format"><div style="display:none;" class="node-text-editor ace_editor ace-tomorrow" id="nr-db-field-format-editor"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter" aria-hidden="true"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px;"><div class="ace_scrollbar-inner" style="width: 22px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px;"><div class="ace_scrollbar-inner" style="height: 22px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></div><div id="base-theme-settings"><div class="form-row"><label class="nr-db-theme-label">Base Settings</label><ul id="base-settings-ul" class="red-ui-dashboard-theme-styles"><li class="red-ui-dashboard-theme-item"><span>Colour</span><span class="nr-db-color-pick-container"><input id="base-color" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(0, 148, 206); color: rgb(238, 238, 238);"></span><i id="base-color-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 1;"></i></li><li class="red-ui-dashboard-theme-item"><span>Font</span><select id="nr-db-field-font"><option value="-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif" style="font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif">System Font (default)</option><option value="Arial,Arial,Helvetica,sans-serif" style="font-family:Arial,Arial,Helvetica,sans-serif">Arial</option><option value="Arial Black,Arial Black,Gadget,sans-serif" style="font-family:Arial Black,Arial Black,Gadget,sans-serif">Arial Black</option><option value="Arial Narrow,Nimbus Sans L,sans-serif" style="font-family:Arial Narrow,Nimbus Sans L,sans-serif">Arial Narrow</option><option value="Century Gothic,CenturyGothic,AppleGothic,sans-serif" style="font-family:Century Gothic,CenturyGothic,AppleGothic,sans-serif">Century Gothic</option><option value="Copperplate,Copperplate Gothic Light,fantasy" style="font-family:Copperplate,Copperplate Gothic Light,fantasy;">Copperplate</option><option value="Courier,monospace" style="font-family:Courier,monospace;">Courier</option><option value="Georgia,Georgia,serif" style="font-family:Georgia,Georgia,serif">Georgia</option><option value="Gill Sans,Geneva,sans-serif" style="font-family:Gill Sans,Geneva,sans-serif;">Gill Sans</option><option value="Impact,Impact,Charcoal,sans-serif" style="font-family:Impact,Impact,Charcoal,sans-serif">Impact</option><option value="Lucida Sans Typewriter,Lucida Console,Monaco,monospace" style="font-family:Lucida Console,Monaco,monospace">Lucida Console</option><option value="Lucida Sans Unicode,Lucida Grande,sans-serif" style="font-family:Lucida Sans Unicode,Lucida Grande,sans-serif">Lucida Sans</option><option value="Palatino Linotype,Palatino,Book Antiqua,serif" style="font-family:Palatino Linotype,Palatino,Book Antiqua,serif">Palatino Linotype</option><option value="Tahoma,Geneva,sans-serif" style="font-family:Tahoma,Geneva,sans-serif">Tahoma</option><option value="Times New Roman,Times,serif" style="font-family:Times New Roman,Times,serif">Times New Roman</option><option value="Trebuchet MS,Helvetica,sans-serif" style="font-family:Trebuchet MS,Helvetica,sans-serif">Trebuchet MS</option><option value="Verdana,Verdana,Geneva,sans-serif" style="font-family:Verdana,Verdana,Geneva,sans-serif">Verdana</option></select></li></ul></div></div><div id="custom-theme-settings" style="display: none;"><div class="form-row"><label class="nr-db-theme-label">Page Settings</label></div><ul class="red-ui-dashboard-theme-styles"><li class="red-ui-dashboard-theme-item"><span>Title Bar Background</span><span class="nr-db-color-pick-container"><input id="page-titlebar-backgroundColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(0, 148, 206); color: rgb(238, 238, 238);"></span><i id="page-titlebar-backgroundColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Page Background</span><span class="nr-db-color-pick-container"><input id="page-backgroundColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(250, 250, 250); color: rgb(17, 17, 17);"></span><i id="page-backgroundColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Side Bar Background</span><span class="nr-db-color-pick-container"><input id="page-sidebar-backgroundColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(255, 255, 255); color: rgb(17, 17, 17);"></span><i id="page-sidebar-backgroundColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li></ul><div class="form-row"><label class="nr-db-theme-label">Group Settings</label></div><ul class="red-ui-dashboard-theme-styles"><li class="red-ui-dashboard-theme-item"><span>Group Text</span><span class="nr-db-color-pick-container"><input id="group-textColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(27, 191, 255); color: rgb(17, 17, 17);"></span><i id="group-textColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Group Border</span><span class="nr-db-color-pick-container"><input id="group-borderColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(255, 255, 255); color: rgb(17, 17, 17);"></span><i id="group-borderColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Group Background</span><span class="nr-db-color-pick-container"><input id="group-backgroundColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(255, 255, 255); color: rgb(17, 17, 17);"></span><i id="group-backgroundColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li></ul><div class="form-row"><label class="nr-db-theme-label">Widget Settings</label></div><ul class="red-ui-dashboard-theme-styles"><li class="red-ui-dashboard-theme-item"><span>Widget Text</span><span class="nr-db-color-pick-container"><input id="widget-textColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(17, 17, 17); color: rgb(238, 238, 238);"></span><i id="widget-textColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Widget Colour</span><span class="nr-db-color-pick-container"><input id="widget-backgroundColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(0, 148, 206); color: rgb(238, 238, 238);"></span><i id="widget-backgroundColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li><li class="red-ui-dashboard-theme-item"><span>Widget Background</span><span class="nr-db-color-pick-container"><input id="widget-borderColor" class="nr-db-field-themeColor" type="color" value="#ffffff" style="background-color: rgb(255, 255, 255); color: rgb(17, 17, 17);"></span><i id="widget-borderColor-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 0.2;"></i></li></ul></div></div><div id="dashboard-site" style="display:none;"><div class="form-row"><div><b>Title</b></div><input type="text" id="nr-db-field-title" style="width: 100%;"></div><div class="form-row"><div><b>Options</b></div><select id="nr-db-field-hideToolbar" style="width: 100%;"><option value="false" selected="selected">Show the title bar</option><option value="true">Hide the title bar</option></select></div><div class="form-row"><select id="nr-db-field-allowSwipe" style="width: 100%;"><option value="false" selected="selected">No swipe between tabs</option><option value="true">Allow swipe between tabs</option></select></div><div class="form-row"><select id="nr-db-field-allowTempTheme" style="width: 100%;"><option value="true" selected="selected">Set theme in ui_template</option><option value="false">No theme in ui_template</option></select></div><div class="form-row"><div" style="width: 80%; display: inline-block;"><b>Date Format</b></div"><div style="display: inline-block; margin-right: 6px; float: right;"><a href="https://momentjs.com/docs/#/displaying/format/" target="_new"><i class="fa fa-info-circle" style="color:grey;"></i></a></div><input type="text" id="nr-db-field-dateFormat" style="width: 100%;"></div><div class="form-row"><span style="width:45%; display:inline-block"><b>Sizes</b></span><span style="width:25%; display:inline-block; font-size:smaller">Horizontal</span><span style="width:20%; display:inline-block; font-size:smaller">Vertical</span><i id="sizes-reset" class="fa fa-undo nr-db-resetIcon" style="opacity: 1;"></i><br>1x1 Widget Size</br><span style="width:45%; display:inline-block">1x1 Widget Size</span><input type="number" name="sx" min="24" id="nr-db-field-sx" style="width: 20%;"><span style="width:5%; display:inline-block"> </span><input type="number" name="sy" min="24" id="nr-db-field-sy" style="width: 20%;"><br>Widget Spacing</br><span style="width:45%; display:inline-block">Widget Spacing</span><input type="number" name="cx" min="0" id="nr-db-field-cx" style="width: 20%;"><span style="width:5%; display:inline-block"> </span><input type="number" name="cy" min="0" id="nr-db-field-cy" style="width: 20%;"><br>Group Padding</br><span style="width:45%; display:inline-block">Group Padding</span><input type="number" name="px" min="0" id="nr-db-field-px" style="width: 20%;"><span style="width:5%; display:inline-block"> </span><input type="number" name="py" min="0" id="nr-db-field-py" style="width: 20%;"><br>Group Spacing</br><span style="width:45%; display:inline-block">Group Spacing</span><input type="number" name="gx" min="0" id="nr-db-field-gx" style="width: 20%;"><span style="width:5%; display:inline-block"> </span><input type="number" name="gy" min="0" id="nr-db-field-gy" style="width: 20%;"></div></div></form></div></div><div class="sidebar-shade hide" style="display: none;"></div></div></div>
        <div id="sidebar-footer"><div style="display: none;"><a class="sidebar-footer-button" id="workspace-config-node-collapse-all" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-angle-double-up"></i></a> <a class="sidebar-footer-button" id="workspace-config-node-expand-all" href="https://smartfactory00.mybluemix.net/red/#"><i class="fa fa-angle-double-down"></i></a></div><div style="display: none;"><span class="button-group"><a id="debug-tab-open" class="sidebar-footer-button" href="https://smartfactory00.mybluemix.net/red/#" data-i18n="[title]node-red:debug.sidebar.openWindow" title="open in new window"><i class="fa fa-desktop"></i></a></span> </div></div>
        <div id="sidebar-shade" class="hide" style="display: none;"></div>
    </div>

    <div id="sidebar-separator" class="ui-draggable"></div>

<div id="red-ui-type-search" class="red-ui-search red-ui-type-search" style="left: 715px; top: 152px; display: block;"><div class="red-ui-search-container"><div class="red-ui-searchBox-container"><i class="fa fa-search"></i><input type="text" placeholder="add a node..."><a href="https://smartfactory00.mybluemix.net/red/#" style="display: none;"><i class="fa fa-times"></i></a><span class="red-ui-searchBox-resultCount hide"></span></div></div><div class="red-ui-search-results-container" style="display: block;"><div class="red-ui-editableList" style="top: 0px; left: 0px; bottom: 0px; right: 0px; position: absolute;"><div class="red-ui-editableList-border red-ui-editableList-container" style="top: 0px; left: 0px; bottom: 0px; right: 0px; position: absolute; max-height: none; overflow-y: scroll;"><ol id="search-result-list" style="position: static; top: auto; bottom: auto; left: auto; right: auto; height: auto;" class="red-ui-editableList-list"><li class="selected"><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(166, 187, 207);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/inject.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">inject</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(135, 169, 128);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/debug.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">debug</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(253, 208, 162);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/function.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">function</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/swap.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">change</div></div></a></div></li><li><div class="red-ui-editableList-item-content red-ui-search-result-separator"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/switch.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">switch</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 230);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/conversation-v1-25x25.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">assistant (watson-conversation-v1)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 180);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/conversation-v1-25x25.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">assistant workspace manager (watson-conversation-v1-workspace-manager)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(119, 198, 204);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/feed.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">audio out (ui_audio)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/batch.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">batch</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(255, 255, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/businessrules-icon25x25.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">business rules (business-rules)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_button.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">button (ui_button)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(228, 145, 145);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/alert.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">catch</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/swap.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">change</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(119, 198, 204);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_chart.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">chart (ui_chart)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(114, 199, 231);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-cf-cloudant/cloudant.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">cloudant in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(114, 199, 231);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-cf-cloudant/cloudant.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">cloudant out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_colour_picker.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">colour picker (ui_colour_picker)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(255, 255, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/comment.png)"></div></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">comment</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(222, 189, 92);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-csv.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">csv</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(153, 204, 153);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-nodes-cf-sqldb-dashdb/dashDB.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">dashDB in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(153, 204, 153);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-nodes-cf-sqldb-dashdb/dashDB.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">dashDB out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_date_picker.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">date picker (ui_date_picker)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(135, 169, 128);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/debug.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">debug</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(230, 224, 248);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/timer.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">delay</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(230, 140, 80);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">discovery (watson-discovery-v1)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(230, 140, 10);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">discovery document loader (watson-discovery-v1-document-loader)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(200, 140, 80);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/discovery.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">discovery query builder (watson-discovery-v1-query-builder)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_dropdown.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">dropdown (ui_dropdown)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(199, 233, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-email/envelope.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">email (e-mail in)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(199, 233, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-email/envelope.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">email (e-mail)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 222, 237);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-feedparser/feed.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">feedparse</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_form.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">form (ui_form)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(253, 208, 162);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/function.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">function</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(119, 198, 204);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_gauge.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">gauge (ui_gauge)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(222, 189, 92);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-html.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">html</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(231, 231, 174);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">http in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(231, 231, 174);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">http request</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(231, 231, 174);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">http response</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(0, 155, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-contrib-scx-ibmiotapp/iotcloud-icon.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">ibmiot in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(0, 155, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-contrib-scx-ibmiotapp/iotcloud-icon.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">ibmiot out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(166, 187, 207);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/inject.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">inject</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/join.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">join</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(222, 189, 92);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-json.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">json</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 230);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/LanguageTranslator25x25.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">language identify (watson-language-translator-identify)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 230);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/LanguageTranslator25x25.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">language translator (watson-translator)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 230);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/languageid.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">language translator util (watson-translator-util)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(221, 221, 221);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/link-out.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">link in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(221, 221, 221);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/link-out.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">link out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(218, 196, 180);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mongodb.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mongodb in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(218, 196, 180);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mongodb.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mongodb out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(109, 167, 209);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mqlightin.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mqlight in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(109, 167, 209);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/mqlightin.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mqlight out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(216, 191, 216);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/bridge.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mqtt in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(216, 191, 216);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/bridge.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">mqtt out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(140, 198, 63);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/NLClassifier.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">natural language classifier (watson-natural-language-classifier)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(0, 162, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/NaturalLanguageUnderstanding.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">Natural Language Understanding (natural-language-understanding)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(119, 198, 204);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_toast.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">notification (ui_toast)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_numeric.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">numeric (ui_numeric)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(108, 159, 195);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-openwhisk/openwhisk.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">OpenWhisk (openwhisk-action)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(108, 159, 195);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-openwhisk/openwhisk.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">OpenWhisk (openwhisk-trigger)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(0, 150, 200);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/personality_insights.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">personality insights (watson-personality-insights-v3)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 222, 237);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/spss.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">predictive analytics (predictive_analytics)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/range.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">range</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-rbe/rbe.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">rbe</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(230, 224, 248);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/arrow-in.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">sentiment</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_slider.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">slider (ui_slider)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/sort.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">sort</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(140, 198, 63);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/speech_to_text.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">speech to text (watson-speech-to-text)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(100, 120, 50);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/speech_to_text.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">speech to text custom builder (watson-speech-to-text-v1-query-builder)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/split.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">split</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 237, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/alert.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">status</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(226, 217, 110);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/switch.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">switch</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_switch.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">switch (ui_switch)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 192, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">tcp in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 192, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">tcp out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 192, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">tcp request</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(243, 181, 103);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/template.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">template</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(63, 173, 181);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_template.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">template (ui_template)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(119, 198, 204);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_text.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">text (ui_text)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(176, 223, 227);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_text.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">text input (ui_text_input)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(140, 198, 63);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/text_to_speech.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">text to speech (watson-text-to-speech)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(100, 120, 50);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/text_to_speech.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">text to speech custom builder (watson-text-to-speech-v1-query-builder)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(84, 149, 230);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/tone_analyzer.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">tone analyzer v3 (watson-tone-analyzer-v3)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(230, 224, 248);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/trigger.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">trigger</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(255, 89, 95);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/twilio.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">twilio out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 222, 237);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-twitter/twitter.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">twitter in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 222, 237);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-twitter/twitter.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">twitter out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 192, 192);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/bridge-dash.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">udp out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(63, 173, 181);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-dashboard/ui_link.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">ui control (ui_ui_control)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(228, 189, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/VR-v3-pink.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">visual recognition (visual-recognition-v3)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(228, 189, 255);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-node-watson/VR-v3-pink.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">visual recognition util (visual-recognition-util-v3)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(192, 222, 237);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red-bluemix-nodes/weather.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">weather insights (weather_insights)</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(215, 215, 160);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">websocket in</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(215, 215, 160);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/white-globe.png)"></div></div><div class="red-ui-search-result-node-port"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">websocket out</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(222, 189, 92);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-xml.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">xml</div></div></a></div></li><li><div class="red-ui-editableList-item-content"><a href="https://smartfactory00.mybluemix.net/red/#" class="red-ui-search-result"><div class="red-ui-search-result-node" style="background-color: rgb(222, 189, 92);"><div class="palette_icon_container"><div class="palette_icon" style="background-image: url(icons/node-red/parser-yaml.png)"></div></div><div class="red-ui-search-result-node-port"></div><div class="red-ui-search-result-node-port red-ui-search-result-node-output"></div></div><div class="red-ui-search-result-description"><div class="red-ui-search-result-node-label">yaml</div></div></a></div></li></ol></div></div></div></div></div>
<div id="full-shade" class="hide"></div>

<div id="notifications"></div>
<div id="dropTarget"><div data-i18n="[append]workspace.dropFlowHere"><br><i class="fa fa-download"></i>Drop the flow here</div></div>






<script type="text/x-red" data-template-name="subflow">
    <div class="form-row">
        <label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-template-name="subflow-template">
    <div class="form-row">
        <i class="fa fa-tag"></i>
        <label for="subflow-input-name" data-i18n="common.label.name"></label><input type="text" id="subflow-input-name">
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="subflow-input-info" data-i18n="editor:subflow.info"></label>
        <a href="https://help.github.com/articles/markdown-basics/" style="font-size: 0.8em; float: right;" data-i18n="[html]subflow.format"></a>
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px;" class="node-text-editor" id="subflow-input-info-editor"></div>
    </div>
    <div class="form-row form-tips" id="subflow-dialog-user-count"></div>
</script>

<script type="text/x-red" data-template-name="_expression">
    <div id="node-input-expression-panels">
        <div id="node-input-expression-panel-expr" class="red-ui-panel">
            <div class="form-row" style="margin-bottom: 3px; text-align: right;">
                <span class="node-input-expression-legacy"><i class="fa fa-exclamation-circle"></i> <span data-i18n="expressionEditor.compatMode"></span></span>
                <button id="node-input-expression-reformat" class="editor-button editor-button-small"><span data-i18n="expressionEditor.format"></span></button>
            </div>
            <div class="form-row node-text-editor-row">
                <div class="node-text-editor" id="node-input-expression"></div>
            </div>
        </div>
        <div id="node-input-expression-panel-info" class="red-ui-panel">
            <div class="form-row">
                <ul id="node-input-expression-tabs"></ul>
                <div id="node-input-expression-tab-help" class="node-input-expression-tab-content hide">
                    <div>
                        <select id="node-input-expression-func"></select>
                        <button id="node-input-expression-func-insert" class="editor-button" data-i18n="expressionEditor.insert"></button>
                    </div>
                    <div id="node-input-expression-help"></div>
                </div>
                <div id="node-input-expression-tab-test" class="node-input-expression-tab-content hide">
                    <div>
                        <span style="display: inline-block; width: calc(50% - 5px);">
                            <span data-i18n="expressionEditor.data"></span>
                            <button style="float: right; margin-right: 5px;" id="node-input-example-reformat" class="editor-button editor-button-small"><span data-i18n="jsonEditor.format"></span></button>
                        </span>
                        <span style="display: inline-block; width: calc(50% - 5px);" data-i18n="expressionEditor.result"></span>
                    </div>
                    <div style="display: inline-block; width: calc(50% - 5px);" class="node-text-editor" id="node-input-expression-test-data"></div>
                    <div style="display: inline-block; width: calc(50% - 5px);" class="node-text-editor" id="node-input-expression-test-result"></div>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/x-red" data-template-name="_json">
    <div class="form-row" style="margin-bottom: 3px; text-align: right;">
        <button id="node-input-json-reformat" class="editor-button editor-button-small"><span data-i18n="jsonEditor.format"></span></button>
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-json"></div>
    </div>
</script>
<script type="text/x-red" data-template-name="_markdown">
    <div class="form-row" id="node-input-markdown-title" style="margin-bottom: 3px; text-align: right;">

    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-markdown"></div>
    </div>
</script>
<script type="text/x-red" data-template-name="_buffer">
    <div id="node-input-buffer-panels">
        <div id="node-input-buffer-panel-str" class="red-ui-panel">
            <div class="form-row" style="margin-bottom: 3px; text-align: right;">
                <span class="node-input-buffer-type"><i class="fa fa-exclamation-circle"></i> <span id="node-input-buffer-type-string" data-i18n="bufferEditor.modeString"></span><span id="node-input-buffer-type-array" data-i18n="bufferEditor.modeArray"></span></span>
            </div>
            <div class="form-row node-text-editor-row">
                <div class="node-text-editor" id="node-input-buffer-str"></div>
            </div>
        </div>
        <div id="node-input-buffer-panel-bin" class="red-ui-panel">
            <div class="form-row node-text-editor-row" style="margin-top: 10px">
                <div class="node-text-editor" id="node-input-buffer-bin"></div>
            </div>
        </div>
    </div>
</script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/vendor.js.download"></script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/jsonata.min.js.download"></script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/ace.js.download"></script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/ext-language_tools.js.download"></script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/red.min.js.download"></script>
<script src="./Node-RED _ smartfactory00.mybluemix.net_files/main.min.js.download"></script>



<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable" tabindex="-1" role="dialog" aria-describedby="library-dialog" aria-labelledby="ui-id-1" style="display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-1" class="ui-dialog-title">Export nodes to library</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="library-dialog" class="hide ui-dialog-content ui-widget-content" style="display: block;"><form class="dialog-form form-horizontal"><div class="form-row"><label for="node-input-library-filename" data-i18n="[append]editor:library.filename"><i class="fa fa-file"></i> Filename</label><input type="text" id="node-input-library-filename" data-i18n="[placeholder]editor:library.fullFilenamePlaceholder" placeholder="a/b/file"><input type="text" style="display: none;"></div></form></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="library-dialog-cancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button><button type="button" id="library-dialog-ok" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Export</span></button></div></div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable" tabindex="-1" role="dialog" aria-describedby="clipboard-dialog" aria-labelledby="ui-id-2" style="display: none;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-2" class="ui-dialog-title">&nbsp;</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="clipboard-dialog" class="hide node-red-dialog ui-dialog-content ui-widget-content" style="display: block;"><form class="dialog-form form-horizontal"></form></div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" id="clipboard-dialog-cancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button><button type="button" id="clipboard-dialog-close" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Close</span></button><button type="button" id="clipboard-dialog-copy" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Export to clipboard</span></button><button type="button" id="clipboard-dialog-ok" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Import</span></button></div></div></div><input type="text" id="clipboard-hidden"><!-- --- [red-module:node-red/sentiment] --- -->

<script type="text/x-red" data-template-name="sentiment">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('sentiment',{
        category: 'analysis-function',
        color:"#E6E0F8",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "arrow-in.png",
        label: function() {
            return this.name||"sentiment";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="sentiment">
    <p>Analyses the chosen property, default <code>payload</code>, and adds a <code>sentiment</code> object.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>sentiment <span class="property-type">object</span></dt>
        <dd>contains the resulting AFINN-111 sentiment.</dd>
        <dt>sentiment.score <span class="property-type">number</span></dt>
        <dd>the sentiment score.</dd>
    </dl>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>overrides <span class="property-type">object</span></dt>
        <dd>an object of word score overrides can be supplied - <code>{ word:score,... }</code>.</dd>
    </dl>
    <h3>Details</h3>
    <p>A score greater than zero is positive and less than zero is negative.</p>
    <p>The score typically ranges from -5 to +5, but can go higher and lower.</p>
    <p>See <a href="https://github.com/thisandagain/sentiment/blob/master/README.md" target="_blank">the Sentiment docs here</a>.</p>
</script>
<!-- --- [red-module:node-red/inject] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="inject">
    <div class="form-row">
        <label for="node-input-payload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
        <input type="text" id="node-input-payload" style="width:70%">
        <input type="hidden" id="node-input-payloadType">
    </div>

    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic">
    </div>

    <div class="form-row" id="node-once">
        <label for="node-input-once">&nbsp;</label>
        <input type="checkbox" id="node-input-once" style="display:inline-block; width:15px; vertical-align:baseline;">
        <span data-i18n="inject.onstart"></span>&nbsp;
        <input type="text" id="node-input-onceDelay" placeholder="0.1" style="width:45px; height:28px;">&nbsp;
        <span data-i18n="inject.onceDelay"></span>
    </div>

    <div class="form-row">
        <label for=""><i class="fa fa-repeat"></i> <span data-i18n="inject.label.repeat"></span></label>
        <select id="inject-time-type-select">
            <option value="none" data-i18n="inject.none"></option>
            <option value="interval" data-i18n="inject.interval"></option>
            <option value="interval-time" data-i18n="inject.interval-time"></option>
            <option value="time" data-i18n="inject.time"></option>
        </select>
        <input type="hidden" id="node-input-repeat">
        <input type="hidden" id="node-input-crontab">
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-interval">
        <span data-i18n="inject.every"></span>
        <input id="inject-time-interval-count" class="inject-time-count" value="1"></input>
        <select style="width:100px" id="inject-time-interval-units">
            <option value="s" data-i18n="inject.seconds"></option>
            <option value="m" data-i18n="inject.minutes"></option>
            <option value="h" data-i18n="inject.hours"></option>
        </select><br/>
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-interval-time">
        <span data-i18n="inject.every"></span> <select style="width:90px; margin-left:20px;" id="inject-time-interval-time-units" class="inject-time-int-count" value="1">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="10">10</option>
            <option value="12">12</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="0">60</option>
        </select> <span data-i18n="inject.minutes"></span><br/>
        <span data-i18n="inject.between"></span> <select id="inject-time-interval-time-start" class="inject-time-times"></select>
        <span data-i18n="inject.and"></span> <select id="inject-time-interval-time-end" class="inject-time-times"></select><br/>
        <div id="inject-time-interval-time-days" class="inject-time-days" style="margin-top:5px">
            <div style="display:inline-block; vertical-align:top; margin-right:5px;" data-i18n="inject.on">on</div>
            <div style="display:inline-block;">
                <div>
                    <label><input type='checkbox' checked value='1'/> <span data-i18n="inject.days.0"></span></label>
                    <label><input type='checkbox' checked value='2'/> <span data-i18n="inject.days.1"></span></label>
                    <label><input type='checkbox' checked value='3'/> <span data-i18n="inject.days.2"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='4'/> <span data-i18n="inject.days.3"></span></label>
                    <label><input type='checkbox' checked value='5'/> <span data-i18n="inject.days.4"></span></label>
                    <label><input type='checkbox' checked value='6'/> <span data-i18n="inject.days.5"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='0'/> <span data-i18n="inject.days.6"></span></label>
                </div>
            </div>
        </div>
    </div>

    <div class="form-row inject-time-row hidden" id="inject-time-row-time">
        <span data-i18n="inject.at"></span> <input type="text" id="inject-time-time" value="12:00"></input><br/>
        <div id="inject-time-time-days" class="inject-time-days">
            <div style="display:inline-block; vertical-align:top; margin-right:5px;" data-i18n="inject.on"></div>
            <div style="display:inline-block;">
                <div>
                    <label><input type='checkbox' checked value='1'/> <span data-i18n="inject.days.0"></span></label>
                    <label><input type='checkbox' checked value='2'/> <span data-i18n="inject.days.1"></span></label>
                    <label><input type='checkbox' checked value='3'/> <span data-i18n="inject.days.2"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='4'/> <span data-i18n="inject.days.3"></span></label>
                    <label><input type='checkbox' checked value='5'/> <span data-i18n="inject.days.4"></span></label>
                    <label><input type='checkbox' checked value='6'/> <span data-i18n="inject.days.5"></span></label>
                </div>
                <div>
                    <label><input type='checkbox' checked value='0'/> <span data-i18n="inject.days.6"></span></label>
                </div>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>

    <div class="form-tips" data-i18n="[html]inject.tip"></div>
</script>
<style>
    .inject-time-row {
        padding-left: 110px;
    }
    .inject-time-row select {
        margin: 3px 0;
    }
    .inject-time-days label {
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        vertical-align: baseline;
        width: 100px;
    }
    .inject-time-days input {
        width: auto;
        vertical-align: baseline;
    }
    .inject-time-times {
        width: 90px;
    }
    #inject-time-time {
        width: 75px;
        margin-left: 8px;
        margin-bottom: 8px;
    }
    .inject-time-count {
        width: 40px !important;
    }
</style>


<script type="text/javascript">
    RED.nodes.registerType('inject',{
        category: 'input',
        color:"#a6bbcf",
        defaults: {
            name: {value:""},
            topic: {value:""},
            payload: {value:"", validate: RED.validators.typedInput("payloadType")},
            payloadType: {value:"date"},
            repeat: {value:"", validate:function(v) { return ((v === "") || (RED.validators.number(v) && (v >= 0) && (v <= 2147483))) }},
            crontab: {value:""},
            once: {value:false},
            onceDelay: {value:0.1}
        },
        icon: "inject.png",
        inputs:0,
        outputs:1,
        outputLabels: function(index) {
            var labels = { str:"string", num:"number", bool:"boolean", json:"object", flow:"flow context", global:"global context" };
            var lab = labels[this.payloadType] || this.payloadType;
            if (lab === "object") {
                try {
                    lab = typeof JSON.parse(this.payload);
                    if (lab === "object") {
                        if (Array.isArray(JSON.parse(this.payload))) { lab = "Array"; }
                    }
                } catch(e) { lab = "Invalid JSON Object"; }
            }
            return lab; },
        label: function() {
            var suffix = "";
            // if fire once then add small indication
            if (this.once) {
                suffix = " ¹";
            }
            // but replace with repeat one if set to repeat
            if ((this.repeat && this.repeat != 0) || this.crontab) {
                suffix = " ↻";
            }
            if (this.name) {
                return this.name+suffix;
            } else if (this.payloadType === "string" ||
                    this.payloadType === "str" ||
                    this.payloadType === "num" ||
                    this.payloadType === "bool" ||
                    this.payloadType === "json") {
                if ((this.topic !== "") && ((this.topic.length + this.payload.length) <= 32)) {
                    return this.topic + ":" + this.payload+suffix;
                } else if (this.payload.length > 0 && this.payload.length < 24) {
                    return this.payload+suffix;
                } else {
                    return this._("inject.inject")+suffix;
                }
            } else if (this.payloadType === 'date') {
                if ((this.topic !== "") && (this.topic.length <= 16)) {
                    return this.topic + ":" + this._("inject.timestamp")+suffix;
                } else {
                    return this._("inject.timestamp")+suffix;
                }
            } else if (this.payloadType === 'flow' && this.payload.length < 19) {
                return 'flow.'+this.payload+suffix;
            } else if (this.payloadType === 'global' && this.payload.length < 17) {
                return 'global.'+this.payload+suffix;
            } else {
                return this._("inject.inject")+suffix;
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.payloadType == null) {
                if (this.payload == "") {
                    this.payloadType = "date";
                } else {
                    this.payloadType = "str";
                }
            } else if (this.payloadType === 'string' || this.payloadType === 'none') {
                this.payloadType = "str";
            }
            $("#node-input-payloadType").val(this.payloadType);

            $("#node-input-payload").typedInput({
                default: 'str',
                typeField: $("#node-input-payloadType"),
                types:['flow','global','str','num','bool','json','bin','date']
            });

            $("#inject-time-type-select").change(function() {
                $("#node-input-crontab").val('');
                var id = $("#inject-time-type-select").val();
                $(".inject-time-row").hide();
                $("#inject-time-row-"+id).show();
                if ((id == "none") || (id == "interval") || (id == "interval-time")) {
                    $("#node-once").show();
                }
                else {
                    $("#node-once").hide();
                    $("#node-input-once").prop('checked', false);
                }
            });

            $("#node-input-once").change(function() {
                $("#node-input-onceDelay").attr('disabled', !$("#node-input-once").prop('checked'));
            })

            $(".inject-time-times").each(function() {
                for (var i=0; i<24; i++) {
                    var l = (i<10?"0":"")+i+":00";
                    $(this).append($("<option></option>").val(i).text(l));
                }
            });
            $("<option></option>").val(24).text("00:00").appendTo("#inject-time-interval-time-end");
            $("#inject-time-interval-time-start").change(function() {
                var start = Number($("#inject-time-interval-time-start").val());
                var end = Number($("#inject-time-interval-time-end").val());
                $("#inject-time-interval-time-end option").remove();
                for (var i=start+1; i<25; i++) {
                    var l = (i<10?"0":"")+i+":00";
                    if (i==24) {
                        l = "00:00";
                    }
                    var opt = $("<option></option>").val(i).text(l).appendTo("#inject-time-interval-time-end");
                    if (i === end) {
                        opt.attr("selected","selected");
                    }
                }
            });

            $(".inject-time-count").spinner({
                //max:60,
                min:1
            });

            var repeattype = "none";
            if (this.repeat != "" && this.repeat != 0) {
                repeattype = "interval";
                var r = "s";
                var c = this.repeat;
                if (this.repeat % 60 === 0) { r = "m"; c = c/60; }
                if (this.repeat % 1440 === 0) { r = "h"; c = c/60; }
                $("#inject-time-interval-count").val(c);
                $("#inject-time-interval-units").val(r);
                $("#inject-time-interval-days").prop("disabled","disabled");
            } else if (this.crontab) {
                var cronparts = this.crontab.split(" ");
                var days = cronparts[4];
                if (!isNaN(cronparts[0]) && !isNaN(cronparts[1])) {
                    repeattype = "time";
                    // Fixed time
                    var time = cronparts[1]+":"+cronparts[0];
                    $("#inject-time-time").val(time);
                    $("#inject-time-type-select").val("s");
                    if (days == "*") {
                        $("#inject-time-time-days input[type=checkbox]").prop("checked",true);
                    } else {
                        $("#inject-time-time-days input[type=checkbox]").removeAttr("checked");
                        days.split(",").forEach(function(v) {
                            $("#inject-time-time-days [value=" + v + "]").prop("checked", true);
                        });
                    }
                } else {
                    repeattype = "interval-time";
                    // interval - time period
                    var minutes = cronparts[0].slice(2);
                    if (minutes === "") { minutes = "0"; }
                    $("#inject-time-interval-time-units").val(minutes);
                    if (days == "*") {
                        $("#inject-time-interval-time-days input[type=checkbox]").prop("checked",true);
                    } else {
                        $("#inject-time-interval-time-days input[type=checkbox]").removeAttr("checked");
                        days.split(",").forEach(function(v) {
                            $("#inject-time-interval-time-days [value=" + v + "]").prop("checked", true);
                        });
                    }
                    var time = cronparts[1];
                    var timeparts = time.split(",");
                    var start;
                    var end;
                    if (timeparts.length == 1) {
                        // 0 or 0-10
                        var hours = timeparts[0].split("-");
                        if (hours.length == 1) {
                            if (hours[0] === "") {
                                start = "0";
                                end = "0";
                            }
                            else {
                                start = hours[0];
                                end = Number(hours[0])+1;
                            }
                        } else {
                            start = hours[0];
                            end = Number(hours[1])+1;
                        }
                    } else {
                        // 23,0 or 17-23,0-10 or 23,0-2 or 17-23,0
                        var startparts = timeparts[0].split("-");
                        start = startparts[0];

                        var endparts = timeparts[1].split("-");
                        if (endparts.length == 1) {
                            end = Number(endparts[0])+1;
                        } else {
                            end = Number(endparts[1])+1;
                        }
                    }
                    $("#inject-time-interval-time-end").val(end);
                    $("#inject-time-interval-time-start").val(start);

                }
            } else {
                $("#inject-time-type-select").val("none");
            }

            $(".inject-time-row").hide();
            $("#inject-time-type-select").val(repeattype);
            $("#inject-time-row-"+repeattype).show();

            $("#node-input-payload").typedInput('type',this.payloadType);

            $("#inject-time-type-select").change();
            $("#inject-time-interval-time-start").change();

        },
        oneditsave: function() {
            var repeat = "";
            var crontab = "";
            var type = $("#inject-time-type-select").val();
            if (type == "none") {
                // nothing
            } else if (type == "interval") {
                var count = $("#inject-time-interval-count").val();
                var units = $("#inject-time-interval-units").val();
                if (units == "s") {
                    repeat = count;
                } else {
                    if (units == "m") {
                        //crontab = "*/"+count+" * * * "+days;
                        repeat = count * 60;
                    } else if (units == "h") {
                        //crontab = "0 */"+count+" * * "+days;
                        repeat = count * 60 * 60;
                    }
                }
            } else if (type == "interval-time") {
                repeat = "";
                var count = $("#inject-time-interval-time-units").val();
                var startTime = Number($("#inject-time-interval-time-start").val());
                var endTime = Number($("#inject-time-interval-time-end").val());
                var days = $('#inject-time-interval-time-days input[type=checkbox]:checked').map(function(_, el) {
                    return $(el).val()
                }).get();
                if (days.length == 0) {
                    crontab = "";
                } else {
                    if (days.length == 7) {
                        days="*";
                    } else {
                        days = days.join(",");
                    }
                    var timerange = "";
                    if (endTime == 0) {
                        timerange = startTime+"-23";
                    } else if (startTime+1 < endTime) {
                        timerange = startTime+"-"+(endTime-1);
                    } else if (startTime+1 == endTime) {
                        timerange = startTime;
                    } else {
                        var startpart = "";
                        var endpart = "";
                        if (startTime == 23) {
                            startpart = "23";
                        } else {
                            startpart = startTime+"-23";
                        }
                        if (endTime == 1) {
                            endpart = "0";
                        } else {
                            endpart = "0-"+(endTime-1);
                        }
                        timerange = startpart+","+endpart;
                    }
                    if (count === "0") {
                        crontab = count+" "+timerange+" * * "+days;
                    } else {
                        crontab = "*/"+count+" "+timerange+" * * "+days;
                    }
                }
            } else if (type == "time") {
                var time = $("#inject-time-time").val();
                var days = $('#inject-time-time-days  input[type=checkbox]:checked').map(function(_, el) {
                    return $(el).val()
                }).get();
                if (days.length == 0) {
                    crontab = "";
                } else {
                    if (days.length == 7) {
                        days="*";
                    } else {
                        days = days.join(",");
                    }
                    var parts = time.split(":");
                    if (parts.length === 2) {
                        repeat = "";
                        parts[1] = ("00" + (parseInt(parts[1]) % 60)).substr(-2);
                        parts[0] = ("00" + (parseInt(parts[0]) % 24)).substr(-2);
                        crontab = parts[1]+" "+parts[0]+" * * "+days;
                    }
                    else { crontab = ""; }
                }
            }

            $("#node-input-repeat").val(repeat);
            $("#node-input-crontab").val(crontab);
        },
        button: {
            enabled: function() {
                return !this.changed
            },
            onclick: function() {
                if (this.changed) {
                    return RED.notify(RED._("notification.warning", {message:RED._("notification.warnings.undeployedChanges")}),"warning");
                }
                var label = (this.name||this.payload);
                if (label.length > 30) {
                    label = label.substring(0,50)+"...";
                }
                label = label.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");

                if (this.payloadType === "date") { label = this._("inject.timestamp"); }
                if (this.payloadType === "none") { label = this._("inject.blank"); }
                var node = this;
                $.ajax({
                    url: "inject/"+this.id,
                    type:"POST",
                    success: function(resp) {
                        RED.notify(node._("inject.success",{label:label}),"success");
                    },
                    error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status == 500) {
                            RED.notify(node._("common.notification.error",{message:node._("inject.errors.failed")}),"error");
                        } else if (jqXHR.status == 0) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:jqXHR.status,message:textStatus})}),"error");
                        }
                    }
                });
            }
        }
    });

</script>
<script type="text/x-red" data-help-name="inject">
<p>Injects a message into a flow either manually or at regular intervals. The message
payload can be a variety of types, including strings, JavaScript objects or the current time.</p>
<h3>Outputs</h3>
<dl class="message-properties">
    <dt>payload<span class="property-type">various</span></dt>
    <dd>The configured payload of the message.</dd>
    <dt class="optional">topic <span class="property-type">string</span></dt>
    <dd>An optional property that can be configured in the node.</dd>
</dl>
<h3>Details</h3>
<p>The Inject node can initiate a flow with a specific payload value.
The default payload is a timestamp of the current time in millisecs since January 1st, 1970.</p>
<p>The node also supports injecting strings, numbers, booleans, JavaScript objects, or flow/global context values.</p>
<p>By default, the node is triggered manually by clicking on its button within the editor. It can also be set to
inject at regular intervals or according to a schedule.</p>
<p>It can also be configured to inject once each time the flows are started.</p>
<p>The maximum <i>Interval</i> that can be specified is about 596 hours / 24 days. However if you are looking at intervals
greater than one day you should consider using a scheduler node that can cope with power outages and restarts.</p>
<p><b>Note</b>: The <i>"Interval between times"</i> and <i>"at a specific time"</i> options use the standard cron system.
This means that 20 minutes will be at the next hour, 20 minutes past and 40 minutes past - not in 20 minutes time.
If you want every 20 minutes from now - use the <i>"interval"</i> option.</p>
<p><b>Note</b>: To include a newline in a string you must use a Function node to create the payload.</p>
</script>
<!-- --- [red-module:node-red/catch] --- -->

<script type="text/x-red" data-template-name="catch">
    <div class="form-row">
        <label style="width: auto" for="node-input-scope" data-i18n="catch.label.source"></label>
        <select id="node-input-scope-select">
            <option value="all" data-i18n="catch.scope.all"></option>
            <option value="target" data-i18n="catch.scope.selected"></options>
        </select>
    </div>
    <div class="form-row node-input-target-row" style="display: none;">
        <div id="node-input-catch-target-container-div" style="min-height: 100px;position: relative;   box-sizing: border-box; border-radius: 2px; height: 180px;  border: 1px solid #ccc;overflow:hidden; ">
            <div style="box-sizing: border-box; line-height: 20px; font-size: 0.8em; border-bottom: 1px solid #ddd; height: 20px;">
              <input type="checkbox" data-i18n="[title]catch.label.selectAll" id="node-input-target-node-checkbox-all" style="width: 30px; margin: 0 2px 1px 2px;">
              <div style="display: inline-block;"><a id="node-input-target-sort-label" href="#" data-i18n="[title]catch.label.sortByLabel"><span data-i18n="catch.label.node"></span> <i class="node-input-catch-sort-label-a fa fa-caret-down"></i><i class="node-input-catch-sort-label-d fa fa-caret-up"></i></a></div>
              <div style="position: absolute; right: 10px; width: 50px; display: inline-block; text-align: right;"><a id="node-input-target-sort-type" href="#" data-i18n="[title]catch.label.sortByType"><i class="node-input-catch-sort-sublabel-a fa fa-caret-down"></i><i class="node-input-catch-sort-sublabel-d fa fa-caret-up"></i> <span data-i18n="catch.label.type"></span></a></div>
            </div>
            <div style="background: #fbfbfb; box-sizing: border-box; position:absolute; top:20px;bottom:0;left:0px;right:0px; overflow-y: scroll; overflow-x: hidden;">
                <ul id="node-input-catch-target-container" style=" list-style-type:none; margin: 0;"></ul>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<style>
#node-input-catch-target-container {
    position: relative;
}
#node-input-catch-target-container li {
    padding: 2px 5px;
    background: none;
    font-size: 0.8em;
    margin:0;
    white-space: nowrap;
}
#node-input-catch-target-container li label {
    margin-bottom: 0;
    width: 100%;
}
#node-input-catch-target-container li label input {
    vertical-align: top;
    width:15px;
    margin-right: 10px;
}
#node-input-catch-target-container li:hover,
#node-input-catch-target-container li:hover .node-input-target-node-sublabel {
    background: #f0f0f0;
}
.node-input-target-node-sublabel {
    position:absolute;
    right: 0px;
    padding-right: 10px;
    padding-left: 10px;
    font-size: 0.8em;
    background: #fbfbfb;
}
</style>
<script type="text/javascript">
    RED.nodes.registerType('catch',{
        category: 'input',
        color:"#e49191",
        defaults: {
            name: {value:""},
            scope: {value:null}
        },
        inputs:0,
        outputs:1,
        icon: "alert.png",
        label: function() {
            return this.name||(this.scope?this._("catch.catchNodes",{number:this.scope.length}):this._("catch.catch"));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var nodeList = $("#node-input-catch-target-container");
            var node = this;
            this.resize = function() {
                var rows = $("#dialog-form>div:not(.node-input-target-row)");
                var height = $("#dialog-form").height();
                for (var i=0;i<rows.size();i++) {
                    height -= $(rows[i]).outerHeight(true);
                }
                var editorRow = $("#dialog-form>div.node-input-target-row");
                height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
                $("#node-input-catch-target-container-div").css("height",height+"px");
            };

            function createNodeList() {
                var scope = node.scope || [];
                nodeList.empty();

                var candidateNodes = RED.nodes.filterNodes({z:node.z});
                var allChecked = true;

                candidateNodes.forEach(function(n) {
                    if (n.id === node.id) {
                        return;
                    }
                    var isChecked = scope.indexOf(n.id) !== -1;

                    allChecked = allChecked && isChecked;

                    var container = $('<li></li>',{class:"node-input-target-node"});
                    var row = $('<label></label>',{for:"node-input-target-node-"+n.id}).appendTo(container);
                    $('<input>',{type:"checkbox",class:"node-input-target-node-checkbox",id:"node-input-target-node-"+n.id})
                        .data('node-id',n.id)
                        .prop('checked', isChecked)
                        .appendTo(row);
                    container.on('mouseover',function(e) {
                        n.highlighted = true;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    container.on('mouseout',function(e) {
                        n.highlighted = false;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    var labelSpan = $('<span>');
                    var nodeDef = RED.nodes.getType(n.type);
                    var label;
                    var sublabel;
                    if (nodeDef) {
                        var l = nodeDef.label;
                        label = (typeof l === "function" ? l.call(n) : l)||"";
                        sublabel = n.type;
                        if (sublabel.indexOf("subflow:") === 0) {
                            var subflowId = sublabel.substring(8);
                            var subflow = RED.nodes.subflow(subflowId);
                            sublabel = "subflow : "+subflow.name;
                        }
                    }
                    if (!nodeDef || !label) {
                        label = n.type;
                    }
                    $('<span>',{class:"node-input-target-node-label",style:"white-space:nowrap"}).text(label).appendTo(row);
                    if (sublabel) {
                        $('<span>',{class:"node-input-target-node-sublabel"}).text(sublabel).appendTo(row);
                    }

                    container.appendTo(nodeList);
                });

                $(".node-input-target-node-checkbox").change(function() {
                    if (!this.checked) {
                        $("#node-input-target-node-checkbox-all").prop('checked',false);
                    }
                });

                $("#node-input-target-node-checkbox-all").prop('checked',allChecked);

                sortNodeList('label');
            }

            function sortNodeList(sortOn) {
                var currentSort = nodeList.data('currentSort');
                var currentSortOrder = nodeList.data('currentSortOrder');

                if (!currentSort) {
                    currentSort = sortOn;
                    currentSortOrder = 'a';
                } else {
                    if (currentSort === sortOn) {
                        currentSortOrder = (currentSortOrder === 'a'?'d':'a');
                    } else {
                        currentSortOrder = 'a';
                    }
                    currentSort = sortOn;
                }
                nodeList.data('currentSort',currentSort);
                nodeList.data('currentSortOrder',currentSortOrder);

                $("#node-input-catch-target-container-div .fa").hide();
                $(".node-input-catch-sort-"+currentSort+"-"+currentSortOrder).show();


                var items = nodeList.find("li").get();
                items.sort(function(a,b) {
                    var labelA = $(a).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    var labelB = $(b).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
                    if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }
                    return 0;
                });
                $.each(items, function(i, li){
                    nodeList.append(li);
                });
            }
            $("#node-input-target-sort-label").click(function(e) {
                e.preventDefault();
                sortNodeList('label');
            });

            $("#node-input-target-sort-type").click(function(e) {
                e.preventDefault();
                sortNodeList('sublabel');
            });
            $("#node-input-target-node-checkbox-all").change(function() {
                $(".node-input-target-node-checkbox").prop('checked',this.checked);
            });



            $("#node-input-scope-select").change(function(e) {
                var scope = $(this).val();
                if (scope === "target") {
                    createNodeList();
                    $(".node-input-target-row").show();
                } else {
                    $(".node-input-target-row").hide();
                }
                node.resize();
            });
            if (this.scope === null) {
                $("#node-input-scope-select").val("all");
            } else {
                $("#node-input-scope-select").val("target");
            }
            $("#node-input-scope-select").change();
        },
        oneditsave: function() {
            var scope = $("#node-input-scope-select").val();
            if (scope === 'all') {
                this.scope = null;
            } else {
                var node = this;
                node.scope = [];
                $(".node-input-target-node-checkbox").each(function(n) {
                    if ($(this).prop("checked")) {
                        node.scope.push($(this).data('node-id'));
                    }
                });
            }
        },
        oneditresize: function(size) {
            this.resize();
        }
    });
</script>
<script type="text/x-red" data-help-name="catch">
    <p>Catch errors thrown by nodes on the same tab.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>error.message <span class="property-type">string</span></dt>
        <dd>the error message.</dd>
        <dt>error.source.id <span class="property-type">string</span></dt>
        <dd>the id of the node that threw the error.</dd>
        <dt>error.source.type <span class="property-type">string</span></dt>
        <dd>the type of the node that threw the error.</dd>
        <dt>error.source.name <span class="property-type">string</span></dt>
        <dd>the name, if set, of the node that threw the error.</dd>
    </dl>
    <h3>Details</h3>
    <p>If a node throws an error whilst handling a message, the flow will typically
       halt. This node can be used to catch those errors and handle them with a
       dedicated flow.</p>
    <p>By default, the node will catch errors thrown by any node on the same tab. Alternatively
    it can be targetted at specific nodes.</p>
    <p>When an error is thrown, all matching catch nodes will receive the message.</p>
    <p>If an error is thrown within a subflow, the error will get handled by any
       catch nodes within the subflow. If none exists, the error will be propagated
       up to the tab the subflow instance is on.</p>
   <p>If the message already has a <code>error</code> property, it is copied to <code>_error</code>.</p>
</script>
<!-- --- [red-module:node-red/status] --- -->

<script type="text/x-red" data-template-name="status">
    <div class="form-row">
        <label style="width: auto" for="node-input-scope" data-i18n="status.label.source"></label>
        <select id="node-input-scope-select">
            <option value="all" data-i18n="status.scope.all"></option>
            <option value="target" data-i18n="status.scope.selected"></options>
        </select>
    </div>
    <div class="form-row node-input-target-row" style="display: none;">
        <div id="node-input-status-target-container-div" style=" min-height: 100px;position: relative;   box-sizing: border-box; border-radius: 2px; height: 180px;  border: 1px solid #ccc;overflow:hidden; ">
            <div style="box-sizing: border-box; line-height: 20px; font-size: 0.8em; border-bottom: 1px solid #ddd; height: 20px;">
              <input type="checkbox" data-i18n="[title]status.label.selectAll" id="node-input-target-node-checkbox-all" style="width: 30px; margin: 0 2px 1px 2px;">
              <div style="display: inline-block;"><a id="node-input-target-sort-label" href="#" data-i18n="[title]status.label.sortByLabel"><span data-i18n="status.label.node"></span> <i class="node-input-status-sort-label-a fa fa-caret-down"></i><i class="node-input-status-sort-label-d fa fa-caret-up"></i></a></div>
              <div style="position: absolute; right: 10px; width: 50px; display: inline-block; text-align: right;"><a id="node-input-target-sort-type" href="#" data-i18n="[title]status.label.sortByType"><i class="node-input-status-sort-sublabel-a fa fa-caret-down"></i><i class="node-input-status-sort-sublabel-d fa fa-caret-up"></i> <span data-i18n="status.label.type"></span></a></div>
            </div>
            <div style="background: #fbfbfb; box-sizing: border-box; position:absolute; top:20px;bottom:0;left:0px;right:0px; overflow-y: scroll; overflow-x: hidden;">
                <ul id="node-input-status-target-container" style=" list-style-type:none; margin: 0;"></ul>
            </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>

<style>
#node-input-status-target-container {
    position: relative;
}
#node-input-status-target-container li {
    padding: 2px 5px;
    background: none;
    font-size: 0.8em;
    margin:0;
    white-space: nowrap;
}
#node-input-status-target-container li label {
    margin-bottom: 0;
    width: 100%;
}
#node-input-status-target-container li label input {
    vertical-align: top;
    width:15px;
    margin-right: 10px;
}
#node-input-status-target-container li:hover,
#node-input-status-target-container li:hover .node-input-target-node-sublabel {
    background: #f0f0f0;
}
.node-input-target-node-sublabel {
    position:absolute;
    right: 0px;
    padding-right: 10px;
    padding-left: 10px;
    font-size: 0.8em;
    background: #fbfbfb;
}
</style>
<script type="text/javascript">
    RED.nodes.registerType('status',{
        category: 'input',
        color:"#c0edc0",
        defaults: {
            name: {value:""},
            scope: {value:null}
        },
        inputs:0,
        outputs:1,
        icon: "alert.png",
        label: function() {
            return this.name||(this.scope?this._("status.statusNodes",{number:this.scope.length}):this._("status.status"));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var nodeList = $("#node-input-status-target-container");
            var node = this;
            this.resize = function() {
                var rows = $("#dialog-form>div:not(.node-input-target-row)");
                var height = $("#dialog-form").height();
                for (var i=0;i<rows.size();i++) {
                    height -= $(rows[i]).outerHeight(true);
                }
                var editorRow = $("#dialog-form>div.node-input-target-row");
                height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
                $("#node-input-status-target-container-div").css("height",height+"px");
            };

            function createNodeList() {
                var scope = node.scope || [];
                nodeList.empty();

                var candidateNodes = RED.nodes.filterNodes({z:node.z});
                var allChecked = true;

                candidateNodes.forEach(function(n) {
                    if (n.id === node.id) {
                        return;
                    }
                    var isChecked = scope.indexOf(n.id) !== -1;

                    allChecked = allChecked && isChecked;

                    var container = $('<li></li>',{class:"node-input-target-node"});
                    var row = $('<label></label>',{for:"node-input-target-node-"+n.id}).appendTo(container);
                    $('<input>',{type:"checkbox",class:"node-input-target-node-checkbox",id:"node-input-target-node-"+n.id})
                        .data('node-id',n.id)
                        .prop('checked', isChecked)
                        .appendTo(row);
                    container.on('mouseover',function(e) {
                        n.highlighted = true;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    container.on('mouseout',function(e) {
                        n.highlighted = false;
                        n.dirty = true;
                        RED.view.redraw();
                    });
                    var labelSpan = $('<span>');
                    var nodeDef = RED.nodes.getType(n.type);
                    var label;
                    var sublabel;
                    if (nodeDef) {
                        var l = nodeDef.label;
                        label = (typeof l === "function" ? l.call(n) : l)||"";
                        sublabel = n.type;
                        if (sublabel.indexOf("subflow:") === 0) {
                            var subflowId = sublabel.substring(8);
                            var subflow = RED.nodes.subflow(subflowId);
                            sublabel = "subflow : "+subflow.name;
                        }
                    }
                    if (!nodeDef || !label) {
                        label = n.type;
                    }
                    $('<span>',{class:"node-input-target-node-label",style:"white-space:nowrap"}).text(label).appendTo(row);
                    if (sublabel) {
                        $('<span>',{class:"node-input-target-node-sublabel"}).text(sublabel).appendTo(row);
                    }

                    container.appendTo(nodeList);
                });

                $(".node-input-target-node-checkbox").change(function() {
                    if (!this.checked) {
                        $("#node-input-target-node-checkbox-all").prop('checked',false);
                    }
                });

                $("#node-input-target-node-checkbox-all").prop('checked',allChecked);

                sortNodeList('label');
            }

            function sortNodeList(sortOn) {
                var currentSort = nodeList.data('currentSort');
                var currentSortOrder = nodeList.data('currentSortOrder');

                if (!currentSort) {
                    currentSort = sortOn;
                    currentSortOrder = 'a';
                } else {
                    if (currentSort === sortOn) {
                        currentSortOrder = (currentSortOrder === 'a'?'d':'a');
                    } else {
                        currentSortOrder = 'a';
                    }
                    currentSort = sortOn;
                }
                nodeList.data('currentSort',currentSort);
                nodeList.data('currentSortOrder',currentSortOrder);

                $("#node-input-status-target-container-div .fa").hide();
                $(".node-input-status-sort-"+currentSort+"-"+currentSortOrder).show();


                var items = nodeList.find("li").get();
                items.sort(function(a,b) {
                    var labelA = $(a).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    var labelB = $(b).find(".node-input-target-node-"+currentSort).text().toLowerCase();
                    if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
                    if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }
                    return 0;
                });
                $.each(items, function(i, li) {
                    nodeList.append(li);
                });
            }
            $("#node-input-target-sort-label").click(function(e) {
                e.preventDefault();
                sortNodeList('label');
            });

            $("#node-input-target-sort-type").click(function(e) {
                e.preventDefault();
                sortNodeList('sublabel');
            });
            $("#node-input-target-node-checkbox-all").change(function() {
                $(".node-input-target-node-checkbox").prop('checked',this.checked);
            });

            $("#node-input-scope-select").change(function(e) {
                var scope = $(this).val();
                if (scope === "target") {
                    createNodeList();
                    $(".node-input-target-row").show();
                } else {
                    $(".node-input-target-row").hide();
                }
                node.resize();
            });
            if (this.scope === null) {
                $("#node-input-scope-select").val("all");
            } else {
                $("#node-input-scope-select").val("target");
            }
            $("#node-input-scope-select").change();
        },
        oneditsave: function() {
            var scope = $("#node-input-scope-select").val();
            if (scope === 'all') {
                this.scope = null;
            } else {
                var node = this;
                node.scope = [];
                $(".node-input-target-node-checkbox").each(function(n) {
                    if ($(this).prop("checked")) {
                        node.scope.push($(this).data('node-id'));
                    }
                });
            }
        },
        oneditresize: function(size) {
            this.resize();
        }
    });
</script>
<script type="text/x-red" data-help-name="status">
    <p>Report status messages from other nodes on the same tab.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>status.text <span class="property-type">string</span></dt>
        <dd>the status text.</dd>
        <dt>status.source.type <span class="property-type">string</span></dt>
        <dd>the type of the node that reported status.</dd>
        <dt>status.source.id <span class="property-type">string</span></dt>
        <dd>the id of the node that reported status.</dd>
        <dt>status.source.name <span class="property-type">string</span></dt>
        <dd>the name, if set, of the node that reported status.</dd>
    </dl>
    <h3>Details</h3>
   <p>This node does not produce a <code>payload</code>.</p>
   <p>By default the node reports status for all nodes on the same workspace tab.
   It can be configured to selectively report status for individual nodes.</p>
</script>
<!-- --- [red-module:node-red/debug] --- -->

<script type="text/x-red" data-template-name="debug">
    <div class="form-row">
        <label for="node-input-typed-complete"><i class="fa fa-list"></i> <span data-i18n="debug.output"></span></label>
        <input id="node-input-typed-complete" type="text" style="width: 70%">
        <input id="node-input-complete" type="hidden">
    </div>
    <div class="form-row">
        <label for="node-input-tosidebar"><i class="fa fa-random"></i> <span data-i18n="debug.to"></span></label>
        <label for="node-input-tosidebar" style="width:70%">
        <input type="checkbox" id="node-input-tosidebar" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toSidebar"></span>
        </label>
    </div>
    <div class="form-row">
        <label for="node-input-console"> </label>
        <label for="node-input-console" style="width:70%">
        <input type="checkbox" id="node-input-console" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toConsole"></span>
        </label>
    </div>
    <div class="form-row" id="node-tostatus-line">
    <label for="node-input-tostatus"> </label>
    <label for="node-input-tostatus" style="width:70%">
        <input type="checkbox" id="node-input-tostatus" style="display:inline-block; width:22px; vertical-align:baseline;"><span data-i18n="debug.toStatus"></span>
    </label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>


<script src="./Node-RED _ smartfactory00.mybluemix.net_files/debug-utils.js.download"></script>

<script type="text/javascript">
(function() {
    var subWindow = null;
    RED.nodes.registerType('debug',{
        category: 'output',
        defaults: {
            name: {value:""},
            active: {value:true},
            tosidebar: {value:true},
            console: {value:false},
            tostatus: {value:false},
            complete: {value:"false", required:true}
        },
        label: function() {
            var suffix = "";
            if (this.console === true || this.console === "true") { suffix = " ⇲"; }
            if (this.complete === true || this.complete === "true") {
                return (this.name||"msg") + suffix;
            } else {
                return (this.name || "msg." + ((!this.complete || this.complete === "false") ? "payload" : this.complete)) + suffix;
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        color:"#87a980",
        inputs:1,
        outputs:0,
        icon: "debug.png",
        align: "right",
        button: {
            toggle: "active",
            onclick: function() {
                var label = this.name||"debug";
                var node = this;
                $.ajax({
                    url: "debug/"+this.id+"/"+(this.active?"enable":"disable"),
                    type: "POST",
                    success: function(resp, textStatus, xhr) {
                        var historyEvent = {
                            t:'edit',
                            node:node,
                            changes:{
                                active: !node.active
                            },
                            dirty:node.dirty,
                            changed:node.changed
                        };
                        node.changed = true;
                        node.dirty = true;
                        RED.nodes.dirty(true);
                        RED.history.push(historyEvent);
                        RED.view.redraw();
                        if (xhr.status == 200) {
                            RED.notify(node._("debug.notification.activated",{label:label}),"success");
                        } else if (xhr.status == 201) {
                            RED.notify(node._("debug.notification.deactivated",{label:label}),"success");
                        }
                    },
                    error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error", {message: node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status === 0) {
                            RED.notify(node._("common.notification.error", {message: node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:err.status,message:err.response})}),"error");
                        }
                    }
                });
            }
        },
        onpaletteadd: function() {
            var options = {
                messageMouseEnter: function(sourceId) {
                    if (sourceId) {
                        var n = RED.nodes.node(sourceId);
                        if (n) {
                            n.highlighted = true;
                            n.dirty = true;
                        }
                        RED.view.redraw();
                    }
                },
                messageMouseLeave: function(sourceId) {
                    if (sourceId) {
                        var n = RED.nodes.node(sourceId);
                        if (n) {
                            n.highlighted = false;
                            n.dirty = true;
                        }
                        RED.view.redraw();
                    }
                },
                messageSourceClick: function(sourceId) {
                    RED.view.reveal(sourceId);
                },
                clear: function() {
                    RED.nodes.eachNode(function(node) {
                        node.highlighted = false;
                        node.dirty = true;
                    });
                    RED.view.redraw();
                }
            };

            var uiComponents = RED.debug.init(options);

            RED.sidebar.addTab({
                id: "debug",
                label: this._("debug.sidebar.label"),
                name: this._("debug.sidebar.name"),
                content: uiComponents.content,
                toolbar: uiComponents.footer,
                enableOnEdit: true
            });
            RED.actions.add("core:show-debug-tab",function() { RED.sidebar.show('debug'); });

            var that = this;
            RED._debug = function(msg) {
                that.handleDebugMessage("", {
                    name:"debug",
                    msg:msg
                });
            };

            this.refreshMessageList = function() {
                RED.debug.refreshMessageList(RED.workspaces.active());
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"workspaceChange",activeWorkspace:RED.workspaces.active()},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.events.on("workspace:change", this.refreshMessageList);

            this.handleDebugMessage = function(t,o) {
                var sourceNode = RED.nodes.node(o.id) || RED.nodes.node(o.z);
                if (sourceNode) {
                    o._source = {id:sourceNode.id,z:sourceNode.z,name:sourceNode.name,type:sourceNode.type,_alias:o._alias};
                }
                RED.debug.handleDebugMessage(o);
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"message",msg:o},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.comms.subscribe("debug",this.handleDebugMessage);

            this.clearMessageList = function() {
                RED.debug.clearMessageList(true);
                if (subWindow) {
                    try {
                        subWindow.postMessage({event:"projectChange"},"*");
                    } catch(err) {
                        console.log(err);
                    }
                }
            };
            RED.events.on("project:change", this.clearMessageList);

            $("#debug-tab-open").click(function(e) {
                e.preventDefault();
                subWindow = window.open(document.location.toString().replace(/[?#].*$/,"")+"debug/view/view.html"+document.location.search,"nodeREDDebugView","menubar=no,location=no,toolbar=no,chrome,height=500,width=600");
                subWindow.onload = function() {
                    subWindow.postMessage({event:"workspaceChange",activeWorkspace:RED.workspaces.active()},"*");
                };
            });

            $(window).unload(function() {
                if (subWindow) {
                    try {
                        subWindow.close();
                    } catch(err) {
                        console.log(err);
                    }
                }
            });

            this.handleWindowMessage = function(evt) {
                var msg = evt.data;
                if (msg.event === "mouseEnter") {
                    options.messageMouseEnter(msg.id);
                } else if (msg.event === "mouseLeave") {
                    options.messageMouseLeave(msg.id);
                } else if (msg.event === "mouseClick") {
                    options.messageSourceClick(msg.id);
                } else if (msg.event === "clear") {
                    options.clear();
                }
            };
            window.addEventListener('message',this.handleWindowMessage);
        },
        onpaletteremove: function() {
            RED.comms.unsubscribe("debug",this.handleDebugMessage);
            RED.sidebar.removeTab("debug");
            RED.events.off("workspace:change", this.refreshMessageList);
            window.removeEventListener("message",this.handleWindowMessage);
            RED.actions.remove("core:show-debug");

            delete RED._debug;
        },
        oneditprepare: function() {
            if (this.tosidebar === undefined) {
                this.tosidebar = true;
                $("#node-input-tosidebar").prop('checked', true);
            }
            if (typeof this.console === "string") {
                this.console = (this.console == 'true');
                $("#node-input-console").prop('checked', this.console);
                $("#node-input-tosidebar").prop('checked', true);
            }
            $("#node-input-typed-complete").typedInput({types:['msg', {value:"full",label:RED._("node-red:debug.msgobj"),hasValue:false}]});
            if (this.complete === "true" || this.complete === true) {
                // show complete message object
                $("#node-input-typed-complete").typedInput('type','full');
            } else {
                var property = (!this.complete||(this.complete === "false")) ? "payload" : this.complete+"";
                $("#node-input-typed-complete").typedInput('type','msg');
                $("#node-input-typed-complete").typedInput('value',property);
            }
            $("#node-input-typed-complete").on('change',function() {
                if ($("#node-input-typed-complete").typedInput('type') === 'msg' &&
                    $("#node-input-typed-complete").typedInput('value') === ''
                ) {
                    $("#node-input-typed-complete").typedInput('value','payload');
                }
                if ($("#node-input-typed-complete").typedInput('type') === 'msg') {
                    $("#node-tostatus-line").show();
                }
                else { $("#node-tostatus-line").hide(); }
            });
            $("#node-input-complete").on('change',function() {
                if ($("#node-input-typed-complete").typedInput('type') === 'msg') {
                    $("#node-tostatus-line").show();
                }
                else { $("#node-tostatus-line").hide(); }
            });
        },
        oneditsave: function() {
            var type = $("#node-input-typed-complete").typedInput('type');
            if (type === 'full') {
                $("#node-input-complete").val("true");
            } else {
                $("#node-input-complete").val($("#node-input-typed-complete").typedInput('value'));
            }
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="debug">
    <p>Displays selected message properties in the debug sidebar tab and optionally the runtime log. By default it displays <code>msg.payload</code>.</p>
    <h3>Details</h3>
    <p>The debug sidebar provides a structured view of the messages it is sent, making it easier to understand their structure.</p>
    <p>JavaScript objects and arrays can be collapsed and expanded as required. Buffer objects can be displayed as raw data or as a string if possible.</p>
    <p>Alongside each message, the debug sidebar includes information about the time the message was received, the node that sent it and the type of the message.
       Clicking on the source node id will reveal that node within the workspace.</p>
    <p>The button on the node can be used to enable or disable its output. It is recommended to disable or remove any Debug nodes that are not being used.</p>
    <p>The node can also be configured to send all messages to the runtime log, or to send short (32 characters) to the status text under the debug node.</p>
</script>
<!-- --- [red-module:node-red/link] --- -->

<script type="text/x-red" data-template-name="link in">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row node-input-link-row"></div>
</script>
<script type="text/x-red" data-template-name="link out">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row node-input-link-row"></div>
</script>


<style>
#node-input-link-container {
    position: relative;
}
#node-input-link-container li {
    padding: 2px 5px;
    background: none;
    font-size: 0.8em;
    margin:0;
    white-space: nowrap;
}
#node-input-link-container li label {
    margin-bottom: 0;
    width: 100%;
}
#node-input-link-container li label input {
    vertical-align: top;
    width:15px;
    margin-right: 10px;
}
#node-input-link-container li:hover,
#node-input-link-container li:hover .node-input-target-node-sublabel {
    background: #f0f0f0;
}
.node-input-link-node-sublabel {
    position:absolute;
    right: 0px;
    padding-right: 10px;
    padding-left: 10px;
    font-size: 0.8em;
}
</style>

<script type="text/javascript">
(function() {

    function sortNodeList(nodeList,sortOn,sortOnSecond) {
        var currentSort = nodeList.data('currentSort');
        var currentSortOrder = nodeList.data('currentSortOrder');

        if (!currentSort) {
            currentSort = sortOn;
            currentSortOrder = 'a';
        } else {
            if (currentSort === sortOn) {
                currentSortOrder = (currentSortOrder === 'a'?'d':'a');
            } else {
                currentSortOrder = 'a';
            }
            currentSort = sortOn;
        }
        nodeList.data('currentSort',currentSort);
        nodeList.data('currentSortOrder',currentSortOrder);

        $("#node-input-link-container-div .fa").hide();
        $(".node-input-link-sort-"+currentSort+"-"+currentSortOrder).show();


        var items = nodeList.find("li").get();
        items.sort(function(a,b) {
            var labelA = $(a).find(".node-input-link-node-"+currentSort).text().toLowerCase();
            var labelB = $(b).find(".node-input-link-node-"+currentSort).text().toLowerCase();
            if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
            if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }

            if (sortOnSecond) {
                labelA = $(a).find(".node-input-link-node-"+sortOnSecond).text().toLowerCase();
                labelB = $(b).find(".node-input-link-node-"+sortOnSecond).text().toLowerCase();
                if (labelA < labelB) { return currentSortOrder==='a'?-1:1; }
                if (labelA > labelB) { return currentSortOrder==='a'?1:-1; }
            }
            return 0;
        });
        $.each(items, function(i, li) {
            nodeList.append(li);
        });
    }
    function onEditPrepare(node,targetType) {
        if (!node.links) {
            node.links = [];
        }
        node.oldLinks = [];

        $('<div id="node-input-link-container-div" style="min-height: 100px;position: relative;   box-sizing: border-box; border-radius: 2px; height: 180px;  border: 1px solid #ccc;overflow:hidden; ">'+
            '    <div style="box-sizing: border-box; line-height: 20px; font-size: 0.8em; border-bottom: 1px solid #ddd; height: 20px;">'+
            '        <div style="display: inline-block;margin-left: 5px;"><a id="node-input-link-sort-label" href="#" data-i18n="[title]node-red:link.label.sortByLabel"><span data-i18n="node-red:link.label.node">name</span> <i class="node-input-link-sort-label-a fa fa-caret-down"></i><i class="node-input-link-sort-label-d fa fa-caret-up"></i></a></div>'+
            '        <div style="position: absolute; right: 10px; width: 50px; display: inline-block; text-align: right;"><a id="node-input-link-sort-type" href="#" data-i18n="[title]node-red:link.label.sortByFlow"><i class="node-input-link-sort-sublabel-a fa fa-caret-down"></i><i class="node-input-link-sort-sublabel-d fa fa-caret-up"></i> <span data-i18n="node-red:link.label.type">flow</span></a></div>'+
            '    </div>'+
            '    <div style="background: #fbfbfb; box-sizing: border-box; position:absolute; top:20px;bottom:0;left:0px;right:0px; overflow-y: scroll; overflow-x: hidden;">'+
            '        <ul id="node-input-link-container" style=" list-style-type:none; margin: 0;"></ul>'+
            '    </div>'+
            '</div>').appendTo('.node-input-link-row');

        var nodeList = $("#node-input-link-container");
        var candidateNodes = RED.nodes.filterNodes({type:targetType});
        var inSubflow = !!RED.nodes.subflow(node.z);
        candidateNodes.forEach(function(n) {
            if (inSubflow) {
                if (n.z !== node.z) {
                    return;
                }
            } else {
                if (!!RED.nodes.subflow(n.z)) {
                    return;
                }
            }
            var isChecked = false;

            isChecked = (node.links.indexOf(n.id) !== -1) || (n.links||[]).indexOf(node.id) !== -1;

            if (isChecked) {
                node.oldLinks.push(n.id);
            }

            var container = $('<li></li>',{class:"node-input-link-node"});
            var row = $('<label></label>',{for:"node-input-link-node-"+n.id}).appendTo(container);
            $('<input>',{type:"checkbox",class:"node-input-link-node-checkbox",id:"node-input-link-node-"+n.id})
                .data('node-id',n.id)
                .prop('checked', isChecked)
                .appendTo(row);
            container.on('mouseover',function(e) {
                n.highlighted = true;
                n.dirty = true;
                RED.view.redraw();
            });
            container.on('mouseout',function(e) {
                n.highlighted = false;
                n.dirty = true;
                RED.view.redraw();
            });
            var labelSpan = $('<span>');
            var label = n.name||n.id;
            var sublabel;
            var tab = RED.nodes.workspace(n.z);
            if (tab) {
                sublabel = tab.label||tab.id;
            } else {
                tab = RED.nodes.subflow(n.z);
                sublabel = "subflow : "+tab.name;
            }
            $('<span>',{class:"node-input-link-node-label",style:"white-space:nowrap"}).text(label).appendTo(row);
            if (sublabel) {
                $('<span>',{class:"node-input-link-node-sublabel"}).text(sublabel).appendTo(row);
            }
            container.appendTo(nodeList);
        });

        sortNodeList(nodeList,'sublabel','label');

        $("#node-input-link-sort-label").click(function(e) {
            e.preventDefault();
            sortNodeList(nodeList,'label');
        });

        $("#node-input-link-sort-type").click(function(e) {
            e.preventDefault();
            sortNodeList(nodeList,'sublabel');
        });
    }

    function resizeNodeList() {
        var rows = $("#dialog-form>div:not(.node-input-link-row)");
        var height = $("#dialog-form").height();
        for (var i=0;i<rows.size();i++) {
            height -= $(rows[i]).outerHeight(true);
        }
        var editorRow = $("#dialog-form>div.node-input-link-row");
        height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
        $("#node-input-link-container-div").css("height",height+"px");
    }

    function onEditSave(node) {
        node.links = [];
        $(".node-input-link-node-checkbox").each(function(n) {
            if ($(this).prop("checked")) {
                node.links.push($(this).data('node-id'));
            }
        });
        node.oldLinks.sort();
        node.links.sort();
        var nodeMap = {};
        var length = Math.max(node.oldLinks.length,node.links.length);
        for (var i=0;i<length;i++) {
            if (i<node.oldLinks.length) {
                nodeMap[node.oldLinks[i]] = nodeMap[node.oldLinks[i]]||{};
                nodeMap[node.oldLinks[i]].old = true;
            }
            if (i<node.links.length) {
                nodeMap[node.links[i]] = nodeMap[node.links[i]]||{};
                nodeMap[node.links[i]].new = true;
            }
        }
        var n;
        for (var id in nodeMap) {
            if (nodeMap.hasOwnProperty(id)) {
                n = RED.nodes.node(id);
                if (n) {
                    if (nodeMap[id].old && !nodeMap[id].new) {
                        // Removed id
                        i = n.links.indexOf(node.id);
                        if (i > -1) {
                            n.links.splice(i,1);
                        }
                    } else if (!nodeMap[id].old && nodeMap[id].new) {
                        // Added id
                        i = n.links.indexOf(id);
                        if (i === -1) {
                            n.links.push(node.id);
                        }
                    }
                }
            }
        }
    }

    function onAdd() {
        for (var i=0;i<this.links.length;i++) {
            var n = RED.nodes.node(this.links[i]);
            if (n && n.links.indexOf(this.id) === -1) {
                n.links.push(this.id);
            }
        }
    }

    RED.nodes.registerType('link in',{
        category: 'input',
        color:"#ddd",//"#87D8CF",
        defaults: {
            name: {value:""},
            links: { value: [] }
        },
        inputs:0,
        outputs:1,
        icon: "link-out.png",
        outputLabels: function(i) {
            return this.name||this._("link.linkIn");
        },
        label: function() {
            return this.name||this._("link.linkIn");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            onEditPrepare(this,"link out");
        },
        oneditsave: function() {
            onEditSave(this);
        },
        onadd: onAdd,
        oneditresize: resizeNodeList
    });

    RED.nodes.registerType('link out',{
        category: 'output',
        color:"#ddd",//"#87D8CF",
        defaults: {
            name: {value:""},
            links: { value: []}
        },
        align:"right",
        inputs:1,
        outputs:0,
        icon: "link-out.png",
        inputLabels: function(i) {
            return this.name||this._("link.linkOut");
        },
        label: function() {
            return this.name||this._("link.linkOut");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            onEditPrepare(this,"link in");
        },
        oneditsave: function() {
            onEditSave(this);
        },
        onadd: onAdd,
        oneditresize: resizeNodeList
    });
})();
</script>
<script type="text/x-red" data-help-name="link in">
    <p>Create virtual wires between flows.</p>
    <h3>Details</h3>
    <p>The node can be connected to any <code>link out</code> node that exists on any tab.
       Once connected, they behave as if they were wired together.</p>
    <p>The wires between link nodes are only displayed when a link node is selected.
       If there are any wires to other tabs, a virtual node is shown that can be clicked
       on to jump to the appropriate tab.</p>
    <p><b>Note: </b>Links cannot be created going into, or out of, a subflow.</p>
</script><script type="text/x-red" data-help-name="link out">
    <p>Create virtual wires between flows.</p>
    <h3>Details</h3>
    <p>The node can be connected to any <code>link in</code> node that exists on any tab.
       Once connected, they behave as if they were wired together.</p>
    <p>The wires between link nodes are only displayed when a link node is selected.
       If there are any wires to other tabs, a virtual node is show that can be clicked
       on to jump to the appropriate tab.</p>
    <p><b>Note: </b>Links cannot be created going into, or out of, a subflow.</p>
</script>
<!-- --- [red-module:node-red/function] --- -->

<script type="text/x-red" data-template-name="function">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="node-input-func"><i class="fa fa-wrench"></i> <span data-i18n="function.label.function"></span></label>
        <input type="hidden" id="node-input-func" autofocus="autofocus">
        <input type="hidden" id="node-input-noerr">
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-func-editor" ></div>
    </div>
    <div class="form-row">
        <label for="node-input-outputs"><i class="fa fa-random"></i> <span data-i18n="function.label.outputs"></span></label>
        <input id="node-input-outputs" style="width: 60px;" value="1">
    </div>
    <div class="form-tips"><span data-i18n="function.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('function',{
        color:"#fdd0a2",
        category: 'function',
        defaults: {
            name: {value:""},
            func: {value:"\nreturn msg;"},
            outputs: {value:1},
            noerr: {value:0,required:true,validate:function(v) { return ((!v) || (v === 0)) ? true : false; }}
        },
        inputs:1,
        outputs:1,
        icon: "function.png",
        label: function() {
            return this.name||this._("function.function");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            $( "#node-input-outputs" ).spinner({
                min:1,
                change: function(event, ui) {
                    var value = this.value;
                    if (!value.match(/^\d+$/)) { value = 1;  }
                    else if (value < this.min) { value = this.min; }
                    if (value !== this.value) { $(this).spinner("value", value); }
                }
            });

            this.editor = RED.editor.createEditor({
                id: 'node-input-func-editor',
                mode: 'ace/mode/javascript',
                value: $("#node-input-func").val(),
                globals: {
                    msg:true,
                    context:true,
                    RED: true,
                    util: true,
                    flow: true,
                    global: true,
                    console: true,
                    Buffer: true,
                    setTimeout: true,
                    clearTimeout: true,
                    setInterval: true,
                    clearInterval: true
                }
            });

            RED.library.create({
                url:"functions", // where to get the data from
                type:"function", // the type of object the library is for
                editor:this.editor, // the field name the main text body goes to
                mode:"ace/mode/javascript",
                fields:['name','outputs']
            });
            this.editor.focus();
        },
        oneditsave: function() {
            var annot = this.editor.getSession().getAnnotations();
            this.noerr = 0;
            $("#node-input-noerr").val(0);
            for (var k=0; k < annot.length; k++) {
                //console.log(annot[k].type,":",annot[k].text, "on line", annot[k].row);
                if (annot[k].type === "error") {
                    $("#node-input-noerr").val(annot.length);
                    this.noerr = annot.length;
                }
            }
            $("#node-input-func").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<script type="text/x-red" data-help-name="function">
    <p>A JavaScript function block to run against the messages being received by the node.</p>
    <p>The messages are passed in as a JavaScript object called <code>msg</code>.</p>
    <p>By convention it will have a <code>msg.payload</code> property containing
       the body of the message.</p>
    <p>The function is expected to return a message object (or multiple message objects), but can choose
       to return nothing in order to halt a flow.</p>
    <h3>Details</h3>
    <p>See the <a target="_blank" href="http://nodered.org/docs/writing-functions.html">online documentation</a>
    for more information on writing functions.</p>
    <h4>Sending messages</h4>
    <p>The function can either return the messages it wants to pass on to the next nodes
    in the flow, or can call <code>node.send(messages)</code>.</p>
    <p>It can return/send:</p>
    <ul>
      <li>a single message object - passed to nodes connected to the first output</li>
      <li>an array of message objects - passed to nodes connected to the corresponding outputs</li>
    </ul>
    <p>If any element of the array is itself an array of messages, multiple
          messages are sent to the corresponding output.</p>
    <p>If null is returned, either by itself or as an element of the array, no
          message is passed on.</p>
    <h4>Logging and Error Handling</h4>
    <p>To log any information, or report an error, the following functions are available:</p>
      <ul>
          <li><code>node.log("Log message")</code></li>
          <li><code>node.warn("Warning")</code></li>
          <li><code>node.error("Error")</code></li>
      </ul>
    </p>
    <p>The Catch node can also be used to handle errors. To invoke a Catch node,
    pass <code>msg</code> as a second argument to <code>node.error</code>:</p>
    <pre>node.error("Error",msg);</pre>
</script>
<!-- --- [red-module:node-red/template] --- -->

<script type="text/x-red" data-template-name="template">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <label for="node-input-field"><i class="fa fa-edit"></i> <span data-i18n="template.label.property"></span></label>
        <input type="text" id="node-input-field" placeholder="payload" style="width:250px;">
        <input type="hidden" id="node-input-fieldType">
    </div>
    <div class="form-row">
        <label for="node-input-syntax"><i class="fa fa-code"></i> <span data-i18n="template.label.syntax"></span></label>
        <select id="node-input-syntax" style="width:180px;">
            <option value="mustache" data-i18n="template.label.mustache"></option>
            <option value="plain" data-i18n="template.label.plain"></option>
        </select>
    </div>

    <div class="form-row" style="position: relative; margin-bottom: 0px;">
        <label for="node-input-template"><i class="fa fa-file-code-o"></i> <span data-i18n="template.label.template"></span></label>
        <input type="hidden" id="node-input-template" autofocus="autofocus">
        <div style="position: absolute; right:0;display:inline-block; text-align: right; font-size: 0.8em;">
            <span data-i18n="template.label.format"></span>:
            <select id="node-input-format" style="width:110px; font-size: 10px !important;  height: 24px; padding:0;">
                <option value="handlebars">mustache</option>
                <option value="html">HTML</option>
                <option value="json">JSON</option>
                <option value="javascript">Javascript</option>
                <option value="css">CSS</option>
                <option value="markdown">Markdown</option>
                <option value="yaml">YAML</option>
                <option value="text" data-i18n="template.label.none"></option>
            </select>
        </div>
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-template-editor" ></div>
    </div>
    <div class="form-row">
        <label for="node-input-output"><i class="fa fa-long-arrow-right"></i> <span data-i18n="template.label.output"></span></label>
        <select id="node-input-output" style="width:180px;">
            <option value="str" data-i18n="template.label.plain"></option>
            <option value="json" data-i18n="template.label.json"></option>
            <option value="yaml" data-i18n="template.label.yaml"></option>
        </select>
    </div>

</script>



<script type="text/javascript">
    RED.nodes.registerType('template',{
        color:"rgb(243, 181, 103)",
        category: 'function',
        defaults: {
            name: {value:""},
            field: {value:"payload", validate:RED.validators.typedInput("fieldType")},
            fieldType: {value:"msg"},
            format: {value:"handlebars"},
            syntax: {value:"mustache"},
            template: {value:"This is the payload: {{payload}} !"},
            output: {value:"str"}
        },
        inputs:1,
        outputs:1,
        icon: "template.png",
        label: function() {
            return this.name||this._("template.template");;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var that = this;
            if (!this.field) {
                this.field = 'payload';
                $("#node-input-field").val("payload");
            }
            if (!this.fieldType) {
                this.fieldType = 'msg';
            }
            if (!this.syntax) {
                this.syntax = 'mustache';
                $("#node-input-syntax").val(this.syntax);
            }
            $("#node-input-field").typedInput({
                default: 'msg',
                types: ['msg','flow','global'],
                typeField: $("#node-input-fieldType")
            });

            this.editor = RED.editor.createEditor({
                id: 'node-input-template-editor',
                mode: 'ace/mode/html',
                value: $("#node-input-template").val()
            });
            RED.library.create({
                url:"functions", // where to get the data from
                type:"function", // the type of object the library is for
                editor:that.editor, // the field name the main text body goes to
                fields:['name','outputs']
            });
            this.editor.focus();

            $("#node-input-format").change(function() {
                var mod = "ace/mode/"+$("#node-input-format").val();
                that.editor.getSession().setMode({
                    path: mod,
                    v: Date.now()
                });
            });
        },
        oneditsave: function() {
            $("#node-input-template").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<script type="text/x-red" data-help-name="template">
    <p>Sets a property based on the provided template.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>msg <span class="property-type">object</span></dt>
        <dd>A msg object containing information to populate the template.</dd>
        <dt class="optional">template <span class="property-type">string</span></dt>
        <dd>A template to be populated from msg.payload. If not configured in the edit panel,
         this can be set as a property of msg.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>msg <span class="property-type">object</span></dt>
        <dd>a msg with a property set by populating the configured template with properties from the incoming msg.</dd>
    </dl>
    <h3>Details</h3>
    <p>By default this uses the <i><a href="http://mustache.github.io/mustache.5.html" target="_blank">mustache</a></i>
    format, but this can be switched off if required.</p>
    <p>For example, when a template of:
    <pre>Hello {{payload.name}}. Today is {{date}}</pre>
    <p>receives a message containing:
    <pre>{
  date: "Monday"
  payload: {
    name: "Fred",
  }
}</pre>
    <p>The resulting property will be:
    <pre>Hello Fred. Today is Monday</pre>
    <p>It is possible to use a property from the flow context or global context. Just use <code>{{flow.name}}</code> or <code>{{global.name}}</code>.
    <p><b>Note: </b>By default, <i>mustache</i> will escape any HTML entities in the values it substitutes.
       To prevent this, use <code>{{{triple}}}</code> braces.
</script>
<!-- --- [red-module:node-red/delay] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="delay">
    <div class="form-row">
        <label for="node-input-delay-action"><i class="fa fa-tasks"></i> <span data-i18n="delay.action"></span></label>
        <select id="node-input-delay-action" style="width:270px !important">
            <option value="delay" data-i18n="delay.delaymsg"></option>
            <option value="rate" data-i18n="delay.limitrate"></option>
        </select>
    </div>

    <div id="delay-details">
        <div class="form-row">
            <label></label>
            <select id="node-input-delay-type" style="width:270px !important">
                <option value="delay" data-i18n="delay.delayfixed"></option>
                <option value="random" data-i18n="delay.randomdelay"></option>
                <option value="delayv" data-i18n="delay.delayvarmsg"></option>
            </select>
        </div>
        <div class="form-row" id="delay-details-for">
            <label for="node-input-timeout"><i class="fa fa-clock-o"></i> <span data-i18n="delay.for"></span></label>
            <input type="text" id="node-input-timeout" style="text-align:end; width:50px !important">
            <select id="node-input-timeoutUnits" style="width:200px !important">
              <option value="milliseconds" data-i18n="delay.milisecs"></option>
              <option value="seconds" data-i18n="delay.secs"></option>
              <option value="minutes" data-i18n="delay.mins"></option>
              <option value="hours" data-i18n="delay.hours"></option>
              <option value="days" data-i18n="delay.days"></option>
            </select>
        </div>
        <div id="random-details" class="form-row">
            <label for="node-input-randomFirst"><i class="fa fa-clock-o"></i> <span data-i18n="delay.between"></span></label>
            <input type="text" id="node-input-randomFirst" placeholder="" style="text-align:end; width:30px !important">
            <span data-i18n="delay.and"></span>
            <input type="text" id="node-input-randomLast" placeholder="" style="text-align:end; width:30px !important">
            <select id="node-input-randomUnits" style="width:140px !important">
              <option value="milliseconds" data-i18n="delay.milisecs"></option>
              <option value="seconds" data-i18n="delay.secs"></option>
              <option value="minutes" data-i18n="delay.mins"></option>
              <option value="hours" data-i18n="delay.hours"></option>
              <option value="days" data-i18n="delay.days"></option>
            </select>
        </div>
    </div>

    <div id="rate-details">
        <div class="form-row">
            <label></label>
            <select id="node-input-rate-type" style="width:270px !important">
                <option value="all" data-i18n="delay.limitall"></option>
                <option value="topic" data-i18n="delay.limittopic"></option>
            </select>
        </div>
        <div class="form-row">
            <label for="node-input-rate"><i class="fa fa-clock-o"></i> <span data-i18n="delay.rate"></span></label>
            <input type="text" id="node-input-rate" placeholder="1" style="text-align:end; width:40px !important">
            <label for="node-input-rateUnits"><span data-i18n="delay.msgper"></span></label>
            <input type="text" id="node-input-nbRateUnits" placeholder="1" style="text-align:end; width:40px !important">
            <select id="node-input-rateUnits" style="width:90px !important">
              <option value="second" data-i18n="delay.label.units.second.singular"></option>
              <option value="minute" data-i18n="delay.label.units.minute.singular"></option>
              <option value="hour" data-i18n="delay.label.units.hour.singular"></option>
              <option value="day" data-i18n="delay.label.units.day.singular"></option>
            </select>
        </div>
        <div class="form-row" id="rate-details-drop">
            <label></label><input style="width: 30px;" type="checkbox" id="node-input-drop"><label style="width: 250px;" for="node-input-drop" data-i18n="delay.dropmsg"></label>
        </div>
        <div class="form-row" id="rate-details-per-topic">
            <label></label>
            <select id="node-input-rate-topic-type" style="width:270px !important">
                <option value="queue" data-i18n="delay.fairqueue"></option>
                <option value="timed" data-i18n="delay.timedqueue"></option>
            </select>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('delay',{
        category: 'function',
        color:"#E6E0F8",
        defaults: {
            name: {value:""},
            pauseType: {value:"delay", required:true},
            timeout: {value:"5", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            timeoutUnits: {value:"seconds"},
            rate: {value:"1", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            nbRateUnits: {value:"1", required:false, validate:RED.validators.regex(/\d+|/)},
            rateUnits: {value: "second"},
            randomFirst: {value:"1", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            randomLast: {value:"5", required:true, validate:function(v) { return RED.validators.number(v) && (v >= 0); }},
            randomUnits: {value: "seconds"},
            drop: {value:false}
        },
        inputs:1,
        outputs:1,
        icon: "timer.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            if (this.pauseType == "delayv") {
                return this._("delay.label.variable");
            } else if (this.pauseType == "delay") {
                var units = this.timeoutUnits ? this.timeoutUnits.charAt(0) : "s";
                if (this.timeoutUnits == "milliseconds") { units = "ms"; }
                return this._("delay.label.delay")+" "+this.timeout+units;
            } else if (this.pauseType == "random") {
                return this._("delay.label.random");
            } else {
                var rate = this.rate+" msg/"+(this.rateUnits ? (this.nbRateUnits > 1 ? this.nbRateUnits : '') + this.rateUnits.charAt(0) : "s");
                if (this.pauseType == "rate") {
                    return this._("delay.label.limit")+" "+rate;
                } else if (this.pauseType == "timed") {
                    return this._("delay.label.limitTopic")+" "+rate;
                } else {
                    return this._("delay.label.limitTopic")+" "+rate;
                }
            }
            //     var units = '';
            //     if (this.nbRateUnits > 1) {
            //         units = this.nbRateUnits + ' ' + this._("delay.label.units." + this.rateUnits + ".plural");
            //     } else {
            //         units = this._("delay.label.units." + this.rateUnits + ".singular");
            //     }
            //     return this.name || this.rate + " " + this._("delay.label.timed") + ' ' + units;
            // } else {
            //     var units = this.rateUnits ? (this.nbRateUnits > 1 ? this.nbRateUnits : '') + this.rateUnits.charAt(0) : "s";
            //     return this.name || this._("delay.label.queue")+" "+this.rate+" msg/"+units;
            // }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            $( "#node-input-timeout" ).spinner({min:1});
            $( "#node-input-rate" ).spinner({min:1});
            $( "#node-input-nbRateUnits" ).spinner({min:1});

            $( "#node-input-randomFirst" ).spinner({min:0});
            $( "#node-input-randomLast" ).spinner({min:1});

            $('.ui-spinner-button').click(function() {
                $(this).siblings('input').change();
            });

            $( "#node-input-nbRateUnits" ).on('change keyup', function() {
                var $this = $(this);
                var val = parseInt($this.val());
                var type = "singular";
                if (val > 1) {
                    type = "plural";
                }
                if ($this.attr("data-type") == type) {
                    return;
                }
                $this.attr("data-type", type);
                $("#node-input-rateUnits option").each(function () {
                    var $option = $(this);
                    var key = "delay.label.units." + $option.val() + "." + type;
                    $option.attr('data-i18n', 'node-red:' + key);
                    $option.html(node._(key));
                });
            });

            if (this.pauseType == "delay") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('delay');
            } else if (this.pauseType == "delayv") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('delayv');
            } else if (this.pauseType == "random") {
                $("#node-input-delay-action").val('delay');
                $("#node-input-delay-type").val('random');
            } else if (this.pauseType == "rate") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('all');
            } else if (this.pauseType == "queue") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('topic');
                $("#node-input-rate-topic-type").val('queue');
            } else if (this.pauseType == "timed") {
                $("#node-input-delay-action").val('rate');
                $("#node-input-rate-type").val('topic');
                $("#node-input-rate-topic-type").val('timed');
            }

            if (!this.timeoutUnits) {
                $("#node-input-timeoutUnits option").filter(function() {
                    return $(this).val() == 'seconds';
                }).attr('selected', true);
            }

            if (!this.randomUnits) {
                $("#node-input-randomUnits option").filter(function() {
                    return $(this).val() == 'seconds';
                }).attr('selected', true);
            }

            $("#node-input-delay-action").on("change",function() {
                if (this.value === "delay") {
                    $("#delay-details").show();
                    $("#rate-details").hide();
                } else if (this.value === "rate") {
                    $("#delay-details").hide();
                    $("#rate-details").show();
                }
            }).change();

            $("#node-input-delay-type").on("change", function() {
                if (this.value === "delay") {
                    $("#delay-details-for").show();
                    $("#random-details").hide();
                } else if (this.value === "delayv") {
                    $("#delay-details-for").show();
                    $("#random-details").hide();
                } else if (this.value === "random") {
                    $("#delay-details-for").hide();
                    $("#random-details").show();
                }
            }).change();

            $("#node-input-rate-type").on("change", function() {
                if (this.value === "all") {
                    $("#node-input-drop").attr('disabled',false).next().css("opacity",1)
                    $("#rate-details-per-topic").hide();
                } else if (this.value === "topic") {
                    $("#node-input-drop").prop('checked',true).attr('disabled',true).next().css("opacity",0.5)
                    $("#rate-details-per-topic").show();
                }
            }).change();
        },
        oneditsave: function() {
            var action = $("#node-input-delay-action").val();
            if (action === "delay") {
                this.pauseType = $("#node-input-delay-type").val();
            } else if (action === "rate") {
                action = $("#node-input-rate-type").val();
                if (action === "all") {
                    this.pauseType = "rate";
                } else {
                    this.pauseType = $("#node-input-rate-topic-type").val();
                }
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="delay">
    <p>Delays each message passing through the node or limits the rate at which they can pass.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">delay <span class="property-type">number</span></dt>
        <dd>Sets the delay, in milliseconds, to be applied to the message. This
            option only applies if the node is configured to allow the message to
            override the configured default delay interval.</dd>
        <dt class="optional">reset</dt>
        <dd>If the received message has this property set to any value, all
            outstanding messages held by the node are cleared without being sent.</dd>
    </dl>
    <h3>Details</h3>
    <p>When configured to delay messages, the delay interval can be a fixed value,
       a random value within a range or dynamically set for each message.</p>
    <p>When configured to rate limit messages, their delivery is spread across
       the configured time period. The status shows the number of messages currently in the queue.
       It can optionally discard intermediate messages as they arrive.</p>
    </p>
    <p>The rate limiting can be applied to all messages, or group them according to
       their <code>msg.topic</code> value. When grouping, intermerdiate messages are
       automatically dropped. At each time interval, the node can either release
       the most recent message for all topics, or release the most recent message
       for the next topic.
    </p>
</script>
<!-- --- [red-module:node-red/trigger] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="trigger">
    <div class="form-row">
        <label data-i18n="trigger.send" for="node-input-op1"></label>
        <input type="hidden" id="node-input-op1type">
        <input style="width: 70%" type="text" id="node-input-op1" placeholder="1">
    </div>
    <div class="form-row">
        <label data-i18n="trigger.then"></label>
        <select id="node-then-type" style="width:70%;">
            <option value="block" data-i18n="trigger.wait-reset"></option>
            <option value="wait" data-i18n="trigger.wait-for"></option>
            <option value="loop" data-i18n="trigger.wait-loop"></option>
        </select>
    </div>
    <div class="form-row node-type-duration">
        <label></label>
        <input type="text" id="node-input-duration" style="text-align:end; width:70px !important">
        <select id="node-input-units" style="width:140px !important">
            <option value="ms" data-i18n="trigger.duration.ms"></option>
            <option value="s" data-i18n="trigger.duration.s"></option>
            <option value="min" data-i18n="trigger.duration.m"></option>
            <option value="hr" data-i18n="trigger.duration.h"></option>
        </select>
    </div>
    <div class="form-row node-type-wait">
    <label></label>
        <input type="checkbox" id="node-input-extend" style="margin-left: 0px; vertical-align: top; width: auto !important;"> <label style="width:auto !important;" for="node-input-extend" data-i18n="trigger.extend"></label>
    </div>
    <div class="form-row node-type-wait">
        <label data-i18n="trigger.then-send"></label>
        <input type="hidden" id="node-input-op2type">
        <input style="width: 70%" type="text" id="node-input-op2" placeholder="0">
    </div>
    <div class="form-row">
        <label data-i18n="trigger.label.reset" style="width:auto"></label>
        <div style="display:inline-block; width:70%;vertical-align:top">
        <ul>
            <li data-i18n="trigger.label.resetMessage"></li>
            <li><span data-i18n="trigger.label.resetPayload"></span> <input type="text" id="node-input-reset" style="width:150px" data-i18n="[placeholder]trigger.label.resetprompt"></li>
        </ul>
    </div>
    <br/>
    <div class="form-row">
        <label data-i18n="trigger.for" for="node-input-bytopic"></label>
        <select id="node-input-bytopic">
            <option value="all" data-i18n="trigger.alltopics"></option>
            <option value="topic" data-i18n="trigger.bytopics"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></input>
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('trigger',{
        category: 'function',
        color:"#E6E0F8",
        defaults: {
            op1: {value:"1", validate: RED.validators.typedInput("op1type")},
            op2: {value:"0", validate: RED.validators.typedInput("op2type")},
            op1type: {value:"val"},
            op2type: {value:"val"},
            duration: {value:"250",required:true,validate:RED.validators.number()},
            extend: {value:"false"},
            units: {value:"ms"},
            reset: {value:""},
            bytopic: {value: "all"},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "trigger.png",
        label: function() {
            if (this.duration > 0) {
                return this.name|| this._("trigger.label.trigger")+" "+this.duration+this.units;
            }
            if (this.duration < 0) {
                return this.name|| this._("trigger.label.trigger-loop")+" "+(this.duration * -1)+this.units;
            }
            else {
                return this.name|| this._("trigger.label.trigger-block");
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-then-type").change(function() {
                if ($(this).val() == "block") {
                    $(".node-type-wait").hide();
                    $(".node-type-duration").hide();
                }
                else if ($(this).val() == "loop") {
                    $(".node-type-wait").hide();
                    $(".node-type-duration").show();
                } else {
                    $(".node-type-wait").show();
                    $(".node-type-duration").show();
                }
            });

            if (this.op1type === 'val') {
                $("#node-input-op1type").val('str');
            }
            if (this.op2type === 'val') {
                $("#node-input-op2type").val('str');
            }

            var optionNothing = {value:"nul",label:this._("trigger.output.nothing"),hasValue:false};
            var optionPayload = {value:"pay",label:this._("trigger.output.existing"),hasValue:false};
            var optionOriginalPayload = {value:"pay",label:this._("trigger.output.original"),hasValue:false};
            var optionLatestPayload = {value:"payl",label:this._("trigger.output.latest"),hasValue:false};

            $("#node-input-op1").typedInput({
                default: 'str',
                typeField: $("#node-input-op1type"),
                types:['flow','global','str','num','bool','json',
                    optionPayload,
                    optionNothing
                ]
            });
            $("#node-input-op2").typedInput({
                default: 'str',
                typeField: $("#node-input-op2type"),
                types:['flow','global','str','num','bool','json',
                    optionOriginalPayload,
                    optionLatestPayload,
                    optionNothing
                ]
            });

            if (this.bytopic === undefined) {
                $("#node-input-bytopic").val("all");
            }

            if (this.duration == "0") {
                $("#node-then-type").val("block");
            }
            else if ((this.duration * 1) < 0) {
                $("#node-then-type").val("loop");
                $("#node-input-duration").val(this.duration*-1);
            } else {
                $("#node-then-type").val("wait");
            }
            $("#node-then-type").change();

            if (this.extend === "true" || this.extend === true) {
                $("#node-input-extend").prop("checked",true);
            } else {
                $("#node-input-extend").prop("checked",false);
            }

        },
        oneditsave: function() {
            if ($("#node-then-type").val() == "block") {
                $("#node-input-duration").val("0");
            }
            if ($("#node-then-type").val() == "loop") {
                $("#node-input-duration").val($("#node-input-duration").val() * -1);
            }


        }
    });
</script>
<script type="text/x-red" data-help-name="trigger">
    <p>When triggered, can send a message, and then optionally a second message, unless extended or reset.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">reset</dt>
        <dd>If a message is received with this property, any timeout or repeat
        currently in progress will be cleared and no message triggered.</dd>
    </dl>

    <h3>Details</h3>
    <p>This node can be used to create a timeout within a flow. By default, when
    it receives a message, it sends on a message with a <code>payload</code> of <code>1</code>.
    It then waits 250ms before sending a second message with a <code>payload</code> of <code>0</code>.
    This could be used, for example, to blink an LED attached to a Raspberry PI GPIO pin.</p>
    <p>The payloads of each message sent can be configured to a variety of values, including
    the option to not send anything. For example, setting the initial message to <i>nothing</i> and
    selecting the option to extend the timer with each received message, the node will
    act as a watchdog timer; only sending a message if nothing is received within the
    set interval.</p>
    <p>If set to a <i>string</i> type, the node supports the mustache template syntax.</p>
    <p>If the node receives a message with a <code>reset</code> property, or a <code>payload</code>
    that matches that configured in the node, any timeout or repeat currently in
    progress will be cleared and no message triggered.</p>
    <p>The node can be configured to resend a message at a regular interval until it
    is reset by a received message.</p>
    <p>Optionally, the node can be configured to treat messages with <code>msg.topic</code> as if they
    are separate streams.</p>
</script>
<!-- --- [red-module:node-red/comment] --- -->

<script type="text/x-red" data-template-name="comment">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-comment"></i> <span data-i18n="comment.label.title"></span></label>
        <input type="text" id="node-input-name">
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="node-input-info" style="width: 100% !important;"><i class="fa fa-comments"></i> <span data-i18n="comment.label.body"></span></label>
        <input type="hidden" id="node-input-info" autofocus="autofocus">
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px; min-height:150px;" class="node-text-editor" id="node-input-info-editor"></div>
    </div>
    <div class="form-tips" data-i18n="[html]comment.tip"></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('comment',{
        category: 'function',
        color:"#ffffff",
        defaults: {
            name: {value:""},
            info: {value:""}
        },
        inputs:0,
        outputs:0,
        icon: "comment.png",
        label: function() {
            return this.name||this._("comment.comment");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        info: function() {
            return (this.name?"# "+this.name+"\n":"")+(this.info||"");
        },
        oneditprepare: function() {
            var that = this;
            this.editor = RED.editor.createEditor({
                id: 'node-input-info-editor',
                mode: 'ace/mode/markdown',
                value: $("#node-input-info").val()
            });
            this.editor.focus();
        },
        oneditsave: function() {
            $("#node-input-info").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>
<script type="text/x-red" data-help-name="comment">
    <p>A node you can use to add comments to your flows.</p>
    <h3>Details</h3>
    <p>The edit panel will accept Markdown syntax. The text will be rendered into
    this information side panel.</p>
</script>
<!-- --- [red-module:node-red/unknown] --- -->

<script type="text/x-red" data-template-name="unknown">
    <div class="form-tips"><span data-i18n="[html]unknown.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('unknown',{
        category: 'unknown',
        color:"#fff0f0",
        defaults: {
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "",
        label: function() {
            return "("+this.name+")"||this._("unknown.label.unknown");
        },
        labelStyle: function() {
            return "node_label_unknown";
        }
    });
</script>
<script type="text/x-red" data-help-name="unknown">
    <p>This node is a type unknown to your installation of Node-RED.</p>
    <h3>Details</h3>
    <p><i>If you deploy with the node in this state, its configuration will be preserved, but
    the flow will not start until the missing type is installed.</i></p>
    <p>Use the <code>Menu - Manage Palette</code> option
    to search for and install nodes, or <b>npm install &lt;module&gt;</b> to
    install, any missing modules and restart Node-RED and reimport the nodes.</p>
    <p>It is possible this node type is already installed, but is missing a dependency. Check the Node-RED start-up
    log for any error messages associated with the missing node type.</p>
    <p>Otherwise, you should contact the author of the flow to obtain a copy of the missing node type.</p>
</script>
<!-- --- [red-module:node-red/tls] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="tls-config">
    <div class="form-row" class="hide" id="node-config-row-uselocalfiles">
        <input type="checkbox" id="node-config-input-uselocalfiles" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-config-input-uselocalfiles" style="width: 70%;"><span data-i18n="tls.label.use-local-files"></label>
    </div>
    <div class="form-row">
        <label style="width: 120px;"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.cert"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-certfile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" id="node-config-input-certfile">
            <span id="tls-config-certname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-cert-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-certname">
        <input type="hidden" id="node-config-input-certdata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-cert" data-i18n="[placeholder]tls.placeholder.cert">
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-key"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.key"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-keyfile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" id="node-config-input-keyfile">
            <span id="tls-config-keyname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-key-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-keyname">
        <input type="hidden" id="node-config-input-keydata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-key" data-i18n="[placeholder]tls.placeholder.key">
    </div>
    <div class="form-row">
        <label style="width: 100px; margin-left: 20px;" for="node-config-input-passphrase"> <span data-i18n="tls.label.passphrase"></span></label>
        <input type="password" style="width: calc(100% - 170px);" id="node-config-input-passphrase" data-i18n="[placeholder]tls.placeholder.passphrase">
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-ca"><i class="fa fa-file-text-o"></i> <span data-i18n="tls.label.ca"></span></label>
        <span class="tls-config-input-data">
            <label class="editor-button" for="node-config-input-cafile"><i class="fa fa-upload"></i> <span data-i18n="tls.label.upload"></span></label>
            <input class="hide" type="file" title=" " id="node-config-input-cafile">
            <span id="tls-config-caname" style="width: calc(100% - 280px); overflow: hidden; line-height:34px; height:34px; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle;"> </span>
            <button class="editor-button editor-button-small" id="tls-config-button-ca-clear" style="margin-left: 10px"><i class="fa fa-times"></i></button>
        </span>
        <input type="hidden" id="node-config-input-caname">
        <input type="hidden" id="node-config-input-cadata">
        <input class="hide tls-config-input-path" style="width: calc(100% - 170px);" type="text" id="node-config-input-ca" data-i18n="[placeholder]tls.placeholder.ca">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-config-input-verifyservercert" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-config-input-verifyservercert" style="width: calc(100% - 170px);" data-i18n="tls.label.verify-server-cert"></label>
    </div>
    <div class="form-row">
        <label style="width: 120px;" for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input style="width: calc(100% - 170px);" type="text" id="node-config-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('tls-config',{
        category: 'config',
        defaults: {
            name: {value:""},
            cert: {value:"", validate: function(v) {
                var currentKey = $("#node-config-input-key").val();
                if (currentKey === undefined) {
                    currentKey = this.key;
                }
                return currentKey === '' || v != '';
            }},
            key: {value:"", validate: function(v) {
                var currentCert = $("#node-config-input-cert").val();
                if (currentCert === undefined) {
                    currentCert = this.cert;
                }
                return currentCert === '' || v != '';
            }},
            ca: {value:""},
            certname: {value:""},
            keyname: {value:""},
            caname: {value:""},
            verifyservercert: {value: true}
        },
        credentials: {
            certdata: {type:"text"},
            keydata: {type:"text"},
            cadata: {type:"text"},
            passphrase: {type:"password"}
        },
        label: function() {
            return this.name || this._("tls.tls");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            function updateFileUpload() {
                if ($("#node-config-input-uselocalfiles").is(':checked')) {
                    $(".tls-config-input-path").show();
                    $(".tls-config-input-data").hide();
                } else {
                    $(".tls-config-input-data").show();
                    $(".tls-config-input-path").hide();
                }
            }
            $("#node-config-input-uselocalfiles").on("click",function() {
                updateFileUpload();
            });

            function saveFile(property, file) {
                var dataInputId = "#node-config-input-"+property+"data";
                var filenameInputId = "#node-config-input-"+property+"name";
                var filename = file.name;
                var reader = new FileReader();
                reader.onload = function(event) {
                    $("#tls-config-"+property+"name").text(filename);
                    $(filenameInputId).val(filename);
                    $(dataInputId).val(event.target.result);
                }
                reader.readAsText(file,"UTF-8");
            }
            $("#node-config-input-certfile" ).change(function() {
                saveFile("cert", this.files[0]);
            });
            $("#node-config-input-keyfile" ).change(function() {
                saveFile("key", this.files[0]);
            });
            $("#node-config-input-cafile" ).change(function() {
                saveFile("ca", this.files[0]);
            });

            function clearNameData(prop) {
                $("#tls-config-"+prop+"name").text("");
                $("#node-config-input-"+prop+"data").val("");
                $("#node-config-input-"+prop+"name").val("");
            }
            $("#tls-config-button-cert-clear").click(function() {
                clearNameData("cert");
            });
            $("#tls-config-button-key-clear").click(function() {
                clearNameData("key");
            });
            $("#tls-config-button-ca-clear").click(function() {
                clearNameData("ca");
            });

            if (RED.settings.tlsConfigDisableLocalFiles) {
                $("#node-config-row-uselocalfiles").hide();
            } else {
                $("#node-config-row-uselocalfiles").show();
            }
            // in case paths were set from old TLS config
            if(this.cert || this.key || this.ca) {
                $("#node-config-input-uselocalfiles").prop('checked',true);
            }
            $("#tls-config-certname").text(this.certname);
            $("#tls-config-keyname").text(this.keyname);
            $("#tls-config-caname").text(this.caname);
            updateFileUpload();
        },
        oneditsave: function() {
            if ($("#node-config-input-uselocalfiles").is(':checked')) {
                clearNameData("ca");
                clearNameData("cert");
                clearNameData("key");
            } else {
                $("#node-config-input-ca").val("");
                $("#node-config-input-cert").val("");
                $("#node-config-input-key").val("");
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="tls-config">
    <p>Configuration options for TLS connections.</p>
</script>
<!-- --- [red-module:node-red/mqtt] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="mqtt in">
    <div class="form-row">
        <label for="node-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
        <input type="text" id="node-input-broker">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic" data-i18n="[placeholder]common.label.topic">
    </div>
    <div class="form-row">
        <label for="node-input-qos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
        <select id="node-input-qos" style="width:125px !important">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('mqtt in',{
        category: 'input',
        defaults: {
            name: {value:""},
            topic: {value:"",required:true,validate: RED.validators.regex(/^(#$|(\+|[^+#]*)(\/(\+|[^+#]*))*(\/(\+|#|[^+#]*))?$)/)},
            qos: {value: "2"},
            broker: {type:"mqtt-broker", required:true}
        },
        color:"#d8bfd8",
        inputs:0,
        outputs:1,
        icon: "bridge.png",
        label: function() {
            return this.name||this.topic||"mqtt";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.qos === undefined) {
                $("#node-input-qos").val("2");
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="mqtt out">
    <div class="form-row">
        <label for="node-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
        <input type="text" id="node-input-broker">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
        <input type="text" id="node-input-topic" data-i18n="[placeholder]common.label.topic">
    </div>
    <div class="form-row">
        <label for="node-input-qos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
        <select id="node-input-qos" style="width:125px !important">
            <option value=""></option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
        &nbsp;&nbsp;<i class="fa fa-history"></i>&nbsp;<span data-i18n="mqtt.retain"></span> &nbsp;<select id="node-input-retain" style="width:125px !important">
            <option value=""></option>
            <option value="false" data-i18n="mqtt.false"></option>
            <option value="true" data-i18n="mqtt.true"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="mqtt.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('mqtt out',{
        category: 'output',
        defaults: {
            name: {value:""},
            topic: {value:""},
            qos: {value:""},
            retain: {value:""},
            broker: {type:"mqtt-broker", required:true}
        },
        color:"#d8bfd8",
        inputs:1,
        outputs:0,
        icon: "bridge.png",
        align: "right",
        label: function() {
            return this.name||this.topic||"mqtt";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="mqtt-broker">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-config-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <ul style="background: #fff; min-width: 600px; margin-bottom: 20px;" id="node-config-mqtt-broker-tabs"></ul>
    </div>
    <div id="node-config-mqtt-broker-tabs-content" style="min-height: 170px;">
        <div id="mqtt-broker-tab-connection" style="display:none">
            <div class="form-row node-input-broker">
                <label for="node-config-input-broker"><i class="fa fa-globe"></i> <span data-i18n="mqtt.label.broker"></span></label>
                <input class="input-append-left" type="text" id="node-config-input-broker" style="width:40%;" data-i18n="[placeholder]mqtt.label.example">
                <label for="node-config-input-port" style="margin-left:20px; width:43px; "> <span data-i18n="mqtt.label.port"></span></label>
                <input type="text" id="node-config-input-port" data-i18n="[placeholder]mqtt.label.port" style="width:55px">
            </div>
            <div class="form-row">
                <input type="checkbox" id="node-config-input-usetls" style="display: inline-block; width: auto; vertical-align: top;">
                <label for="node-config-input-usetls" style="width: auto" data-i18n="mqtt.label.use-tls"></label>
                <div id="node-config-row-tls" class="hide">
                    <label style="width: auto; margin-left: 20px; margin-right: 10px;" for="node-config-input-tls"><span data-i18n="mqtt.label.tls-config"></span></label><input style="width: 300px;" type="text" id="node-config-input-tls">
                </div>
            </div>
            <div class="form-row">
                <label for="node-config-input-clientid"><i class="fa fa-tag"></i> <span data-i18n="mqtt.label.clientid"></span></label>
                <input type="text" id="node-config-input-clientid" data-i18n="[placeholder]mqtt.placeholder.clientid">
            </div>
            <div class="form-row">
                <label for="node-config-input-keepalive" style="width: auto"><i class="fa fa-clock-o"></i> <span data-i18n="mqtt.label.keepalive"></span></label>
                <input type="text" id="node-config-input-keepalive" style="width: 50px">
                <input type="checkbox" id="node-config-input-cleansession" style="margin-left: 30px; height: 1em;display: inline-block; width: auto; vertical-align: middle;">
                <label for="node-config-input-cleansession" style="width: auto;" data-i18n="mqtt.label.cleansession"></label>
            </div>
            <div class="form-row">
                <input type="checkbox" id="node-config-input-compatmode" style="display: inline-block; width: auto; vertical-align: top;">
                <label for="node-config-input-compatmode" style="width: auto;" data-i18n="mqtt.label.compatmode"></label>
            </div>
        </div>
        <div id="mqtt-broker-tab-security" style="display:none">
            <div class="form-row">
                <label for="node-config-input-user"><i class="fa fa-user"></i> <span data-i18n="common.label.username"></span></label>
                <input type="text" id="node-config-input-user">
            </div>
            <div class="form-row">
                <label for="node-config-input-password"><i class="fa fa-lock"></i> <span data-i18n="common.label.password"></span></label>
                <input type="password" id="node-config-input-password">
            </div>
        </div>
        <div id="mqtt-broker-tab-messages" style="display:none">
            <div id="mqtt-broker-section-birth">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.birth-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-birthTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-birthTopic" data-i18n="[placeholder]mqtt.placeholder.birth-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-birthRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-birthRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-birthPayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-birthPayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-birthQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-birthQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="mqtt-broker-section-close">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.close-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-closeTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-closeTopic" style="width:300px" data-i18n="[placeholder]mqtt.placeholder.close-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-closeRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-closeRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-closePayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-closePayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-closeQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-closeQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="mqtt-broker-section-will">
                <div class="palette-header">
                    <i class="fa fa-angle-down"></i><span data-i18n="mqtt.sections-label.will-message"></span>
                </div>
                <div class="section-content" style="padding:10px 0 0 10px">
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-willTopic"><i class="fa fa-tasks"></i> <span data-i18n="common.label.topic"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-willTopic" style="width:300px" data-i18n="[placeholder]mqtt.placeholder.will-topic">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-willRetain"><i class="fa fa-history"></i> <span data-i18n="mqtt.label.retain"></span></label>
                        <select id="node-config-input-willRetain" style="width:75px !important">
                            <option value="false" data-i18n="mqtt.false"></option>
                            <option value="true" data-i18n="mqtt.true"></option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label style="width: 100px !important;" for="node-config-input-willPayload"><i class="fa fa-envelope"></i> <span data-i18n="common.label.payload"></span></label>
                        <input style="width: calc(100% - 300px) !important" type="text" id="node-config-input-willPayload" style="width:300px" data-i18n="[placeholder]common.label.payload">
                        <label style="margin-left: 10px; width: 90px !important;" for="node-config-input-willQos"><i class="fa fa-empire"></i> <span data-i18n="mqtt.label.qos"></span></label>
                        <select id="node-config-input-willQos" style="width:75px !important">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('mqtt-broker',{
        category: 'config',
        defaults: {
            name: {value:""},
            broker: {value:"",required:true},
            port: {value:1883,required:false,validate:RED.validators.number(true)},
            tls: {type:"tls-config",required: false},
            clientid: {value:"", validate: function(v) {
                if ($("#node-config-input-clientid").length) {
                    // Currently editing the node
                    return $("#node-config-input-cleansession").is(":checked") || (v||"").length > 0;
                } else {
                    return (this.cleansession===undefined || this.cleansession) || (v||"").length > 0;
                }
            }},
            usetls: {value: false},
            verifyservercert: { value: false},
            compatmode: { value: true},
            keepalive: {value:60,validate:RED.validators.number()},
            cleansession: {value: true},
            birthTopic: {value:""},
            birthQos: {value:"0"},
            birthRetain: {value:false},
            birthPayload: {value:""},
            closeTopic: {value:""},
            closeQos: {value:"0"},
            closeRetain: {value:false},
            closePayload: {value:""},
            willTopic: {value:""},
            willQos: {value:"0"},
            willRetain: {value:false},
            willPayload: {value:""}
        },
        credentials: {
            user: {type:"text"},
            password: {type: "password"}
        },
        label: function() {
            if (this.name) {
                return this.name;
            }
            var b = this.broker;
            if (b === "") { b = "undefined"; }
            var lab = "";
            lab = (this.clientid?this.clientid+"@":"")+b;
            if (b.indexOf("://") === -1){
                if (!this.port){ lab = lab + ":1883"; }
                else { lab = lab + ":" + this.port; }
            }
            return lab;
        },
        oneditprepare: function () {
            var tabs = RED.tabs.create({
                id: "node-config-mqtt-broker-tabs",
                onchange: function(tab) {
                    $("#node-config-mqtt-broker-tabs-content").children().hide();
                    $("#" + tab.id).show();
                }
            });
            tabs.addTab({
                id: "mqtt-broker-tab-connection",
                label: this._("mqtt.tabs-label.connection")
            });
            tabs.addTab({
                id: "mqtt-broker-tab-security",
                label: this._("mqtt.tabs-label.security")
            });

            tabs.addTab({
                id: "mqtt-broker-tab-messages",
                label: this._("mqtt.tabs-label.messages")
            });

            function setUpSection(sectionId, isExpanded) {
                var birthMessageSection = $(sectionId);
                var paletteHeader = birthMessageSection.find('.palette-header');
                var twistie = paletteHeader.find('i');
                var sectionContent = birthMessageSection.find('.section-content');

                function toggleSection(expanded) {
                    twistie.toggleClass('expanded', expanded);
                    sectionContent.toggle(expanded);
                }
                paletteHeader.click(function(e) {
                    e.preventDefault();
                    var isExpanded = twistie.hasClass('expanded');
                    toggleSection(!isExpanded);
                });
                toggleSection(isExpanded);
            }

            // show first section if none are set so the user gets the idea
            var showBirthSection = this.birthTopic !== ""
                || this.willTopic === ""
                && this.birthTopic === ""
                && this.closeTopic == "";
            setUpSection('#mqtt-broker-section-birth', showBirthSection);
            setUpSection('#mqtt-broker-section-close', this.closeTopic !== "");
            setUpSection('#mqtt-broker-section-will', this.willTopic !== "");

            setTimeout(function() { tabs.resize(); },0);
            if (typeof this.cleansession === 'undefined') {
                this.cleansession = true;
                $("#node-config-input-cleansession").prop("checked",true);
            }
            if (typeof this.usetls === 'undefined') {
                this.usetls = false;
                $("#node-config-input-usetls").prop("checked",false);
            }
            if (typeof this.compatmode === 'undefined') {
                this.compatmode = true;
                $("#node-config-input-compatmode").prop('checked', true);
            }
            if (typeof this.keepalive === 'undefined') {
                this.keepalive = 15;
                $("#node-config-input-keepalive").val(this.keepalive);
            }
            if (typeof this.birthQos === 'undefined') {
                this.birthQos = "0";
                $("#node-config-input-birthQos").val("0");
            }
            if (typeof this.closeQos === 'undefined') {
                this.willQos = "0";
                $("#node-config-input-willQos").val("0");
            }
            if (typeof this.willQos === 'undefined') {
                this.willQos = "0";
                $("#node-config-input-willQos").val("0");
            }

            function updateTLSOptions() {
                if ($("#node-config-input-usetls").is(':checked')) {
                    $("#node-config-row-tls").show();
                } else {
                    $("#node-config-row-tls").hide();
                }
            }
            updateTLSOptions();
            $("#node-config-input-usetls").on("click",function() {
                updateTLSOptions();
            });
            var node = this;
            function updateClientId() {
                if ($("#node-config-input-cleansession").is(":checked")) {
                    $("#node-config-input-clientid").attr("placeholder",node._("mqtt.placeholder.clientid"));
                } else {
                    $("#node-config-input-clientid").attr("placeholder",node._("mqtt.placeholder.clientid-nonclean"));
                }
                $("#node-config-input-clientid").change();
            }
            setTimeout(updateClientId,0);
            $("#node-config-input-cleansession").on("click",function() {
                updateClientId();
            });

            function updatePortEntry(){
                var disabled = $("#node-config-input-port").prop("disabled");
                if ($("#node-config-input-broker").val().indexOf("://") === -1){
                    if (disabled){
                        $("#node-config-input-port").prop("disabled", false);
                    }
                }
                else {
                    if (!disabled){
                        $("#node-config-input-port").prop("disabled", true);
                    }
                }
            }
            $("#node-config-input-broker").change(function() {
                updatePortEntry();
            });
            $("#node-config-input-broker").on( "keyup", function() {
                updatePortEntry();
            });
            setTimeout(updatePortEntry,50);

        },
        oneditsave: function() {
            if (!$("#node-config-input-usetls").is(':checked')) {
                $("#node-config-input-tls").val("");
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="mqtt in">
<p>Connects to a MQTT broker and subscribes to messages from the specified topic.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
       <dt>payload <span class="property-type">string | buffer</span></dt>
       <dd>a string unless detected as a binary buffer.</dd>
       <dt>topic <span class="property-type">string</span></dt>
       <dd>the MQTT topic, uses / as a hierarchy separator.</dd>
       <dt>qos <span class="property-type">number</span> </dt>
       <dd>0, fire and forget - 1, at least once - 2, once and once only.</dd>
       <dt>retain <span class="property-type">boolean</span></dt>
       <dd>true indicates the message was retained and may be old.</dd>
    </dl>
    <h3>Details</h3>
    The subscription topic can include MQTT wildcards, + for one level, # for multiple levels.</p>
    <p>This node requires a connection to a MQTT broker to be configured. This is configured by clicking
    the pencil icon.</p>
    <p>Several MQTT nodes (in or out) can share the same broker connection if required.</p>
</script><script type="text/x-red" data-help-name="mqtt out">
    <p>Connects to a MQTT broker and publishes messages.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
       <dt>payload <span class="property-type">string | buffer</span></dt>
       <dd> most users prefer simple text payloads, but binary buffers can also be published.</dd>

       <dt class="optional">topic <span class="property-type">string</span></dt>
       <dd> the MQTT topic to publish to.</dd>

       <dt class="optional">qos <span class="property-type">number</span></dt>
       <dd>0, fire and forget - 1, at least once - 2, once and once only. Default 0.</dd>

       <dt class="optional">retain <span class="property-type">boolean</span></dt>
       <dd>set to true to retain the message on the broker. Default false.</dd>
    </dl>
    <h3>Details</h3>
    <code>msg.payload</code> is used as the payload of the published message.
    If it contains an Object it will be converted to a JSON string before being sent.
    If it contains a binary Buffer the message will be published as-is.</p>
    <p>The topic used can be configured in the node or, if left blank, can be set by <code>msg.topic</code>.</p>
    <p>Likewise the QoS and retain values can be configured in the node or, if left
    blank, set by <code>msg.qos</code> and <code>msg.retain</code> respectively. To clear a previously
    retained topic from the broker, send a blank message to that topic with the retain flag set.</p>
    <p>This node requires a connection to a MQTT broker to be configured. This is configured by clicking
    the pencil icon.</p>
    <p>Several MQTT nodes (in or out) can share the same broker connection if required.</p>
</script><script type="text/x-red" data-help-name="mqtt-broker">
    <p>Configuration for a connection to an MQTT broker.</p>
    <p>This configuration will create a single connection to the broker which can
       then be reused by <code>MQTT In</code> and <code>MQTT Out</code> nodes.</p>
    <p>The node will generate a random Client ID if one is not set and the
       node is configured to use a Clean Session connection. If a Client ID is set,
       it must be unique to the broker you are connecting to.</p>
    <h4>Birth Message</h4>
    <p>This is a message that will be published on the configured topic whenever the
       connection is established.</p>
    <h4>Close Message</h4>
    <p>This is a message that will be published on the configured topic before the
       connection is closed normally, either by re-deploying the node, or by shutting down.</p>
    <h4>Will Message</h4>
    <p>This is a message that will be published by the broker in the event the node
       unexpectedly loses its connection.</p>
    <h4>WebSockets</h4>
    <p>The node can be configured to use a WebSocket connection. To do so, the Server
       field should be configured with a full URI for the connection. For example:</p>
    <pre>ws://example.com:4000/mqtt</pre>

</script>
<!-- --- [red-module:node-red/httpin] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="http in">
    <div class="form-row">
        <label for="node-input-method"><i class="fa fa-tasks"></i> <span data-i18n="httpin.label.method"></span></label>
        <select type="text" id="node-input-method" style="width:70%;">
        <option value="get">GET</option>
        <option value="post">POST</option>
        <option value="put">PUT</option>
        <option value="delete">DELETE</option>
        <option value="patch">PATCH</option>
        </select>
    </div>
    <div class="form-row form-row-http-in-upload hide">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-upload" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-upload" style="width: 70%;" data-i18n="httpin.label.upload"></label>
    </div>
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="httpin.label.url"></span></label>
        <input id="node-input-url" type="text" placeholder="/url">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row row-swagger-doc">
        <label for="node-input-swaggerDoc"><i class="fa fa-file-text-o"></i> <span data-i18n="httpin.label.doc"></span></label>
        <input type="text" id="node-input-swaggerDoc">
    </div>
    <div id="node-input-tip" class="form-tips"><span data-i18n="httpin.tip.in"></span><code><span id="node-input-path"></span></code>.</div>
</script>



<script type="text/x-red" data-template-name="http response">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <label for="node-input-statusCode"><i class="fa fa-long-arrow-left"></i> <span data-i18n="httpin.label.status"></span></label>
        <input type="text" id="node-input-statusCode" placeholder="msg.statusCode">
    </div>
    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> <span data-i18n="httpin.label.headers"></span></label>
    </div>
    <div class="form-row node-input-headers-container-row">
        <ol id="node-input-headers-container"></ol>
    </div>
    <div class="form-tips"><span data-i18n="[html]httpin.tip.res"></span></div>
</script>



<script type="text/javascript">
(function() {
    RED.nodes.registerType('http in',{
        category: 'input',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            url: {value:"",required:true},
            method: {value:"get",required:true},
            upload: {value:false},
            swaggerDoc: {type:"swagger-doc", required:false}
        },
        inputs:0,
        outputs:1,
        icon: "white-globe.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.url) {
                var root = RED.settings.httpNodeRoot;
                if (root.slice(-1) != "/") {
                    root = root+"/";
                }
                if (this.url.charAt(0) == "/") {
                    root += this.url.slice(1);
                } else {
                    root += this.url;
                }
                return "["+this.method+"] "+root;
            } else {
                return "http";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) == "/") {
                root = root.slice(0,-1);
            }
            if (root == "") {
                $("#node-input-tip").hide();
            } else {
                $("#node-input-path").html(root);
                $("#node-input-tip").show();
            }
            if(!RED.nodes.getType("swagger-doc")){
                $('.row-swagger-doc').hide();
            }
            $("#node-input-method").change(function() {
                if ($(this).val() === "post") {
                    $(".form-row-http-in-upload").show();
                } else {
                    $(".form-row-http-in-upload").hide();
                }
            }).change();


        }

    });
    var headerTypes = [
        {value:"content-type",label:"Content-Type",hasValue: false},
        {value:"location",label:"Location",hasValue: false},
        {value:"other",label:RED._("node-red:httpin.label.other"),icon:"red/images/typedInput/az.png"}
       ]
    var contentTypes = [
        {value:"application/json",label:"application/json",hasValue: false},
        {value:"application/xml",label:"application/xml",hasValue: false},
        {value:"text/css",label:"text/css",hasValue: false},
        {value:"text/html",label:"text/html",hasValue: false},
        {value:"text/plain",label:"text/plain",hasValue: false},
        {value:"image/gif",label:"image/gif",hasValue: false},
        {value:"image/png",label:"image/png",hasValue: false},
        {value:"other",label:RED._("node-red:httpin.label.other"),icon:"red/images/typedInput/az.png"}
    ];

    RED.nodes.registerType('http response',{
        category: 'output',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            statusCode: {value:"",validate: RED.validators.number(true)},
            headers: {value:{}}
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "white-globe.png",
        label: function() {
            return this.name||("http"+(this.statusCode?" ("+this.statusCode+")":""));
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            function resizeRule(rule) {
                var newWidth = rule.width();
                rule.find('.red-ui-typedInput').typedInput("width",(newWidth-15)/2);
            }
            var headerList = $("#node-input-headers-container").css('min-height','150px').css('min-width','450px').editableList({
                addItem: function(container,i,header) {
                    var row = $('<div></div>').css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    }).appendTo(container);

                    var propertyName = $('<input/>',{class:"node-input-header-name",type:"text"})
                        .appendTo(row)
                        .typedInput({types:headerTypes});

                    var propertyValue = $('<input/>',{class:"node-input-header-value",type:"text",style:"margin-left: 10px"})
                        .appendTo(row)
                        .typedInput({types:
                            header.h === 'content-type'?contentTypes:[{value:"other",label:"other",icon:"red/images/typedInput/az.png"}]
                        });

                    var matchedType = headerTypes.filter(function(ht) {
                        return ht.value === header.h
                    });
                    if (matchedType.length === 0) {
                        propertyName.typedInput('type','other');
                        propertyName.typedInput('value',header.h);
                        propertyValue.typedInput('value',header.v);
                    } else {
                        propertyName.typedInput('type',header.h);

                        if (header.h === "content-type") {
                            matchedType = contentTypes.filter(function(ct) {
                                return ct.value === header.v;
                            });
                            if (matchedType.length === 0) {
                                propertyValue.typedInput('type','other');
                                propertyValue.typedInput('value',header.v);
                            } else {
                                propertyValue.typedInput('type',header.v);
                            }
                        } else {
                            propertyValue.typedInput('value',header.v);
                        }
                    }

                    matchedType = headerTypes.filter(function(ht) {
                        return ht.value === header.h
                    });
                    if (matchedType.length === 0) {
                        propertyName.typedInput('type','other');
                        propertyName.typedInput('value',header.h);
                    } else {
                        propertyName.typedInput('type',header.h);
                    }

                    propertyName.on('change',function(event) {
                        var type = propertyName.typedInput('type');
                        if (type === 'content-type') {
                            propertyValue.typedInput('types',contentTypes);
                        } else {
                            propertyValue.typedInput('types',[{value:"other",label:"other",icon:"red/images/typedInput/az.png"}]);
                        }
                    });



                    resizeRule(container);
                },
                resizeItem: resizeRule,
                removable: true
            });

            if (this.headers) {
                for (var key in this.headers) {
                    if (this.headers.hasOwnProperty(key)) {
                        headerList.editableList('addItem',{h:key,v:this.headers[key]});
                    }
                }
            }
        },
        oneditsave: function() {
            var headers = $("#node-input-headers-container").editableList('items');
            var node = this;
            node.headers = {};
            headers.each(function(i) {
                var header = $(this);
                var keyType = header.find(".node-input-header-name").typedInput('type');
                var keyValue = header.find(".node-input-header-name").typedInput('value');
                var valueType = header.find(".node-input-header-value").typedInput('type');
                var valueValue = header.find(".node-input-header-value").typedInput('value');
                var key = keyType;
                var value = valueType;
                if (keyType === 'other') {
                    key = keyValue;
                }
                if (valueType === 'other') {
                    value = valueValue;
                }
                if (key !== '') {
                    node.headers[key] = value;
                }
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-headers-container-row)");
            var height = size.height;
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-headers-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));

            $("#node-input-headers-container").editableList('height',height);
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="http in">
    <p>Creates an HTTP end-point for creating web services.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload</dt>
        <dd>For a GET request, contains an object of any query string parameters.
            Otherwise, contains the body of the HTTP request.</dd>
        <dt>req<span class="property-type">object</span></dt>
        <dd>An HTTP request object. This object contains multiple properties that
            provide information about the request.
            <ul>
             <li><code>body</code> - the body of the incoming request. The format
                 will depend on the request.</li>
             <li><code>headers</code> - an object containing the HTTP request headers.</li>
             <li><code>query</code> - an object containing any query string parameters.</li>
             <li><code>params</code> - an object containing any route parameters.</li>
             <li><code>cookies</code> - an object containing the cookies for the request.</li>
             <li><code>files</code> - if enabled within the node, an object containing
                 any files uploaded as part of a POST request.</li>
            </ul>
        </dd>
        <dt>res<span class="property-type">object</span></dt>
        <dd>An HTTP response object. This property should not be used directly;
            the <code>HTTP Response</code> node documents how to respond to a request.
            This property must remain attached to the message passed to the response node.</dd>
    </dl>
    <h3>Details</h3>
    <p>The node will listen on the configured path for requests of a particular type.
       The path can be fully specified, such as <code>/user</code>, or include
       named parameters that accept any value, such as <code>/user/:name</code>.
       When named parameters are used, their actual value in a request can be accessed under <code>msg.req.params</code>.</p>
    <p>For requests that include a body, such as a POST or PUT, the contents of
       the request is made available as <code>msg.payload</code>.</p>
    <p>If the content type of the request can be determined, the body will be parsed to
       any appropriate type. For example, <code>application/json</code> will be parsed to
       its JavaScript object representation.</p>
    <p><b>Note:</b> this node does not send any response to the request. The flow
       must include an HTTP Response node to complete the request.</p>
</script><script type="text/x-red" data-help-name="http response">
    <p>Sends responses back to requests received from an HTTP Input node.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>The body of the response.</dd>
        <dt class="optional">statusCode <span class="property-type">number</span></dt>
        <dd>If set, this is used as the response status code. Default: 200.</dd>
        <dt class="optional">headers <span class="property-type">object</span></dt>
        <dd>If set, provides HTTP headers to include in the response.</dd>
        <dt class="optional">cookies <span class="property-type">object</span></dt>
        <dd>If set, can be used to set or delete cookies.</dd>
    </dl>
    <h3>Details</h3>
    <p>The <code>statusCode</code> and <code>headers</code> can also be set within
    the node itself. If a property is set within the node, it cannot be overridden
    by the corresponding message property.</p>
    <h4>Cookie handling</h4>
    <p>The <code>cookies</code> property must be an object of name/value pairs.
    The value can be either a string to set the value of the cookie with default
    options, or it can be an object of options.<p>
    <p>The following example sets two cookies - one called <code>name</code> with
    a value of <code>nick</code>, the other called <code>session</code> with a
    value of <code>1234</code> and an expiry set to 15 minutes.</p>
    <pre>
msg.cookies = {
    name: 'nick',
    session: {
        value: '1234',
        maxAge: 900000
    }
}</pre>
    <p>The valid options include:</p>
    <ul>
    <li><code>domain</code> - (String) domain name for the cookie</li>
    <li><code>expires</code> - (Date) expiry date in GMT. If not specified or set to 0, creates a session cookie</li>
    <li><code>maxAge</code> - (String) expiry date as relative to the current time in milliseconds</li>
    <li><code>path</code> - (String) path for the cookie. Defaults to /</li>
    <li><code>value</code> - (String) the value to use for the cookie</li>
    </ul>
    <p>To delete a cookie, set its <code>value</code> to <code>null</code>.</p>

</script>
<!-- --- [red-module:node-red/httprequest] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="http request">
    <div class="form-row">
        <label for="node-input-method"><i class="fa fa-tasks"></i> <span data-i18n="httpin.label.method"></span></label>
        <select type="text" id="node-input-method" style="width:70%;">
        <option value="GET">GET</option>
        <option value="POST">POST</option>
        <option value="PUT">PUT</option>
        <option value="DELETE">DELETE</option>
        <option value="use" data-i18n="httpin.setby"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="httpin.label.url"></span></label>
        <input id="node-input-url" type="text" placeholder="http://">
    </div>

    <div class="form-row">
        <input type="checkbox" id="node-input-usetls" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-usetls" style="width: auto" data-i18n="httpin.use-tls"></label>
        <div id="node-row-tls" class="hide">
            <label style="width: auto; margin-left: 20px; margin-right: 10px;" for="node-input-tls"><span data-i18n="httpin.tls-config"></span></label><input type="text" style="width: 300px" id="node-input-tls">
        </div>
    </div>

    <div class="form-row">
        <input type="checkbox" id="node-input-useAuth" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-useAuth" style="width: 70%;"><span data-i18n="httpin.basicauth"></span></label>
        <div style="margin-left: 20px" class="node-input-useAuth-row hide">
            <div class="form-row">
                <label for="node-input-user"><i class="fa fa-user"></i> <span data-i18n="common.label.username"></span></label>
                <input type="text" id="node-input-user">
            </div>
            <div class="form-row">
                <label for="node-input-password"><i class="fa fa-lock"></i> <span data-i18n="common.label.password"></span></label>
                <input type="password" id="node-input-password">
            </div>
        </div>
    </div>


    <div class="form-row">
        <label for="node-input-ret"><i class="fa fa-arrow-left"></i> <span data-i18n="httpin.label.return"></span></label>
        <select type="text" id="node-input-ret" style="width:70%;">
        <option value="txt" data-i18n="httpin.utf8"></option>
        <option value="bin" data-i18n="httpin.binary"></option>
        <option value="obj" data-i18n="httpin.json"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="tip-json" hidden><span data-i18n="httpin.tip.req"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('http request',{
        category: 'function',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            method:{value:"GET"},
            ret: {value:"txt"},
            url:{value:"",validate:function(v) { return (v.trim().length === 0) || (v.indexOf("://") === -1) || (v.trim().indexOf("http") === 0)} },
            tls: {type:"tls-config",required: false}
        },
        credentials: {
            user: {type:"text"},
            password: {type: "password"}
        },
        inputs:1,
        outputs:1,
        outputLabels: function(i) {
            return ({txt:"UTF8 string", bin:"binary buffer", obj:"parsed JSON object"}[this.ret]);
        },
        icon: "white-globe.png",
        label: function() {
            return this.name||this._("httpin.httpreq");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-useAuth").change(function() {
                if ($(this).is(":checked")) {
                    $(".node-input-useAuth-row").show();
                } else {
                    $(".node-input-useAuth-row").hide();
                    $('#node-input-user').val('');
                    $('#node-input-password').val('');
                }
            });
            if (this.credentials.user || this.credentials.has_password) {
                $('#node-input-useAuth').prop('checked', true);
            } else {
                $('#node-input-useAuth').prop('checked', false);
            }
            $("#node-input-useAuth").change();

            function updateTLSOptions() {
                if ($("#node-input-usetls").is(':checked')) {
                    $("#node-row-tls").show();
                } else {
                    $("#node-row-tls").hide();
                }
            }
            if (this.tls) {
                $('#node-input-usetls').prop('checked', true);
            } else {
                $('#node-input-usetls').prop('checked', false);
            }
            updateTLSOptions();
            $("#node-input-usetls").on("click",function() {
                updateTLSOptions();
            });
            $("#node-input-ret").change(function() {
                if ($("#node-input-ret").val() === "obj") {
                    $("#tip-json").show();
                } else {
                    $("#tip-json").hide();
                }
            });
        },
        oneditsave: function() {
            if (!$("#node-input-usetls").is(':checked')) {
                $("#node-input-tls").val("_ADD_");
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="http request">
    <p>Sends HTTP requests and returns the response.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">url <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the url of the request.</dd>
        <dt class="optional">method <span class="property-type">string</span></dt>
        <dd>If not configured in the node, this optional property sets the HTTP method of the request.
            Must be one of <code>GET</code>, <code>PUT</code>, <code>POST</code>, <code>PATCH</code> or <code>DELETE</code>.</dd>
        <dt class="optional">headers <span class="property-type">object</span></dt>
        <dd>Sets the HTTP headers of the request.</dd>
        <dt class="optional">cookies <span class="property-type">object</span></dt>
        <dd>If set, can be used to send cookies with the request.</dd>
        <dt class="optional">payload</dt>
        <dd>Sent as the body of the request.</dd>
        <dt class="optional">rejectUnauthorized</dt>
        <dd>If set to <code>false</code>, allows requests to be made to https sites that use
            self signed certificates.</dd>
        <dt class="optional">followRedirects</dt>
        <dd>If set to <code>false</code> prevent following Redirect (HTTP 301).<code>true</code> by default</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string | object | buffer</span></dt>
        <dd>The body of the response. The node can be configured to return the body
             as a string, attempt to parse it as a JSON string or leave it as a
             binary buffer.</dd>
        <dt>statusCode <span class="property-type">number</span></dt>
        <dd>The status code of the response, or the error code if the request could not be completed.</dd>
        <dt>headers <span class="property-type">object</span></dt>
        <dd>An object containing the response headers.</dd>
        <dt>responseUrl <span class="property-type">string</span></dt>
        <dd>In case any redirects occurred while processing the request, this property is the final redirected url.
            Otherwise, the url of the original request.</dd>
        <dt>responseCookies <span class="property-type">object</span></dt>
        <dd>If the response includes cookies, this propery is an object of name/value pairs for each cookie.</dd>
    </dl>
    <h3>Details</h3>
    <p>When configured within the node, the URL property can contain <a href="http://mustache.github.io/mustache.5.html" target="_blank">mustache-style</a> tags. These allow the
    url to be constructed using values of the incoming message. For example, if the url is set to
    <code>example.com/{{{topic}}}</code>, it will have the value of <code>msg.topic</code> automatically inserted.
    Using {{{...}}} prevents mustache from escaping characters like / & etc.</p>
    <p><b>Note</b>: If running behind a proxy, the standard <code>http_proxy=...</code> environment variable should be set and Node-RED restarted.</p>
    <h4>Using multiple HTTP Request nodes</h4>
    <p>In order to use more than one of these nodes in the same flow, care must be taken with
    the <code>msg.headers</code> property. The first node will set this property with
    the response headers. The next node will then use those headers for its request - this
    is not usually the right thing to do. If <code>msg.headers</code> property is left unchanged
    between nodes, it will be ignored by the second node. To set custom headers, <code>msg.headers</code>
    should first be deleted or reset to an empty object: <code>{}</code>.
    <h4>Cookie handling</h4>
    <p>The <code>cookies</code> property passed to the node must be an object of name/value pairs.
    The value can be either a string to set the value of the cookie or it can be an
    object with a single <code>value</code> property.<p>
    <p>Any cookies returned by the request are passed back under the <code>responseCookies</code> property.</p>
    <h4>Content type handling</h4>
    <p>If <code>msg.payload</code> is an Object, the node will automatically set the content type
    of the request to <code>application/json</code> and encode the body as such.</p>
    <p>To encode the request as form data, <code>msg.headers["content-type"]</code> should be set to <code>application/x-www-form-urlencoded</code>.</p>

</script>
<!-- --- [red-module:node-red/websocket] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!-- WebSocket Input Node -->
<script type="text/x-red" data-template-name="websocket in">
    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-dot-circle-o"></i> <span data-i18n="websocket.label.type"></span></label>
        <select id="node-input-mode">
            <option value="server" data-i18n="websocket.listenon"></option>
            <option value="client" data-i18n="websocket.connectto"></option>
        </select>
    </div>
    <div class="form-row" id="websocket-server-row">
        <label for="node-input-server"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row" id="websocket-client-row">
        <label for="node-input-client"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input type="text" id="node-input-client">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">

(function() {

    function ws_oneditprepare() {
        $("#websocket-client-row").hide();
        $("#node-input-mode").change(function() {
            if ( $("#node-input-mode").val() === 'client') {
                $("#websocket-server-row").hide();
                $("#websocket-client-row").show();
            }
            else {
                $("#websocket-server-row").show();
                $("#websocket-client-row").hide();
            }
        });

        if (this.client) {
            $("#node-input-mode").val('client').change();
        }
        else {
            $("#node-input-mode").val('server').change();
        }
    }

    function ws_oneditsave() {
        if ($("#node-input-mode").val() === 'client') {
            $("#node-input-server").append('<option value="">Dummy</option>');
            $("#node-input-server").val('');
        }
        else {
            $("#node-input-client").append('<option value="">Dummy</option>');
            $("#node-input-client").val('');
        }
    }

    function ws_label() {
        var nodeid = (this.client)?this.client:this.server;
        var wsNode = RED.nodes.node(nodeid);
        return this.name||(wsNode?"[ws] "+wsNode.label():"websocket");
    }

    function ws_validateserver() {
        if ($("#node-input-mode").val() === 'client' || (this.client && !this.server)) {
            return true;
        }
        else {
            return RED.nodes.node(this.server) != null;
        }
    }

    function ws_validateclient() {
        if ($("#node-input-mode").val() === 'client' || (this.client && !this.server)) {
            return RED.nodes.node(this.client) != null;
        }
        else {
            return true;
        }
    }

    RED.nodes.registerType('websocket in',{
        category: 'input',
        defaults: {
            name: {value:""},
            server: {type:"websocket-listener", validate: ws_validateserver},
            client: {type:"websocket-client", validate: ws_validateclient}
        },
        color:"rgb(215, 215, 160)",
        inputs:0,
        outputs:1,
        icon: "white-globe.png",
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        label: ws_label,
        oneditsave: ws_oneditsave,
        oneditprepare: ws_oneditprepare
    });

    RED.nodes.registerType('websocket out',{
        category: 'output',
        defaults: {
            name: {value:""},
            server: {type:"websocket-listener", validate: ws_validateserver},
            client: {type:"websocket-client", validate: ws_validateclient}
        },
        color:"rgb(215, 215, 160)",
        inputs:1,
        outputs:0,
        icon: "white-globe.png",
        align: "right",
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        label: ws_label,
        oneditsave: ws_oneditsave,
        oneditprepare: ws_oneditprepare
    });

    RED.nodes.registerType('websocket-listener',{
        category: 'config',
        defaults: {
            path: {value:"",required:true,validate:RED.validators.regex(/^((?!\/debug\/ws).)*$/)},
            wholemsg: {value:"false"}
        },
        inputs:0,
        outputs:0,
        label: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) != "/") {
                root = root+"/";
            }
            if (this.path.charAt(0) == "/") {
                root += this.path.slice(1);
            } else {
                root += this.path;
            }
            return root;
        },
        oneditprepare: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) == "/") {
                root = root.slice(0,-1);
            }
            if (root === "") {
                $("#node-config-ws-tip").hide();
            } else {
                $("#node-config-ws-path").html(root);
                $("#node-config-ws-tip").show();
            }
        }
    });

    RED.nodes.registerType('websocket-client',{
        category: 'config',
        defaults: {
            path: {value:"",required:true,validate:RED.validators.regex(/^((?!\/debug\/ws).)*$/)},
            tls: {type:"tls-config",required: false},
            wholemsg: {value:"false"}
        },
        inputs:0,
        outputs:0,
        label: function() {
            return this.path;
        },
        oneditprepare: function() {
            $("#node-config-input-path").on("change keyup paste",function() {
                $(".node-config-row-tls").toggle(/^wss:/i.test($(this).val()))
            });
            $("#node-config-input-path").change();
        },
        oneditsave: function() {
            if (!/^wss:/i.test($("#node-config-input-path").val())) {
                $("#node-config-input-tls").val("_ADD_");
            }
        }
    });

})();
</script>

<!-- WebSocket out Node -->
<script type="text/x-red" data-template-name="websocket out">
    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-dot-circle-o"></i> <span data-i18n="websocket.label.type"></span></label>
        <select id="node-input-mode">
            <option value="server" data-i18n="websocket.listenon"></option>
            <option value="client" data-i18n="websocket.connectto"></option>
        </select>
    </div>
    <div class="form-row" id="websocket-server-row">
        <label for="node-input-server"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row" id="websocket-client-row">
        <label for="node-input-client"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input type="text" id="node-input-client">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<!-- WebSocket Server configuration node -->
<script type="text/x-red" data-template-name="websocket-listener">
    <div class="form-row">
        <label for="node-config-input-path"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.path"></span></label>
        <input id="node-config-input-path" type="text" placeholder="/ws/example">
    </div>
    <div class="form-row">
        <label for="node-config-input-wholemsg"></label>
        <select type="text" id="node-config-input-wholemsg" style="width: 70%;">
            <option value="false" data-i18n="websocket.payload"></option>
            <option value="true" data-i18n="websocket.message"></option>
        </select>
    </div>
    <div class="form-tips">
        <span data-i18n="[html]websocket.tip.path1"></span>
        <p id="node-config-ws-tip"><span data-i18n="[html]websocket.tip.path2"></span><code><span id="node-config-ws-path"></span></code>.</p>
    </div>
</script>



<!-- WebSocket Client configuration node -->
<script type="text/x-red" data-template-name="websocket-client">
    <div class="form-row">
        <label for="node-config-input-path"><i class="fa fa-bookmark"></i> <span data-i18n="websocket.label.url"></span></label>
        <input id="node-config-input-path" type="text" placeholder="ws://example.com/ws">
    </div>
    <div class="form-row node-config-row-tls hide">
        <label for="node-config-input-tls" data-i18n="httpin.tls-config"></label>
        <input type="text" id="node-config-input-tls">
    </div>

    <div class="form-row">
        <label for="node-config-input-wholemsg" data-i18n="websocket.sendrec"></label>
        <select type="text" id="node-config-input-wholemsg" style="width: 70%;">
            <option value="false" data-i18n="websocket.payload"></option>
            <option value="true" data-i18n="websocket.message"></option>
        </select>
    </div>
    <div class="form-tips">
        <p><span data-i18n="[html]websocket.tip.url1"></span></p>
        <span data-i18n="[html]websocket.tip.url2"></span>
    </div>
</script>


<script type="text/x-red" data-help-name="websocket in">
    <p>WebSocket input node.</p>
    <p>By default, the data received from the WebSocket will be in <code>msg.payload</code>.
    The socket can be configured to expect a properly formed JSON string, in which
    case it will parse the JSON and send on the resulting object as the entire message.</p>
</script><script type="text/x-red" data-help-name="websocket out">
    <p>WebSocket out node.</p>
    <p>By default, <code>msg.payload</code> will be sent over the WebSocket. The socket
    can be configured to encode the entire <code>msg</code> object as a JSON string and send that
    over the WebSocket.</p>

    <p>If the message arriving at this node started at a WebSocket In node, the message
    will be sent back to the client that triggered the flow. Otherwise, the message
    will be broadcast to all connected clients.</p>
    <p>If you want to broadcast a message that started at a WebSocket In node, you
    should delete the <code>msg._session</code> property within the flow.</p>
</script><script type="text/x-red" data-help-name="websocket-listener">
   <p>This configuration node creates a WebSocket Server endpoint using the specified path.</p>
</script><script type="text/x-red" data-help-name="websocket-client">
   <p>This configuration node connects a WebSocket client to the specified URL.</p>
</script>
<!-- --- [red-module:node-red/switch] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="switch">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row">
        <label data-i18n="switch.label.property"></label>
        <input type="text" id="node-input-property" style="width: 70%"/>
        <input type="hidden" id="node-input-outputs"/>
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
    </div>
    <div class="form-row">
        <select id="node-input-checkall" style="width:100%; margin-right:5px;">
            <option value="true" data-i18n="switch.checkall"></option>
            <option value="false" data-i18n="switch.stopfirst"></option>
        </select>
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-input-repair" style="display: inline-block; width: auto; vertical-align: top;">
        <label style="width: auto;" for="node-input-repair"><span data-i18n="switch.label.repair"></span></label></input>
    </div>
</script>



<script type="text/javascript">
(function() {
    var operators = [
        {v:"eq",t:"==",kind:'V'},
        {v:"neq",t:"!=",kind:'V'},
        {v:"lt",t:"<",kind:'V'},
        {v:"lte",t:"<=",kind:'V'},
        {v:"gt",t:">",kind:'V'},
        {v:"gte",t:">=",kind:'V'},
        {v:"btwn",t:"switch.rules.btwn",kind:'V'},
        {v:"cont",t:"switch.rules.cont",kind:'V'},
        {v:"regex",t:"switch.rules.regex",kind:'V'},
        {v:"true",t:"switch.rules.true",kind:'V'},
        {v:"false",t:"switch.rules.false",kind:'V'},
        {v:"null",t:"switch.rules.null",kind:'V'},
        {v:"nnull",t:"switch.rules.nnull",kind:'V'},
        {v:"istype",t:"switch.rules.istype",kind:'V'},
        {v:"head",t:"switch.rules.head",kind:'S'},
        {v:"index",t:"switch.rules.index",kind:'S'},
        {v:"tail",t:"switch.rules.tail",kind:'S'},
        {v:"jsonata_exp",t:"switch.rules.exp",kind:'O'},
        {v:"else",t:"switch.rules.else",kind:'O'}
    ];

    function clipValueLength(v) {
        if (v.length > 15) {
            return v.substring(0,15)+"...";
        }
        return v;
    }
    function getValueLabel(t,v) {
        if (t === 'str') {
            return '"'+clipValueLength(v)+'"';
        } else if (t === 'msg' || t==='flow' || t==='global') {
            return t+"."+clipValueLength(v);
        }
        return clipValueLength(v);
    }
    RED.nodes.registerType('switch', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            property: {value:"payload", required:true, validate: RED.validators.typedInput("propertyType")},
            propertyType: { value:"msg" },
            rules: {value:[{t:"eq", v:"", vt:"str"}]},
            checkall: {value:"true", required:true},
            repair: {value:false},
            outputs: {value:1}
        },
        inputs: 1,
        outputs: 1,
        outputLabels: function(index) {
            var rule = this.rules[index];
            var label = "";
            if (rule) {
                for (var i=0;i<operators.length;i++) {
                    if (operators[i].v === rule.t) {
                        label = /^switch/.test(operators[i].t)?this._(operators[i].t):operators[i].t;
                        break;
                    }
                }
                if ((rule.t === 'btwn') || (rule.t === 'index')) {
                    label += " "+getValueLabel(rule.vt,rule.v)+" & "+getValueLabel(rule.v2t,rule.v2);
                } else if (rule.t !== 'true' && rule.t !== 'false' && rule.t !== 'null' && rule.t !== 'nnull' && rule.t !== 'else' ) {
                    label += " "+getValueLabel(rule.vt,rule.v);
                }
                return label;
            }
        },
        icon: "switch.png",
        label: function() {
            return this.name||this._("switch.switch");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;
            var previousValueType = {value:"prev",label:this._("inject.previous"),hasValue:false};

            $("#node-input-property").typedInput({default:this.propertyType||'msg',types:['msg','flow','global','jsonata']});
            var outputCount = $("#node-input-outputs").val("{}");

            var andLabel = this._("switch.and");
            var caseLabel = this._("switch.ignorecase");

            function resizeRule(rule) {
                var newWidth = rule.width();
                var selectField = rule.find("select");
                var type = selectField.val()||"";
                var valueField = rule.find(".node-input-rule-value");
                var typeField = rule.find(".node-input-rule-type-value");
                var numField = rule.find(".node-input-rule-num-value");
                var expField = rule.find(".node-input-rule-exp-value");
                var btwnField1 = rule.find(".node-input-rule-btwn-value");
                var btwnField2 = rule.find(".node-input-rule-btwn-value2");
                var selectWidth;
                if (type.length < 4) {
                    selectWidth = 60;
                } else if (type === "regex") {
                    selectWidth = 147;
                } else {
                    selectWidth = 120;
                }
                selectField.width(selectWidth);
                if ((type === "btwn") || (type === "index")) {
                    btwnField1.typedInput("width",(newWidth-selectWidth-70));
                    btwnField2.typedInput("width",(newWidth-selectWidth-70));
                } else if ((type === "head") || (type === "tail")) {
                    numField.typedInput("width",(newWidth-selectWidth-70));
                } else if (type === "jsonata_exp") {
                    expField.typedInput("width",(newWidth-selectWidth-70));
                } else if (type === "istype") {
                    typeField.typedInput("width",(newWidth-selectWidth-70));
                } else {
                    if (type === "true" || type === "false" || type === "null" || type === "nnull" || type === "else") {
                        // valueField.hide();
                    } else {
                        valueField.typedInput("width",(newWidth-selectWidth-70));
                    }
                }
            }

            $("#node-input-rule-container").css('min-height','250px').css('min-width','450px').editableList({
                addItem: function(container,i,opt) {
                    if (!opt.hasOwnProperty('r')) {
                        opt.r = {};
                    }
                    var rule = opt.r;
                    if (!rule.hasOwnProperty('t')) {
                        rule.t = 'eq';
                    }
                    if (!opt.hasOwnProperty('i')) {
                        opt._i = Math.floor((0x99999-0x10000)*Math.random()).toString();
                    }
                    container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row = $('<div></operators>').appendTo(container);
                    var row2 = $('<div></div>',{style:"padding-top: 5px; padding-left: 175px;"}).appendTo(container);
                    var row3 = $('<div></div>',{style:"padding-top: 5px; padding-left: 102px;"}).appendTo(container);
                    var selectField = $('<select></select>',{style:"width:120px; margin-left: 5px; text-align: center;"}).appendTo(row);
                    var group0 = $('<optgroup></optgroup>', { label: "value rules" }).appendTo(selectField);
                    for (var d in operators) {
                        if(operators[d].kind === 'V') {
                            group0.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    var group1 = $('<optgroup></optgroup>', { label: "sequence rules" }).appendTo(selectField);
                    for (var d in operators) {
                        if(operators[d].kind === 'S') {
                            group1.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    for (var d in operators) {
                        if(operators[d].kind === 'O') {
                            selectField.append($("<option></option>").val(operators[d].v).text(/^switch/.test(operators[d].t)?node._(operators[d].t):operators[d].t));
                        }
                    }
                    var valueField = $('<input/>',{class:"node-input-rule-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'str',types:['msg','flow','global','str','num','jsonata',previousValueType]});
                    var numValueField = $('<input/>',{class:"node-input-rule-num-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'num',types:['flow','global','num','jsonata']});
                    var expValueField = $('<input/>',{class:"node-input-rule-exp-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'jsonata',types:['jsonata']});
                    var btwnValueField = $('<input/>',{class:"node-input-rule-btwn-value",type:"text",style:"margin-left: 5px;"}).appendTo(row).typedInput({default:'num',types:['msg','flow','global','str','num','jsonata',previousValueType]});
                    var btwnAndLabel = $('<span></span>',{class:"node-input-rule-btwn-label"}).text(" "+andLabel+" ").appendTo(row3);
                    var btwnValue2Field = $('<input/>',{class:"node-input-rule-btwn-value2",type:"text",style:"margin-left:2px;"}).appendTo(row3).typedInput({default:'num',types:['msg','flow','global','str','num','jsonata',previousValueType]});
                    var typeValueField = $('<input/>',{class:"node-input-rule-type-value",type:"text",style:"margin-left: 5px;"}).appendTo(row)
                        .typedInput({default:'string',types:[
                            {value:"string",label:"string",hasValue:false},
                            {value:"number",label:"number",hasValue:false},
                            {value:"boolean",label:"boolean",hasValue:false},
                            {value:"array",label:"array",hasValue:false},
                            {value:"buffer",label:"buffer",hasValue:false},
                            {value:"object",label:"object",hasValue:false},
                            {value:"json",label:"JSON string",hasValue:false},
                            {value:"undefined",label:"undefined",hasValue:false},
                            {value:"null",label:"null",hasValue:false}
                        ]});
                    var finalspan = $('<span></span>',{style:"float: right;margin-top: 6px;"}).appendTo(row);
                    finalspan.append(' &#8594; <span class="node-input-rule-index">'+(i+1)+'</span> ');
                    var caseSensitive = $('<input/>',{id:"node-input-rule-case-"+i,class:"node-input-rule-case",type:"checkbox",style:"width:auto;vertical-align:top"}).appendTo(row2);
                    $('<label></label>',{for:"node-input-rule-case-"+i,style:"margin-left: 3px;"}).text(caseLabel).appendTo(row2);
                    selectField.change(function() {
                        resizeRule(container);
                        var type = selectField.val();
                        if ((type === "btwn") || (type === "index")) {
                            valueField.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            btwnValueField.typedInput('show');
                        } else if ((type === "head") || (type === "tail")) {
                            btwnValueField.typedInput('hide');
                            btwnValue2Field.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('show');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                        } else if (type === "jsonata_exp") {
                            btwnValueField.typedInput('hide');
                            btwnValue2Field.typedInput('hide');
                            expValueField.typedInput('show');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                        } else {
                            btwnValueField.typedInput('hide');
                            expValueField.typedInput('hide');
                            numValueField.typedInput('hide');
                            typeValueField.typedInput('hide');
                            valueField.typedInput('hide');
                            if (type === "true" || type === "false" || type === "null" || type === "nnull" || type === "else") {
                                valueField.typedInput('hide');
                                typeValueField.typedInput('hide');
                            }
                            else
                            if (type === "istype") {
                                valueField.typedInput('hide');
                                typeValueField.typedInput('show');
                            }
                            else {
                                typeValueField.typedInput('hide');
                                valueField.typedInput('show');
                            }
                        }
                        if (type === "regex") {
                            row2.show();
                            row3.hide();
                        } else if ((type === "btwn") || (type === "index")) {
                            row2.hide();
                            row3.show();
                            btwnValue2Field.typedInput('show');
                        } else {
                            row2.hide();
                            row3.hide();
                        }
                    });
                    selectField.val(rule.t);
                    if ((rule.t == "btwn") || (rule.t == "index")) {
                        btwnValueField.typedInput('value',rule.v);
                        btwnValueField.typedInput('type',rule.vt||'num');
                        btwnValue2Field.typedInput('value',rule.v2);
                        btwnValue2Field.typedInput('type',rule.v2t||'num');
                    } else if ((rule.t === "head") || (rule.t === "tail")) {
                        numValueField.typedInput('value',rule.v);
                        numValueField.typedInput('type',rule.vt||'num');
                    } else if (rule.t === "istype") {
                        typeValueField.typedInput('value',rule.vt);
                        typeValueField.typedInput('type',rule.vt);
                    } else if (rule.t === "jsonata_exp") {
                        expValueField.typedInput('value',rule.v);
                        expValueField.typedInput('type',rule.vt||'jsonata');
                    } else if (typeof rule.v != "undefined") {
                        valueField.typedInput('value',rule.v);
                        valueField.typedInput('type',rule.vt||'str');
                    }
                    if (rule.case) {
                        caseSensitive.prop('checked',true);
                    } else {
                        caseSensitive.prop('checked',false);
                    }
                    selectField.change();

                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    currentOutputs[opt.hasOwnProperty('i')?opt.i:opt._i] = i;
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                removeItem: function(opt) {
                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    if (opt.hasOwnProperty('i')) {
                        currentOutputs[opt.i] = -1;
                    } else {
                        delete currentOutputs[opt._i];
                    }
                    var rules = $("#node-input-rule-container").editableList('items');
                    rules.each(function(i) {
                        $(this).find(".node-input-rule-index").html(i+1);
                        var data = $(this).data('data');
                        currentOutputs[data.hasOwnProperty('i')?data.i:data._i] = i;
                    });
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                resizeItem: resizeRule,
                sortItems: function(rules) {
                    var currentOutputs = JSON.parse(outputCount.val()||"{}");
                    var rules = $("#node-input-rule-container").editableList('items');
                    rules.each(function(i) {
                        $(this).find(".node-input-rule-index").html(i+1);
                        var data = $(this).data('data');
                        currentOutputs[data.hasOwnProperty('i')?data.i:data._i] = i;
                    });
                    outputCount.val(JSON.stringify(currentOutputs));
                },
                sortable: true,
                removable: true
            });

            for (var i=0;i<this.rules.length;i++) {
                var rule = this.rules[i];
                $("#node-input-rule-container").editableList('addItem',{r:rule,i:i});
            }
        },
        oneditsave: function() {
            var rules = $("#node-input-rule-container").editableList('items');
            var ruleset;
            var node = this;
            node.rules = [];
            rules.each(function(i) {
                var ruleData = $(this).data('data');
                var rule = $(this);
                var type = rule.find("select").val();
                var r = {t:type};
                if (!(type === "true" || type === "false" || type === "null" || type === "nnull" || type === "else")) {
                    if ((type === "btwn") || (type === "index")) {
                        r.v = rule.find(".node-input-rule-btwn-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-btwn-value").typedInput('type');
                        r.v2 = rule.find(".node-input-rule-btwn-value2").typedInput('value');
                        r.v2t = rule.find(".node-input-rule-btwn-value2").typedInput('type');
                    } else if ((type === "head") || (type === "tail")) {
                        r.v = rule.find(".node-input-rule-num-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-num-value").typedInput('type');
                    } else if (type === "istype") {
                        r.v = rule.find(".node-input-rule-type-value").typedInput('type');
                        r.vt = rule.find(".node-input-rule-type-value").typedInput('type');
                    } else if (type === "jsonata_exp") {
                        r.v = rule.find(".node-input-rule-exp-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-exp-value").typedInput('type');
                    } else {
                        r.v = rule.find(".node-input-rule-value").typedInput('value');
                        r.vt = rule.find(".node-input-rule-value").typedInput('type');
                    }
                    if (type === "regex") {
                        r.case = rule.find(".node-input-rule-case").prop("checked");
                    }
                }
                node.rules.push(r);
            });
            this.propertyType = $("#node-input-property").typedInput('type');
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-rule-container-row)");
            var height = size.height;
            for (var i=0;i<rows.size();i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-rule-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $("#node-input-rule-container").editableList('height',height);
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="switch">
    <p>Route messages based on their property values or sequence position.</p>
    <h3>Details</h3>
    <p>When a message arrives, the node will evaluate each of the defined rules
    and forward the message to the corresponding outputs of any matching rules.</p>
    <p>Optionally, the node can be set to stop evaluating rules once it finds one
    that matches.</p>
    <p>The rules can be evaluated against an individual message property, a flow or global
    context property or the result of a JSONata expression.</p>
    <h4>Rules</h4>
    <p>There are four types of rule:</p>
    <ol>
        <li><b>Value</b> rules are evaluated against the configured property</li>
        <li><b>Sequence</b> rules can be used on message sequences, such as those
            generated by the Split node</li>
        <li>A JSONata <b>Expression</b> can be provided that will be evaluated
            against the whole message and will match if the expression returns
            a true value.</li>
        <li>An <b>Otherwise</b> rule can be used to match if none of the preceeding
            rules have matched.</li>
    </ol>
    <h4>Handling message sequences</h4>
    <p>By default, the node does not modify the <code>msg.parts</code> property of messages
       that are part of a sequence.</p>
    <p>The <b>recreate message sequences</b> option can be enabled to generate new message sequences
       for each rule that matches. In this mode, the node will buffer the entire incoming
       sequence before sending the new sequences on. The runtime setting <code>nodeMessageBufferMaxLength</code>
       can be used to limit how many messages nodes will buffer.</p>
</script>
<!-- --- [red-module:node-red/change] --- -->

<script type="text/x-red" data-template-name="change">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-row" style="margin-bottom:0;">
        <label><i class="fa fa-list"></i> <span data-i18n="change.label.rules"></span></label>
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('change', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            rules:{value:[{t:"set",p:"payload",pt:"msg",to:"",tot:"str"}]},
            // legacy
            action: {value:""},
            property: {value:""},
            from: {value:""},
            to: {value:""},
            reg: {value:false}
        },
        inputs: 1,
        outputs: 1,
        icon: "swap.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            if (!this.rules) {
                if (this.action === "replace") {
                    return this._("change.label.set",{property:"msg."+this.property});
                } else if (this.action === "change") {
                    return this._("change.label.change",{property:"msg."+this.property});
                } else if (this.action === "move") {
                    return this._("change.label.move",{property:"msg."+this.property});
                } else {
                    return this._("change.label.delete",{property:"msg."+this.property});
                }
            } else {
                if (this.rules.length == 1) {
                    if (this.rules[0].t === "set") {
                        return this._("change.label.set",{property:(this.rules[0].pt||"msg")+"."+this.rules[0].p});
                    } else if (this.rules[0].t === "change") {
                        return this._("change.label.change",{property:(this.rules[0].pt||"msg")+"."+this.rules[0].p});
                    } else if (this.rules[0].t === "move") {
                        return this._("change.label.move",{property:(this.rules[0].pt||"msg")+"."+this.rules[0].p});
                    } else {
                        return this._("change.label.delete",{property:(this.rules[0].pt||"msg")+"."+this.rules[0].p});
                    }
                } else {
                    return this._("change.label.changeCount",{count:this.rules.length});
                }
            }
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var set = this._("change.action.set");
            var change = this._("change.action.change");
            var del = this._("change.action.delete");
            var move = this._("change.action.move");
            var to = this._("change.action.to");
            var search = this._("change.action.search");
            var replace = this._("change.action.replace");
            var regex = this._("change.label.regex");

            function resizeRule(rule) {
                var newWidth = rule.width();
                rule.find('.red-ui-typedInput').typedInput("width",newWidth-130);

            }
            $('#node-input-rule-container').css('min-height','300px').css('min-width','450px').editableList({
                addItem: function(container,i,opt) {
                    var rule = opt;
                    if (!rule.hasOwnProperty('t')) {
                        rule = {t:"set",p:"payload",to:"",tot:"str"};
                    }
                    if (rule.t === "change" && rule.re) {
                        rule.fromt = 're';
                        delete rule.re;
                    }
                    if (rule.t === "set" && !rule.tot) {
                        if (rule.to.indexOf("msg.") === 0 && !rule.tot) {
                            rule.to = rule.to.substring(4);
                            rule.tot = "msg";
                        } else {
                            rule.tot = "str";
                        }
                    }
                    if (rule.t === "move" && !rule.tot) {
                        rule.tot = "msg";
                    }
                    container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row1 = $('<div></div>').appendTo(container);
                    var row2 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);
                    var row3 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);
                    var row4 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(container);

                    var selectField = $('<select></select>',{class:"node-input-rule-type",style:"width:110px; margin-right:10px;"}).appendTo(row1);
                    var selectOptions = [{v:"set",l:set},{v:"change",l:change},{v:"delete",l:del},{v:"move",l:move}];
                    for (var i=0; i<4; i++) {
                        selectField.append($("<option></option>").val(selectOptions[i].v).text(selectOptions[i].l));
                    }

                    var propertyName = $('<input/>',{class:"node-input-rule-property-name",type:"text"})
                        .appendTo(row1)
                        .typedInput({types:['msg','flow','global']});

                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(to)
                        .appendTo(row2);
                    var propertyValue = $('<input/>',{class:"node-input-rule-property-value",type:"text"})
                        .appendTo(row2)
                        .typedInput({default:'str',types:['msg','flow','global','str','num','bool','json','bin','date','jsonata']});

                    var row3_1 = $('<div></div>').appendTo(row3);
                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(search)
                        .appendTo(row3_1);
                    var fromValue = $('<input/>',{class:"node-input-rule-property-search-value",type:"text"})
                        .appendTo(row3_1)
                        .typedInput({default:'str',types:['msg','flow','global','str','re','num','bool']});

                    var row3_2 = $('<div></div>',{style:"margin-top:8px;"}).appendTo(row3);
                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(replace)
                        .appendTo(row3_2);
                    var toValue = $('<input/>',{class:"node-input-rule-property-replace-value",type:"text"})
                        .appendTo(row3_2)
                        .typedInput({default:'str',types:['msg','flow','global','str','num','bool','json','bin']});

                    $('<div></div>',{style:"display:inline-block;text-align:right; width:120px; padding-right:10px; box-sizing:border-box;"})
                        .text(to)
                        .appendTo(row4);
                    var moveValue = $('<input/>',{class:"node-input-rule-property-move-value",type:"text"})
                        .appendTo(row4)
                        .typedInput({default:'msg',types:['msg','flow','global']});

                    selectField.change(function() {
                        var width = $("#node-input-rule-container").width();
                        var type = $(this).val();
                        if (type == "set") {
                            row2.show();
                            row3.hide();
                            row4.hide();
                        } else if (type == "change") {
                            row2.hide();
                            row3.show();
                            row4.hide();
                        } else if (type == "delete") {
                            row2.hide();
                            row3.hide();
                            row4.hide();
                        } else if (type == "move") {
                            row2.hide();
                            row3.hide();
                            row4.show();
                        }
                        resizeRule(container);
                    });

                    selectField.val(rule.t);
                    propertyName.typedInput('value',rule.p);
                    propertyName.typedInput('type',rule.pt);
                    propertyValue.typedInput('value',rule.to);
                    propertyValue.typedInput('type',rule.tot);
                    moveValue.typedInput('value',rule.to);
                    moveValue.typedInput('type',rule.tot);
                    fromValue.typedInput('value',rule.from);
                    fromValue.typedInput('type',rule.fromt);
                    toValue.typedInput('value',rule.to);
                    toValue.typedInput('type',rule.tot);
                    selectField.change();

                    var newWidth = $("#node-input-rule-container").width();
                    resizeRule(container);
                },
                resizeItem: resizeRule,
                removable: true,
                sortable: true
            });

            if (!this.rules) {
                var rule = {
                    t:(this.action=="replace"?"set":this.action),
                    p:this.property,
                    pt:"msg"
                };

                if ((rule.t === "set")||(rule.t === "move")) {
                    rule.to = this.to;
                } else if (rule.t === "change") {
                    rule.from = this.from;
                    rule.to = this.to;
                    rule.re = this.reg;
                }

                delete this.to;
                delete this.from;
                delete this.reg;
                delete this.action;
                delete this.property;

                this.rules = [rule];
            }

            for (var i=0; i<this.rules.length; i++) {
                var rule = this.rules[i];
                $("#node-input-rule-container").editableList('addItem',rule);
            }
        },
        oneditsave: function() {
            var rules = $("#node-input-rule-container").editableList('items');
            var ruleset;
            var node = this;
            node.rules= [];
            rules.each(function(i) {
                var rule = $(this);
                var type = rule.find(".node-input-rule-type").val();
                var r = {
                    t:type,
                    p:rule.find(".node-input-rule-property-name").typedInput('value'),
                    pt:rule.find(".node-input-rule-property-name").typedInput('type')
                };
                if (type === "set") {
                    r.to = rule.find(".node-input-rule-property-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-value").typedInput('type');
                } else if (type === "move") {
                    r.to = rule.find(".node-input-rule-property-move-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-move-value").typedInput('type');
                } else if (type === "change") {
                    r.from = rule.find(".node-input-rule-property-search-value").typedInput('value');
                    r.fromt = rule.find(".node-input-rule-property-search-value").typedInput('type');
                    r.to = rule.find(".node-input-rule-property-replace-value").typedInput('value');
                    r.tot = rule.find(".node-input-rule-property-replace-value").typedInput('type');
                }
                node.rules.push(r);
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-rule-container-row)");
            var height = size.height;
            for (var i=0; i<rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-rule-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));

            $("#node-input-rule-container").editableList('height',height);
        }
    });
</script>
<script type="text/x-red" data-help-name="change">
    <p>Set, change, delete or move properties of a message, flow context or global context.</p>
    <p>The node can specify multiple rules that will be applied in the order they are defined.</p>
    <h3>Details</h3>
    <p>The available operations are:</p>
    <dl class="message-properties">
    <dt>Set</dt>
    <dd>set a property. The value can be a variety of different types, or
            can be taken from an existing message or context property.</dd>
    <dt>Change</dt>
    <dd>search &amp; replace parts of the property. If regular expressions
        are enabled, the "replace with" property can include capture groups, for
        example <code>$1</code>. Replace will only change the type if there
        is a complete match.</dd>
    <dt>Delete</dt>
    <dd>delete a property.</dd>
    <dt>Move</dt>
    <dd>move or rename a property.</dd>
    </dl>
    <p>The "expression" type uses the <a href="http://jsonata.org/" target="_new">JSONata</a>
    query and expression language.
    </p>
</script>
<!-- --- [red-module:node-red/range] --- -->

<script type="text/x-red" data-template-name="range">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:calc(70% - 1px)"/>
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-dot-circle-o"></i> <span data-i18n="range.label.action"></span></label>
        <select id="node-input-action" style="width:70%;">
            <option value="scale" data-i18n="range.scale.payload"></option>
            <option value="clamp" data-i18n="range.scale.limit"></option>
            <option value="roll" data-i18n="range.scale.wrap"></option>
        </select>
    </div>
    <br/>
    <div class="form-row"><i class="fa fa-sign-in"></i> <span data-i18n="range.label.inputrange"></span>:</div>
    <div class="form-row"><label></label>
        <span data-i18n="range.label.from"></span>: <input type="text" id="node-input-minin" data-i18n="[placeholder]range.placeholder.min" style="width:100px;"/>
        &nbsp;&nbsp;<span data-i18n="range.label.to"></span>: <input type="text" id="node-input-maxin" data-i18n="[placeholder]range.placeholder.maxin" style="width:100px;"/>
    </div>
    <div class="form-row"><i class="fa fa-sign-out"></i> <span data-i18n="range.label.resultrange"></span>:</div>
    <div class="form-row"><label></label>
        <span data-i18n="range.label.from"></span>: <input type="text" id="node-input-minout" data-i18n="[placeholder]range.placeholder.min" style="width:100px;"/>
        &nbsp;&nbsp;<span data-i18n="range.label.to"></span>: <input type="text" id="node-input-maxout" data-i18n="[placeholder]range.placeholder.maxout" style="width:100px;"/>
    </div>
    <br/>
    <div class="form-row"><label></label>
        <input type="checkbox" id="node-input-round" style="display: inline-block; width: auto; vertical-align: top;">
        <label style="width: auto;" for="node-input-round"><span data-i18n="range.label.roundresult"></span></label></input>
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips" id="node-tip"><span data-i18n="range.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('range', {
        color: "#E2D96E",
        category: 'function',
        defaults: {
            minin: {value:"",required:true,validate:RED.validators.number()},
            maxin: {value:"",required:true,validate:RED.validators.number()},
            minout: {value:"",required:true,validate:RED.validators.number()},
            maxout: {value:"",required:true,validate:RED.validators.number()},
            action: {value:"scale"},
            round: {value:false},
            property: {value:"payload",required:true},
            name: {value:""}
        },
        inputs: 1,
        outputs: 1,
        icon: "range.png",
        label: function() {
            if (this.minout !== "" && this.maxout !== "") { return this.name||this.minout + " - " + this.maxout; }
            else { return this.name||this._("range.range"); }
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="range">
    <p>Maps a numeric value to a different range.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>The payload <i>must</i> be a number. Anything else will try to be
        parsed into a number and rejected if that fails.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">number</span></dt>
        <dd>The value mapped to the new range.</dd>
    </dl>
    <h3>Details</h3>
    <p>This node will linearly scale the received value. By default, the result
       is not constrained to the range defined in the node.</p>
    <p><i>Scale and limit to target range</i> means that the result will never be outside
    the range specified within the result range.</p>
    <p><i>Scale and wrap within the target range</i> means that the result will
    be wrapped within the result range.</p>
</script>
<!-- --- [red-module:node-red/split] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="split">
    <div class="form-row"><span data-i18n="[html]split.intro"></span></div>
    <div class="form-row"><span data-i18n="[html]split.strBuff"></span></div>
    <div class="form-row">
        <label for="node-input-splt" style="padding-left:10px; margin-right:-10px;" data-i18n="split.splitUsing"></label>
        <input type="text" id="node-input-splt" style="width:70%">
        <input type="hidden" id="node-input-spltType">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-input-stream" style="margin-left:10px; vertical-align:top; width:auto;">
        <label for="node-input-stream" style="width:auto;" data-i18n="split.stream"></label>
    </div>
    <div class="form-row"><span data-i18n="[html]split.array"></span></div>
    <div class="form-row">
        <label for="node-input-arraySplt" style="padding-left:10px; margin-right:-10px;" data-i18n="split.splitUsing"></label>
        <input type="text" id="node-input-arraySplt" style="width:70%">
        <input type="hidden" id="node-input-arraySpltType">
    </div>
    <div class="form-row"><span data-i18n="[html]split.object"></span></div>
    <div class="form-row" style="padding-left: 10px"><span data-i18n="[html]split.objectSend"></span></div>
    <div class="form-row">
        <input type="checkbox" id="node-input-addname-cb" style="margin-left:10px; vertical-align:baseline; width:auto;">
        <label for="node-input-addname-cb" style="width:auto;" data-i18n="split.addname"></label>
        <input type="text" id="node-input-addname" style="width:70%">
    </div>
    <hr/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('split',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            splt: {value:"\\n"},
            spltType: {value:"str"},
            arraySplt: {value:1},
            arraySpltType: {value:"len"},
            stream: {value:false},
            addname: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "split.png",
        label: function() {
            return this.name||this._("split.split");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-splt").typedInput({
                default: 'str',
                typeField: $("#node-input-spltType"),
                types:[
                    'str',
                    'bin',
                    {value:"len", label:RED._("node-red:split.splitLength"),validate:/^\d+$/}
                ]
            });
            if (this.arraySplt === undefined) {
                $("#node-input-arraySplt").val(1);
            }
            $("#node-input-arraySplt").typedInput({
                default: 'len',
                typeField: $("#node-input-arraySpltType"),
                types:[
                    {value:"len", label:RED._("node-red:split.splitLength"),validate:/^\d+$/}
                ]
            });
            $("#node-input-addname").typedInput({
                typeField: $("#node-input-fnameType"),
                types:['msg']
            });

            $("#node-input-addname-cb").change(function() {
                $("#node-input-addname").prop('disabled',!this.checked);
            })
            if (this.addname === "") {
                $("#node-input-addname-cb").prop('checked',false);
                $("#node-input-addname").val('topic');
            } else {
                $("#node-input-addname-cb").prop('checked',true);
            }
            $("#node-input-addname-cb").change();
        },
        oneditsave: function() {
            if (!$("#node-input-addname-cb").prop('checked')) {
                $("#node-input-addname").val('');
            }
        }
    });
</script>


<script type="text/x-red" data-template-name="join">
    <div class="form-row">
        <label data-i18n="join.mode.mode"></label>
        <select id="node-input-mode" style="width:200px;">
            <option value="auto" data-i18n="join.mode.auto"></option>
            <option value="custom" data-i18n="join.mode.custom"></option>
            <option value="reduce" data-i18n="join.mode.reduce"></option>
        </select>
    </div>
    <div class="node-row-custom">
        <div class="form-row node-row-property">
            <label data-i18n="join.combine"> </label>
            <input type="text" id="node-input-property" style="width:70%;">
            <input type="hidden" id="node-input-propertyType">
        </div>
        <div class="form-row">
            <label data-i18n="join.create"></label>
            <select id="node-input-build" style="width:70%;">
                <option value="string" data-i18n="join.type.string"></option>
                <option value="buffer" data-i18n="join.type.buffer"></option>
                <option value="array" data-i18n="join.type.array"></option>
                <option value="object" data-i18n="join.type.object"></option>
                <option value="merged" data-i18n="join.type.merged"></option>
            </select>
        </div>
        <div class="form-row node-row-key">
            <label style="vertical-align:top; margin-top:7px; width:auto; margin-right: 5px;" data-i18n="join.using"></label>
            <div style="display:inline-block">
                <input type="text" id="node-input-key" style="width:220px;"> <span data-i18n="join.key"></span>
            </div>
        </div>
        <div class="form-row node-row-joiner">
            <label for="node-input-joiner" data-i18n="join.joinedUsing"></label>
            <input type="text" id="node-input-joiner" style="width:70%">
            <input type="hidden" id="node-input-joinerType">
        </div>
        <div class="form-row node-row-trigger" id="trigger-row">
            <label style="width:auto;" data-i18n="join.send"></label>
            <ul>
                <li>
                    <label style="width:280px;" for="node-input-count" data-i18n="join.afterCount"></label> <input id="node-input-count" data-i18n="[placeholder]join.count" type="text" style="width:75px;">
                </li>
                <li class="node-row-accumulate" style="list-style-type:none;">
                    <input type="checkbox" id="node-input-accumulate" style="display:inline-block; width:20px; margin-left:20px; vertical-align:top;">  <label style="width: auto" for="node-input-accumulate" data-i18n="join.subsequent"></label>
                </li>
                <li>
                    <label style="width:280px;" for="node-input-timeout" data-i18n="join.afterTimeout"></label> <input id="node-input-timeout" data-i18n="[placeholder]join.seconds" type="text" style="width:75px;">
                </li>
                <li>
                    <label style="width:auto; padding-top:6px;" data-i18n="[html]join.complete"></label>
                </li>
            </ul>
        </div>
    </div>
    <div class="node-row-reduce">
        <div class="form-row">
            <label for="node-input-reduceExp" data-i18n="join.reduce.exp" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceExp" data-i18n="[placeholder]join.reduce.exp-value" style="width:65%">
        </div>
        <div class="form-row">
            <label for="node-input-reduceInit" data-i18n="join.reduce.init" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceInit" data-i18n="[placeholder]join.reduce.init" style="width:65%">
            <input type="hidden" id="node-input-reduceInitType">
        </div>
        <div class="form-row">
            <label for="node-input-reduceFixup" data-i18n="join.reduce.fixup" style="margin-left:10px;"></label>
            <input type="text" id="node-input-reduceFixup" data-i18n="[placeholder]join.reduce.exp-value" style="width:65%">
        </div>
        <div class="form-row">
            <label>&nbsp;</label>
            <input type="checkbox" id="node-input-reduceRight" style="display:inline-block; width:auto; vertical-align:top; margin-left:10px;">
            <label for="node-input-reduceRight" style="width:70%;" data-i18n="join.reduce.right" style="margin-left:10px;"></label>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <div class="form-tips form-tips-auto hide" data-i18n="[html]join.tip"></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('join',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            mode: {value:"auto"},
            build: { value:"string"},
            property: { value:"payload", validate:RED.validators.typedInput("propertyType")},
            propertyType: { value:"msg"},
            key: {value:"topic"},
            joiner: { value:"\\n"},
            joinerType: { value:"str"},
            accumulate: { value:"false" },
            timeout: {value:""},
            count: {value:""},
            reduceRight: {value:false},
            reduceExp: {value:undefined},
            reduceInit: {value:undefined},
            reduceInitType: {value:undefined},
            reduceFixup: {value:undefined}
        },
        inputs:1,
        outputs:1,
        icon: "join.png",
        label: function() {
            return this.name||this._("join.join");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var node = this;

            $("#node-input-mode").change(function(e) {
                var val = $(this).val();
                $(".node-row-custom").toggle(val==='custom');
                $(".node-row-reduce").toggle(val==='reduce');
                $(".form-tips-auto").toggle((val==='auto') || (val==='reduce'));
                if (val === "auto") {
                    $("#node-input-accumulate").attr('checked', false);
                }
                else if (val === "custom") {
                    $("#node-input-build").change();
                }
                else if (val === "reduce") {
                    var jsonata_or_empty = {
                        value: "jsonata",
                        label: "expression",
                        icon: "red/images/typedInput/expr.png",
                        validate: function(v) {
                            try{
                                if(v !== "") {
                                    jsonata(v);
                                }
                                return true;
                            }
                            catch(e){
                                return false;
                            }
                        },
                        expand:function() {
                            var that = this;
                            RED.editor.editExpression({
                                value: this.value().replace(/\t/g,"\n"),
                                complete: function(v) {
                                    that.value(v.replace(/\n/g,"\t"));
                                }
                            })
                        }
                    };
                    $("#node-input-reduceExp").typedInput({types:[jsonata_or_empty]});
                    $("#node-input-reduceInit").typedInput({
                        default: 'num',
                        types:['flow','global','str','num','bool','json','bin','date','jsonata'],
                        typeField: $("#node-input-reduceInitType")
                    });
                    $("#node-input-reduceFixup").typedInput({types:[jsonata_or_empty]});
                }
            });

            $("#node-input-build").change(function(e) {
                var val = $(this).val();
                $(".node-row-key").toggle(val==='object');
                $(".node-row-accumulate").toggle(val==='object' || val==='merged');
                $(".node-row-joiner").toggle(val==='string' || val==='buffer');
                $(".node-row-trigger").toggle(val!=='auto');
                if (val === 'string' || val==='buffer') {
                    $("#node-input-property").typedInput('types',['msg']);
                    $("#node-input-joiner").typedInput("show");
                } else {
                    $("#node-input-property").typedInput('types',['msg', {value:"full",label:"complete message",hasValue:false}]);
                }
            });

            $("#node-input-joiner").typedInput({
                default: 'str',
                typeField: $("#node-input-joinerType"),
                types:[
                    'str',
                    'bin'
                ]
            });

            $("#node-input-property").typedInput({
                typeField: $("#node-input-propertyType"),
                types:['msg', {value:"full", label:"complete message", hasValue:false}]
            });

            $("#node-input-key").typedInput({
                types:['msg', {value:"merge", label:"", hasValue:false}]
            });

            $("#node-input-build").change();
            $("#node-input-mode").change();
        },
        oneditsave: function() {
            var build = $("#node-input-build").val();
            if (build !== 'object' && build !== 'merged') {
                $("#node-input-accumulate").prop("checked",false);
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="split">
    <p>Splits a message into a sequence of messages.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string | array | buffer</span></dt>
        <dd>The behaviour of the node is determined by the type of <code>msg.payload</code>:
            <ul>
                <li><b>string</b>/<b>buffer</b> - the message is split using the specified character (default: <code>\n</code>), buffer sequence or into fixed lengths.</li>
                <li><b>array</b> - the message is split into either individual array elements, or arrays of a fixed-length.</li>
                <li><b>object</b> - a message is sent for each key/value pair of the object.</li>
            </ul>
        </dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>parts<span class="property-type">object</span></dt>
        <dd>This property contains information about how the message was split from
        the original message. If passed to the <b>join</b> node, the sequence can be
        reassembled into a single message. The property has the following properties:
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - if known, the total number of messages in the group. See 'streaming mode' below.</li>
            <li><code>type</code> - the type of message - string/array/object/buffer</li>
            <li><code>ch</code> - for a string or buffer, the data used to the split the message as either the string or an array of bytes</li>
            <li><code>key</code> - for an object, the key of the property this message was created from. The node can be configured to also copy this value to another message properties, such as <code>msg.topic</code>.</li>
            <li><code>len</code> - the length of each message when split using a fixed length value</li>
        </ul>
        </dd>
    </dl>
    <h3>Details</h3>
    <p>This node makes it easy to create a flow that performs common actions across
    a sequence of messages before, using the <b>join</b> node, recombining the
    sequence into a single message.</p>
    <p>It uses the <code>msg.parts</code> property to track the individual parts
    of a sequence.</p>
    <h4>Streaming mode</h4>
    <p>The node can also be used to reflow a stream of messages. For example, a
    serial device that sends newline-terminated commands may deliver a single message
    with a partial command at its end. In 'streaming mode', this node will split
    a message and send each complete segment. If there is a partial segment at the end,
    the node will hold on to it and prepend it to the next message that is received.
    </p>
    <p>When operating in this mode, the node will not set the <code>msg.parts.count</code>
    property as it does not know how many messages to expect in the stream. This
    means it cannot be used with the <b>join</b> node in its automatic mode</p>
</script><script type="text/x-red" data-help-name="join">
    <p>Joins sequences of messages into a single message.</p>
    <p>There are three modes available:</p>
    <dl>
        <dt>automatic</dt>
        <dd>When paired with the <b>split</b> node, it will automatically join the messages to reverse the split that was performed.</dd>
        <dt>manual</dt>
        <dd>Join sequences of messages in a variety of ways.</dd>
        <dt>reduce sequence</dt>
        <dd>Apply an expression against all messages in a sequence to reduce it to a single message.</dd>
    </dl>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt class="optional">parts<span class="property-type">object</span></dt>
        <dd>To automatically join a sequence of messages, they should all have
        this property set. The <b>split</b> node generates this property but it
        can be manually created. It has the following properties:
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - the total number of messages in the group</li>
            <li><code>type</code> - the type of message - string/array/object/buffer</li>
            <li><code>ch</code> - for a string or buffer, the data used to the split the message as either the string or an array of bytes</li>
            <li><code>key</code> - for an object, the key of the property this message was created from</li>
            <li><code>len</code> - the length of each message when split using a fixed length value</li>
        </ul>
        </dd>
        <dt class="optional">complete</dt>
        <dd>If set, the node will send its output message in its current state.</dd>
    </dl>
    <h3>Details</h3>

    <h4>Automatic mode</h4>
    <p>Automatic mode uses the <code>parts</code> property of incoming messages to
       determine how the sequence should be joined. This allows it to automatically
       reverse the action of a <b>split</b> node.

    <h4>Manual mode</h4>
    <p>When configured to join in manual mode, the node is able to join sequences
     of messages into a number of different results:</p>
    <ul>
        <li>a <b>string</b> or <b>buffer</b> - created by joining the selected property of each message with the specified join characters or buffer.</li>
        <li>an <b>array</b> - created by adding each selected property, or entire message, to the output array.</li>
        <li>a <b>key/value object</b> - created by using a property of each message to determine the key under which
        the required value is stored.</li>
        <li>a <b>merged object</b> - created by merging the property of each message under a single object.</li>
    </ul>
    <p>The other properties of the output message are taken from the last message received before the result is sent.</p>
    <p>A <i>count</i> can be set for how many messages should be received before generating the output message.
    For object outputs, once this count has been reached, the node can be configured to send a message for each subsequent message
    received.</p>
    <p>A <i>timeout</i> can be set to trigger sending the new message using whatever has been received so far.</p>
    <p>If a message is received with the <b>msg.complete</b> property set, the output message is sent.</p>

    <h4>Reduce Sequence mode</h4>
    <p>When configured to join in reduce mode, an expression is applied to each
       message in a sequence and the result accumulated to produce a single message.</p>

    <dl class="message-properties">
        <dt>Initial value</dt>
        <dd>The initial value of the accumulated value (<code>$A</code>).</dd>
        <dt>Reduce expression</dt>
        <dd>A JSONata expression that is called for each message in the sequence.
            The result is passed to the next call of the expression as the accumulated value.
            In the expression, the following special variables can be used:
            <ul>
                <li><code>$A</code>: the accumulated value, </li>
                <li><code>$I</code>: index of the message in the sequence, </li>
                <li><code>$N</code>: number of messages in the sequence.</li>
            </ul>
        </dd>
        <dt>Fix-up expression</dt>
        <dd>An optional JSONata expression that is applied after the reduce expression
            has been applied to all messages in the sequence.
            In the expression, following special variables can be used:
            <ul>
                <li><code>$A</code>: the accumulated value, </li>
                <li><code>$N</code>: number of messages in the sequence.</li>
            </ul>
        </dd>
        <p>By default, the reduce expression is applied in order, from the first
           to the last message of the sequence. It can optionally be applied in
           reverse order.</p>
    </dl>
    <p><b>Example:</b> the following settings, given a sequence of numeric values,
       calculates the average value:
        <ul>
            <li><b>Reduce expression</b>: <code>$A+payload</code></li>
            <li><b>Initial value</b>: <code>0</code></li>
            <li><b>Fix-up expression</b>: <code>$A/$N</code></li>
        </ul>
    </p>
    <h4>Storing messages</h4>
    <p>This node will buffer messages internally in order to work across sequences. The
       runtime setting <code>nodeMessageBufferMaxLength</code> can be used to limit how many messages nodes
       will buffer.</p>
</script>
<!-- --- [red-module:node-red/sort] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="sort">

    <div class="form-row">
        <label for="node-input-target"><i class="fa fa-dot-circle-o"></i> <span data-i18n="sort.target"></span></label>
        <input type="text" id="node-input-target" style="width:70%;">
        <input type="hidden" id="node-input-targetType">
    </div>

    <div class="node-row-sort-msg-key">
        <div class="form-row">
            <label for="node-input-msgKey"><i class="fa fa-filter"></i> <span data-i18n="sort.key"></span></label>
            <input type="text" id="node-input-msgKey" style="width:70%;">
            <input type="hidden" id="node-input-msgKeyType">
        </div>
    </div>

    <div class="node-row-sort-seq-key">
        <div class="form-row">
            <label for="node-input-seqKey"><i class="fa fa-filter"></i> <span data-i18n="sort.key"></span></label>
            <input type="text" id="node-input-seqKey" style="width:70%;">
            <input type="hidden" id="node-input-seqKeyType">
        </div>
    </div>

    <div class="form-row">
        <label><i class="fa fa-random"></i>  <span data-i18n="sort.order"></span></label>
        <select id="node-input-order" style="width:200px;">
            <option value="ascending" data-i18n="sort.ascending"></option>
            <option value="descending" data-i18n="sort.descending"></option>
        </select>
    </div>

    <div class="form-row" id="node-as_num">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-as_num" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-as_num" style="width: 70%;" data-i18n="sort.as-number"></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('sort',{
        category: 'function',
        color:"#E2D96E",
        defaults: {
            name: { value:"" },
            order: { value:"ascending" },
            as_num: { value:false },
            target: { value:"payload" },
            targetType: { value:"msg" },
            msgKey: { value:"payload" },
            msgKeyType: { value:"elem" },
            seqKey: { value:"payload" },
            seqKeyType: { value:"msg" }
        },
        inputs:1,
        outputs:1,
        icon: "sort.png",
        label: function() {
            return this.name||this._("sort.sort");
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var seq = {
                value: "seq",
                label: RED._("node-red:sort.seq"),
                hasValue: false
            };
            var elem = {
                value: "elem",
                label: RED._("node-red:sort.elem"),
                hasValue: false
            };
            $("#node-input-target").typedInput({
                default:'msg',
                typeField: $("#node-input-targetType"),
                types:['msg', seq]
            });
            $("#node-input-msgKey").typedInput({
                default:'elem',
                typeField: $("#node-input-msgKeyType"),
                types:[elem, 'jsonata']
            });
            $("#node-input-seqKey").typedInput({
                default:'msg',
                typeField: $("#node-input-seqKeyType"),
                types:['msg', 'jsonata']
            });
            $("#node-input-target").change(function(e) {
                var val = $("#node-input-target").typedInput('type');
                $(".node-row-sort-msg-key").toggle(val === "msg");
                $(".node-row-sort-seq-key").toggle(val === "seq");
            });
            $("#node-input-target").change();
        }
    });
</script>
<script type="text/x-red" data-help-name="sort">
    <p>A function that sorts message property or a sequence of messages.</p>
    <p>When configured to sort message property, the node sorts array data pointed to by specified message property.</p>
    <p>When configured to sort a sequence of messages, it will reorder the messages.</p>
    <p>The sorting order can be:</p>
    <ul>
        <li><b>ascending</b>,</li>
        <li><b>descending</b>.</li>
    </ul>
    <p>For numbers, numerical ordering can be specified by a checkbox.</p>
    <p>Sort key can be element value or JSONata expression for sorting property value, or message property or JSONata expression for sorting a message sequence.<p>
    <p>When sorting a message sequence, the sort node relies on the received messages to have <code>msg.parts</code> set.  The split node generates this property, but can be manually created.  It has the following properties:</p>
    <p>
        <ul>
            <li><code>id</code> - an identifier for the group of messages</li>
            <li><code>index</code> - the position within the group</li>
            <li><code>count</code> - the total number of messages in the group</li>
        </ul>
    </p>
    <p><b>Note:</b> This node internally keeps messages for its operation.  In order to prevent unexpected memory usage, maximum number of messages kept can be specified.  Default is no limit on number of messages.
        <ul>
            <li><code>nodeMessageBufferMaxLength</code> property set in <b>settings.js</b>.</li>
        </ul>
    </p>
</script>
<!-- --- [red-module:node-red/batch] --- -->
<!--
  Copyright JS Foundation and other contributors, http://js.foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="batch">
    <div class="form-row">
        <label for="node-input-mode"><span data-i18n="batch.mode.label"></span></label>
        <select type="text" id="node-input-mode" style="width: 300px;">
            <option value="count" data-i18n="batch.mode.num-msgs"></option>
            <option value="interval" data-i18n="batch.mode.interval"></option>
            <option value="concat" data-i18n="batch.mode.concat"></option>
        </select>
    </div>

    <div class="node-row-msg-count">
        <div class="form-row node-row-count">
            <label style="margin-left: 10px; width: 175px;" for="node-input-count" data-i18n="batch.count.label"></label>
            <input type="text" id="node-input-count" style="width: 50px;">
        </div>
    </div>

    <div class="node-row-msg-overlap">
        <div class="form-row node-row-overlap">
            <label style="margin-left: 10px; width: 175px;" for="node-input-overlap" data-i18n="batch.count.overlap"></label>
            <input type="text" id="node-input-overlap" style="width: 50px;">
        </div>
    </div>

    <div class="node-row-msg-interval">
        <div class="form-row node-row-interval">
            <label style="margin-left: 10px; width: 175px;" for="node-input-interval"> <span data-i18n="batch.interval.label"></span></label>
            <input type="text" id="node-input-interval" style="width: 50px;">
            <span data-i18n="batch.interval.seconds"></span>
        </div>
        <div class="form-row">
            <input type="checkbox" id="node-input-allowEmptySequence" style="margin-left:20px; margin-right: 10px; vertical-align:top; width:auto;">
            <label for="node-input-allowEmptySequence" style="width:auto;" data-i18n="batch.interval.empty"></label>
	</div>
    </div>

    <div class="node-row-msg-concat">
        <div class="form-row">
            <label data-i18n="batch.concat.topics-label"></label>
            <div class="form-row node-input-topics-container-row">
                <ol id="node-input-topics-container"></ol>
            </div>
        </div>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>

</script>



<script type="text/javascript">
    RED.nodes.registerType("batch",{
        category: "function",
        color:"#E2D96E",
        defaults: {
            name: {value:""},
            mode: {value:"count"},
            count: {value:10},
            overlap: {value:0},
            interval: {value:10},
            allowEmptySequence: {value:false},
            topics: {value:[{topic:""}]}
        },
        inputs:1,
        outputs:1,
        icon: "batch.png",
        label: function() {
            return this.name||this._("batch.batch");;
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            var node = this;
            var topic_str = node._("batch.concat.topic");

            function resizeTopics(topic) {
                var newWidth = topic.width();
                topic.find('.red-ui-typedInput')
                     .typedInput("width",newWidth-15);
            }

            $("#node-input-topics-container")
                .css('min-height','200px').css('min-width','430px')
                .editableList({
                    addItem: function(container, i, opt) {
                        if (!opt.hasOwnProperty('topic')) {
                            opt.topic = "";
                        }
                        var row = $('<div></div>').appendTo(container);
                        var valueField = $('<input/>',{
                            class:"node-input-topic-value",
                            type:"text",
                            style:"margin-left: 5px;"
                        }).appendTo(row)
                        .typedInput({default:'str', types:['str']});
                        valueField.typedInput('value', opt.topic);
                        valueField.typedInput('type', 'str');
                        valueField.attr('placeholder', topic_str);
                        resizeTopics(container);
                    },
                    resizeItem: resizeTopics,
                    sortable: true,
                    removable: true
                });

            $("#node-input-count").spinner({
            });
            $("#node-input-overlap").spinner({
            });
            $("#node-input-interval").spinner({
            });
            $("#node-input-mode").change(function(e) {
                var val = $(this).val();
                $(".node-row-msg-count").toggle(val==="count");
                $(".node-row-msg-overlap").toggle(val==="count");
                $(".node-row-msg-interval").toggle(val==="interval");
                $(".node-row-msg-concat").toggle(val==="concat");
                if (val==="concat") {
                    var topics = node.topics;
                    var container = $("#node-input-topics-container");
                    container.editableList('empty');
                    for (var i = 0; i < topics.length; i++) {
                        var topic = topics[i];
                        container.editableList('addItem', topic);
                    }
                }
            });
        },
        oneditsave: function() {
            var topics = $("#node-input-topics-container").editableList('items');
            var node = this;
            node.topics = [];
            topics.each(function(i) {
                var topicData = $(this).data('data');
                var topic = $(this);
                var vf = topic.find(".node-input-topic-value");
                var value = vf.typedInput('value');
                var type = vf.typedInput('type');
                var r = {topic:value};
                node.topics.push(r);
            });
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-input-topics-container-row)");
            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }
            var editorRow = $("#dialog-form>div.node-input-topics-container-row");
            height -= (parseInt(editorRow.css("marginTop"))+parseInt(editorRow.css("marginBottom")));
            $("#node-input-topics-container").editableList('height',height);
        }
    });
</script>
<script type="text/x-red" data-help-name="batch">
    <p>Creates sequences of messages based on various rules.</p>
    <h3>Details</h3>
    <p>There are three modes for creating message sequences:</p>
    <dl>
        <dt>Number of messages</dt>
        <dd>groups messages into sequences of a given length. The <b>overlap</b>
        option specifies how many messages at the end of one sequence should be
        repeated at the start of the next sequence.</dd>

        <dt>Time interval</dt>
        <dd>groups messages that arrive within the specified interval. If no messages
            arrive within the interval, the node can optionally send on an empty message.</dd>

        <dt>Concatenate Sequences</dt>
        <dd>creates a message sequence by concatenating incoming sequences. Each message
            must have a <code>msg.topic</code> property and a <code>msg.parts</code> property
            identifying its sequence. The node is configured with a list of <code>topic</code>
            values to identify the order sequences are concatenated.
        </dd>
    </dl>
    <h4>Storing messages</h4>
    <p>This node will buffer messages internally in order to work across sequences. The
       runtime setting <code>nodeMessageBufferMaxLength</code> can be used to limit how many messages nodes
       will buffer.</p>
</script>
<!-- --- [red-module:node-red/CSV] --- -->

<script type="text/x-red" data-template-name="csv">
    <div class="form-row">
        <label for="node-input-temp"><i class="fa fa-list"></i> <span data-i18n="csv.label.columns"></span></label>
        <input type="text" id="node-input-temp" data-i18n="[placeholder]csv.placeholder.columns">
    </div>
    <div class="form-row">
        <label for="node-input-select-sep"><i class="fa fa-text-width"></i> <span data-i18n="csv.label.separator"></span></label>
            <select style="width:150px" id="node-input-select-sep">
                <option value="," data-i18n="csv.separator.comma"></option>
                <option value="\t" data-i18n="csv.separator.tab"></option>
                <option value=" " data-i18n="csv.separator.space"></option>
                <option value=";" data-i18n="csv.separator.semicolon"></option>
                <option value=":" data-i18n="csv.separator.colon"></option>
                <option value="#" data-i18n="csv.separator.hashtag"></option>
                <option value="" data-i18n="csv.separator.other"></option>
           </select>
           <input style="width:40px;" type="text" id="node-input-sep" pattern=".">
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row">
        <label style="width:100%; border-bottom:1px solid #eee;"><span data-i18n="csv.label.c2o"></span></label>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="csv.label.input"></span></label>
        <span data-i18n="csv.label.skip-s"></span>&nbsp;<input type="text" id="node-input-skip" style="width:30px; height:25px;"/>&nbsp;<span data-i18n="csv.label.skip-e"></span><br/>
        <label>&nbsp;</label>
        <input style="width:20px; vertical-align:baseline; margin-right:5px;" type="checkbox" id="node-input-hdrin"><label style="width:auto; margin-top:7px;" for="node-input-hdrin"><span data-i18n="csv.label.firstrow"></span>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-out"></i> <span data-i18n="csv.label.output"></span></label>
        <select type="text" id="node-input-multi" style="width:250px;">
            <option value="one" data-i18n="csv.output.row"></option>
            <option value="mult" data-i18n="csv.output.array"></option>
        </select>
    </div>
    <div class="form-row" style="margin-top:20px">
        <label style="width:100%; border-bottom:1px solid #eee;"><span data-i18n="csv.label.o2c"></span></label>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label><i class="fa fa-sign-in"></i> <span data-i18n="csv.label.output"></span></label>
        <input style="width:20px; vertical-align:top; margin-right:5px;" type="checkbox" id="node-input-hdrout"><label style="width:auto;" for="node-input-hdrout"><span data-i18n="csv.label.includerow"></span></span>
    </div>
    <div class="form-row" style="padding-left:20px;">
        <label></label>
        <label style="width:auto; margin-right:10px;" for="node-input-ret"><span data-i18n="csv.label.newline"></span></label>
        <select style="width:150px;" id="node-input-ret">
            <option value='\n' data-i18n="csv.newline.linux"></option>
            <option value='\r' data-i18n="csv.newline.mac"></option>
            <option value='\r\n' data-i18n="csv.newline.windows"></option>
       </select>
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('csv',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            sep: {value:',',required:true,validate:RED.validators.regex(/^.{1,2}$/)},
            //quo: {value:'"',required:true},
            hdrin: {value:""},
            hdrout: {value:""},
            multi: {value:"one",required:true},
            ret: {value:'\\n'},
            temp: {value:""},
            skip: {value:"0"}
        },
        inputs:1,
        outputs:1,
        icon: "parser-csv.png",
        label: function() {
            return this.name||"csv";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            console.log(this.skip,$("#node-input-skip").val());
            if (this.skip === undefined) { this.skip = 0; $("#node-input-skip").val("0");}
            $("#node-input-skip").spinner({ min:0 });
            if (this.sep == "," || this.sep == "\\t" || this.sep == ";" || this.sep == ":" || this.sep == " " || this.sep == "#") {
                $("#node-input-select-sep").val(this.sep);
                $("#node-input-sep").hide();
            } else {
                $("#node-input-select-sep").val("");
                $("#node-input-sep").val(this.sep);
                $("#node-input-sep").show();
            }
            $("#node-input-select-sep").change(function() {
                var v = $("#node-input-select-sep").val();
                $("#node-input-sep").val(v);
                if (v == "") {
                    $("#node-input-sep").val("");
                    $("#node-input-sep").show().focus();
                } else {
                    $("#node-input-sep").hide();
                }
            });
        }
    });
</script>
<script type="text/x-red" data-help-name="csv">
    <p>Converts between a CSV formatted string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>A JavaScript object, array or CSV string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | array | string</span></dt>
        <dd>
        <ul>
            <li>If the input is a string it tries to parse it as CSV and creates a JavaScript object of key/value pairs for each line.
                The node will then either send a message for each line, or a single message containing an array of objects.</li>
            <li>If the input is a JavaScript object it tries to build a CSV string.</li>
            <li>If the input is an array of simple values, it builds a single line CSV string.</li>
            <li>If the input is an array of arrays, or an array of objects, a multiple-line CSV string is created.</li>
        </ul>
        </dd>
    </dl>
    <h3>Details</h3>
    <p>The column template can contain an ordered list of column names. When converting CSV to an object, the column names
    will be used as the property names. Alternatively, the column names can be taken from the first row of the CSV.</p>
    <p>When converting to CSV, the column template is used to identify which properties to extract from the object and in what order.</p>
    <p>If the input is an array then the columns template is only used to optionally generate a row of column titles.</p>
    <p>The node can accept a multi-part input as long as the <code>parts</code> property is set correctly.</p>
    <p>If outputting multiple messages they will have their <code>parts</code> property set and form a complete message sequence.</p>
    <p><b>Note:</b> the column template must be comma separated - even if a different separator is chosen for the data.</p>
    </script>
<!-- --- [red-module:node-red/HTML] --- -->

<script type="text/x-red" data-template-name="html">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%">
    </div>
    <div class="form-row">
        <label for="node-input-tag"><i class="fa fa-filter"></i> <span data-i18n="html.label.select"></span></label>
        <input type="text" id="node-input-tag" placeholder="h1">
    </div>
    <div class="form-row">
        <label for="node-input-ret"><i class="fa fa-sign-out"></i> <span data-i18n="html.label.output"></span></label>
        <select id="node-input-ret" style="width:70%">
            <option value="html" data-i18n="html.output.html"></option>
            <option value="text" data-i18n="html.output.text"></option>
            <option value="attr" data-i18n="html.output.attr"></option>
            <!-- <option value="val">return the value from a form element</option> -->
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-as">&nbsp;</label>
        <select id="node-input-as" style="width:70%">
            <option value="single" data-i18n="html.format.single"></option>
            <option value="multi" data-i18n="html.format.multi"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-outproperty">&nbsp;</label>
        <span data-i18n="html.label.in" style="padding-left:8px; padding-right:2px; vertical-align:-1px;"></span> <input type="text" id="node-input-outproperty" style="width:64%">
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" style="width:70%" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('html',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload"},
            outproperty: {value:"payload"},
            tag: {value:""},
            ret: {value:"html"},
            as: {value:"single"}
        },
        inputs:1,
        outputs:1,
        icon: "parser-html.png",
        label: function() {
            return this.name||this.tag||"html";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            $("#node-input-outproperty").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="html">
    <p>Extracts elements from an html document held in <code>msg.payload</code> using a CSS selector.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
    <dt>payload <span class="property-type">string</span></dt>
    <dd>the html string from which to extract elements.</dd>
    <dt class="optional">select <span class="property-type">string</span></dt>
    <dd>if not configured in the edit panel the selector can be set as a property of msg.</dd>
</dl>
    <h3>Output</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">array | string</span></dt>
        <dd>the result can be either a single message with a payload containing an array of the matched elements, or multiple
           messages that each contain a matched element. If multiple messages are sent they will also have <code>parts</code> set.</dd>
    </dl>
    <h3>Details</h3>
    <p>This node supports a combination of CSS and jQuery selectors. See the
    <a href="https://github.com/fb55/CSSselect#user-content-supported-selectors" target="_blank">css-select documentation</a> for more information
    on the supported syntax.</p>
</script>
<!-- --- [red-module:node-red/JSON] --- -->

<script type="text/x-red" data-template-name="json">
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-dot-circle-o"></i> <span data-i18n="json.label.action"></span></label>
        <select style="width:70%" id="node-input-action">
            <option value=""    data-i18n="json.label.actions.toggle"></option>
            <option value="str" data-i18n="json.label.actions.str"></option>
            <option value="obj" data-i18n="json.label.actions.obj"></option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="json.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row node-json-to-json-options">
        <label style="width:100%; border-bottom: 1px solid #eee;"><span data-i18n="json.label.o2j"></span></label>
    </div>
    <div class="form-row node-json-to-json-options" style="padding-left: 20px;">
        <input style="width:20px; vertical-align:top; margin-right: 5px;" type="checkbox" id="node-input-pretty"><label style="width: auto;" for="node-input-pretty" data-i18n="json.label.pretty"></span>
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('json',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true},
            action: {value:""},
            pretty: {value:false}
        },
        inputs:1,
        outputs:1,
        icon: "parser-json.png",
        label: function() {
            return this.name||"json";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            $("#node-input-action").change(function() {
                if (this.value === "" || this.value === "str") {
                    $(".node-json-to-json-options").show();
                } else {
                    $(".node-json-to-json-options").hide();
                }
            });
            $("#node-input-action").change();
        }
    });
</script>
<script type="text/x-red" data-help-name="json">
    <p>Converts between a JSON string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or JSON string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a JSON string it tries to parse it to a JavaScript object.</li>
                <li>If the input is a JavaScript object it creates a JSON string. The string can optionally be well-formatted.</li>
            </ul>
        </dd>
    </dl>
    <h3>Details</h3>
    <p>By default, the node operates on <code>msg.payload</code>, but can be configured
       to convert any message property.</p>
    <p>The node can also be configured to ensure a particular encoding instead of toggling
       between the two. This can be used, for example, with the <code>HTTP In</code>
       node to ensure the payload is a parsed object even if an incoming request
       did not set its content-type correctly for the HTTP In node to do the conversion.</p>
    <p>If the node is configured to ensure the property is encoded as a String and it
       receives a String, no further checks will be made of the property. It will
       not check the String is valid JSON nor will it reformat it if the format option
       is selected.</p>
</script>
<!-- --- [red-module:node-red/XML] --- -->

<script type="text/x-red" data-template-name="xml">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
    <hr align="middle"/>
    <div class="form-row">
        <label style="width:100%; border-bottom: 1px solid #eee;"><span data-i18n="xml.label.x2o"></span></label>
    </div>
    <div class="form-row" style="padding-left: 20px;">
        <label style="width:250px;" for="node-input-attr" data-i18n="xml.label.represent"></label> <input type="text" id="node-input-attr" style="text-align:center; width:40px" placeholder="$">
    </div>
    <div class="form-row" style="padding-left: 20px;">
        <label style="width:250px;" for="node-input-chr" data-i18n="xml.label.prefix"></label> <input type="text" id="node-input-chr" style="text-align:center; width:40px" placeholder="_">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('xml',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            name: {value:""},
            property: {value:"payload",required:true},
            attr: {value:""},
            chr: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "parser-xml.png",
        label: function() {
            return this.name||"xml";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="xml">
    <p>Converts between an XML string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or XML string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a string it tries to parse it as XML and creates a JavaScript object.</li>
                <li>If the input is a JavaScript object it tries to build an XML string.</li>
            </ul>
        </dd>
        <dt class="optional">options <span class="property-type">object</span></dt>
        <dd>This optional property can be used to pass in any of the options supported by the underlying
            library used to convert to and from XML. See <a href="https://github.com/Leonidas-from-XIV/node-xml2js/blob/master/README.md#options" target="_blank">the xml2js docs</a>
            for more information.</dd>
    </dl>
    <h3>Details</h3>
    <p>When converting between XML and an object, any XML attributes are added as a property named <code>$</code> by default.
    Any text content is added as a property named <code>_</code>. These property names can be specified in the node configuration.</p>
    <p>For example, the following XML will be converted as shown:</p>
    <pre>&lt;p class="tag"&gt;Hello World&lt;/p&gt;</pre>
    <pre>{
  "p": {
    "$": {
      "class": "tag"
    },
    "_": "Hello World"
  }
}</pre>
</script>
<!-- --- [red-module:node-red/YAML] --- -->

<script type="text/x-red" data-template-name="yaml">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('yaml',{
        category: 'function',
        color:"#DEBD5C",
        defaults: {
            property: {value:"payload",required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "parser-yaml.png",
        label: function() {
            return this.name||"yaml";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
        }
    });
</script>
<script type="text/x-red" data-help-name="yaml">
    <p>Converts between a YAML formatted string and its JavaScript object representation, in either direction.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>A JavaScript object or YAML string.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object | string</span></dt>
        <dd>
            <ul>
                <li>If the input is a YAML string it tries to parse it to a JavaScript object.</li>
                <li>If the input is a JavaScript object it creates a YAML string.</li>
            </ul>
        </dd>
    </dl>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/tcp] --- -->
<!--
  Copyright 2013,2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="tcp in">
    <div class="form-row">
        <label for="node-input-server"><i class="icon-resize-small"></i> Connect</label>
        to port &nbsp;<input type="text" id="node-input-port" style="width: 250px;">
    </div>
    <div class="form-row" id="node-input-host-row" style="padding-left: 110px;">
        at host <input type="text" id="node-input-host" placeholder="localhost" style="width: 250px;">
    </div>
    <div class="form-row">
        <label><i class="icon-th"></i> Output</label>
        a
        <select id="node-input-datamode" style="width:110px;">
            <option value="stream">stream of</option>
            <option value="single">single</option>
        </select>
        <select id="node-input-datatype" style="width:140px;">
            <option value="buffer">Buffer</option>
            <option value="utf8">String</option>
            <option value="base64">Base64 String</option>
        </select>
        payload<span id="node-input-datamode-plural">s</span>
    </div>
    <div id="node-row-newline" class="form-row hidden" style="padding-left: 110px;">
        delimited by <input type="text" id="node-input-newline" style="width: 110px;">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="icon-tasks"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="Topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('tcp in',{
        category: 'input',
        color:"Silver",
        defaults: {
            server: {value:"client",required:true},
            host: {value:"",validate:function(v) { return (this.server == "server")||v.length > 0;} },
            port: {value:"",required:true,validate:RED.validators.number()},
            datamode:{value:"stream"},
            datatype:{value:"buffer"},
            newline:{value:""},
            topic: {value:""},
            name: {value:""},
            base64: {/*deprecated*/ value:false,required:true}
        },
        inputs:0,
        outputs:1,
        icon: "bridge-dash.png",
        label: function() {
            return this.name || "tcp:"+(this.host?this.host+":":"")+this.port;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var updateOptions = function() {
                var datamode = $("#node-input-datamode option:selected").val();
                var datatype = $("#node-input-datatype option:selected").val();
                if (datamode == "stream") {
                    $("#node-input-datamode-plural").show();
                    if (datatype == "utf8") {
                        $("#node-row-newline").show();
                    } else {
                        $("#node-row-newline").hide();
                    }
                } else {
                    $("#node-input-datamode-plural").hide();
                    $("#node-row-newline").hide();
                }
            };
            updateOptions();
            $("#node-input-server").change(updateOptions);
            $("#node-input-datatype").change(updateOptions);
            $("#node-input-datamode").change(updateOptions);
        }
    });
</script>


<script type="text/x-red" data-template-name="tcp out">
    <div class="form-row">
        <label for="node-input-beserver"><i class="icon-resize-small"></i> Type</label>
        <select id="node-input-beserver" style="width:150px; margin-right:5px;">
            <!-- <option value="server">Listen on</option> -->
            <option value="client">Connect to</option>
            <option value="reply">Reply to TCP</option>
        </select>
        <span id="node-input-port-row">port <input type="text" id="node-input-port" style="width: 50px"></span>
    </div>
    <div class="form-row hidden" id="node-input-host-row" style="padding-left: 110px;">
        at host <input type="text" id="node-input-host" placeholder="localhost" style="width: 40%;">
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-base64" placeholder="base64" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-base64" style="width: 70%;">Decode Base64 message ?</label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('tcp out',{
        category: 'output',
        color:"Silver",
        defaults: {
            host: {value:"",validate:function(v) { return (this.beserver != "client")||v.length > 0;} },
            port: {value:"",validate:function(v) { return (this.beserver == "reply")||RED.validators.number()(v) } },
            beserver: {value:"client",required:true},
            base64: {value:false,required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:0,
        icon: "bridge-dash.png",
        align: "right",
        label: function() {
            return this.name || "tcp:"+(this.host?this.host+":":"")+this.port;
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        },
        oneditprepare: function() {
            var updateOptions = function() {
                var sockettype = $("#node-input-beserver option:selected").val();
                if (sockettype == "reply") {
                    $("#node-input-port-row").hide();
                    $("#node-input-host-row").hide();
                } else {
                    $("#node-input-port-row").show();
                }

                if (sockettype == "client") {
                    $("#node-input-host-row").show();
                } else {
                    $("#node-input-host-row").hide();
                }
            };
            updateOptions();
            $("#node-input-beserver").change(updateOptions);
        }
    });
</script>


<script type="text/x-red" data-template-name="tcp request">
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> Server</label>
        <input type="text" id="node-input-server" placeholder="ip.address" style="width:45%">
        &nbsp;port <input type="text" id="node-input-port" style="width:60px">
    </div>
    <div class="form-row">
        <label for="node-input-out"><i class="fa fa-sign-out"></i> Return</label>
        <select type="text" id="node-input-out" style="width:56%;">
            <option value="time">after a fixed timeout of</option>
            <option value="char">when character received is</option>
            <option value="count">a fixed number of chars</option>
            <option value="sit">never - keep connection open</option>
        </select>
        <input type="text" id="node-input-splitc"  style="width:50px;">
        <span id="node-units"></span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</span></label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <script>
        var previous = null;
        $("#node-input-out").on('focus', function () { previous = this.value; }).change(function() {
            if (previous == null) { previous = $("#node-input-out").val(); }
            if ($("#node-input-out").val() == "char") {
                if (previous != "char") $("#node-input-splitc").val("\\n");
                $("#node-units").text("");
            }
            else if ($("#node-input-out").val() == "time") {
                if (previous != "time") $("#node-input-splitc").val("0");
                $("#node-units").text("ms");
            }
            else if ($("#node-input-out").val() == "count") {
                if (previous != "count") $("#node-input-splitc").val("12");
                $("#node-units").text("chars");
            }
            else {
                if (previous != "sit") $("#node-input-splitc").val("0");
                $("#node-units").text("");
            }
        });
</script>



<script type="text/javascript">
    RED.nodes.registerType('tcp request',{
        category: 'function',
        color:"Silver",
        defaults: {
            server: {value:""},
            port: {value:"",validate:RED.validators.regex(/^(\d*|)$/)},
            out: {value:"time",required:true},
            splitc: {value:"0",required:true},
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "bridge-dash.png",
        label: function() {
            return this.name || "tcp:"+(this.server?this.server+":":"")+this.port;
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<script type="text/x-red" data-help-name="tcp in">
    <p>Provides a tcp input client. Connects to a remote tcp port.</p>
</script><script type="text/x-red" data-help-name="tcp out">
    <p>Provides a tcp output client. Connects to a remote tcp port, or replies to messages received from a TCP In node.</p>
    <p>Only <code>msg.payload</code> is sent.</p>
    <p>If <code>msg.payload</code> is a string containing a base64 encoding of binary
    data, the Base64 decoding option will cause it to be converted back to binary
    before being sent.</p>
</script><script type="text/x-red" data-help-name="tcp request">
    <p>A simple TCP request node - sends the <code>msg.payload</code> to a server tcp port and expects a response.</p>
    <p>Connects, sends the "request", reads the "response". It can either count a number of
    returned characters into a fixed buffer, match a specified character before returning,
    wait a fixed timeout from first reply and then return, or just sit and wait for data.</p>
    <p>The response will be output in <code>msg.payload</code> as a buffer, so you may want to .toString() it.</p>
    <p>If you leave tcp host or port blank they must be set by using the <code>msg.host</code> and <code>msg.port</code> properties.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/udp] --- -->
<!--
  Copyright 2013,2014 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!--  The Output Node  -->
<script type="text/x-red" data-template-name="udp out">
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-envelope"></i> Send a</label>
        <select id="node-input-multicast" style='width:40%'>
          <option value="false">udp message</option>
          <option value="broad">broadcast message</option>
          <option value="multi">multicast message</option>
        </select>
        to port <input type="text" id="node-input-port" placeholder="port" style="width: 70px">
    </div>
    <div class="form-row node-input-addr">
        <label for="node-input-addr" id="node-input-addr-label"><i class="fa fa-list"></i> Address</label>
        <input type="text" id="node-input-addr" placeholder="destination ip" style="width: 70%;">
    </div>
    <div class="form-row node-input-iface">
        <label for="node-input-iface"><i class="fa fa-random"></i> Interface</label>
        <input type="text" id="node-input-iface" placeholder="(optional) ip address of eth0">
    </div>
    <div class="form-row">
        <label for="node-input-outport-type">&nbsp;</label>
        <select id="node-input-outport-type">
          <option id="node-input-outport-type-random" value="random">use random local port</option>
          <option value="fixed">bind to local port</option>
        </select>
        <input type="text" id="node-input-outport"  style="width: 70px;" placeholder="port">
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-base64" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-base64" style="width: 70%;">Decode Base64 encoded payload ?</label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-tips">Tip: leave address and port blank if you want to set using <b>msg.ip</b> and <b>msg.port</b>.</div>
    <script>
        $("#node-input-multicast").change(function() {
            var id = $("#node-input-multicast option:selected").val();
            if (id !== "multi") {
                $(".node-input-iface").hide();
                $("#node-input-addr-label").html('<i class="fa fa-list"></i> Address');
                $("#node-input-addr")[0].placeholder = 'destination ip';
            }
            else {
                $(".node-input-iface").show();
                $("#node-input-addr-label").html('<i class="fa fa-list"></i> Group');
                $("#node-input-addr")[0].placeholder = '225.0.18.83';
            }
            if (id === "broad") {
                $("#node-input-addr")[0].placeholder = '255.255.255.255';
            }
        });
    </script>




<script type="text/javascript">
    RED.nodes.registerType('udp out',{
        category: 'output',
        color:"Silver",
        defaults: {
            name: {value:""},
            addr: {value:""},
            iface: {value:""},
            port: {value:""},
            outport: {value:""},
            base64: {value:false,required:true},
            multicast: {value:"false"}
        },
        inputs:1,
        outputs:0,
        icon: "bridge-dash.png",
        align: "right",
        label: function() {
            return this.name||"udp "+(this.addr+":"+this.port);
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var type = this.outport==""?"random":"fixed";
            $("#node-input-outport-type option").filter(function() {
                return $(this).val() == type;
            }).attr('selected',true);


            $("#node-input-outport-type").change(function() {
                var type = $(this).children("option:selected").val();
                if (type == "random") {
                    $("#node-input-outport").val("").hide();
                } else {
                    $("#node-input-outport").show();
                }
            });

            $("#node-input-outport-type").change();

            $("#node-input-multicast").change(function() {
                var type = $(this).children("option:selected").val();
                if (type == "false") {
                    $("#node-input-outport-type-random").html("bind to random local port");
                } else {
                    $("#node-input-outport-type-random").html("bind to target port");
                }
            });
            $("#node-input-multicast").change();
        }
    });
</script>
<script type="text/x-red" data-help-name="udp out">
    <p>This node sends <code>msg.payload</code> to the designated udp host and port. Supports multicast.</p>
    <p>You may also use <code>msg.ip</code> and <code>msg.port</code> to set the destination values.<br/>
    <b>Note</b>: the statically configured values have precedence.</p>
    <p>If you select broadcast either set the address to the local broadcast ip address, or maybe try 255.255.255.255,
    which is the global broadcast address.</p>
    <p>On some systems you may need to be root to use ports below 1024 and/or broadcast.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/mqlight] --- -->
<!--
  Copyright 2013,2014 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="mqlight in">
    <div class="form-row">
        <label for="node-input-service"><i class="icon-folder-close"></i> Service</label>
        <select type="text" id="node-input-service" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tag"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="news/nodered">
    </div>
    <div class="form-row">
        <label for="node-input-share"><i class="fa fa-tag"></i> Share</label>
        <input type="text" id="node-input-share">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-tips" id="node-missing-service-warning" style="display: none"><i class="fa fa-warning"></i><b> Warning:</b> There are no MQ Light services connected</div>
</script>



<script type="text/javascript">
    (function() {
        RED.nodes.registerType('mqlight in', {
            category: 'input',
            defaults: {
                name: {value: ""},
                service: {value: "", required: true},
                topic: {value: ""},
                share: {value:""}
            },
            color: "#6da7d1",
            inputs: 0,
            outputs: 1,
            icon: "mqlightin.png",
            label: function() {
                if (this.topic) {
                    return this.topic+(this.share?" ["+this.share+"]":"");
                } else {
                    return this.name || "mqlight";
                }
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                $.getJSON('mqlight/vcap/', function(services) {
                    if (services.length === 0) {
                        $("#node-missing-service-warning").show();
                    } else {
                        var select = $('#node-input-service');
                        for (var i = 0; i < services.length; ++i) {
                            var name = services[i];
                            var option = "<option value=\"" + name + "\">" + name + "</option>";
                            select.append(option);
                        }
                    }
                });
            }
        });
    })();
</script>

<script type="text/x-red" data-template-name="mqlight out">
    <div class="form-row">
        <label for="node-input-service"><i class="icon-folder-close"></i> Service</label>
        <select type="text" id="node-input-service" style="display: inline-block; vertical-align:top; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tag"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="news/nodered">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-tips" id="node-missing-service-warning" style="display: none"><i class="fa fa-warning"></i><b> Warning:</b> There are no MQ Light services connected</div>
</script>



<script type="text/javascript">
    (function() {
        RED.nodes.registerType('mqlight out', {
            category: 'output',
            defaults: {
                name: {value: ""},
                service: {value: "", required: true},
                topic: {value: ""}
            },
            color: "#6da7d1",
            inputs: 1,
            outputs: 0,
            align: "right",
            icon: "mqlightin.png",
            label: function() {
                return this.name || this.topic || "mqlight";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                $.getJSON('mqlight/vcap/', function(services) {
                    if (services.length === 0) {
                        $("#node-missing-service-warning").show();
                    } else {
                        var select = $('#node-input-service');
                        for (var i = 0; i < services.length; ++i) {
                            var name = services[i];
                            var option = "<option value=\"" + name + "\">" + name + "</option>";
                            select.append(option);
                        }
                    }
                });
            }
        });
    })();
</script>
<script type="text/x-red" data-help-name="mqlight in">
    <p>Provides an MQ Light receive client.</p>
    <p>Subscribes the client to a destination based on the supplied topic and (optional) share arguments.</p>
    <p>Topic can contain any character in the Unicode character set, with # representing a multilevel wildcard and + a
    single level wildcard as described <a href="https://developer.ibm.com/messaging/mq-light/wildcard-topicpatterns/">here</a>.
    <p>Share identifies a shared destination for which messages are anycast between connected subscribers. If left blank,
    it defaults to a private destination.</p>
    <p>Received messages will be sent on in <code>msg.payload</code> with their topic sent in <code>msg.topic</code>
    and the share, if specified, sent in <code>msg.share</code>.</p>
</script><script type="text/x-red" data-help-name="mqlight out">
    <p>Provides an MQ Light send client.</p>
    <p>Sends the value passed in on <code>msg.payload</code> to the specified topic.</p>
    <p>The topic can be passed in on <code>msg.topic</code>, however the topic in the node must be blank for this to take
    effect. If the topic is set in the node <code>msg.topic</code> will be overridden.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/mongodb] --- -->
<!--
  Copyright 2013 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="mongodb">
    <div class="form-row">
        <label for="node-config-input-hostname"><i class="icon-bookmark"></i> Host</label>
        <input class="input-append-left" type="text" id="node-config-input-hostname" placeholder="localhost" style="width: 40%;" >
        <label for="node-config-input-port" style="margin-left: 10px; width: 35px; "> Port</label>
        <input type="text" id="node-config-input-port" placeholder="27017" style="width:45px">
    </div>
    <div class="form-row">
        <label for="node-config-input-db"><i class="icon-briefcase"></i> Database</label>
        <input type="text" id="node-config-input-db" placeholder="test">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="icon-user"></i> Username</label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-pass"><i class="icon-lock"></i> Password</label>
        <input type="password" id="node-config-input-pass">
    </div>
</script>

<script type="text/javascript">

    RED.nodes.registerType('mongodb',{
        category: 'config',
        color:"rgb(218, 196, 180)",
        defaults: {
            hostname: { value:"127.0.0.1"},
            port: { value: 27017},
            db: { value:""},
            name: { value:"" },
            //user -> credentials
            //pass -> credentials
        },
        label: function() {
            return this.name||this.hostname+":"+this.port+"/"+this.db;
        },
        oneditprepare: function() {
            $.getJSON('mongodb/'+this.id,function(data) {
                if (data.user) {
                    $('#node-config-input-user').val(data.user);
                }
                if (data.hasPassword) {
                    $('#node-config-input-pass').val('__PWRD__');
                } else {
                    $('#node-config-input-pass').val('');
                }

            });
        },
        oneditsave: function() {
            var newUser = $('#node-config-input-user').val();
            var newPass = $('#node-config-input-pass').val();
            var credentials = {};
            credentials.user = newUser;
            if (newPass != '__PWRD__') {
                credentials.password = newPass;
            }
            $.ajax({
                url: 'mongodb/'+this.id,
                type: 'POST',
                data: credentials,
                success:function(result){}
            });
        },
        ondelete: function() {
            $.ajax({
                url: 'mongodb/'+this.id,
                type: 'DELETE',
                success: function(result) {}
            });
        }
    });
</script>


<script type="text/x-red" data-template-name="mongodb out">
    <div class="form-row">
        <label for="node-input-service"><i class="icon-folder-close"></i> Service</label>
        <select id="node-input-service">
            <option value="" disabled></option>
            <option value="_ext_">External service</option>
        </select>
    </div>
    <div class="form-row hide" id="node-input-external-details">
        <label for="node-input-mongodb"><i class="icon-bookmark"></i> Server</label>
        <input type="text" id="node-input-mongodb">
    </div>
    <div class="form-row">
        <label for="node-input-collection"><i class="icon-briefcase"></i> Collection</label>
        <input type="text" id="node-input-collection" placeholder="collection">
    </div>
        <div class="form-row">
        <label for="node-input-operation"><i class="icon-wrench"></i> Operation</label>
        <select type="text" id="node-input-operation" style="display: inline-block; vertical-align: top;">
            <option value="store">save</option>
            <option value="insert">insert</option>
            <option value="update">update</option>
            <option value="delete">remove</option>
        </select>
    </div>
    <div class="form-row node-input-payonly">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-payonly" placeholder="Only" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-payonly" style="width: 70%;">Only store msg.payload object ?</label>
    </div>
    <div class="form-row node-input-upsert">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-upsert" placeholder="Only" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-upsert" style="width: 70%;">Create a new document if no match found</label>
    </div>
    <div class="form-row node-input-multi">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-multi" placeholder="Only" style="display: inline-block; width: auto; vertical-align: top;;">
        <label for="node-input-multi" style="width: 70%;">Update all matching documents</label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-tips" id="node-warning" style="display: none"><b> Tip:</b> If no collection is set, ensure <b>msg.collection</b> will contain the collection name
    </div>
</script>



<script type="text/x-red" data-template-name="mongodb in">
    <div class="form-row">
        <label for="node-input-service"><i class="icon-folder-close"></i> Service</label>
        <select id="node-input-service">
            <option value="" disabled></option>
            <option value="_ext_">External service</option>
        </select>
    </div>
    <div class="form-row hide" id="node-input-external-details">
        <label for="node-input-mongodb"><i class="icon-bookmark"></i> Server</label>
        <input type="text" id="node-input-mongodb">
    </div>
    <div class="form-row">
        <label for="node-input-collection"><i class="icon-briefcase"></i> Collection</label>
        <input type="text" id="node-input-collection" placeholder="collection">
    </div>
    <div class="form-row">
        <label for="node-input-operation"><i class="fa fa-wrench"></i> Operation</label>
        <select type="text" id="node-input-operation" style="display: inline-block; vertical-align: top;">
            <option value="find">find</option>
            <option value="count">count</option>
            <option value="aggregate">aggregate</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-tips" id="node-warning" style="display: none"><b> Tip:</b> If no collection is set, ensure <b>msg.collection</b> will contain the collection name
    </div>
</script>



<script type="text/javascript">
    (function() {

        function oneditprepare() {
            var select = $('#node-input-service')
            var node = this;
            $.getJSON('mongodb/vcap/', function(data) {
                var last = select.children().last();
                var opts = [];
                for (var i =0; i<data.length; i++) {
                    opts.push('<option value="' + data[i].name + '"' + (node.service === data[i].name ? " selected" : "") + '>' + data[i].name + '</option>');
                }
                if (opts.length === 0) {
                    node.service = "_ext_";
                    select.find("option").filter(function() {return $(this).val() === node.service;
                    }).attr('selected', true);
                } else {
                    last.before(opts.join(""));
                }
                select.change();
            });

            select.change(function() {
                var service = select.val();
                if (service === "_ext_") {
                    $("#node-input-external-details").show();
                } else {
                    $("#node-input-external-details").hide();
                }
            });

            $("#node-input-operation").change(function () {
                var id = $("#node-input-operation option:selected").val();

                if (id === "update") {
                    $(".node-input-payonly").hide();
                    $(".node-input-upsert, .node-input-multi").show();
                } else if (id === "delete") {
                    $(".node-input-payonly, .node-input-upsert, .node-input-multi").hide();
                } else {
                    $(".node-input-payonly").show();
                    $(".node-input-upsert, .node-input-multi").hide();
                }
            });

            $("#node-input-collection").change(function () {
                if($("#node-input-collection").val() === "") {
                    $("#node-warning").show();
                } else {
                    $("#node-warning").hide();
                }
            });
        }

        function label() {
            var mongoNode = RED.nodes.node(this.mongodb);
            if (this.name) {
                return this.name;
            }
            if (this.service === "_ext_") {
                return (mongoNode?mongoNode.label() + " " + this.collection: "mongodb");
            }
            return this.service || "mongodb";
        }

        function validateServer(v) {
            return this.service !== "_ext_" || v !== "_ADD_";
        }

        RED.nodes.registerType('mongodb out', {
            category: 'storage-output',
            color:"rgb(218, 196, 180)",
            defaults: {
                service: {value:"", required: true},
                mongodb: { type:  "mongodb", validate: validateServer},
                name: {value: ""},
                collection: {value: ""},
                payonly: {value: false},
                upsert: {value: false},
                multi: {value: false},
                operation: {value: "store"}
            },
            inputs: 1,
            outputs: 0,
            icon: "mongodb.png",
            align: "right",
            label: label,
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: oneditprepare
        });


        RED.nodes.registerType('mongodb in',{
            category: 'storage-input',
            color: "rgb(218, 196, 180)",
            defaults: {
                service: {value: "", required: true},
                mongodb: {type: "mongodb", validate: validateServer},
                name: {value: ""},
                collection: {value: ""},
                operation: {value: "find"}
            },
            inputs: 1,
            outputs: 1,
            icon: "mongodb.png",
            label: label,
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="mongodb out">
    <p>A simple MongoDB output node. Can save, insert, update and remove objects from a chosen collection.</p>
    <p>Save will update an existing object or insert a new object if one does not already exist.</p>
    <p>Insert will insert a new object.</p>
    <p>Save and insert either store <b>msg</b> or <code>msg.payload</code>.</p>
    <p>Update will modify an existing object or objects. The query to select objects to update uses <code>msg.query</code> and the update to the element uses <code>msg.payload</code>.</p>
    <p>Update can add a object if it does not exist or update multiple objects.</p>
    <p>Remove will remove objects that match the query passed in on <code>msg.payload</code>. A blank query will delete <i>all of the objects</i> in the collection.</p>
    <p>You can either set the collection method in the node config or on <code>msg.collection</code>. Setting it in the node will override <code>msg.collection</code>.</p>
    <p>By default MongoDB creates an <i>_id</i> property as the primary key - so repeated injections of the same <code>msg</code> will result in many database entries.</p>
    <p>If this is NOT the desired behaviour - ie. you want repeated entries to overwrite, then you must set the <code>msg._id</code> property to be a constant by the use of a previous function node.</p>
    <p>This could be a unique constant or you could create one based on some other msg property.</p>
    <p>Currently we do not limit or cap the collection size at all... this may well change.</p>
</script><script type="text/x-red" data-help-name="mongodb in">
    <p>Calls a MongoDB collection method based on the selected operator.</p>
    <p>Find queries a collection using the <code>msg.payload</code> as the query statement as per the .find() function.
    Optionally, you may also (via a function) set a <code>msg.projection</code> object to constrain the returned fields,
    a <code>msg.sort</code> object and a <code>msg.limit</code> object.</p>
    <p>Count returns a count of the number of documents in a collection or matching a query using the <code>msg.payload</code> 
    as the query statement.</p>
    <p>Aggregate provides access to the aggregation pipeline using the <code>msg.payload</code> as the pipeline array.</p>
    <p>See the <a href="http://docs.mongodb.org/manual/reference/method/db.collection.find/" target="new"><i>MongoDB
    collection methods docs</i></a> for examples.</p>
    <p>The result is returned in <code>msg.payload</code>.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/twilio] --- -->
<!--
  Copyright 2013 Andrew D Lindsay @AndrewDLindsay
  http://blog.thiseldo.co.uk

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="twilio out">
    <div class="form-row">
        <label for="node-input-service"><i class="icon-folder-close"></i> Service</label>
        <select id="node-input-service">
            <option value="" disabled></option>
            <option value="_ext_">External service</option>
        </select>
    </div>
    <div class="form-row" id="node-input-twilio-row">
        <label for="node-input-twilio"><i class="icon-user"></i> Twilio</label>
        <input type="text" id="node-input-twilio">
    </div>
    <div class="form-row" id="node-input-from-row">
        <label for="node-input-from"><i class="icon-user"></i> From</label>
        <input type="text" id="node-input-from" placeholder="+4412345678901">
    </div>
    <div class="form-row">
        <label for="node-input-number"><i class="icon-envelope"></i> SMS to</label>
        <input type="text" id="node-input-number" placeholder="+4412345678901">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>



<script type="text/x-red" data-template-name="twilio-api">
    <div class="form-row">
        <label for="node-config-input-sid">Account SID</label>
        <input type="text" id="node-config-input-sid">
    </div>
    <div class="form-row">
        <label for="node-config-input-from"><i class="icon-envelope"></i> From</label>
        <input type="text" id="node-config-input-from" placeholder="01234 5678901">
    </div>
    <div class="form-row">
        <label for="node-config-input-token"><i class="icon-lock"></i> Token</label>
        <input type="password" id="node-config-input-token">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">


    (function() {
    
        RED.nodes.registerType('twilio-api',{
            category: 'config',
            defaults: {
                sid: {value:"",required:true},
                from: {value:"",required:true},
                // token -> credentials
                name: { value: ""}
            },
            label: function() {
                return this.name||this.from;
            },
            oneditprepare: function() {
                $.getJSON('twilio-api/'+this.id,function(data) {
                    if (data.hasToken) {
                        $('#node-config-input-token').val('__PWRD__');
                    } else {
                        $('#node-config-input-token').val('');
                    }
    
                });
            },
            oneditsave: function() {
                var newToken = $('#node-config-input-token').val();
                if (newToken != '__PWRD__') {
                var credentials = {};
                    credentials.token = newToken;
                    $.ajax({
                        url: 'twilio-api/'+this.id,
                        type: 'POST',
                        data: credentials,
                        success:function(result){}
                    });
                }
            },
            ondelete: function() {
                $.ajax({
                    url: 'twilio-api/'+this.id,
                    type: 'DELETE',
                    success: function(result) {}
                });
            }
        });
        
        RED.nodes.registerType('twilio out',{
            category: 'output',
            defaults: {
                service: {value:"", required: true},
                twilio:{type:"twilio-api",validate:function(v) {
                    return (this.service && this.service != "_ext_") || (v&&v!="_ADD_");
                }},
                from: {value:""},
                number: {value:""},
                name: {value:""}
            },
            color:"#FF595F",
            inputs:1,
            outputs:0,
            icon: "twilio.png",
            align: "right",
            label: function() {
                var api = RED.nodes.node(this.twilio);
                if (this.name) {
                    return this.name;
                }
                if (this.service == "_ext_") {
                    return (api?api.label():"twilio");
                }
                return this.service||"twilio";
            },
            labelStyle: function() {
                return this.name?"node_label_italic":"";
            },
            oneditprepare: function() {
                var select = $('#node-input-service')
                var node = this;
                $.getJSON('twilio-api/vcap/',function(data) {
                    var last = select.children().last();
                    var opts = [];
                    for (var i =0;i<data.length;i++) {
                        opts.push('<option value="'+data[i].name+'"'+(node.service==data[i].name?" selected":"")+'>'+data[i].name+'</option>');
                    }
                    if (opts.length == 0) {
                        node.service = "_ext_";
                        select.find("option").filter(function() {return $(this).val() == node.service;}).attr('selected',true);
                    } else {
                        last.before(opts.join(""));
                    }
                    select.change();
                });
                select.change(function() {
                    var service = select.val();
                    if (service == "_ext_") {
                        $("#node-input-twilio-row").show();
                        $("#node-input-from-row").hide();
                    } else {
                        $("#node-input-twilio-row").hide();
                        $("#node-input-from-row").show();
                    }
                });
            }
        });
    })();

</script>
<script type="text/x-red" data-help-name="twilio out">
    <p>Sends an SMS message using the Twilio service.</p>
    <p><code>msg.payload</code> is used as the body of the message. The node can be configured with the number
    to send the message to. Alternatively, if the number is left blank, it can be set using <code>msg.topic</code>.</p>
    <p>You must have an account with Twilio to use this node. You can register for one <a href="https://www.twilio.com/">here</a>.</p>
    <p>You can either set your account details within the node, or provide it as a bound service within Bluemix.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/weather] --- -->

<!--
  Copyright 2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="weather_insights">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-host"><i class="fa fa-server"></i> API Host</label>
        <input type="text" id="node-input-host" placeholder="Hostname for API provider">
    </div>
    <div class="form-row">
        <label for="node-input-service"><i class="fa fa-question"></i> Service</label>
        <select type="text" id="node-input-service" style="display: inline-block; width: 70%;" >
            <option value="/forecast/daily/10day.json">Daily Forecast (10 Days)</option>
            <option value="/forecast/hourly/48hour.json">Hourly Forecast (48 Hours)</option>
            <option value="/observations.json">Current Observations</option>
            <option value="/observations/timeseries.json?hours=23">Historic Observations (24 Hours)</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-geocode"><i class="fa fa-tag"></i> Location</label>
        <input type="text" id="node-input-geocode" placeholder="latitude,longitude">
    </div>
    <div class="form-row">
        <label for="node-input-units"><i class="fa fa-question"></i> Units</label>
        <select type="text" id="node-input-units" style="display: inline-block; width: 70%;" >
            <option value="m">Metric</option>
            <option value="e">Imperial (English)</option>
            <option value="h">Hybrid</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-language"><i class="fa fa-question"></i> Language</label>
        <input type="text" id="node-input-language" placeholder="Language Code">
    </div>
</script>



<script type="text/javascript">
    (function() {
        RED.nodes.registerType('weather_insights', {
            category: 'weather',
            defaults: {
                name: {value: ""},
                host: {value: "twcservice.mybluemix.net"},
                service: {value: "/forecast/daily/10day.json"},
                geocode: {value: ""},
                units: {value: "m"},
                language: {value: ""}
            },
            credentials: {
                username: {type:"text"},
                password: {type:"password"}
            },
            color: "rgb(192, 222, 237)",
            inputs: 1,
            outputs: 1,
            icon: "weather.png",
            paletteLabel: "weather insights",
            label: function() {
                return this.name || "weather insights";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                $.getJSON('weather_insights/vcap/')
                  .done(function (service) {
                      $('.credentials').toggle(!service);
                  })
                  .fail(function () {
                      $('.credentials').show();
                  }).always(function () {
                      $('#credentials-check').hide();
                  })
            }
        });
    })();
</script>
<script type="text/x-red" data-help-name="weather_insights">
    <p>The Weather Insights service allows you access historical and real-time weather data from The Weather Company.</p>
    <p>You can retrieve weather data for an area specified by a geolocation. The data allows you to forecast, detect, and visualize disruptive weather events.</p>
    <p>The forecast service to query must be set on the editor panel to choose from forecasts (hourly and daily) or observations (current or 24 hours).</p>
    <p>The geo-location to retrieve results for can be set in the editor panel or at runtime through <code>msg.payload</code>.
    This <code>msg.payload</code> value must be a valid comma-delimited latitude and longitude string, e.g. <code>34.53,84.50</code>.</p>
    <p>The <code>msg.language</code> parameter to set the forecast text language can be set using the message parameter. If this value is set
    in the editor configuration panel, message parameter values will be ignored. If no value is set on the message or in the editor, it defaults to "en-US".</p>
    The service also supports the <code>msg.location</code> parameter with lat and lon attributes.</p>
    <p>The results will be returned on <code>msg.forecasts</code>, <code>msg.observation</code> or <code>msg.observations</code>
     depending on the service.</p>
    <p>For more information about Weather Insights service, read the <a href="https://www.ng.bluemix.net/docs/services/Weather/index.html" target="_new">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-bluemix-nodes/businessrules] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<script type="text/x-red" data-template-name="business-rules">

    <div class="form-row">
        <label for="node-input-service"><i class="fa fa-hand-o-right"></i> Bluemix Service</label>
        <select type="text" id="node-input-service" style="display: inline-block; vertical-align:middle; width: 72%;">
        	<option value="">Select a Business Rules service instance</option>
        </select>
    </div>
    
    <div class="form-row">
        <label for="node-input-rulesets"><i class="fa fa-hand-o-right"></i> Decision Services </label>
        <select type="text" id="node-input-rulesets" style="display: inline-block; vertical-align:middle; width: 72%;">
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-ruleset"><i class="fa fa-save"></i> Current </label>
        <input type="text" id="node-input-ruleset" placeholder="Ruleset Path" readonly style="display: inline-block; vertical-align:middle; width: 72%;"/>
    </div>

    <div class="form-row">
        <label for="node-input-test-test-mode"><i class="fa fa-cog"></i> Test </label>
        <select type="text" id="node-input-test-mode" style="display: inline-block; vertical-align:middle; width: 59%;">
            <option value="false">Current Decision Service with trace disabled</option>
            <option value="true">Current Decision Service with trace enabled</option>
        </select>
        <a id="node-input-htds-test-btn" class="btn" href="#" onclick="javascript:TestDecisionService();return false;">
            <i class="fa fa-external-link"></i> Run</a>
    </div>

    <div class="form-tips" id="node-missing-service-warning" style="display: none"><i class="fa fa-warning"></i><b> Warning:</b> There is no Business Rules service connected
    </div>

    <div class="form-tips" id="node-node-info"><i class="fa fa-book"></i><b> Tips:</b> Check out the node info tab for more information
    </div>


</script>



<script type="text/javascript">

 function TestDecisionService () {
            var traceMode = null, serviceSelect = null, rulesetSelect = null, serviceSelectedVal = null, rulesetSelectedVal = null
                req_string = null, fullURL = null;
            
            traceMode = $('#node-input-test-mode').val();
            serviceSelect = $('#node-input-service');
            rulesetSelect = $('#node-input-ruleset');
            serviceSelectedVal = serviceSelect.val();
            rulesetSelectedVal = rulesetSelect.val();
            req_string = 'business-rules/get-htds-test-uri/' + encodeURIComponent(serviceSelectedVal)+ '/'+ encodeURIComponent(rulesetSelectedVal) ;
            $.getJSON(req_string, function(data) {
                fullURL = 'https://' + data.username + ':' + data.password + '@' + data.url.host + '/DecisionService/run.jsp?path=' +rulesetSelectedVal+'&trace='+(traceMode === "true" ? true : false);
                window.open(fullURL);
            });
}

    (function() {

		function updateRulesetList(node) {
            
			var serviceSelect = $('#node-input-service');
			var rulesetsSelect = $('#node-input-rulesets');
			
            rulesetsSelect.empty();
			$.getJSON('business-rules/service/' + serviceSelect.val() + '/rulesets', function(rulesets) {
				$.each(rulesets, function(index, ruleset) {
					var option = "<option value=\"" + ruleset + "\">"+ ruleset + "</option>";
					rulesetsSelect.append(option);
				});
                rulesetsSelect.find("option").filter(function() {return $(this).val() === node.rulesets;}).attr('selected', true);
			});
            
		}
			
        function oneditprepare() {

            var node = this;

            $.getJSON('business-rules/vcap/', function(services) {
                if (services.length == 0) {
                    $("#node-missing-service-warning").show();
                } else {
                    // Assume service[0]
                    var select = $('#node-input-service');
                    var rulesetsSelect = $('#node-input-rulesets');

                    for (var i = 0; i < services.length; ++i) {
                        var name = services[i];
                        var option = "<option value=\"" + name + "\">"+ name + "</option>";
                        select.append(option);
                    }
                    
                    select.find("option").filter(function() {return $(this).val() === node.service;}).attr('selected', true);

					// update list of ruleset for the selected service when the service changes
					$('#node-input-service').change(function() {
        				updateRulesetList(node);
        			});
					updateRulesetList(node);
        			
                    // update the text value when rulesets are selected
					rulesetsSelect.change(function() {
						$("#node-input-ruleset").val($(this).val());
					});
                }
            });
        }

        RED.nodes.registerType('business-rules',{
            category: 'Smarter Process',
            defaults: {
                service: {value: ""},
                rulesets: {value: ""},
                ruleset: {value: ""}
            },
            color: "rgb(255, 255, 255)",
            inputs: 1,
            outputs: 1,
            icon: "businessrules-icon25x25.png",
            paletteLabel: "business rules",
            label: function() {
                return this.name || "business rules";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="business-rules">
    <p>Enables developers to spend less time recoding and testing when the business policy changes.</p>
    <p>The Business Rules service minimizes your code changes by keeping business logic separate from application logic.</p>
    <p><b>Node Configuration</b></p>
    <ul>
    <li> Create and Bind a Business Rules service instance on this Node-RED App</li>
    <li> Deploy some Decisions Services</li>
    <li> Select the Decision Service to be executed and click on Done</li>
    <li> In input, wire your Business Rules node with a valid Json or Xml payload (use the test tool to help you)</li>
    <li> In output, wire your Business Rules node with the node that will use the response of Decision Service execution request done by this node</li>
    </ul>

    <p><b>Node input</b></p>
    <ul>
    <li><code>msg.payload</code> : a string representing a valid XML or JSON payload matching the selected Decision Service in the node configuration.</li>
    </ul>
    <p><b>Node output</b></p>
    <ul>
    <li><code>msg.payload</code> : the decision corresponding the input data, returned either in XML or JSON as detected in the input.</li>
    </ul>

    <p><b>Documentations</b></p>
    <ul>
        <li><a href="https://github.com/ylecleach/labs/tree/master/node-red/basic-labs/business-rules" target="_blank">Business Rules Node Tutorials</a></li>
        <li><a href="https://console.ng.bluemix.net/docs/services/rules/rules.html#rules" target="_blank">Business Rules Service documentation</a></li>
        <li><a href="http://www.ibm.com/developerworks/topics/business%20rules%20service" target="_blank">All Business Rules service tutorials</a></li>
        <li><a href="http://www.ibm.com/developerworks/bpm/library/techarticles/1504_reinholds-bluemix/1504_reinholds.html" target="_blank">Top 10 Bluemix tutorials for BPM</a></li>
    </ul>

</script>
<!-- --- [red-module:node-red-bluemix-nodes/spssscoring] --- -->

<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="predictive_analytics">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-key"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-key" placeholder="API key">
    </div>
    <div class="form-row">
        <label for="node-input-cid"><i class="fa fa-question"></i> Context ID</label>
        <input type="text" id="node-input-cid" placeholder="Please hit search" style="width:61%">
        <a id="node-lookup-key" class="btn"><i class="fa fa-search"></i></a>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>



<script type="text/javascript">
    (function() {
        RED.nodes.registerType('predictive_analytics', {
            category: 'analysis',
            defaults: {
                name: {value:""},
                cid: {value:"", required:true}
            },
            credentials: {
                key: {type:"password"}
            },
            color: "rgb(192, 222, 237)",
            inputs: 1,
            outputs: 1,
            icon: "spss.png",
            paletteLabel: "predictive analytics",
            label: function() {
                return this.name || "predictive analytics";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                var bm = false;
                var myId = this.id;

                $.getJSON('predictive_analytics/vcap/')
                    .done(function (service) {
                        if (service) { bm = true; }
                        $('.credentials').toggle(!service);
                    })
                    .fail(function () {
                        $('.credentials').show();
                        if ($("#node-input-key").val().length === 0) {
                            $("#node-input-cid").val("Please enter API key then hit search");
                        }
                    }).always(function () {
                        $('#credentials-check').hide();
                    });

                try {
                    $("#node-input-cid").autocomplete( "destroy" );
                } catch(err) {
                }
                $("#node-lookup-key").click(function() {
                    var lkey = $("#node-input-key").val();
                    if (bm || lkey.length !== 0) {
                        var u = 'predictive_analytics/models/';
                        if (!bm) {
                            if (lkey !== "__PWRD__") { u += "?k="+lkey; }
                            else { u += "?id="+myId; }
                        }
                        $.getJSON(u)
                            .done(function (list) {
                                $("#node-input-cid").autocomplete({
                                    source:list,
                                    minLength:0,
                                    close: function( event, ui ) {
                                        $("#node-input-cid").autocomplete( "destroy" );
                                    }
                                }).autocomplete("search","");
                            })
                            .fail(function (err) {
                                $("#node-input-cid").val("fetch failed - enter manually");
                            });
                    }
                });
            }
        });
    })();
</script>
<script type="text/x-red" data-help-name="predictive_analytics">
    <p>The Predictive Analytics node allows you score an input set of parameters using an SPSS model running
    on a <a href="http://bluemix.net" target="_new">Bluemix</a> Predictive Analytics Service.</p>
    <p>You must pass in a <code>msg.payload</code> object <i>as required</i> by the model... so you must
    know what the model looks like. Typically it would be an object similar to :</p>
    <pre>{
    "tablename":"scoring",
    "header":["X","Y","Z"],
    "data":[[4,2,1]]
}</pre>
    <p>The <code>data</code> may be an array of multiple input arrays, and each element will be scored.</p>
    <p>The results will be returned as a <code>msg.payload</code> object formatted as defined by the model.</p>
    <p>For more information about the Predictive Analytics service, read the
    <a href="https://www.ng.bluemix.net/docs/services/PredictiveModeling/index.html" target="_new">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-contrib-scx-ibmiotapp/ibmiotapp] --- -->
<!--
  Copyright 2014, 2017 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="ibmiot">
	<div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="fa fa-user-secret"></i> API Key</label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-pass"><i class="fa fa-lock"></i> API Token</label>
        <input type="password" id="node-config-input-password">
    </div>
    <div class="form-row">
        <label for="node-config-input-serverName"><i class="fa fa-tag"></i> Server-Name</label>
        <input type="text" id="node-config-input-serverName" placeholder="orgid.messaging.internetofthings.ibmcloud.com">
    </div>
    <div class="form-row">
        <label for="node-config-input-shared"><i class="fa fa-tag"></i> Scalable</label>
        <input type="checkbox" id="node-config-input-shared" style="width: 15px;">

        <label for="node-config-input-appId" style="margin-left: 20px; width: 120px" ><i class="fa fa-tag"></i> Application ID</label>
        <input type="text" id="node-config-input-appId" style="width: 35%; ">
    </div>
    <div class="form-row">
       <label for="node-config-input-keepalive">  <i class="fa fa-clock-o"></i> Keep Alive </label>
       <input type="text" id="node-config-input-keepalive" placeholder="60" style="width: 50px;">
       <label style="width: 80px;"> Seconds </label>
       <input type="checkbox" id="node-config-input-cleansession" style="margin-left: 30px; height: 1em;display: inline-block; width: auto; vertical-align: middle;">
       <label for="node-config-input-cleansession" style="width: auto;">Use Clean Session</label>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('ibmiot',{
        category: 'config',
        color:"rgb(0, 155, 255)",
        defaults: {
            name: { value:"" },
            keepalive: {value: 60, validate:RED.validators.number()},
            serverName: {value : "" },
            cleansession: {value: true},
            appId : { value : "" },
            shared : { value : false }
            //user -> credentials
            //pass -> credentials
        },
        label: function() {
            return this.name || this.appId;
        },
        oneditprepare: function() {
            if($("#node-config-input-keepalive").val() === '') {
                $("#node-config-input-keepalive").val("60");
            }

            if (typeof this.cleansession === 'undefined') {
                this.cleansession = true;
                $("#node-config-input-cleansession").prop("checked",true);
            }

            $("#node-config-input-shared").change(function() {
              if ($('#node-config-input-shared').is(":checked")) {
                $("#node-config-input-appId").prop('required',true);
              } else {
                $("#node-config-input-appId").prop('required',false);
              }

            });
        },
		credentials: {
			user: {type:"text"},
			password: {type:"password"}
		}
    });
</script>



<script type="text/x-red" data-template-name="ibmiot out">

    <div class="form-row">
        <label for="node-input-authentication" id="node-input-authenticationLabel" style="width:130px;"><i class="fa fa-umbrella"></i> Authentication</label>
		<select id="node-input-authentication"  style="width:300px;">
			<option value="quickstart">Quickstart</option>
			<option value="apiKey">API Key</option>
			<option value="boundService" id = "node-input-bounded-outnode">Bluemix Service</option>
		</select>
    </div>

	<div class="form-row hide" id="node-input-apiKey-div">
        <label for="node-input-apiKey" id="node-input-apiKeyLabel" style="width:130px;"><i class="fa fa-key"></i> API Key</label>
        <input type="text" id="node-input-apiKey" placeholder="API Key" style="width:300px;">
    </div>

	<div class="form-row">
        <label for="node-input-outputType" id="node-input-outputTypeLabel" style="width:130px;"><i class="fa fa-gears"></i> Output Type</label>
		<select id="node-input-outputType"  style="width:300px;">
			<option value="evt">Device Event</option>
			<option value="cmd">Device Command</option>
		</select>
    </div>

	<div class="form-row">
        <label for="node-input-deviceType" id="node-input-deviceTypeLabel" style="width:130px;"><i class="fa fa-rocket"></i> Device Type</label>
        <input type="text" id="node-input-deviceType" placeholder="device type e.g. armmbed" style="width:300px;">
    </div>


	<div class="form-row">
        <label for="node-input-deviceId" id="node-input-deviceIdLabel" style="width:130px;"><i class="fa fa-street-view"></i> Device Id</label>
        <input type="text" id="node-input-deviceId" placeholder="device id e.g. ab12cd231a21" style="width:300px;">
    </div>

    <div class="form-row">
        <label for="node-input-eventCommandType" id="node-input-eventCommandTypeId" style="width:130px;"><i class="fa fa-tachometer"></i> Event Type</label>
        <input type="text" id="node-input-eventCommandType" placeholder="command/event format e.g blink" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-format" id="node-input-formatLabel"style="width:130px;"><i class="fa fa-file"></i> Format</label>
        <input type="text" id="node-input-format" placeholder="format e.g. json" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-data" style="width:130px;"><i class="fa fa-database"></i> Data</label>
        <input type="text" id="node-input-data" placeholder="payload information e.g. data points" style="width:300px;">
    </div>

    <div class="form-row" id="node-form-qos-div">
        <label id="node-input-qos-label" for="node-input-qos" style="width:130px;"> <i class="fa fa-empire"></i> QoS </label>
        <select id="node-input-qos" style="width:50px;">
            <option value=''></option>
            <option value=0>0</option>
            <option value=1>1</option>
            <option value=2>2</option>
        </select>
    </div>

	<div class="form-row">
        <label for="node-input-name" style="width:130px;"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="iot-new-out" style="width:300px;">
    </div>

	<div class="form-row hidden">
        <label for="node-input-service" style="width:130px;"><i class="fa fa-tag"></i> Service</label>
        <input type="text" id="node-input-service" placeholder="iot-new-out" style="width:300px;">
    </div>

    <div class="form-tips">
		<div id="registeredTips">
			<b>Note:</b> If there is a property in the message that corresponds to any of the values entered above, then the property in the message takes precedence. See the Info tab for more details.<br/>
			<b>Example JSON device event:</b> {"d":{"myName":"Arduino Uno", "temperature":989}}
		</div>

		<div id="quickstartTips">
			<b>Note:</b> If there is a property in the message that corresponds to any of the values entered above, then the property in the message takes precedence. See the Info tab for more details.<br/>
			<b>Quickstart flow can only accept JSON events.</b> <br/>
			<b>Example JSON device event:</b> {"d":{"myName":"Arduino Uno", "temperature":989}}
		</div>
	</div>
</script>




<script type="text/x-red" data-template-name="ibmiot in">
    <div class="form-row">
        <label for="node-input-authentication" id="node-input-authenticationLabel" style="width:130px;"><i class="fa fa-umbrella"></i> Authentication</label>
		<select id="node-input-authentication"  style="width:300px;">
			<option value="quickstart">Quickstart</option>
			<option value="apiKey">API Key</option>
			<option value="boundService" id = "node-input-bounded-innode">Bluemix Service</option>
		</select>
    </div>

	<div class="form-row hide" id = "node-input-apiKey-div">
        <label for="node-input-apiKey" id="node-input-apiKeyLabel" style="width:130px;"><i class="fa fa-key"></i> API Key</label>
        <input type="text" id="node-input-apiKey" placeholder="API Key" style="width:300px;">
    </div>

    <div class="form-row">
        <label for="node-input-inputType" id="node-input-inputTypeLabel" style="width:130px;"><i class="fa fa-gears"></i> Input Type</label>
		<select id="node-input-inputType"  style="width:300px;">
			<option value="evt">Device Event</option>
			<option value="cmd" id="node-input-inputTypeCmd">Device Command</option>
			<option value="devicestate" id="node-input-inputTypeDeviceState">Device State Event</option>
			<option value="devicestateerr" id="node-input-inputTypeDeviceStateErr">Device State Error Event</option>
			<option value="ruletrig" id="node-input-inputTypeRuleT">Rule Trigger</option>
			<option value="ruleerr" id="node-input-inputTypeRuleE">Rule Error</option>
			<option value="devsts">Device Status</option>
			<option value="appsts">Application Status</option>
		</select>
    </div>

    <div class="form-row">
        <label for="node-input-deviceType" id="node-input-deviceTypeLabel" style="width:130px;"><i class="fa fa-rocket"></i> Device Type</label>
		<input type="checkbox" id="node-input-allDeviceTypes" style="width:10px;" >
		<label for="node-input-allDeviceTypesLabel" id="node-input-allDeviceTypesLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-deviceType" placeholder="device type e.g. armmbed" style="width:240px;">
    </div>
	<div class="form-row">
        <label for="node-input-deviceId" id="node-input-deviceIdLabel"style="width:130px;"><i class="fa fa-street-view"></i> Device Id</label>
		<input type="checkbox" id="node-input-allDevices" style="width:10px;">
		<label for="node-input-allDevicesLabel" id="node-input-allDevicesLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-deviceId" placeholder="device id e.g. ab12cd231a21" style="width:240px;">
	</div>
	
	<div class="form-row">
        <label for="node-input-logicalInterface" id="node-input-logicalInterfaceLabel" style="width:130px;"><i class="fa fa-rocket"></i> Logical Interface</label>
		<input type="checkbox" id="node-input-allLogicalInterfaces" style="width:10px;" >
		<label for="node-input-allLogicalInterfaces" id="node-input-allLogicalInterfacesLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-logicalInterface" placeholder="Logical Interface e.g. ITempSensor" style="width:240px;">
	</div>

	<div class="form-row">
        <label for="node-input-ruleId" id="node-input-ruleIdLabel" style="width:130px;"><i class="fa fa-rocket"></i> Rule Id</label>
		<input type="checkbox" id="node-input-allRules" style="width:10px;" >
		<label for="node-input-allRules" id="node-input-allRulesLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-ruleId" placeholder="Rule Id e.g. ab03efffb45cf66" style="width:240px;">
	</div>

	<div class="form-row">
        <label for="node-input-applicationId" id="node-input-applicationIdLabel"style="width:130px;"><i class="fa fa-tasks"></i> Application Id</label>
		<input type="checkbox" id="node-input-allApplications" style="width:10px;">
		<label for="node-input-allApplicationsLabel" id="node-input-allApplicationsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-applicationId" placeholder="application id e.g. ab12cd231a21" style="width:240px;">
    </div>

	<div class="form-row">
        <label for="node-input-event" id="node-input-eventLabel" style="width:130px;"><i class="fa fa-tasks"></i> Event</label>
		<input type="checkbox" id="node-input-allEvents" style="width:10px;" >
		<label for="node-input-allEventsLabel" id="node-input-allEventsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-eventType" placeholder="event type e.g. status" style="width:240px;">
    </div>

	<div class="form-row">
        <label for="node-input-event" id="node-input-commandLabel" style="width:130px;"><i class="fa fa-tasks"></i> Command</label>
		<input type="checkbox" id="node-input-allCommands" style="width:10px;" >
		<label for="node-input-allCommandsLabel" id="node-input-allCommandsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-commandType" placeholder="comand type e.g. blink" style="width:240px;">
    </div>

    <div class="form-row">
        <label for="node-input-format" id="node-input-formatLabel"  style="width:130px;"><i class="fa fa-file"></i> Format</label>
		<input type="checkbox" id="node-input-allFormats" style="width:10px;" >
		<label for="node-input-allFormatsLabel" id="node-input-allFormatsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-format" placeholder="format e.g. json" style="width:240px;">
    </div>

    <div class="form-row" id="node-form-qos-div">
        <label id="node-input-qos-label" for="node-input-qos" style="width:130px;"><i class="fa fa-empire"></i> QoS </label>
        <select id="node-input-qos" style="width:70px;">
            <option value=0>0</option>
            <option value=1>1</option>
            <option value=2>2</option>
        </select>
    </div>

	<div class="form-row">
        <label for="node-input-name" style="width:130px;"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="iot-new-in" style="width:300px;">
    </div>

	<div class="form-row hidden">
        <label for="node-input-service" style="width:130px;"><i class="fa fa-tag"></i> Service</label>
        <input type="text" id="node-input-service" placeholder="iot-new-out" style="width:300px;">
    </div>

    <div class="form-tips">
		<div id="registeredTips">
			Use the Input Type property to configure this node to
			receive Events sent by IoT Devices, Commands sent to IoT Devices, Status Messages referring to IoT Devices, or Status Messages referring to IoT Applications<br/>
		</div>

		<div id="quickstartTips">
			<b>Quickstart:</b> Use the Input Type property to configure this node to receive Events sent by IoT Devices, Status Messages referring to IoT Devices, or Status Messages referring to IoT Applications<br/>
		</div>

		Check the info tab, to get more information about each of the fields
	</div>

</script>





<script type="text/javascript">
	RED.nodes.registerType('ibmiot out',{
		category: 'output',
		color:"rgb(0, 155, 255)",
		defaults: {
			authentication: {value:"quickstart"},
			apiKey: {type:"ibmiot", validate: validateAuthorization},
			outputType: {value:""},
			deviceId: {value:"", required: true},
			deviceType: {value:"", required: true},
			eventCommandType: {value:"", required: true},
			format: {value:"", required: true},
			data: {value:"", required: true},
			qos: {value: 0},
			name: { value:"IBM IoT" },
			service: {value: ""}
		},
		inputs:1,
		outputs:0,
		icon: "iotcloud-icon.png",
		align: "right",
		label: function() {
			return this.name || "ibmiot out";
		},
		labelStyle: function() {
			return this.name ? "node_label_italic" : "";
		},
		oneditprepare: function() {
			var result = "";
			var noderedVersion = "";
			$.getJSON('ibmiot/service?ts=' + Math.random(), function(data) {
				var authnode = document.getElementById('node-input-authentication');
				var bluemixnode = authnode.lastElementChild;
				if(data.service !== 'registered') {
					if(bluemixnode.id === 'node-input-bounded-outnode') {
						bluemixnode.remove();
					} else {
					}

				} else {
				}
				noderedVersion = data.version;
				var serviceSelected = $("#node-input-authentication").val();
				if(serviceSelected === "quickstart") {

					result = "quickstart";

					$('#node-input-service').val(result);

					document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
					document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
					$('#node-input-eventCommandType').attr("placeholder", "event type e.g. status");

					$("#node-input-apiKey-div").hide();

					$('#node-input-outputType').val("evt");
					$("#node-input-outputTypeLabel").hide();
					$("#node-input-outputType").hide();
					$("#node-input-deviceTypeLabel").hide();
					$("#node-input-deviceType").hide();
					$("#node-input-deviceType").val(noderedVersion);
					$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
					$("#node-input-formatLabel").hide();
					$("#node-input-format").val("json");
					$("#node-input-format").hide();

					$("#registeredTips").hide();
					$("#quickstartTips").show();

                    $("#node-form-qos-div").hide();
				} else if(serviceSelected === "apiKey"){
					result = "registered";

					$("#node-input-apiKey-div").show();

					var id = $("#node-input-outputType").val();
					if (id == "evt") {
						document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
						$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
					}

					if (id == "cmd") {
						document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
						$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
					}


					$('#node-input-service').val(result);
					$("#node-input-outputTypeLabel").show();
					$("#node-input-outputType").show();
					$("#node-input-deviceTypeLabel").show();
					$("#node-input-deviceType").show();
					$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
					$("#node-input-formatLabel").show();
					$("#node-input-format").show();

                    $("#node-form-qos-div").show();

					$("#registeredTips").show();
					$("#quickstartTips").hide();

					$("#node-input-outputType").change(function() {
						var id = $("#node-input-outputType option:selected").val();
						if (id == "evt") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
						} else if (id == "cmd") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
						}
						$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
					});

				} else {
					result = "registered";

					$("#node-input-apiKey-div").hide();

					$("#node-input-apiTokenLabel").hide();
					$("#node-input-apiToken").hide();

					var id = $("#node-input-outputType").val();
					if (id == "evt") {
						document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
						$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
					}

					if (id == "cmd") {
						document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
						$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
					}

					$('#node-input-service').val(result);
					$("#node-input-outputTypeLabel").show();
					$("#node-input-outputType").show();
					$("#node-input-deviceTypeLabel").show();
					$("#node-input-deviceType").show();
					$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
					$("#node-input-formatLabel").show();
					$("#node-input-format").show();

                                        $("#node-form-qos-div").show();

					$("#registeredTips").show();
					$("#quickstartTips").hide();

					$("#node-input-outputType").change(function() {
						var id = $("#node-input-outputType option:selected").val();
						if (id == "evt") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
						} else if (id == "cmd") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
						}
						$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
					});
				}
				$("#node-input-authentication").change(function() {
					var serviceSelected = $("#node-input-authentication option:selected").val();
					if(serviceSelected === "quickstart") {

						result = "quickstart";

						$('#node-input-service').val(result);

						document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
						document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
						$('#node-input-eventCommandType').attr("placeholder", "event type e.g. status");

						$("#node-input-apiKey-div").hide();

						$('#node-input-outputType').val("evt");
						$("#node-input-outputTypeLabel").hide();
						$("#node-input-outputType").hide();
						$("#node-input-deviceTypeLabel").hide();
						$("#node-input-deviceType").hide();
						$("#node-input-deviceType").val(noderedVersion);
						$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.-]/gi, ""));
						$("#node-input-formatLabel").hide();
						$("#node-input-format").val("json");
						$("#node-input-format").hide();

						$("#registeredTips").hide();
						$("#quickstartTips").show();

                                                $("#node-form-qos-div").hide();
					} else if(serviceSelected === "apiKey"){
						result = "registered";
						$("#node-input-apiKey-div").show();

						var id = $("#node-input-outputType").val();
						if (id == "evt") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
						}

						if (id == "cmd") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
						}


						$('#node-input-service').val(result);
						$("#node-input-outputTypeLabel").show();
						$("#node-input-outputType").show();
						$("#node-input-deviceTypeLabel").show();
						$("#node-input-deviceType").show();
						$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
						$("#node-input-formatLabel").show();
						$("#node-input-format").show();

                                                $("#node-form-qos-div").show();

						$("#registeredTips").show();
						$("#quickstartTips").hide();

						$("#node-input-outputType").change(function() {
							var id = $("#node-input-outputType option:selected").val();
							if (id == "evt") {
								document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
								$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
							} else if (id == "cmd") {
								document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
								$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
							}
							$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
						});
					} else {
						result = "registered";

						$("#node-input-apiKey-div").hide();

						var id = $("#node-input-outputType").val();
						if (id == "evt") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
						}

						if (id == "cmd") {
							document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
							$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
						}

						$('#node-input-service').val(result);
						$("#node-input-outputTypeLabel").show();
						$("#node-input-outputType").show();
						$("#node-input-deviceTypeLabel").show();
						$("#node-input-deviceType").show();
						$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
						$("#node-input-formatLabel").show();
						$("#node-input-format").show();

                                                $("#node-form-qos-div").show();

						$("#registeredTips").show();
						$("#quickstartTips").hide();

						$("#node-input-outputType").change(function() {
							var id = $("#node-input-outputType option:selected").val();
							if (id == "evt") {
								document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-tachometer"></i> Event Type</label>';
								$('#node-input-eventCommandType').attr("placeholder", "event type e.g. blink");
							} else if (id == "cmd") {
								document.getElementById('node-input-eventCommandTypeId').innerHTML='<i class="fa fa-legal"></i> Command Type</label>';
								$('#node-input-eventCommandType').attr("placeholder", "command type e.g. blink");
							}
							$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
						});
					}
				});
			});
		}
	});

	function validateAuthorization(v) {
		return this.authentication !== "quickstart" || this.authentication !== "boundService";
	}

</script>

<script type="text/javascript">
	RED.nodes.registerType('ibmiot in',{
		category: 'input',
		color:"rgb(0, 155, 255)",
		defaults: {
			authentication: {value:"quickstart"},
			apiKey: {type:"ibmiot", validate: validateAuthorization},
			inputType: {value:"evt"},
			logicalInterface: {value:""},
			ruleId: {value:""},
			deviceId: {value:""},
			applicationId: {value:""},
			deviceType: {value:""},
			eventType: {value:""},
			commandType: {value:""},
			format: {value:""},
			name: { value:"IBM IoT" },
			service: {value:""},
			allDevices: {value: ""},
			allApplications: {value: ""},
			allDeviceTypes: {value: ""},
			allLogicalInterfaces: {value: ""},
			allEvents: {value: ""},
			allCommands: {value: ""},
			allFormats: {value: ""},
            qos: {value: 0},

		},
		inputs:0,
		outputs:1,
		icon: "iotcloud-icon.png",
		label: function() {
			return this.name || "iot-new-in";
		},
		labelStyle: function() {
				return this.name ? "node_label_italic" : "";
		},
		oneditprepare: function() {

			var hideAllRuleInput = function() {
				$('#node-input-logicalInterfaceLabel').hide();				
				$("#node-input-allLogicalInterfaces").hide();
				$("#node-input-allLogicalInterfacesLabel").hide();				
				$("#node-input-logicalInterface").hide();

				$('#node-input-ruleIdLabel').hide();				
				$("#node-input-allRules").hide();
				$("#node-input-allRulesLabel").hide();
				$("#node-input-ruleId").hide();
			};

			var showTypeIdDeviceIdInput = function() {
				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-allDevicesLabel").show();

				$('#node-input-deviceIdLabel').show();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceId').show();				
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';				
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");

				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-allDevicesLabel").show();
			}

			var hideAllInputsAndLabels = function() {
				hideAllRuleInput();
				$('#node-input-deviceIdLabel').hide();
				$("#node-input-deviceId").hide();
				$('#node-input-applicationIdLabel').hide();
				$('#node-input-allApplicationsLabel').hide();
				$('#node-input-allApplications').hide();
				$('#node-input-applicationId').hide();
				$("#node-input-eventLabel").hide();
				$("#node-input-allEvents").hide();
				$("#node-input-allEventsLabel").hide();
				$("#node-input-eventType").hide();
				$("#node-input-commandLabel").hide();
				$("#node-input-allCommands").hide();
				$("#node-input-allCommandsLabel").hide();
				$("#node-input-commandType").hide();
				$("#node-input-formatLabel").hide();
				$("#node-input-format").hide();
				$("#node-input-allFormats").hide();
				$("#node-input-allFormatsLabel").hide();
				$("#node-input-deviceTypeLabel").hide();
				$("#node-input-deviceType").hide();
				$("#node-input-allDeviceTypes").hide();
				$("#node-input-allDeviceTypesLabel").hide();
				$("#node-input-allDevices").hide();
				$("#node-input-allDevicesLabel").hide();
			}

			/*
			 * Function to configure the events panel for registered
			*/
			var onEvtSelectedREG = function() {
				hideAllInputsAndLabels();
				$('#node-input-deviceIdLabel').show();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceId').show();
				document.getElementById('node-input-eventLabel').innerHTML='<i class="fa fa-tasks"></i> Event';
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
				$('#node-input-eventType').attr("placeholder", "event type e.g. status");
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");
				$("#node-input-eventLabel").show();
				$("#node-input-allEvents").show();
				$("#node-input-allEventsLabel").show();
				$("#node-input-eventType").show();
				$("#node-input-formatLabel").show();
				$("#node-input-format").show();
				$("#node-input-allFormats").show();
				$("#node-input-allFormatsLabel").show();
				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-allDevicesLabel").show();
			};

			var onEvtSelectedQS = function() {
				hideAllInputsAndLabels();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceIdLabel').show();
				$('#node-input-deviceId').show();
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");
			};

			/*
			 * Function to configure the device status panel for registered
			*/
			var onDevStsSelectedREG = function() {
				hideAllInputsAndLabels();
				$('#node-input-deviceIdLabel').show();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceId').show();
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");
				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-allDevicesLabel").show();
			};

			var onDevStsSelectedQS = function() {
				hideAllInputsAndLabels();
				$('#node-input-deviceIdLabel').show();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceId').show();
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");
			};

			/*
			 * Function to configure the cmd panel for registered
			*/
			var onCmdSelectedREG = function() {
				hideAllInputsAndLabels();
				$('#node-input-deviceIdLabel').show();
				$("#node-input-deviceId").val($("#node-input-deviceId").val().trim().replace(/[^a-zA-Z0-9_\.\-]/gi, ""));
				$('#node-input-deviceId').show();
				document.getElementById('node-input-eventLabel').innerHTML='<i class="fa fa-tasks"></i> Command';
				document.getElementById('node-input-deviceIdLabel').innerHTML='<i class="fa fa-street-view"></i> Device Id</label>';
				$('#node-input-eventType').attr("placeholder", "command type e.g. blink");
				$('#node-input-deviceId').attr("placeholder", "device id e.g. ab12cd231a21");
				$("#node-input-commandLabel").show();
				$("#node-input-allCommands").show();
				$("#node-input-allCommandsLabel").show();
				$("#node-input-commandType").show();
				$("#node-input-formatLabel").show();
				$("#node-input-format").show();
				$("#node-input-allFormats").show();
				$("#node-input-allFormatsLabel").show();
				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-allDevicesLabel").show();
			};

			/*
			 * Function to configure the app status for registered
			*/
			var onAppStsSelectedREG = function() {
				hideAllInputsAndLabels();
				$('#node-input-applicationIdLabel').show();
				$('#node-input-allApplicationsLabel').show();
				$('#node-input-allApplications').show();
				$('#node-input-applicationId').show();
				document.getElementById('node-input-applicationIdLabel').innerHTML='<i class="fa fa-tasks"></i> App Id</label>';
				$('#node-input-applicationId').attr("placeholder", "app id e.g. myapp02");
				$('#node-input-deviceId').attr("placeholder", "app id e.g. myapp02");
			};

			var onAppStsSelectedQS = function() {
				hideAllInputsAndLabels();
				$('#node-input-applicationIdLabel').show();
				$('#node-input-applicationId').show();
				document.getElementById('node-input-applicationIdLabel').innerHTML='<i class="fa fa-tasks"></i> App Id</label>';
				$('#node-input-applicationId').attr("placeholder", "app id e.g. myapp02");
			};

			var showLIInput = function() {
				$('#node-input-logicalInterfaceLabel').show();				
				$("#node-input-allLogicalInterfaces").show();
				$("#node-input-allLogicalInterfacesLabel").show();
				$("#node-input-logicalInterface").show();
			};

			var onRuleSelectREG = function() {
				hideAllInputsAndLabels();
				showLIInput();

				$('#node-input-ruleIdLabel').show();
				$("#node-input-allRules").show();
				$("#node-input-allRulesLabel").show();
				$("#node-input-ruleId").show();
			};

			var onDeviceStateSelectREG = function() {
				hideAllInputsAndLabels();
				showTypeIdDeviceIdInput();
				showLIInput();
			};

			var onDeviceStateErrSelectREG = function() {
				hideAllInputsAndLabels();
				showTypeIdDeviceIdInput();
			};

			/*
			 * Function to disable/enable input fields based on the value of the associated 'All' checkbox
			*/
			var configureCheckBoxInputs = function() {
				var allInterfacesValue = $("#node-input-allLogicalInterfaces").is(":checked");
				if( allInterfacesValue) {
					$("#node-input-logicalInterface").prop("disabled", true);
				} else {
					$("#node-input-logicalInterface").prop("disabled", false);
				}

				var allRulesValue = $("#node-input-allRules").is(":checked");
				if( allRulesValue) {
					$("#node-input-ruleId").prop("disabled", true);
				} else {
					$("#node-input-ruleId").prop("disabled", false);
				}

				$("#node-input-allLogicalInterfaces").change(function() {
					if($("#node-input-allLogicalInterfaces").is(":checked")) {
						$("#node-input-logicalInterface").prop("disabled", true);
					} else {
						$("#node-input-logicalInterface").prop("disabled", false);
					}
				});

				$("#node-input-allRules").change(function() {
					if($("#node-input-allRules").is(":checked")) {
						$("#node-input-ruleId").prop("disabled", true);
					} else {
						$("#node-input-ruleId").prop("disabled", false);
					}
				});

				var allDevicesValue = $("#node-input-allDevices").is(":checked");
				if( allDevicesValue) {
					$("#node-input-deviceId").prop("disabled", true);
				} else {
					$("#node-input-deviceId").prop("disabled", false);
				}
				$("#node-input-allDevices").change(function() {
					if($("#node-input-allDevices").is(":checked")) {
						$("#node-input-deviceId").prop("disabled", true);
					} else {
						$("#node-input-deviceId").prop("disabled", false);
					}
				});

				var allApplicationsValue = $("#node-input-allApplications").is(":checked");
				if( allApplicationsValue) {
					$("#node-input-applicationId").prop("disabled", true);
				} else {
					$("#node-input-applicationId").prop("disabled", false);
				}
				$("#node-input-allApplications").change(function() {
					if($("#node-input-allApplications").is(":checked")) {
						$("#node-input-applicationId").prop("disabled", true);
					} else {
						$("#node-input-applicationId").prop("disabled", false);
					}
				});

				var allDeviceTypesValue = $("#node-input-allDeviceTypes").is(":checked");
				if( allDeviceTypesValue) {
					$("#node-input-deviceType").prop("disabled", true);
				} else {
					$("#node-input-deviceType").prop("disabled", false);
				}
				$("#node-input-allDeviceTypes").change(function() {
					if($("#node-input-allDeviceTypes").is(":checked")) {
						$("#node-input-deviceType").prop("disabled", true);
					} else {
						$("#node-input-deviceType").prop("disabled", false);
					}
				});

				var allEventsValue = $("#node-input-allEvents").is(":checked");
				if( allEventsValue) {
					$("#node-input-eventType").prop("disabled", true);
				} else {
					$("#node-input-eventType").prop("disabled", false);
				}
				$("#node-input-allEvents").change(function() {
					if($("#node-input-allEvents").is(":checked")) {
						$("#node-input-eventType").prop("disabled", true);
					} else {
						$("#node-input-eventType").prop("disabled", false);
					}
				});

				var allCommandsValue = $("#node-input-allCommands").is(":checked");
				if( allCommandsValue) {
					$("#node-input-commandType").prop("disabled", true);
				} else {
					$("#node-input-commandType").prop("disabled", false);
				}
				$("#node-input-allCommands").change(function() {
					if($("#node-input-allCommands").is(":checked")) {
						$("#node-input-commandType").prop("disabled", true);
					} else {
						$("#node-input-commandType").prop("disabled", false);
					}
				});

				var allFormatsValue = $("#node-input-allFormats").is(":checked");
				if( allFormatsValue) {
					$("#node-input-format").prop("disabled", true);
				} else {
					$("#node-input-format").prop("disabled", false);
				}
				$("#node-input-allFormats").change(function() {
					if($("#node-input-allFormats").is(":checked")) {
						$("#node-input-format").prop("disabled", true);
					} else {
						$("#node-input-format").prop("disabled", false);
					}
				});

				if(!$("#node-input-qos option:selected").length) {
					document.getElementById("node-input-qos").options[0].selected = true;
				}
			};

			var configureCheckboxInputsQS = function() {
				var allDevicesValue = $("#node-input-allDevices").is(":checked");
				if( allDevicesValue) {
					$("#node-input-deviceId").prop("disabled", false);
				}

				var allDeviceTypesValue = $("#node-input-allDeviceTypes").is(":checked");
				if( allDeviceTypesValue) {
					$("#node-input-deviceType").prop("disabled", false);
				}

				var allEventsValue = $("#node-input-allEvents").is(":checked");
				if( allEventsValue) {
					$("#node-input-eventType").prop("disabled", false);
				}

				var allFormatsValue = $("#node-input-allFormats").is(":checked");
				if( allFormatsValue) {
					$("#node-input-format").prop("disabled", false);
				}

				var inputTypeSelected = $("#node-input-inputType").val();
				if( inputTypeSelected == "cmd") {
					$("#node-input-inputType").val("evt");
				}
			}

			var defaultShowInputs = function(serviceSelected) {
				if( serviceSelected === "boundService" ) {
					$("#node-input-apiKey-div").hide();
				} else {
					$("#node-input-apiKey-div").show();
				}

				$('#node-input-service').val(result);
				$("#node-input-inputTypeCmd").show();
				$("#node-input-inputTypeDeviceState").show();
				$("#node-input-inputTypeDeviceStateErr").show();
				$("#node-input-inputTypeRuleT").show();
				$("#node-input-inputTypeRuleE").show();
				$("#node-input-inputType").show();
				$("#node-input-allDevicesLabel").show();
				$("#node-input-allDevices").show();
				$("#node-input-deviceTypeLabel").show();
				$("#node-input-deviceType").show();
				$("#node-input-allDeviceTypesLabel").show();
				$("#node-input-allDeviceTypes").show();
				$("#node-input-eventLabel").show();
				$("#node-input-eventType").show();
				$("#node-input-allEventsLabel").show();
				$("#node-input-allEvents").show();
				$("#node-input-formatLabel").show();
				$("#node-input-format").show();
				$("#node-input-allFormatsLabel").show();
				$("#node-input-allFormats").show();
				$("#node-form-qos-div").show();

				$("#registeredTips").show();
				$("#quickstartTips").hide();
				onRuleSelectREG();
			}

			var defaultShowInputsQS = function() {
				$('#node-input-service').val(result);

				$("#node-input-inputTypeCmd").hide();
				$("#node-input-inputTypeDeviceState").hide();
				$("#node-input-inputTypeDeviceStateErr").hide();
				$("#node-input-inputTypeRuleT").hide();
				$("#node-input-inputTypeRuleE").hide();
				$("#node-input-allDevicesLabel").hide();
				$("#node-input-allDevices").prop("checked", false);
				$("#node-input-allDevices").hide();

				$("#node-input-allApplicationsLabel").hide();
				$("#node-input-allApplications").prop("checked", false);
				$("#node-input-allApplications").hide();

				$("#node-input-deviceTypeLabel").hide();
				$("#node-input-deviceType").val("+");
				$("#node-input-deviceType").hide();
				$("#node-input-allDeviceTypesLabel").hide();
				$("#node-input-allDeviceTypes").prop("checked", true);
				$("#node-input-allDeviceTypes").hide();
				$("#node-input-eventLabel").hide();
				$("#node-input-eventType").val("+");
				$("#node-input-eventType").hide();
				$("#node-input-allEventsLabel").hide();
				$("#node-input-allEvents").prop("checked", true);
				$("#node-input-allEvents").hide();
				$("#node-input-formatLabel").hide();
				$("#node-input-format").val("json");
				$("#node-input-format").hide();
				$("#node-input-allFormatsLabel").hide();
				$("#node-input-allFormats").hide();

				$("#node-input-commandLabel").hide();
				$("#node-input-allCommands").hide();
				$("#node-input-allCommandsLabel").hide();
				$("#node-input-commandType").hide();

				$("#registeredTips").hide();
				$("#quickstartTips").show();
			}

			var configureInput = function() {
				var id = $("#node-input-inputType").val();
				if (id == "evt") {
					onEvtSelectedREG();
				} else if (id == "devsts"){
					onDevStsSelectedREG();
				} else if (id == "cmd"){
					onCmdSelectedREG();
				} else if (id == "appsts") {
					onAppStsSelectedREG();
				} else if (id == "ruletrig") {
					onRuleSelectREG();
				} else if (id == "ruleerr") {
					onRuleSelectREG();
				} else if (id == "devicestate"){
					onDeviceStateSelectREG();
				} else if (id == "devicestateerr"){
					onDeviceStateErrSelectREG();
				} else {

				}
			};

			var configureInputQS = function() {
				var id = $("#node-input-inputType").val();
				if (id == "evt") {
					onEvtSelectedQS();
				}

				if (id == "devsts") {
					onDevStsSelectedQS();
				}

				if (id == "appsts") {
					onAppStsSelectedQS();
				}
			};

			result = "";

			var noderedVersion = "";
			$.getJSON('ibmiot/service?ts=' + Math.random(), function(data) {
				var authnode = document.getElementById('node-input-authentication');
				var bluemixnode = authnode.lastElementChild;

				if(data.service !== 'registered') {
					noderedVersion = data.version;

					if(bluemixnode.id === 'node-input-bounded-innode') {
						bluemixnode.remove();
					}
				}
			});

			var serviceSelected = $("#node-input-authentication").val();

			if(serviceSelected === "quickstart") {
				result = "quickstart";

                $("#node-input-apiKey-div").hide();

				configureInputQS();
				defaultShowInputsQS();
				configureCheckboxInputsQS();

				$("#node-input-inputType").change(function() {
					configureInputQS();
				});

                $("#node-form-qos-div").hide();
			} else {

				result = "registered";

				defaultShowInputs(serviceSelected);
				configureCheckBoxInputs();
				configureInput();

				$("#node-input-inputType").change(function() {
					configureCheckBoxInputs();
					configureInput();
				});
			}

			$("#node-input-authentication").change(function() {
				var serviceSelected = $("#node-input-authentication option:selected").val();				

				if(serviceSelected === "quickstart") {
					result = "quickstart";

					$("#node-input-apiKey-div").hide();

					configureInputQS();
					defaultShowInputsQS();
					configureCheckboxInputsQS();

					$("#node-input-inputType").change(function() {
						configureCheckBoxInputs();
						configureInputQS();
					});
				} else {

					result = "registered";

					defaultShowInputs(serviceSelected);
					configureCheckBoxInputs();
					configureInput();

					$("#node-input-inputType").change(function() {
						configureCheckBoxInputs();
						configureInput();
					});
				}

			});

		}
	});

	function validateAuthorization(v) {
		return this.authentication !== "quickstart" || this.authentication !== "boundService";
	}

</script>
<script type="text/x-red" data-help-name="ibmiot">
  <p> To use Shared subscription, check <b>Scalable</b> and provide the <b>Application ID</b>. The <b>Application ID</b> must be same across different clients.
</script><script type="text/x-red" data-help-name="ibmiot out">
   <p>Output node that can be used with Watson IoT Platform to send a commands to a device or send an event on behalf of a device </p>
   <p>The following message properties take precedence and override the values configured in the node:
   <p><b>msg.deviceId </b> overrides the value of "Device Id"</p>
   <p><b>msg.deviceType</b> overrides the value of "Device Type"</p>
   <p><b>msg.eventOrCommandType</b> overrides the value of "Event Type" or "Command Type"</p>
   <p><b>msg.format</b> overrides the value of "Format". This Node supports json, buffer and other types. When the format is set to json, this node expects either an object or Stringify version of the json object. In order to send the buffer and other types, just send the contents as is without doing any conversion and set the format appropriately.</p>
   <p><b>msg.payload</b> overrides the value of "Data"</p>
   <p>In Non-Quickstart mode, value for QoS (Quality of Service) and connection
      keep alive interval value can be specified.
   </p>
   <p>The <b>Quality of Service (QoS)</b> level is an agreement between sender
      and receiver of a message regarding the guarantees of delivering a message.
      There are 3 QoS levels in MQTT: 0,1,2. Client can choose the QoS level
      depending on its network reliability and application logic.
   </p>
   <p>
      The <b>keep alive</b> functionality assures that the connection is still open and
      both Watson IoT Platform and client are connected to one another. Therefore the client
      species a time interval in seconds and communicates it to the Watson IoT Platform during
      the establishment of the connection. The interval is the longest possible
      period of time, which Watson IoT Platform and client can endure without sending a message.
   </p>
   <p>The <b>Server-Name</b> property can be optionally used to specify the Watson IoT Platform messaging endpoint name. By default the value is "[organization id].messaging.internetofthings.ibmcloud.com"(Watson IoT Production server). The mqtt_host property of the Watson IoT service credentials carries the value of the messaging endpoint name.</p>
   <p>
       A <b>persistent session</b> can be requested by the client on connection establishment with the Watson IoT Platform using the <b>cleanSession</b> Flag.
       If the clean session is set to <b>true</b> then the client does not have a persistent session and all information are lost when the client disconnects for any reason.
       When clean session is set to <b>false</b>, a persistent session is created and it will be preserved until the client requests a clean session again.
       If there is already a session available then it is used and queued messages will be delivered to the client if available. For more information, refer to Watson IoT Platform documentation.
    </p>
   <p><b>Note:</b>Some of the functions of this node are not available when it is running in <b>Quickstart</b> Mode.</p>
</script><script type="text/x-red" data-help-name="ibmiot in">
	<p>Input node that can be used with Watson IoT Platform to receive events sent from devices, receive commands sent to devices,  or receive status updates concerning devices or applications. It produces an object called msg and sets <b>msg.payload</b> to be a String containing the payload of the incoming message.</p>
	<p>The value of "Device Id" is stored in <b>msg.deviceId</b></p>
	<p>The value of "Application Id" is stored in <b>msg.applicationId</b></p>
	<p>The value of "Device Type" is stored in  <b>msg.deviceType</b></p>
	<p>The value of "Event Type" is stored in  <b>msg.eventType</b></p>
	<p>The value of "Command Type" is stored in <b>msg.commandType</b></p>
	<p>The value of "Format" is stored in <b>msg.format</b>. This node supports json, buffer and other types. When the format is set to json, this node parses the incoming data using JSON.parse() and outputs. When the buffer object is received by this node, it outputs the contents as is without any conversion. And for remaining types, this node outputs the message in String. </p>
  <p>In Non-Quickstart mode, value for QoS (Quality of Service) and connection
     keep alive interval value can be specified.
  </p>
  <p>The <b>Quality of Service (QoS)</b> level is an agreement between sender
     and receiver of a message regarding the guarantees of delivering a message.
     There are 3 QoS levels in MQTT: 0,1,2. Client can choose the QoS level
     depending on its network reliability and application logic.
  </p>
  <p>
     The <b>keep alive</b> functionality assures that the connection is still open and
     both Watson IoT Platform and client are connected to one another. Therefore the client
     species a time interval in seconds and communicates it to the Watson IoT Platform during
     the establishment of the connection. The interval is the longest possible
     period of time, which Watson IoT Platform and client can endure without sending a message.
  </p>
  <p>The <b>Server-Name</b> property can be optionally used to specify the Watson IoT Platform messaging endpoint name. By default the value is "[organization id].messaging.internetofthings.ibmcloud.com"(Watson IoT Production server). The mqtt_host property of the Watson IoT service credentials carries the value of the messaging endpoint name.</p>
  <p>
       A <b>persistent session</b> can be requested by the client on connection establishment with the Watson IoT Platform using the <b>cleanSession</b> Flag.
       If the clean session is set to <b>true</b> then the client does not have a persistent session and all information are lost when the client disconnects for any reason.
       When clean session is set to <b>false</b>, a persistent session is created and it will be preserved until the client requests a clean session again.
       If there is already a session available then it is used and queued messages will be delivered to the client if available. For more information, refer to Watson IoT Platform documentation.
   </p>
	<p><b>Note:</b>Some of the functions of this node are not available when it is running in <b>Quickstart</b> Mode.</p>
</script>
<!-- --- [red-module:node-red-node-cf-cloudant/cloudant-cf] --- -->
<!--
  Copyright 2014,2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="cloudant">
    <div class="form-row">
        <label for="node-config-input-host"><i class="fa fa-bookmark"></i> Host</label>
        <input class="input-append-left" type="text" id="node-config-input-host" placeholder="[username].cloudant.com or http://your-server.com">
    </div>
    <div class="form-row">
        <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-config-input-username">
    </div>
    <div class="form-row">
        <label for="node-config-input-pass"><i class="fa fa-lock"></i> Password</label>
        <input type="password" id="node-config-input-pass">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType("cloudant",{
        category: "config",
        color: "rgb(114, 199, 231)",
        defaults: {
            host: {value:"", required:true},
            name: {value:""}
        },
        credentials: {
            username: {type:"text"},
            pass: {type:"password"}
        },
        label: function() {
            return this.name || this.host;
        }
    });
</script>

<script type="text/x-red" data-template-name="cloudant out">
    <div class="form-row">
        <label for="node-input-service"><i class="fa fa-folder-close"></i> Service</label>
        <select id="node-input-service" style="width:68%;">
            <!-- <option value="" disabled></option> -->
            <option value="_ext_"> External cloudant or couchdb service</option>
        </select>
    </div>
    <div class="form-row hide" id="node-input-external-details">
        <label for="node-input-cloudant"><i class="fa fa-bookmark"></i> Server</label>
        <input type="text" id="node-input-cloudant">
    </div>
    <div class="form-row">
        <label for="node-input-database"><i class="fa fa-briefcase"></i> Database</label>
        <input type="text" id="node-input-database" placeholder="database" style="width:65%;">
    </div>
    </div>
        <div class="form-row">
        <label for="node-input-operation"><i class="fa fa-wrench"></i> Operation</label>
        <select type="text" id="node-input-operation" style="width:68%;">
            <option value="insert">insert</option>
            <option value="delete">remove</option>
        </select>
    </div>
    <div class="form-row node-input-payonly">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-payonly" placeholder="Only"
               style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-payonly" style="width:65%;">Only store msg.payload object?</label>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:65%;">
    </div>
    <script>
        $("#node-input-operation").change(function() {
            var id = $("#node-input-operation option:selected").val();
            if (id == "delete") $(".node-input-payonly").hide();
            else $(".node-input-payonly").show();
        });
    </script>


<script type="text/x-red" data-template-name="cloudant in">
    <div class="form-row">
        <label for="node-input-service"><i class="fa fa-folder-close"></i> Service</label>
        <select id="node-input-service" style="width:68%;">
            <!-- <option value="" disabled></option> -->
            <option value="_ext_"> External cloudant or couchdb service</option>
        </select>
    </div>
    <div class="form-row hide" id="node-input-external-details">
        <label for="node-input-cloudant"><i class="fa fa-bookmark"></i> Server</label>
        <input type="text" id="node-input-cloudant">
    </div>
    <div class="form-row">
        <label for="node-input-database"><i class="fa fa-briefcase"></i> Database</label>
        <input type="text" id="node-input-database" placeholder="database" style="width:65%;">
    </div>
    <div class="form-row">
        <label for="node-input-search"><i class="fa fa-search"></i> Search by</label>
        <select id="node-input-search" style="width:68%;">
            <option value="_id_">_id</option>
            <option value="_idx_">search index</option>
            <option value="_all_">all documents</option>
        </select>
    </div>
    <div id="node-search-index-form" class="form-row">
        <label>&nbsp;</label>
        <input type="text" id="node-input-design" style="width:30%" placeholder="design document">
        /
        <input type="text" id="node-input-index" style="width:30%" placeholder="index name">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:65%;">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType("cloudant out", {
        category: "storage-output",
        color: "rgb(114, 199, 231)",
        defaults: {
            name: { value: "" },
            cloudant: { type:"cloudant", validate:validateServer},
            database: { value:"", required:true, validate:validateDatabase },
            service: { value:"", required:true },
            payonly: { value:false },
            operation: { value:"insert" }
        },
        inputs: 1,
        outputs: 0,
        icon: "cloudant.png",
        align: "right",
        label: label,
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: oneditprepare
    });

    RED.nodes.registerType("cloudant in", {
        category: "storage-input",
        color: "rgb(114, 199, 231)",
        defaults: {
            name    : { value:"" },
            cloudant: { type:"cloudant", validate:validateServer },
            database: { value:"", required:true, validate:validateDatabase },
            service : { value:"", required:true },
            search  : { value:"_id_", required:true },
            design  : { value:"" },
            index   : { value:"" }
        },
        inputs : 1,
        outputs: 1,
        icon   : "cloudant.png",
        label  : label,
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: oneditprepare
    });

    function oneditprepare() {
        var node = this;
        var serviceSelect  = $('#node-input-service');
        var searchBySelect = $('#node-input-search');
        var searchForm     = $('#node-search-index-form');

        $.getJSON('cloudant/vcap/',function(data) {
            var last = serviceSelect.children().last();
            var opts = [];

            for (var i=0; i < data.length; i++) {
                var selected = node.service == data[i].name;
                opts.push('<option value="' + data[i].name + '"' + (selected ? " selected":"") + '>' + data[i].name + '</option>');
            }

            if (opts.length == 0) {
                node.service = "_ext_";
                serviceSelect.find("option").filter(function() {
                    return $(this).val() == node.service;
                }).attr('selected', true);
            } else {
                last.before(opts.join(""));
            }

            serviceSelect.change();
        });

        serviceSelect.change(function() {
            var service = serviceSelect.val();
            if (service == "_ext_") {
                $("#node-input-external-details").show();
            } else {
                $("#node-input-external-details").hide();
            }
        });

        searchBySelect.change(function() {
            var searchBy = searchBySelect.val();

            if (searchBy === "_idx_") {
                node._def.defaults.design.required = true;
                node._def.defaults.index.required  = true;
                searchForm.show();
            } else {
                node._def.defaults.design.required = false;
                node._def.defaults.index.required  = false;
                searchForm.hide();
            }
        });
    }

    function label() {
        return this.name || this.database || "cloudant";
    }

    function validateServer(v) {
        return this.service != "_ext_" || v != "_ADD_";
    }

    // https://wiki.apache.org/couchdb/HTTP_database_API#Naming_and_Addressing
    function validateDatabase(v) {
        return (v.indexOf('_') !== 0) && (v.search(/[A-Z\s\\/]/g) < 0)
    }
</script>




<script type="text/x-red" data-help-name="cloudant out">
   <p>
       A simple Cloudant output node. Stores <b>msg</b> in a chosen database.
    </p>
   <p>
       Cloudant generates a random id for the <code>_id</code> property if one
       is not specified and a new document will be <b>inserted</b> each time.
       You can <b>insert</b> only the <code>msg.payload</code> by checking the
       checkbox in the configuration window.
   </p>
   <p>
       If you want to <b>update</b> an existing document you must specify the
       latest values for <code>_id</code> and <code>_rev</code> in your object.
       If they don't match the current values stored in the database you will
       receive a <b>conflict error</b> message, so make sure you are using the
       most updated information for the document.
    </p>
    <p>
        It is also possible to <b>delete</b> documents from the database by
        providing values for <code>_id</code> and <code>_rev</code> and selecting
        the <b>remove</b> option for the node. You can pass these values in the
        <code>msg</code> object itself or as an object in the
        <code>msg.payload</code>.
    </p>
    <p>
        The <b>database name</b> must follow these rules:
        <ul>
            <li>No spaces</li>
            <li>All letters in small caps</li>
            <li>The first character can't be <code>_</code></li>
        </ul>
    </p>
    <p>
        Your document should avoid having top-level fields that start with
        <code>_</code>, with exceptions for <code>_id</code>, <code>_rev</code>
        and other <a href="https://wiki.apache.org/couchdb/HTTP_Document_API#Special_Fields">
        CouchDB reserved words</a>.
    </p>
</script><script type="text/x-red" data-help-name="cloudant in">
   <p>
        A node for searching documents in a Cloudant database.
    </p>
    <p>
        Searching for documents can be done in three modes: directly by using the
        document's <b>_id</b>, by using an existing <a
        href="https://cloudant.com/for-developers/search/" target="_blank">Search
        Index</a> or retrieving <b>all documents</b> stored in your database.
    </p>
    <p>
        When querying using the <b>_id</b> option, the value for the document's
        <code>_id</code> should be passed in the <code>msg.payload</code> as a
        string.
    </p>
    <p>
        To use an existing <b>Search Index</b> stored on the desired database,
        the query argument should be passed on the <code>msg.payload</code> as a
        string following the <code>indexName:value</code> pattern. Keep in mind
        that <i>the index must be created beforehand in the database.</i> and
        referenced here by its <code>design document/index name</code>.
    </p>
    <p>
        When querying using a <b>Search Index</b> you can pass the search
        parameters as an object in <code>msg.payload</code>.
    </p>
    <p>
        For example, you can pass an object like this:
    <p>
        <code>{ query: "abc*", limit: 100 }</code>
    </p>
    <p>
        to change the value of <code>limit</code>. You can find more information
        about <b>Search Index</b> parameters in the <a
        href="https://docs.cloudant.com/api.html?http#queries" target="_blank">
        official Cloudant documentation</a>.
    </p>
    <p>
        The last method to retrieve documents is to simply get all of them by
        selecting the option <b>all documents</b>.
    </p>
    <p>
        The <b>database name</b> must follow these rules:
        <ul>
            <li>No spaces</li>
            <li>All letters in small caps</li>
            <li>The first character can't be <code>_</code></li>
        </ul>
    </p>
</script>
<!-- --- [red-module:node-red-node-email/email] --- -->

<script type="text/x-red" data-template-name="e-mail">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-envelope"></i> <span data-i18n="email.label.to"></span></label>
        <input type="text" id="node-input-name" placeholder="email@address.com">
    </div>
    <!-- <div class="form-row">
        <label for="node-input-pin"><i class="fa fa-asterisk"></i> Service</label>
        <select type="text" id="node-input-pin" style="width: 150px;">
            <option value="-" disabled> </option>
            <option value="DynectEmail">DynectEmail</option>
            <option value="Gmail">Gmail</option>
            <option value="hot.ee">hot.ee</option>
            <option value="Hotmail">Hotmail</option>
            <option value="iCloud">iCloud</option>
            <option value="mail.ee">mail.ee</option>
            <option value="Mail.Ru">Mail.Ru</option>
            <option value="Mailgun">Mailgun</option>
            <option value="Mailjet">Mailjet</option>
            <option value="Mandrill">Mandrill</option>
            <option value="Postmark">Postmark</option>
            <option value="QQ">QQ</option>
            <option value="QQex">QQex</option>
            <option value="SendGrid">SendGrid</option>
            <option value="SendCloud">SendCloud</option>
            <option value="SES">SES</option>
            <option value="Yahoo">Yahoo</option>
            <option value="yandex">yandex</option>
            <option value="Zoho">Zoho</option>
         </select>
    </div> -->
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> <span data-i18n="email.label.server"></span></label>
        <input type="text" id="node-input-server" placeholder="smtp.gmail.com">
    </div>
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-random"></i> <span data-i18n="email.label.port"></span></label>
        <input type="text" id="node-input-port" placeholder="465" style="width:100px">
        <label style="width:40px"> </label>
        <input type="checkbox" id="node-input-secure" style="display:inline-block; width:20px; vertical-align:baseline;">
        <span data-i18n="email.label.useSecureConnection"></span>
    </div>
    <div class="form-row">
        <label for="node-input-userid"><i class="fa fa-user"></i> <span data-i18n="email.label.userid"></span></label>
        <input type="text" id="node-input-userid">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-lock"></i> <span data-i18n="email.label.password"></span></label>
        <input type="password" id="node-input-password">
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-dname"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-dname" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <div class="form-tips" id="node-tip"><span data-i18n="[html]email.tip.cred"></span></div>
</script>



<script type="text/javascript">
(function() {
    RED.nodes.registerType('e-mail',{
        category: 'social-output',
        color:"#c7e9c0",
        defaults: {
            server: {value:"smtp.gmail.com",required:true},
            port: {value:"465",required:true},
            secure: {value: true},
            name: {value:""},
            dname: {value:""}
        },
        credentials: {
            userid: {type:"text"},
            password: {type: "password"},
            global: { type:"boolean"}
        },
        inputs:1,
        outputs:0,
        icon: "envelope.png",
        align: "right",
        paletteLabel: function() {
            return this._("email.email");
        },
        label: function() {
            return this.dname||this.name||"email";
        },
        labelStyle: function() {
            return (this.dname)?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.credentials.global) {
                $('#node-tip').show();
            } else {
                $('#node-tip').hide();
            }
        }
    });
})();
</script>


<script type="text/x-red" data-template-name="e-mail in">
    <div class="form-row node-input-repeat">
        <label for="node-input-repeat"><i class="fa fa-repeat"></i> <span data-i18n="email.label.repeat"></span></label>
        <input type="text" id="node-input-repeat" style="width: 80px"> <span data-i18n="email.label.seconds">seconds</span>
    </div>
    <div class="form-row">
        <label for="node-input-protocol"><i class="fa fa-envelope"></i> <span data-i18n="email.label.protocol"></span></label>
        <select type="text" id="node-input-protocol">
            <option value="IMAP">IMAP</option>
            <option value="POP3">POP3</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-useSSL"><i class="fa fa-lock"></i> <span data-i18n="email.label.useSSL"></span></label>
        <input type="checkbox" id="node-input-useSSL" style="width: auto;">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> <span data-i18n="email.label.server"></span></label>
        <input type="text" id="node-input-server" placeholder="imap.gmail.com">
    </div>
    <div class="form-row">
        <label for="node-input-port"><i class="fa fa-random"></i> <span data-i18n="email.label.port"></span></label>
        <input type="text" id="node-input-port" placeholder="993">
    </div>
    <div class="form-row">
        <label for="node-input-userid"><i class="fa fa-user"></i> <span data-i18n="email.label.userid"></span></label>
        <input type="text" id="node-input-userid">
    </div>
    <div class="form-row">
        <label for="node-input-password"><i class="fa fa-lock"></i> <span data-i18n="email.label.password"></span></label>
        <input type="password" id="node-input-password">
    </div>
    <div class="form-row node-input-box">
        <label for="node-input-box"><i class="fa fa-inbox"></i> <span data-i18n="email.label.folder"></span></label>
        <input type="text" id="node-input-box">
    </div>
    <div class="form-row node-input-disposition">
            <label for="node-input-disposition"><i class="fa fa-trash"></i> <span data-i18n="email.label.disposition"></span></label>
        <select type="text" id="node-input-disposition">
            <option value="None" selected="selected" data-i18n="email.label.none"></option>
            <option value="Read" data-i18n="email.label.read"></option>
            <option value="Delete" data-i18n="email.label.delete"></option>
        </select>
    </div>
    <br/>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <script>
        var checkPorts = function() {
            var currentPort = $("#node-input-port").val();
            if (currentPort === "143" || currentPort === "993" || currentPort === "110" || currentPort == "995") {
                if ($("#node-input-useSSL").prop("checked") === true) {
                    $("#node-input-port").val($("#node-input-protocol").val() === "IMAP"?"993":"995");
                } else {
                    $("#node-input-port").val($("#node-input-protocol").val() === "IMAP"?"143":"110");
                }
            }
        };

        $("#node-input-useSSL").change(function(x, y) {
          console.log("useSSL: x="+ JSON.stringify(x) + ", y=" + y);
          console.log("Value: " + $("#node-input-useSSL").prop("checked"));
          checkPorts();
        });

        $("#node-input-protocol").change(function() {
            var protocol = $("#node-input-protocol").val();
            if (protocol === "IMAP") {
                $(".node-input-box").show();
                $(".node-input-disposition").show();
            } else {
                $(".node-input-box").hide();
                $(".node-input-disposition").hide();
            }
            checkPorts();
        });
    </script>




<script type="text/javascript">
(function() {
    RED.nodes.registerType('e-mail in',{
        category: 'social-input',
        color:"#c7e9c0",
        defaults: {
            name: {value:""},
            protocol: {value: "IMAP", required:true}, // Which protocol to use to connect to the mail server ("IMAP" or "POP3")
            server: {value:"imap.gmail.com",required:true},
            useSSL: {value: true},
            port: {value:"993",required:true},
            box: {value:"INBOX"}, // For IMAP, The mailbox to process
            disposition: { value: "Read" }, // For IMAP, the disposition of the read email
            repeat: {value:"300",required:true}
        },
        credentials: {
            userid: {type:"text"},
            password: {type: "password"},
            global: { type:"boolean"}
        },
        inputs:0,
        outputs:1,
        icon: "envelope.png",
        paletteLabel: function() {
            return this._("email.email");
        },
        label: function() {
            return this.name||this._("email.email");
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.credentials.global) {
                $('#node-tip').show();
            } else {
                $('#node-tip').hide();
            }
            if (typeof this.box === 'undefined') {
                $("#node-input-box").val("INBOX");
                this.box = "INBOX";
            }
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="e-mail">
    <p>Sends the <code>msg.payload</code> as an email, with a subject of <code>msg.topic</code>.</p>
    <p>The default message recipient can be configured in the node, if it is left
    blank it should be set using the <code>msg.to</code> property of the incoming message. If left blank
    you can also specify <code>msg.cc</code> and/or <code>msg.bcc</code> properties.</p>
    <p>You may optionally set <code>msg.from</code> in the payload which will override the <code>userid</code>
    default value.</p>
    <p>The payload can be html format.</p>
    <p>If the payload is a binary buffer then it will be converted to an attachment.
    The filename should be set using <code>msg.filename</code>. Optionally <code>msg.description</code> can be added for the body text.</p>
    <p>Alternatively you may provide <code>msg.attachments</code> which should contain an array of one or
    more attachments in <a href="https://www.npmjs.com/package/nodemailer#attachments" target="_new">nodemailer</a> format.</p>
    <p>If required by your recipient you may also pass in a <code>msg.envelope</code> object, typically containing extra from and to properties.</p>
    <p>Note: uses SMTP with SSL to port 465.</p>
</script><script type="text/x-red" data-help-name="e-mail in">
    <p>Repeatedly gets a <b>single email</b> from an IMAP server and forwards on as a msg if not already seen.</p>
    <p>The subject is loaded into <code>msg.topic</code> and <code>msg.payload</code> is the plain text body.
       If there is text/html then that is returned in <code>msg.html</code>. <code>msg.from</code> and <code>msg.date</code> are also set if you need them.</p>
    <p>Additionally <code>msg.header</code> contains the complete header object including
    <i>to</i>, <i>cc</i> and other potentially useful properties.</p>
    <p>Uses the imap module.</p>
    <p><b>Note:</b> this node <i>only</i> gets the most recent single email from the inbox, so set the repeat (polling) time appropriately.</p>
    <p>Note: uses IMAP with SSL to port 993.</p>
    <p>Any attachments supplied in the incoming email can be found in the <code>msg.attachments</code> property.  This will be an array of objects where
    each object represents a specific attachments.  The format of the object is:</p>

<pre>
{
  contentType:        // The MIME content description
  fileName:           // A suggested file name associated with this attachment
  transferEncoding:   // How was the original email attachment encodded?
  contentDisposition: // Unknown
  generatedFileName:  // A suggested file name associated with this attachment
  contentId:          // A unique generated ID for this attachment
  checksum:           // A checksum against the data
  length:             // Size of data in bytes
  content:            // The actual content of the data contained in a Node.js Buffer object
                      // We can turn this into a base64 data string with content.toString('base64')
}
</pre>
<p>For POP3, the default port numbers are 110 for plain TCP and 995 for SSL.  For IMAP the port numbers are 143 for plain TCP and 993 for SSL.</p>
<p>The maximum refresh interval is 2147483 seconds (24.8 days).</p>

</script>
<!-- --- [red-module:node-red-node-feedparser/feedparse] --- -->

<script type="text/x-red" data-template-name="feedparse">
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> <span data-i18n="feedparse.label.feedurl"></span></label>
        <input type="text" id="node-input-url">
    </div>
    <div class="form-row">
        <label for="node-input-interval"><i class="fa fa-repeat"></i> <span data-i18n="feedparse.label.refresh"></span></label>
        <input type="text" id="node-input-interval" style="width:60px"> <span data-i18n="feedparse.label.minutes"></span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('feedparse',{
        category: 'advanced-input',
        color:"#C0DEED",
        defaults: {
            name: {value:""},
            url: {value:"", required:true},
            interval: { value:15, required:true, validate:function(v) {return (!isNaN(parseInt(v)) && (parseInt(v) <= 35790))} }
        },
        inputs:0,
        outputs:1,
        icon: "feed.png",
        label: function() {
            return this.name||this.url||this._("feedparse.feedparse");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>
<script type="text/x-red" data-help-name="feedparse">
    <p>Monitors an RSS/atom feed for new entries.</p>
    <p>The <code>msg.topic</code> contains the original article link. The <code>msg.payload</code>
    contains the description, and <code>msg.article</code> contains the complete article object,
    which has properties such as <code>.title</code>, <code>.summary</code>, <code>.date</code> and so on.</p>
    <p>The Refresh interval cannot be greater than 35790 minutes (approx 24.8 days).
</script>
<!-- --- [red-module:node-red-node-openwhisk/openwhisk] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="openwhisk-service">
<div class="form-row">
    <label for="node-config-input-api"><i class="fa fa-cloud"></i> API URL</label>
    <input type="text" id="node-config-input-api">
</div>
<div class="form-row">
    <label for="node-config-input-key"><i class="fa fa-lock"></i> Auth Key</label>
    <input type="password" id="node-config-input-key">
</div>
<div class="form-row">
    <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
    <input type="text" id="node-config-input-name" data-i18n="[placeholder]node-red:common.label.name">
</div>
</script>

<script type="text/x-red" data-template-name="openwhisk-trigger">
<div class="form-row">
    <label for="node-input-service"><i class="fa fa-cloud"></i> Service</label>
    <input type="text" id="node-input-service">
</div>
<div class="form-row">
    <label for="node-input-namespace"><i class="fa fa-users"></i> Namespace</label>
    <select id="node-input-namespace">
    </select>
</div>
<div class="form-row">
    <label for="node-input-trigger"><i class="fa fa-cog"></i> Trigger</label>
    <input type="text" style="width: 45%;" id="node-input-trigger">
    <div style="display: inline-block; width: 95px; margin: 5px 35px 0 10px;">
      <label for="node-input-edit" style="width: 75px;">Allow Edits</label>
      <input type="checkbox" id="node-input-edit" style="width: 14px; margin-top: 0px;">
    </div>
</div>

<div class="form-row trigger-source" style="display: none;">
  <label><i class="fa fa-list"></i> Parameters</label>
  <input type="hidden" id="node-input-parameters" autofocus="autofocus">
</div>
<div class="form-row node-input-parameters-container-row trigger-source" style="display: none;">
  <ol id="node-input-parameters-container"></ol>
</div>

<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
    <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
</div>
</script>

<script type="text/x-red" data-template-name="openwhisk-action">
<div class="form-row">
    <label for="node-input-namespace"><i class="fa fa-cloud"></i> Service</label>
    <input type="text" id="node-input-service">
</div>

<div class="form-row">
    <label for="node-input-namespace"><i class="fa fa-users"></i> Namespace</label>
    <select id="node-input-namespace">
    </select>
</div>

<div class="form-row">
    <label for="node-input-action"><i class="fa fa-cog"></i> Action</label>
    <input type="text"  style="width: 45%" id="node-input-action">
    <div style="display: inline-block; width: 95px; margin: 5px 35px 0 10px;">
      <label for="node-input-edit" style="width: 75px;">Allow Edits</label>
      <input type="checkbox" id="node-input-edit" style="width: 14px; margin-top: 0px;">
  </div>
</div>

<div class="form-row action-source" style="display: none;">
  <label><i class="fa fa-list"></i> Parameters</label>
  <input type="hidden" id="node-input-parameters" autofocus="autofocus">
</div>
<div class="form-row node-input-parameters-container-row action-source" style="display: none;">
  <ol id="node-input-parameters-container"></ol>
</div>
<div class="form-row action-source" style="margin-bottom: 0px; display: none;">
  <label for="node-input-func" style="width: 200px;">
    <i class="fa fa-wrench"></i> Action Source
    </label>
  <input type="hidden" id="node-input-func" autofocus="autofocus">
  <input type="hidden" id="node-input-noerr">
</div>

<div class="form-row node-text-editor-row action-source" style="display: none;">
  <div style="height: 250px;" class="node-text-editor" id="node-input-func-editor" ></div>
</div>

<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
    <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
</div>

</script>






<script type="text/javascript">
(function() {
    RED.nodes.registerType('openwhisk-service', {
        category: 'config',
        defaults: {
            name: { value: "" },
            api: { value: "https://openwhisk.ng.bluemix.net/api/v1"},
        },
        credentials: {
            key: {type:"password"}
        },
        label: function() {
            return this.name || this.namespace ||  "OpenWhisk Service";
        }
    });

    RED.nodes.registerType('openwhisk-trigger', {
        category: 'output',
        defaults: {
            name: { value: "" },
            namespace: { value: "" },
            trigger: { value: "" },
            service: { type:"openwhisk-service", required: true },
            params: { value: [{key: "", value: "", disabled: true}] },
            edit: { value: false }
        },
        align: "right",
        inputs: 1,
        outputs: 0,
        color: "#6C9FC3",
        icon: "openwhisk.png",
        paletteLabel:"OpenWhisk",
        label: function() {
            return this.name || this.trigger ||  "Trigger";
        },
        oneditprepare: function () {
          $("#node-input-parameters-container").editableList({
            removable: true,
            addItem: addItem
          });

          this.params.forEach(function (param) {
              if (param.key) {
                  $("#node-input-parameters-container").editableList('addItem', param);
              }
          });

          if (this.edit) {
              $('.trigger-source').show();
          } else if (this.trigger && this.namespace && this.service) {
              retrieveTriggerSource(this);
          }

          if (this.service) {
              retrieveNamespaceListTrigger(this);
          }

          var that = this;

          $('#node-input-service').change(function () {
              that.namespaces = undefined;
              retrieveNamespaceListTrigger(that);
          });

          $('#node-input-trigger').keyup(function () {
            clearTimeout(that.timeout);
            that.timeout = setTimeout(function () {
              retrieveTriggerSource(that);
            }, 500);
          });

          $("#node-input-edit").change(function () {
            var checked = $("#node-input-edit").prop("checked");
            if (checked) {
              makeParametersReadOnly(false);
            } else {
              retrieveTriggerSource(that);
            }
          });

          makeParametersReadOnly(true);
        },
        oneditsave: function () {
          var checked = $("#node-input-edit").prop("checked");
          if (checked) {
            var params = [];
            $(".node-input-parameters-container-row li").each(function (idx, li) {
              var key = $(li).find(".params-key").val();
              var value = $(li).find(".params-value").val();
              params.push({key: key, value: value});
            })
            this.params = params;
          } else {
            this.params = [{disabled: true}];
          }
        },

    });

    function makeParametersReadOnly(readOnly) {
      $(".node-input-parameters-container-row input").prop('disabled', readOnly);
      if (readOnly) {
        $(".node-input-parameters-container-row .editor-button").hide();
      } else {
        $(".node-input-parameters-container-row .editor-button").show();
      }
    }

    function makeActionReadOnly(editor, readOnly) {
      editor.setOptions({
        readOnly: readOnly,
        highlightActiveLine: !readOnly,
        highlightGutterLine: !readOnly
      });
      editor.renderer.$cursorLayer.element.style.opacity = readOnly ? 0 : 1;
      makeParametersReadOnly(readOnly);
    }

    function retrieveNamespaceListAction(node) {
        retrieveNamespaceList(node, retrieveActionSource)
    }

    function retrieveNamespaceListTrigger(node) {
        retrieveNamespaceList(node, retrieveTriggerSource)
    }

    function retrieveNamespaceList(node, retrieveSource) {
        // Bail if there is no value set for service.
        var service = RED.nodes.node($("#node-input-service").val());
        if (!service) return;

        if (node.namespaces && node.namespaces.length) {
            drawNamespaceList(node, retrieveSource);
            return;
        }

        var url = "openwhisk-namespace-list/";

        // if the user has defined the service before deploying, send the credentials.
        // otherwise, send the service identifier.
        if (service.credentials && service.credentials.has_key) {
            url += "?key=" + service.credentials.key + "&api=" + service.api;
        } else {
            url += "?id=" + service.id;
        }

        $.getJSON(url)
            .done(function (result) {
                node.namespaces = result;
                drawNamespaceList(node, retrieveSource);
            });
    }

    function drawNamespaceList (node, retrieveSource) {
        var namespaceDiv = $('#node-input-namespace');
        if (!namespaceDiv || !node.namespaces) return;
        // empty the list before populating it
        namespaceDiv.empty();
        // populate the list
        node.namespaces.forEach(function (namespace) {
            namespaceDiv.append($('<option>', {value: namespace, text: namespace}));
        });
        // if namespace is not set use the first item in the list
        if (node.namespace) {
            namespaceDiv.val(node.namespace);
        }
        // when a new selection is made update the state
        namespaceDiv.change(function (e, d) {
            var selected = $('#node-input-namespace option').filter(':selected').text();;
            if (node.namespace === selected) return;
            node.namespace = selected;
            retrieveSource(node);
        });
    }

    function retrieveActionSource(node) {
      var action = $('#node-input-action').val();
      var namespace = $('#node-input-namespace').val();
      var service = RED.nodes.node($("#node-input-service").val());

      if (!action || !namespace || !service) return;
      $('.action-source').show();
      $(".fa-cog").addClass("fa-spin")

      var url = "openwhisk-action/?action=" + action + "&namespace=" + namespace;
      // if the user has defined the service before deploying, send the credentials.
      // otherwise, send the service identifier.
      if (service.credentials && service.credentials.has_key) {
        url += "&key=" + service.credentials.key + "&api=" + service.api;
      } else {
        url += "&id=" + service.id;
      }

      $.getJSON(url)
        .done(function (result) {
          node.editor.setValue(result.exec.code);
          node.editor.clearSelection();
          $("#node-input-edit").prop("checked", false);
          $(".fa-cog").removeClass("fa-spin")
          $("#node-input-parameters-container").editableList('empty');
          var parameters = result.parameters || [];
          if (!parameters.length) parameters.push({});
          parameters.forEach(function (param) {
            param.disabled = true;
            $("#node-input-parameters-container").editableList('addItem', param);
          });
          makeActionReadOnly(node.editor, true);
        })
        .fail(function () {
          $('.action-source').hide();
          $(".fa-cog").removeClass("fa-spin")
        });
    };

    function retrieveTriggerSource(node) {
      var action = $('#node-input-trigger').val();
      var namespace = $('#node-input-namespace').val();
      var service = RED.nodes.node($("#node-input-service").val());

      if (!action || !namespace || !service) return;
      $('.trigger-source').show();
      $(".fa-cog").addClass("fa-spin")

      var url = "openwhisk-trigger/?trigger=" + action + "&namespace=" + namespace;
      if (service.credentials && service.credentials.has_key) {
        url += "&key=" + service.credentials.key + "&api=" + service.api;
      } else {
        url += "&id=" + service.id;
      }

      $.getJSON(url)
        .done(function (result) {
          $("#node-input-edit").prop("checked", false);
          $(".fa-cog").removeClass("fa-spin")
          $("#node-input-parameters-container").editableList('empty');
          var parameters = result.parameters || [];
          if (!parameters.length) parameters.push({});
          parameters.forEach(function (param) {
            param.disabled = true;
            $("#node-input-parameters-container").editableList('addItem', param);
          });
          makeParametersReadOnly(true);
        })
        .fail(function () {
          $('.trigger-source').hide();
          $(".fa-cog").removeClass("fa-spin")
        });
    }

    var addItem = function (row, index, data) {
      var key = data.key || "";
      var value = data.value || "";
      var disabled = data.disabled ? "disabled" : "";
      var template = '<i style="color: #eee; margin-left:15px;" class="fa fa-bars"></i><input class="params-key" style="width: 40%; margin-left: 15px;" '+disabled+' type="text" placeholder="key" value="'+key+'"><input class="params-value" style="width: 40%; margin-left: 15px;" '+disabled+' type="text" placeholder="value" value="'+value+'">';
      $(row).html(template);
    };

    RED.nodes.registerType('openwhisk-action', {
        category: 'function',
        defaults: {
            name: { value: "" },
            func: {value:""},
            namespace: { value: "" },
            action: { value: "" },
            params: { value: [{key: "", value: "", disabled: true}] },
            service: { type:"openwhisk-service", required: true },
            edit: { value: false }
        },
        inputs: 1,
        outputs: 1,
        color: "#6C9FC3",
        icon: "openwhisk.png",
        paletteLabel:"OpenWhisk",
        oneditprepare: function () {
          // create editor dom element
          this.editor = RED.editor.createEditor({
            id: 'node-input-func-editor',
            mode: 'ace/mode/javascript',
            value: $("#node-input-func").val()
          });

          makeActionReadOnly(this.editor, true);

          $("#node-input-parameters-container").editableList({
            removable: true,
            addItem: addItem
          });

          this.params.forEach(function (param) {
              if (param.key) {
                  $("#node-input-parameters-container").editableList('addItem', param);
              }
          });
          // if node configuration includes custom action source,
          // show the editor panel straight away.
          if (this.edit) {
              $('.action-source').show();
          // otherwise, if we have the correct parameters, retrieve it
          // from the platform.
          } else if (this.action && this.namespace && this.service) {
              retrieveActionSource(this);
          }

          if (this.service) {
              retrieveNamespaceListAction(this);
          }

          var that = this;

          $('#node-input-service').change(function () {
              that.namespaces = undefined;
              retrieveNamespaceListAction(that);
          });

          // whenever action name changes, update Action source.
          // debounce events to half a second.
          $('#node-input-action').keyup(function () {
            clearTimeout(that.timeout);
            that.timeout = setTimeout(function () {
              retrieveActionSource(that);
            }, 500);
          });

          // when user swaps back to non-edit mode,
          // retrieve current action source from openwhisk.
          // otherwise, take editor out of readonly mode.
          $("#node-input-edit").change(function () {
            var checked = $("#node-input-edit").prop("checked");
            if (checked) {
              makeActionReadOnly(that.editor, false);
              that.editor.focus();
            } else {
              retrieveActionSource(that);
            }
          });
        },
        oneditsave: function () {
            var annot = this.editor.getSession().getAnnotations();
            this.noerr = 0;
            $("#node-input-noerr").val(0);
            for (var k=0; k < annot.length; k++) {
                if (annot[k].type === "error") {
                    $("#node-input-noerr").val(annot.length);
                    this.noerr = annot.length;
                }
            }
            // if user has decided to allow source modifications, store the
            // function definition within the node. otherwise, wipe it out
            // so we can retrieve it from the API next time...
            var checked = $("#node-input-edit").prop("checked");
            if (checked) {
              $("#node-input-func").val(this.editor.getValue());
              var params = []
              $(".node-input-parameters-container-row li").each(function (idx, li) {
                var key = $(li).find(".params-key").val();
                var value = $(li).find(".params-value").val();
                params.push({key: key, value: value});
              })
              this.params = params;
            } else {
              $("#node-input-func").val("");
              this.params = [{disabled: true}];
            }
            delete this.editor;
        },
        label: function() {
            return this.name || this.action ||  "Action";
        }
    });
})();
</script>
<script type="text/x-red" data-help-name="openwhisk-service"></script><script type="text/x-red" data-help-name="openwhisk-trigger">
<p>Invoke an OpenWhisk trigger.</p>
<p>The namespace and trigger can be configured in the node or, if left blank,
provided by <code>msg.namespace</code> and <code>msg.trigger</code> respectively.</p>
<p><code>msg.payload</code> should be an object of key-value pairs to pass to the
trigger; any other type is ignored.</p>
</script><script type="text/x-red" data-help-name="openwhisk-action">
<p>Invoke an OpenWhisk action.</p>
<p>The namespace and trigger can be configured in the node or, if left blank,
provided by <code>msg.namespace</code> and <code>msg.action</code> respectively.</p>
<p><code>msg.payload</code> should be an object of key-value pairs to pass to the
action; any other type is ignored.</p>
<p>The output message contains the following properties:</p>
<ul>
<li><code>payload</code> is the result of the action</li>
<li><code>data</code> is the complete response object</li>
</ul>
</script>
<!-- --- [red-module:node-red-node-rbe/rbe] --- -->

<script type="text/x-red" data-template-name="rbe">
    <div class="form-row">
        <label for="node-input-func"><i class="fa fa-wrench"></i> <span data-i18n="rbe.label.func"></span></label>
        <select type="text" id="node-input-func" style="width:70%;">
            <option value="rbe" data-i18n="rbe.opts.rbe"></option>
            <option value="rbei" data-i18n="rbe.opts.rbei"></option>
            <option value="deadbandEq" data-i18n="rbe.opts.deadbandEq"></option>
            <option value="deadband" data-i18n="rbe.opts.deadband"></option>
            <option value="narrowbandEq" data-i18n="rbe.opts.narrowbandEq"></option>
            <option value="narrowband" data-i18n="rbe.opts.narrowband"></option>
        </select>
    </div>
    <div class="form-row" id="node-bandgap">
        <label for="node-input-gap">&nbsp;</label>
        <input type="text" id="node-input-gap" data-i18n="[placeholder]rbe.placeholder.bandgap" style="width:95px;">
        <select type="text" id="node-input-inout" style="width:54%;">
            <option value="out" data-i18n="rbe.opts.out"></option>
            <option value="in" data-i18n="rbe.opts.in"></option>
        </select>
    </div>
    <div class="form-row" id="node-startvalue">
        <label for="node-input-start"><i class="fa fa-thumb-tack"></i> <span data-i18n="rbe.label.start"></span></label>
        <input type="text" id="node-input-start" data-i18n="[placeholder]rbe.placeholder.start" style="width:70%;">
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-ellipsis-h"></i> <span data-i18n="node-red:common.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:70%;"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="rbe.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]rbe.label.name" style="width:70%;">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType("rbe", {
        color:"#E2D96E",
        category: 'function',
        defaults: {
            name: {value:""},
            func: {value:"rbe"},
            gap: {value:"",validate:RED.validators.regex(/^(\d*[.]*\d*|)(%|)$/)},
            start: {value:""},
            inout: {value:"out"},
            property: {value:"payload",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "rbe.png",
        label: function() {
            var ll = (this.func||"").replace("Eq","").replace("rbei","rbe")||this._("rbe.rbe");
            return this.name||ll||this._("rbe.rbe");
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({default:'msg',types:['msg']});
            //$( "#node-input-gap" ).spinner({min:0});
            if ($("#node-input-inout").val() === null) {
                $("#node-input-inout").val("out");
            }
            $("#node-input-func").on("change",function() {
                if (($("#node-input-func").val() === "rbe")||($("#node-input-func").val() === "rbei")) {
                    $("#node-bandgap").hide();
                } else {
                    $("#node-bandgap").show();
                }
                if ($("#node-input-func").val() === "narrowband") {
                    $("#node-startvalue").show();
                } else {
                    $("#node-startvalue").hide();
                }
            });
        }
    });
</script>
<script type="text/x-red" data-help-name="rbe">
    <p>Report by Exception node - only passes on data if the payload has changed.</p>
    <p>It can also block until the value changes by a specified amount - deadband modes.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">number | string | (object)</span>
        </dt>
        <dd>RBE mode will accept numbers, strings, and simple objects. Other modes must provide a parseable number.</dd>
        <dt class="optional">topic <span class="property-type">string</span>
        </dt>
        <dd>if specified the function will work on a per topic basis.</dd>
        <dt class="optional">reset<span class="property-type">any</span></dt>
        <dd>if set clears the stored value for the specified msg.topic, or
        all topics if msg.topic is not specified.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">as per input</span>
        </dt>
        <dd>If triggered the output will be the same as the input.</dd>
    </dl>
    <h3>Details</h3>
    <p>In RBE mode this node will block until the <code>msg.payload</code> is
    different to the previous one. </p>
    <p>In Deadband modes the incoming payload must contain a parseable number and is
    output only if greater than + or - the band gap away from a previous value.</p>
    <p>Deadband also supports % - only sends if the input differs by more than x% of the original value.</p>
    <p>In Narrowband mode the incoming payload is blocked if it is more than + or - the band gap
    away from the previous value. Useful for ignoring outliers from a faulty sensor for example.</p>
    <p>Both Deadband and Narrowband allow comparison against either the previous valid output value, thus
    ignoring any values out of range; or the previous input value, which resets the set point, thus allowing
    gradual drift (deadband), or a step change (narrowband).</p>
    <p><b>Note:</b> This works on a per <code>msg.topic</code> basis. This means that a single rbe node can
    handle multiple different topics at the same time.</p>
</script>
<!-- --- [red-module:node-red-node-twitter/twitter] --- -->

<script type="text/x-red" data-template-name="twitter-credentials">
    <div class="form-row">
        <label for="node-config-input-screen_name"><i class="fa fa-twitter"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <i class="fa fa-at"></i> <input type="text" id="node-config-input-screen_name">
    </div>
    <div class="form-row">
        <p style="margin-top: 30px;"><b>1.</b> <span data-i18n="twitter.label.create"></span> <a href="https://apps.twitter.com/" target="_blank" style="text-decoration:underline;">apps.twitter.com</a></p>
    </div>
    <div class="form-row">
        <p style="margin-top: 30px;"><b>2.</b> <span data-i18n="twitter.label.copy-consumer"></span></p>
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-consumer_key"><span data-i18n="twitter.label.consumer_key"></span></label>
        <input type="password" id="node-config-input-consumer_key">
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-consumer_secret"><span data-i18n="twitter.label.consumer_secret"></span></label>
        <input type="password" id="node-config-input-consumer_secret">
    </div>

    <div class="form-row">
        <p style="margin-top: 30px;"><b>3.</b> <span data-i18n="twitter.label.copy-accessToken"></span></p>
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-access_token"><span data-i18n="twitter.label.access_key"></span></label>
        <input type="password" id="node-config-input-access_token">
    </div>
    <div class="form-row">
        <label style="margin-left: 20px;" for="node-config-input-access_token_secret"><span data-i18n="twitter.label.access_secret"></span></label>
        <input type="password" id="node-config-input-access_token_secret">
    </div>
</script>




<script type="text/javascript">
(function() {
    var twitterConfigNodeId = null;
    var twitterConfigNodeIntervalId = null;

    RED.nodes.registerType('twitter-credentials',{
        category: 'config',
        defaults: {
            screen_name: {value:""}
        },
        credentials: {
            consumer_key: { type: "password"},
            consumer_secret: { type: "password" },
            access_token: {type: "password"},
            access_token_secret: {type:"password"}
        },
        label: function() {
            if (this.screen_name) {
                return (this.screen_name[0]!=="@"?"@":"")+this.screen_name
            } else {
                return "Twitter: "+this.id
            }
        },
        exportable: false,
        oneditsave: function() {
            var trimFields = [
                "consumer_key",
                "consumer_secret",
                "access_token",
                "access_token_secret"
            ];
            // Just in case any whitespace has crept in with the copy-paste of the fields
            trimFields.forEach(function(field) {
                var v = $("#node-config-input-"+field).val();
                v = v.trim();
                $("#node-config-input-"+field).val(v);

            });
        }
    });
})();
</script>

<script type="text/x-red" data-template-name="twitter in">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <input type="text" id="node-input-twitter">
    </div>
    <div class="form-row">
        <label for="node-input-user"><i class="fa fa-search"></i> <span data-i18n="twitter.label.search"></span></label>
        <select type="text" id="node-input-user" style="display: inline-block; vertical-align: middle; width:60%;">
            <option value="false" data-i18n="twitter.search.public"></option>
            <option value="true" data-i18n="twitter.search.follow"></option>
            <option value="user" data-i18n="twitter.search.user"></option>
            <option value="dm" data-i18n="twitter.search.direct"></option>
            <option value="event" data-i18n="twitter.search.events"></option>
        </select>
    </div>
    <div id="tweet-events-deprecated" class="hide form-tips" style="background: #edd; padding: 20px; margin-bottom: 20px">
        <i class="fa fa-warning"></i> Twitter are withdrawing the API used to access a user&apos;s activity stream in August 2018 so this feature will be removed from the node in the near future. See <a href="https://bit.ly/2kr7InE">here</a> for details.
    </div>
    <div class="form-row" id="node-input-tags-row">
        <label for="node-input-tags"><i class="fa fa-tags"></i> <span id="node-input-tags-label" data-i18n="twitter.label.for"></span></label>
        <input type="text" id="node-input-tags" data-i18n="[placeholder]twitter.placeholder.for">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <div class="form-tips"><span data-i18n="[html]twitter.tip"></span></div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('twitter in',{
        category: 'social-input',
        color:"#C0DEED",
        defaults: {
            twitter: {type:"twitter-credentials",required:true},
            tags: {value:""},
            user: {value:"false",required:true},
            name: {value:""},
            topic: {value:"tweets"},
            inputs: {value:0}
        },
        inputs: 0,
        outputs: 1,
        icon: "twitter.png",
        label: function() {
            if (this.name) {
                return this.name;
            }
            var uname = RED.nodes.node(this.twitter);
            if (this.user == "dm") {
                return (uname?uname.label()+" ":"")+this._("twitter.label.dmslabel");
            } else if (this.user == "event") {
                var user = RED.nodes.node(this.twitter);
                return (user?user.label()+" ":"")+this._("twitter.label.eventslabel");
            } else if (this.user == "user") {
                return this.tags+" "+this._("twitter.label.tweetslabel");
            }
            else if (this.user == "true") {
                return this._("twitter.label.followers") + (uname?(" "+uname.label()):"");
            }
            return "twitter";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var userlabel = this._("twitter.label.user");
            var userph = this._("twitter.placeholder.user");
            var forlabel = this._("twitter.label.for");
            var forph = this._("twitter.placeholder.for");
            $("#node-input-user").change(function() {
                var type = $("#node-input-user option:selected").val();
                if (type == "user") {
                    $("#node-input-tags-row").show();
                    $("#node-input-tags-label").html(userlabel);
                    $("#node-input-tags").attr("placeholder",userph);
                } else if ((type == "dm")||(type == "true")||(type == "event")) {
                    $("#node-input-tags-row").hide();
                } else {
                    $("#node-input-tags-row").show();
                    $("#node-input-tags-label").html(forlabel);
                    $("#node-input-tags").attr("placeholder",forph);
                }
                $("#tweet-events-deprecated").toggle((type === 'event'));
            });
            $("#node-input-user").change();
        },
        oneditsave: function() {
            if ($('#node-input-tags').val() === '' && $("#node-input-user option:selected").val() === 'false') {
                this.inputs = 1;
            }
            else {
                //set back the default state of 0 inputs
                //this.inputs = 0;
            }
        }
    });
</script>


<script type="text/x-red" data-template-name="twitter out">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> <span data-i18n="twitter.label.twitter-id"></span></label>
        <input type="text" id="node-input-twitter">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
</script>



<script type="text/javascript">
    RED.nodes.registerType('twitter out',{
        category: 'social-output',
        color:"#C0DEED",
        defaults: {
            twitter: {type:"twitter-credentials",required:true},
            name: {value:"Tweet"}
        },
        inputs:1,
        outputs:0,
        icon: "twitter.png",
        align: "right",
        label: function() {
            return this.name;
        }
    });
</script>
<script type="text/x-red" data-help-name="twitter-credentials">
    <p>Authentication for the Twitter API</p>
    <p>Earlier versions of this node provided one-click authentication. Twitter removed the ability
       to do that in June 2018. You must now register your own application with
       <a href="https://apps.twitter.com">Twitter</a> and generate your own access tokens.</p>

</script><script type="text/x-red" data-help-name="twitter in">
    <p>Twitter input node. Can be used to search either:
    <ul><li>the public stream for tweets containing the configured search term</li>
        <li>all the tweets from accounts that the authenticated user follows</li>
        <li>all tweets by specified users</li>
        <li>direct messages received by the authenticated user</li>
    </ul></p>
    <p>Use space for <i>and</i> and comma , for <i>or</i> when searching for multiple terms.
    If you want to pass in the search term(s) via the <code>msg.payload</code>, leave the <b>for</b> field blank.</p>
    <p>Sets the <code>msg.topic</code> to <i>tweets/</i> and then appends the senders screen name.</p>
    <p>Sets <code>msg.location</code> to the tweeters location if known.</p>
    <p>When returning events it sets the <code>msg.payload</code> to the twitter event, a full list is documented by
    <a href="https://dev.twitter.com/streaming/overview/messages-types#Events_event" target="_new">Twitter</a>.</p>
    <p>Sets <code>msg.tweet</code> to the full tweet object as documented by <a href="https://dev.twitter.com/overview/api/tweets" target="_new">Twitter</a>.

    <p><b>Note</b>: This node is not connected to the FireHose, so will not return 100% of all tweets to a busy @id or #hashtag.</p>
    <p><b>Note:</b> when set to follow specific users, or your direct messages, the node is subject to
      the rate limiting of the Twitter API. If you deploy the flows multiple times within a 15 minute window, you may
      exceed the limit and will see errors from the node. These errors will clear automatically when the current 15
      minute window passes.</p>
</script><script type="text/x-red" data-help-name="twitter out">
    <p>Twitter out node. Tweets the <code>msg.payload</code>.</p>
    <p>To send a Direct Message (DM) - use a payload like "D {username} {message}"</p>
    <p>If <code>msg.media</code> exists and is a Buffer object, this node will treat it
       as an image and attach it to the tweet.</p>
    <p>If <code>msg.params</code> exists and is an object of name:value pairs,
    this node will treat it as parameters for the update request.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-conversation-v1] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-conversation-v1">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/assistant/api">
    </div>

    <div class="form-row">
        <label for="node-input-workspaceid"><i class="fa fa-tag"></i> Workspace ID</label>
        <input type="text" id="node-input-workspaceid" placeholder="WorkspaceID">
    </div>
    <div class="form-row">
        <label for="node-input-timeout"><i class="fa fa-tag"></i> Timeout Period</label>
        <input type="text" id="node-input-timeout" placeholder="Leave empty to disable">
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-context" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-context" style="width: 70%;"> Save context</label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-multiuser" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-multiuser" style="width: 70%;"> Multiple Users</label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-empty-payload" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-empty-payload" style="width: 70%;"> Permit Empty Payload</label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-optout-learning" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-optout-learning" style="width: 70%;"> Opt Out Request Logging</label>
    </div>

    <div class="form-tips" id="conversation-form-tips">
      <strong>Note:</strong> When using with multiple users, <code>msg.user</code> must be set.<br>
      See info box for details.
    </div>
</script>




<script type="text/javascript">
    var oneditprepare = function() {
        $('input#node-input-context').change(function () {
            var checked = $('input#node-input-context').prop('checked');
            if (checked) {
                $('input#node-input-multiuser').parent().show();
                $('#conversation-form-tips').show();
            } else {
                $('input#node-input-multiuser').parent().hide();
                $('#conversation-form-tips').hide();
            }
        });
        $('input#node-input-default-endpoint').change(function () {
            var checked = $('input#node-input-default-endpoint').prop('checked');
            if (checked) {
                $('#node-input-service-endpoint').parent().hide();
            } else {
                $('#node-input-service-endpoint').parent().show();
            }
        });

        $.getJSON('watson-conversation/vcap/')
            .done(function (service) {
              $('.credentials').toggle(!service);
            })
            .fail(function () {
              $('.credentials').show();
            })
            .always(function () {
              $('#credentials-check').hide();
            })
    };

    (function() {
        RED.nodes.registerType('watson-conversation-v1', {
            category: 'IBM Watson',
            defaults: {
              name: {value: ''},
              workspaceid: {value: ''},
              multiuser: {value: false},
              context: {value: true},
              'empty-payload': {value: false},
              'default-endpoint' : {value: true},
              'service-endpoint' : {value: 'https://gateway.watsonplatform.net/assistant/api'},
              timeout: {value: '', validate: RED.validators.number(true)},
              'optout-learning': {value: false}
            },
            credentials: {
              username: {type:'text'},
              password: {type:'password'},
              apikey: {type:'password'}
            },
            color: 'rgb(84,149,230)',
            inputs: 1,
            outputs: 1,
            icon: 'conversation-v1-25x25.png',
            paletteLabel: 'assistant',
            label: function() {
                return this.name || 'assistant';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-conversation-v1">
	<p>With the IBM Watson™ Assistant service you can create cognitive agents – virtual agents that combine machine learning, natural language understanding, and integrated dialog scripting tools to provide outstanding customer engagements.</p>

    <p><b>Usage</b></p>
    <p>This node should be provided in input : </p>
    <ul>
    <li><code>msg.payload</code> : the message of the Assistant to analyse. Format: String </li>
    <li><code>msg.user</code> (optional): unique identifier of the user. This will be used to maintain the context of the Assistant for each user when using with multiple users. Format: String </li>
    <li><code>msg.params.workspace_id</code> : unique identifier of the workspace to be used. Could be also configured in the node. Format: String </li>
    <li><code>msg.params.timeout</code> (optional): The timeout period (in millisecond) for Watson request. Leave empty or set to 0 to disable. </li>
    <li><code>msg.params.context</code> (optional): A context object that includes state information for the Assistant. When you send multiple requests for the same Assistant, include the context object from the response. (<a href="http://www.ibm.com/watson/developercloud/assistant/api/v1/#send_input" target="_blank">documentation</a>). This will overwrite any context saved in the node. Format: JSON </li>
    <li><code>msg.params.alternate_intents</code> (optional) : whether to return more than one intent. Default is false. Set to true to return all matching intents. For example, return all intents when the confidence is not high to allow users to choose their intent.</li>
    <li><code>msg.params.output</code> (optional) : see API documentation </li>
    <li><code>msg.params.entities</code> (optional) : see API documentation </li>
    <li><code>msg.params.output</code> (optional) : see API documentation </li>
    <li><code>msg.additional_context</code> (optional) : additional properties that will be added to the context object. Format: Object </li>
    <br/>
    <li><code>msg.params.username</code> : If provided will be used as the username credential for the Assistant service.</li>
    <li><code>msg.params.password</code> : If provided will be used as the password credential for the Assistant service.</li>
    <li><code>msg.params.apikey</code> : If provided will be used as the api key credential for the Assistant service.</li>
    <li><code>msg.params.endpoint</code> : If provided will be used as the url for the Assistant service.</li>
    <li><code>msg.params.version</code> : If provided will be used as the API version date for the Assistant service.</li>
    <li><code>msg.params.optout_learning</code> : Set to true to opt out of request logging. Check the <a href="https://console.bluemix.net/docs/services/watson/getting-started-logging.html#controlling-request-logging-for-watson-services" target="_blank">documentation</a> for details.</li>
    </ul>
    <p>See <a href="http://www.ibm.com/watson/developercloud/assistant/api/v1/#send_input" target="_blank">Assistant API documentation</a> for details.</p>
    <p>All Results will made available at <code>msg.payload</code> in JSON format. Check the  <a href="http://www.ibm.com/watson/developercloud/assistant/api/v1/#send_input" target="_blank">documentation</a> for details.</p>

    <p><b>Important</b> : before using this node, a workspace must be created and configured using the Watson Assistant Tool available in IBM Cloud, in the Watson Assistant instance detail page.</p>
    <p><b>Documentation</b>
    <ul>
    <li><a href="https://console.bluemix.net/docs/services/assistant/index.html" target="_blank">Watson Assistant API documentation</a></li>
    <li><a href="https://watson-api-explorer.mybluemix.net/apis/assistant-v1" target="_blank">Watson API Explorer</a></li>
    <li><a href="https://console.bluemix.net/docs/services/assistant/getting-started.html" target="_blank">Getting started tutorial</a>
    <li><a href="https://github.com/watson-developer-cloud/node-red-bluemix-starter" target="_blank">Sample Flow in the Watson Node-RED Starter</a>
    </ul>
</script>
<!-- --- [red-module:node-red-node-watson/watson-conversation-workspace-manager-v1] --- -->
<!--
  Copyright 2017 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-conversation-v1-workspace-manager">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div>
        <label id="node-label-message"><i class="fa fa-exclamation-triangle"></i></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"></input>
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-cwm-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-cwm-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-cwm-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-cwm-service-endpoint" placeholder="https://gateway.watsonplatform.net/assistant/api">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-custom-mode"><i class="fa fa-book"></i> Detect: </label>
        <select type="text" id="node-input-cwm-custom-mode" style="display: inline-block; width: 70%;">
            <option value="listWorkspaces">List Workspaces</option>
            <option value="getWorkspace">Get Workspace Details</option>
            <option value="createWorkspace">Create Workspace</option>
            <option value="updateWorkspace">Update Workspace</option>
            <option value="deleteWorkspace">Delete Workspace</option>
            <option disabled>______________</option>
            <option value="listIntents">List Intents</option>
            <option value="getIntent">Get Intent Details</option>
            <option value="createIntent">Create Intent</option>
            <option value="updateIntent">Update Intent</option>
            <option value="deleteIntent">Delete Intent</option>
            <option disabled>______________</option>
            <option value="listExamples">List Examples</option>
            <option value="createExample">Create Example</option>
            <option value="deleteExample">Delete Example</option>
            <option disabled>______________</option>
            <option value="listCounterExamples">List Counter Examples</option>
            <option value="createCounterExample">Create Counter Example</option>
            <option value="deleteCounterExample">Delete Counter Example</option>
            <option disabled>______________</option>
            <option value="listEntities">List Entities</option>
            <option value="getEntity">Get Entity Details</option>
            <option value="createEntity">Create Entity</option>
            <option value="updateEntity">Update Entity</option>
            <option value="deleteEntity">Delete Entity</option>
            <option disabled>______________</option>
            <option value="listEntityValues">List Entity Values</option>
            <option value="getEntityValue">Get Entity Value Details</option>
            <option value="addEntityValue">Add Entity Value</option>
            <option value="updateEntityValue">Update Entity Value</option>
            <option value="deleteEntityValue">Delete Entity Value</option>
            <option disabled>______________</option>
            <option value="listDialogNodes">List Dialog Nodes</option>
            <option value="getDialogNode">Get Dialog Node Details</option>
            <option value="createDialogNode">Create Dialog Node</option>
            <option value="updateDialogNode">Update Dialog Node</option>
            <option value="deleteDialogNode">Delete Dialog Node</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-cwm-workspace-id"><i class="fa fa-book"></i> Workspace ID</label>
        <input type="text" id="node-input-cwm-workspace-id" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-intent"><i class="fa fa-book"></i> Intent</label>
        <input type="text" id="node-input-cwm-intent" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-example"><i class="fa fa-book"></i> Example Input</label>
        <input type="text" id="node-input-cwm-example" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-entity"><i class="fa fa-book"></i> Entity</label>
        <input type="text" id="node-input-cwm-entity" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-entity-value"><i class="fa fa-book"></i> Entity Value</label>
        <input type="text" id="node-input-cwm-entity-value" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-dialog-node"><i class="fa fa-book"></i> Dialog Node ID</label>
        <input type="text" id="node-input-cwm-dialog-node" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-cwm-export-content"><i class="fa fa-book"></i> Export All Content</label>
        <input type="checkbox" id="node-input-cwm-export-content" placeholder="">
    </div>

</script>



<script type="text/javascript">

  // Need to simulate a namespace, as some of the variables had started to leak across nodes
  function CV1WM () {
  }

  // This is the namespace for cv1wm. Currently only contains models, but more vars and functions may need to be
  // moved in if there is a clash with other nodes.
  var cv1wm = new CV1WM();
  cv1wm.mode_selected = null;
  cv1wm.endpoint_required = false;

  cv1wm.showSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().show();
    }
  }

  cv1wm.hideSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().hide();
    }
  }

  // Function to be used at the start, as don't want to expose any fields, unless the models are
  // available. The models can only be fetched if the credentials are available.
  cv1wm.hideEverything = function () {
    var fields = [];

    fields.push('#node-input-cwm-workspace-id'
                     + ', #node-input-cwm-intent'
                     + ', #node-input-cwm-example'
                     + ', #node-input-cwm-entity'
                     + ', #node-input-cwm-entity-value'
                     + ', #node-input-cwm-dialog-node'
                     + ', #node-input-cwm-export-content'
                     + ', #node-input-cwm-service-endpoint');

    cv1wm.hideSelectedFields(fields);
  }

  cv1wm.processSelectedMethod = function(method) {
    var fields = [];

    cv1wm.hideEverything();

    switch (method) {
      case 'getWorkspace':
      case 'listIntents':
      case 'listEntities':
        fields.push('#node-input-cwm-workspace-id'
                       + ', #node-input-cwm-export-content');
        break;
      case 'getIntent':
        fields.push('#node-input-cwm-workspace-id'
                       + ', #node-input-cwm-intent'
                       + ', #node-input-cwm-export-content');
        break;
      case 'updateIntent':
      case 'deleteIntent':
      case 'listExamples':
        fields.push('#node-input-cwm-workspace-id'
                     + ', #node-input-cwm-intent');
        break;
      case 'createExample':
      case 'deleteExample':
        fields.push('#node-input-cwm-workspace-id'
                     + ', #node-input-cwm-intent'
                     + ', #node-input-cwm-example');
        break;
      case 'createCounterExample':
      case 'deleteCounterExample':
        fields.push('#node-input-cwm-workspace-id'
                      + ', #node-input-cwm-example');
        break;
      case 'getEntity':
      case 'listEntityValues':
        fields.push('#node-input-cwm-workspace-id'
                        + ', #node-input-cwm-entity'
                        + ', #node-input-cwm-export-content');
        break;
      case 'getEntityValue':
        fields.push('#node-input-cwm-workspace-id'
                        + ', #node-input-cwm-entity'
                        + ', #node-input-cwm-entity-value'
                        + ', #node-input-cwm-export-content');
        break;
      case 'updateEntity':
      case 'deleteEntity':
        fields.push('#node-input-cwm-workspace-id'
                       + ', #node-input-cwm-entity');
        break;
      case 'getDialogNode':
      case 'updateDialogNode':
      case 'deleteDialogNode':
        fields.push('#node-input-cwm-workspace-id'
                       + ', #node-input-cwm-dialog-node');
        break;
      case 'addEntityValue':
      case 'updateEntityValue':
      case 'deleteEntityValue':
        fields.push('#node-input-cwm-workspace-id'
                        + ', #node-input-cwm-entity'
                        + ', #node-input-cwm-entity-value');
        break;
      case 'deleteWorkspace':
      case 'updateWorkspace':
      case 'createIntent':
      case 'createEntity':
      case 'listCounterExamples':
      case 'listDialogNodes':
      case 'createDialogNode':
        fields.push('#node-input-cwm-workspace-id');
        break;
      case 'listWorkspaces':
      case 'createWorkspace':
        break;
    }
    if (cv1wm.endpoint_required) {
      fields.push('#node-input-cwm-service-endpoint');
    }
    cv1wm.showSelectedFields(fields);
  }

  // Register the handlers for the fields
  cv1wm.handlersUI = function () {
    $('#node-input-cwm-custom-mode').change(function() {
      cv1wm.mode_selected = $('#node-input-cwm-custom-mode').val();
      cv1wm.processSelectedMethod(cv1wm.mode_selected);
    });
    $('#node-input-cwm-default-endpoint').change(function () {
      cv1wm.endpoint_required = ! $('#node-input-cwm-default-endpoint').prop('checked');
      cv1wm.processSelectedMethod(cv1wm.mode_selected);
    });
  }

  // This is the on edit prepare function, which will be invoked everytime the dialog
  // is shown.
  function cv1wmoneditprepare() {
    cv1wm.hideEverything();
    cv1wm.handlersUI();

    $.getJSON('watson-conversation-v1-workspace-manager/vcap/')
      // for some reason the getJSON resets the vars so need to restoreFromHidden again
      // so again.
      .done(function (service) {
        $('.credentials').toggle(!service);
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
     });
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function cv1wmoneditsave(){
  }

    (function() {
        RED.nodes.registerType('watson-conversation-v1-workspace-manager', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                'cwm-custom-mode': {value:"listWorkspaces"},
                'cwm-workspace-id': {value:""},
                'cwm-intent': {value:""},
                'cwm-example': {value:""},
                'cwm-entity': {value:""},
                'cwm-entity-value': {value:""},
                'cwm-dialog-node': {value:""},
                'cwm-export-content': {value:false},
                'cwm-default-endpoint' :{value: true},
                'cwm-service-endpoint' :{value: 'https://gateway.watsonplatform.net/assistant/api'}
            },
            credentials: {
              username: {type:'text'},
              password: {type: 'password'},
              apikey: {type: 'password'}
            },
            color: 'rgb(84,149,180)',
            inputs: 1,
            outputs: 1,
            icon: 'conversation-v1-25x25.png',
            paletteLabel: 'assistant workspace manager',
            label: function() {
                return this.name || 'assistant workspace manager';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: cv1wmoneditprepare,
            oneditsave: cv1wmoneditsave
        });
    })();

</script>
<script type="text/x-red" data-help-name="watson-conversation-v1-workspace-manager">
    <p>The Conversation Workspace Manager is used to ... </p>
    <ul>
    <li>list Workspaces
      <p>In this mode a list of all workspaces a that you have
        created in the conversation services are returned on
        <code>msg.workspaces</code>
      </p>
    </li>
    <li>Get Workspace
      <p>In this mode all information about a workspace,
        optionally including all workspace content, is retrieved.
        The information is returned on
        <code>msg.workspace</code>
      </p>
    </li>
    <li>Create Workspace
      <p>In this mode, a new worskpace is created. The input json structure
        defining the content of the new workspace
        should be passed in
        as <code>msg.payload</code>
      </p>
    </li>
    <li>Update Workspace
      <p>In this mode, the specified worskpace is updated. The input json structure
        defining the content of the updates
        should be passed in
        as <code>msg.payload</code>. Only the elements need to be included
        in the json. Any included element will override the existing setting
        for the element. ie. If only updating entities, then only entities need
        to be included in the json. Any existing entities in the workspace will
        be overridden. ie. If any entity is not mentioned in the json, then it
        will be deleted from the workspace.
      </p>
    </li>
    <li>Delete Workspace
      <p>In this mode the selected workspace is deleted.
      </p>
    </li>
    <li>list Intents
      <p>In this mode a list of all intents for the specified conversation
        workspace are returned on
        <code>msg.intents</code>
      </p>
    </li>
    <li>Get Intent
      <p>In this mode all information about the specified intent
        is retrieved. The information is returned on
        <code>msg.intent</code>
      </p>
    </li>
    <li>Create Intent
      <p>In this mode, a new intent is created in the specified workspace.
        The input json structure
        defining the content of the new intent
        should be passed in
        as <code>msg.payload</code>
      </p>
    </li>
    <li>Update Intent
      <p>In this mode, the specified intent is updated. The input json structure
        defining the content of the updates
        should be passed in
        as <code>msg.payload</code>. Only the elements need to be included
        in the json. Any included element will override the existing setting
        for the element. ie. If only updating examples, then only the examples
        need be included in the json. Any existing examples will
        be overridden. ie. If any example is not mentioned in the json, then it
        will be deleted.
        You can use this mode to rename an intent.
      </p>
    </li>
    <li>Delete Intent
      <p>In this mode the selected intent is removed from the worskpace.
      </p>
    </li>
    <li>List Examples
      <p>In this mode a list of all user input examples for an intent in
        the specified conversation
        workspace are returned on
        <code>msg.examples</code>
      </p>
    </li>
    <li>Create Example
      <p>In this mode a new example is created for an intent in the
        specified conversation workspace.
      </p>
    </li>
    <li>Delete Example
      <p>In this mode the selected example for an intent is removed.
      </p>
    </li>
    <li>List Counter Examples
      <p>In this mode a list of all counter examples in
        the specified conversation
        workspace are returned on
        <code>msg.counterexamples</code>.
        Counterexamples are examples that have been marked as
        irrelevant input.
      </p>
    </li>
    <li>Create Counter Example
      <p>In this mode a new counter example is created in the
        specified conversation workspace.
      </p>
    </li>
    <li>Delete Counter Example
      <p>In this mode an existing counter example is deleted from the
        specified conversation workspace.
      </p>
    </li>
    <li>list Entities
      <p>In this mode a list of all entities for the specified conversation
        workspace are returned on
        <code>msg.entities</code>
      </p>
    </li>
    <li>Get Entity
      <p>In this mode all information about the specified entity
        is retrieved. The information is returned on
        <code>msg.entity</code>
      </p>
    </li>
    <li>Create Entity
      <p>In this mode, a new entity is created in the specified workspace.
        The input json structure
        defining the content of the new entity
        should be passed in
        as <code>msg.payload</code>
      </p>
    </li>
    <li>Update Entity
      <p>In this mode, the specified entity is updated. The input json structure
        defining the content of the updates
        should be passed in
        as <code>msg.payload</code>. Only the elements need to be included
        in the json. Any included element will override the existing setting
        for the element. ie. Any existing elements will
        be overridden. ie. If any element is not mentioned in the json, then it
        will be deleted.
        You can use this mode to rename an entity.
      </p>
    </li>
    <li>Delete Entity
      <p>In this mode the selected entity is removed from the worskpace.
      </p>
    </li>
    <li>list Entity Values
      <p>In this mode a list of all values for an entitu for the specified conversation
        workspace are returned on
        <code>msg.values</code>
      </p>
    </li>
    <li>Get Entity Value
      <p>In this mode all information about the specified entity value
        is retrieved. The information is returned on
        <code>msg.value</code>
      </p>
    </li>
    <li>Add Entity Value
      <p>In this mode, a new entity value is created in the specified workspace.
        The input json structure
        defining the content of the new entity value
        should be passed in
        as <code>msg.value</code>
      </p>
    </li>
    <li>Update Entity Value
      <p>In this mode, the specified entity value is updated. The input json
        structure
        defining the content of the updates
        should be passed in
        as <code>msg.payload</code>. Only the elements need to be included
        in the json. Any included element will override the existing setting
        for the element. ie. Any existing elements will
        be overridden. ie. If any element is not mentioned in the json, then it
        will be deleted.
        You can use this mode to rename an entity value.
      </p>
    </li>
    <li>Delete Entity Value
      <p>In this mode the selected entity value is removed from the worskpace.
      </p>
    </li>
    <li>list Dialog Nodes
      <p>In this mode a list of all dialog nodes for the specified conversation
        workspace are returned on
        <code>msg.dialog_nodes</code>
      </p>
    </li>
    <li>Get Dialog Node
      <p>In this mode all information about the dialog node
        is retrieved. The information is returned on
        <code>msg.dialog_node</code>
      </p>
    </li>
    <li>Create Dialog Node
      <p>In this mode, a new dialog node is created. The input json structure
        defining the content of the node
        should be passed in
        as <code>msg.payload</code>.
      </p>
    </li>
    <li>Update Dialog Node
      <p>In this mode, the specified dialog node is updated. The input json structure
        defining the content of the updates
        should be passed in
        as <code>msg.payload</code>.
      </p>
    </li>
    <li>Delete Dialog Node
      <p>In this mode the selected dialog node is removed from the worskpace.
      </p>
    </li>
    </ul>

    <p>The node configurations can be overridden by setting
    <ul>
      <li>
        <code>msg.params.username</code>
      </li>
      <li>
        <code>msg.params.password</code>
      </li>
      <li>
        <code>msg.params.apikey</code>
      </li>
      <li>
        <code>msg.params.workspace_id</code>
      </li>
      <li>
        <code>msg.params.intent</code>
      </li>
      <li>
        <code>msg.params.example</code>
      </li>
      <li>
        <code>msg.params.entity</code>
      </li>
      <li>
        <code>msg.params.entity_value</code>
      </li>
      <li>
        <code>msg.params.dialog_node</code>
      </li>

      <li>
        <code>msg.params.method</code>
        <p>to one of the following values:
        <select>
        <option> listWorkspaces </option>
        <option> getWorkspace </option>
        <option> createWorkspace </option>
        <option> updateWorkspace </option>
        <option> deleteWorkspace </option>
        <option> listIntents </option>
        <option> getIntent </option>
        <option> createIntent </option>
        <option> updateIntent </option>
        <option> deleteIntent </option>
        <option> listExamples </option>
        <option> createExample </option>
        <option> deleteExample </option>
        <option> listCounterExamples </option>
        <option> createCounterExample</option>
        <option> deleteCounterExample </option>
        <option> listEntities </option>
        <option> getEntity </option>
        <option> createEntity </option>
        <option> updateEntity </option>
        <option> deleteEntity </option>
        <option> listEntityValues </option>
        <option> getEntityValue </option>
        <option> addEntityValue </option>
        <option> updateEntityValue </option>
        <option> deleteEntityValue </option>
        <option> listDialogNodes </option>
        <option> getDialogNode </option>
        <option> createDialogNode </option>
        <option> updateDialogNode </option>
        <option> deleteDialogNode </option>
        </select>
        </p>


      </li>
    </ul>
    </p>

    <p>For more information about the conversation service,
    read the <a href="https://console.bluemix.net/docs/services/conversation/index.html">
    documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-discovery-v1] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-discovery-v1">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/discovery/api">
    </div>

    <div class="form-row">
        <label for="node-input-discovery-method"><i class="fa fa-book"></i> Method: </label>
        <select type="text" id="node-input-discovery-method" style="display: inline-block; width: 70%;">
            <option value="query">Search in collection</option>
            <option disabled>______________</option>
            <option value="createEnvrionment">Create new environment</option>
            <option value="listEnvrionments">List existing environments</option>
            <option value="getEnvironmentDetails">Retrieve environment details</option>
            <option value="deleteEnvironment">Delete environment</option>
            <option disabled>______________</option>
            <option value="createCollection">Create new collection</option>
            <option value="listCollections">List existing collections</option>
            <option value="getCollectionDetails">Retrieve collection details</option>
            <option value="deleteCollection">Delete collection</option>
            <option disabled>______________</option>
            <option value="createConfiguration">Create new configuration</option>
            <option value="listConfigurations">List existing configurations</option>
            <option value="getConfigurationDetails">Retrieve configuration details</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-environmentname"><i class="fa fa-tag"></i> Environment Name</label>
        <input type="text" id="node-input-environmentname" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-environment_id"><i class="fa fa-tag"></i> Environment ID</label>
        <input type="text" id="node-input-environment_id" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-collection_name"><i class="fa fa-tag"></i> Collection Name</label>
        <input type="text" id="node-input-collection_name" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-collection_id"><i class="fa fa-tag"></i> Collection ID</label>
        <input type="text" id="node-input-collection_id" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-configurationname"><i class="fa fa-tag"></i> Configuration Name</label>
        <input type="text" id="node-input-configurationname" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-configuration_id"><i class="fa fa-tag"></i> Configuration ID</label>
        <input type="text" id="node-input-configuration_id" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-language_code"><i class="fa fa-language"></i> Language: </label>
        <select type="text" id="node-input-language_code" style="display: inline-block; width: 70%;">
            <option value="en">English</option>
            <option value="de">German</option>
            <option value="es">Spanish</option>
            <option value="ar">Arabic</option>
            <option value="fr">French</option>
            <option value="it">Italian</option>
            <option value="ja">Japanese</option>
            <option value="pt-br">Brazilian Portuguese</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-count"><i class="fa fa-tag"></i> Number of documents</label>
        <input type="text" id="node-input-count" placeholder="">
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-passages" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-passages" style="width: 70%;"> Passages</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-nlp_query" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-nlp_query" style="width: 70%;"> Query in Plain Language</label>
    </div>

    <div class="form-row">
        <label for="node-input-query"><i class="fa fa-tag"></i> Query for Search</label>
        <input type="text" id="node-input-query" placeholder="">
    </div>


    <div class="form-row">
        <label for="node-input-filter"><i class="fa fa-tag"></i> Filter for Search</label>
        <input type="text" id="node-input-filter" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-aggregation"><i class="fa fa-tag"></i> Aggregation for Search</label>
        <input type="text" id="node-input-aggregation" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-return"><i class="fa fa-tag"></i> List of sections to return</label>
        <input type="text" id="node-input-return" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-tag"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="Name">
    </div>
    <div class="form-row">
      <label for="node-input-size">Envrionment Size</label>
      <input type="number" min="0" max="4"
             id="node-input-size" />
    </div>

</script>



<script type="text/javascript">

    // Need to simulate a namespace, so that some of the variables don't leak across nodes
    function DiscoveryExperimentalV1 () {}

    // This is the namespace for this version of this Node.
    var disV1 = new DiscoveryExperimentalV1();

    //disV1.abc = 'abc';
    disV1.hideAll = function() {
      $('#node-input-environmentname').parent().hide();
      $('#node-input-environment_id').parent().hide();
      $('#node-input-collection_name').parent().hide();
      $('#node-input-collection_id').parent().hide();
      $('#node-input-configurationname').parent().hide();
      $('#node-input-configuration_id').parent().hide();
      $('#node-input-language_code').parent().hide();
      $('#node-input-count').parent().hide();
      $('#node-input-passages').parent().hide();
      $('#node-input-nlp_query').parent().hide();
      $('#node-input-query').parent().hide();
      $('#node-input-filter').parent().hide();
      $('#node-input-aggregation').parent().hide();
      $('#node-input-return').parent().hide();
      $('#node-input-description').parent().hide();
      $('#node-input-size').parent().hide();
    };

    disV1.showSelectedFields = function(fields) {
      for (i = 0; i < fields.length; i++) {
        $(fields[i]).parent().show();
      }
    }

    disV1.processSelectedMethod = function(method) {
      disV1.hideAll();
      fields = [];
      switch (method) {
        case 'createEnvrionment':
          fields.push('#node-input-environmentname'
                          + ', #node-input-size'
                          + ', #node-input-description');
          break;
        case 'listEnvrionments':
          fields.push('#node-input-environmentname');
          break;
        case 'createCollection':
          fields.push('#node-input-environment_id'
                          + ', #node-input-configuration_id'
                          + ', #node-input-language_code'
                          + ', #node-input-collection_name'
                          + ', #node-input-description');
          break;
        case 'createConfiguration':
        case 'getEnvironmentDetails':
        case 'listCollections':
        case 'deleteEnvironment':
          fields.push('#node-input-environment_id');
          break;
        case 'getCollectionDetails':
        case 'deleteCollection':
          fields.push('#node-input-environment_id'
                          + ', #node-input-collection_id');
          break;
        case 'listConfigurations':
          fields.push('#node-input-environment_id'
                          + ', #node-input-configurationname');
          break;
        case 'getConfigurationDetails':
          fields.push('#node-input-environment_id'
                         + ', #node-input-configuration_id');
          break;
        case 'query':
          fields.push('#node-input-environment_id'
                         + ', #node-input-collection_id'
                         + ', #node-input-count'
                         + ', #node-input-passages'
                         + ', #node-input-nlp_query'
                         + ', #node-input-query'
                         + ', #node-input-filter'
                         + ', #node-input-aggregation'
                         + ', #node-input-return');
          break;
      }
      disV1.showSelectedFields(fields);
    }

    disV1.UIListeners = function () {
      $('#node-input-discovery-method').change(function(val){
        var method = $('#node-input-discovery-method').val();
        disV1.processSelectedMethod(method);
      });

      $('input#node-input-default-endpoint').change(function () {
          var checked = $('input#node-input-default-endpoint').prop('checked')
          if (checked) {
              $('#node-input-service-endpoint').parent().hide();
          } else {
              $('#node-input-service-endpoint').parent().show();
          }
      });
    }

    disV1.checkForPrepare = function () {
      disV1.hideAll();
      disV1.UIListeners();
    };

    // This is the on edit prepare function, which will be invoked everytime the dialog is shown.
    function oneditprepare() {
      disV1.checkForPrepare();
      $.getJSON('watson-discovery/vcap/')
        .done(function (service) {
          $('.credentials').toggle(!service);
        })
        .fail(function () {
          $('.credentials').show();
        }).always(function () {
          $('#credentials-check').hide();
        })
    }

    (function() {
        RED.nodes.registerType('watson-discovery-v1', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                environmentname: {value: ''},
                environment_id: {value: ''},
                collection_id: {value: ''},
                configurationname: {value: ''},
                configuration_id: {value: ''},
                language_code: {value: 'en'},
                collection_name: {value: ''},
                count: {value: '1'},
                passages: {value: 'false'},
                nlp_query: {value: 'false'},
                query: {value: ''},
                filter: {value: ''},
                aggregation: {value: ''},
                return: {value: ''},
                description: {value: ''},
                size: {value: 0},
                'discovery-method': {value:'query'},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/discovery/api'}
            },
            credentials: {
              username: {type:'text'},
              password: {type:'password'},
              apikey: {type:'password'}
            },
            color: 'rgb(230,140,80)',
            inputs: 1,
            outputs: 1,
            icon: 'discovery.png',
            paletteLabel: 'discovery',
            label: function() {
                return this.name || 'discovery';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-discovery-v1">
    <p>This is the Node for the V1 Watson Discovery service.</p>
    <p>The following methods are available:</p>
    <ul>
    <li>
        <p><b>Create New Environment</b><p>
        <p>For this method the node needs an Environment Name,
        Description and Environment Size as input.
        </p>
        <p>The name and description can be overridden by specifying
          in <code>msg.discoveryparams.environmentname</code>
          , <code>msg.discoveryparams.description</code>
          and <code>msg.discoveryparams.size</code>
        </p>
        <p>Node output : </p>
          <ul>
            <li><code>msg.environment</code> : Information about the
            newly created envrionment.</li>
          </ul>
    </li>
    <br/>
        <li>
            <p><b>List Existing Environments</b><p>
            <p>For this method the node does not need any input. If the envrionment name field is left blank
      it will list all envrionments created for the instance of the Discovery service.
      If the envrionment name is specified, then only the details for
      the Discovery envrionment with the specified name will be returned.
            </p>
            <p>The environment being requested can be overridden by specifying the search name
      in <code>msg.discoveryparams.environmentname</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.environments</code> : A list of the envrionments created under
              the Discovery service instance.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>Get Envrionment Details</b><p>
            <p>For this method the node needs an Environment ID as input.
            </p>
            <p>The environment being requested can be overridden by specifying the search id
      in <code>msg.discoveryparams.environment_id</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.environment_details</code> : Details of the requested environment.</li>
              </ul>
        </li>
        <li>
            <p><b>Create New Collection</b><p>
            <p>For this method the node needs an Environment ID, Collection Name,
            Description, Configuration ID and Language Code as input.
            </p>
            <p>The fields can be overridden by specifying
              in <code>msg.discoveryparams.environment_id</code>
              , <code>msg.discoveryparams.collection_name</code>
              , <code>msg.discoveryparams.description</code>
              , <code>msg.discoveryparams.configuration_id</code>
              and <code>msg.discoveryparams.language_code</code>
            </p>

            <p>Node output : </p>
              <ul>
                <li><code>msg.collection</code> : Information about the
                newly created collection.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>List Existing Collections</b><p>
            <p>For this method the node needs an Environment ID as input.</p>
            <p>The Environment ID for the collection list being requested can be overridden by specifying the search id
      in <code>msg.discoveryparams.environment_id</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.collections</code> : A list of the collections created under
              the environment in the Discovery service instance.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>Get Collections Details</b><p>
            <p>For this methond the node needs an Environment ID and Collection ID as input.
            </p>
            <p>The collection being requested can be overridden by specifying the
            search ids in
            <code>msg.discoveryparams.environment_id</code>
            and <code>msg.discoveryparams.collection_id</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.collection_details</code> : Details of the requested collection.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>List Existing Configurations</b><p>
            <p>For this method the node needs an Environment ID as input.</p>
            <p>and an optional Configuration name to show only the
               configuration with the given name.</p>
            <p>The Environment ID for the configuration list being requested can be
               overridden by specifying the environment id in
               <code>msg.discoveryparams.environment_id</code>
               The configuration name can be overridden by specifying the name inspect
               <code>msg.discoveryparams.configuration_name</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.configurations</code> : A list of the configurations
                  created under
                  the environment in the Discovery service instance.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>Get Configuration Details</b><p>
            <p>For this method node needs an Environment ID and Configuration ID as input.</p>
            <p>The Environment and Configuration IDs for the configuration being
               requested can be
               overridden by specifying the environment id in
               <code>msg.discoveryparams.environment_id</code>
               and the configuration id in
               <code>msg.discoveryparams.configuration_id</code>
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.configuration_details</code> : Details the
                  requested configuration.</li>
              </ul>
        </li>
        <br/>
        <li>
            <p><b>Search in Collection</b><p>
            <p>For this method the node needs an Environment ID and Collection ID as input.
            </p>
            <p>The collection being requested can be overridden by specifying the
            search ids in
            <code>msg.discoveryparams.environment_id</code>
            and <code>msg.discoveryparams.collection_id</code>
            </p>
            <p>Optionally you can specify the number of documents to retrieve, a
               query to find the most relevant search results, whether to
               retrieve the most relevant passages,
               to limit the search results, an aggregation to return an
               exact result, and a comma separated list of the sections of the
               documents to return.</p>
            <p>The query being submitted can be overridden by specifying the
            query in <code>msg.discoveryparams.query</code>.
            </p>
            <p>The passages parameter can be overridden by specifying
            <code>msg.discoveryparams.passages</code>.
            </p>
            <p>Node output : </p>
              <ul>
                <li><code>msg.search_results</code> : Details of the requested collection.</li>
              </ul>
        </li>

    </ul>

    <p>For more information about the Discovery service,
    read the service <a href="https://console.bluemix.net/docs/services/discovery/index.html">documentation</a>.</p>

</script>
<!-- --- [red-module:node-red-node-watson/watson-discovery-v1-document-loader] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-discovery-v1-document-loader">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/discovery/api">
    </div>

    <div class="form-row">
        <label for="node-input-environment_id"><i class="fa fa-tag"></i> Environment ID</label>
        <input type="text" id="node-input-environment_id" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-collection_id"><i class="fa fa-tag"></i> Collection ID</label>
        <input type="text" id="node-input-collection_id" placeholder="">
    </div>
    <div class="form-row">
        <label for="node-input-filename"><i class="fa fa-tag"></i> Filename</label>
        <input type="text" id="node-input-filename" placeholder="">
    </div>

</script>



<script type="text/javascript">

    // Need to simulate a namespace, so that some of the variables don't leak across nodes
    function DiscoveryDocLoaderV1 () {}

    // This is the namespace for this version of this Node.
    var disdocV1 = new DiscoveryDocLoaderV1();

    disdocV1.UIListeners = function () {
      $('input#node-input-default-endpoint').change(function () {
          var checked = $('input#node-input-default-endpoint').prop('checked')
          if (checked) {
              $('#node-input-service-endpoint').parent().hide();
          } else {
              $('#node-input-service-endpoint').parent().show();
          }
      });
    }

    disdocV1.checkForPrepare = function () {
      disdocV1.UIListeners();
    };

    // This is the on edit prepare function, which will be invoked everytime the dialog is shown.
    function oneditprepare() {
      disdocV1.checkForPrepare();
      $.getJSON('watson-discovery-docs/vcap/')
        .done(function (service) {
          $('.credentials').toggle(!service);
        })
        .fail(function () {
          $('.credentials').show();
        }).always(function () {
          $('#credentials-check').hide();
        })
    }

    (function() {
        RED.nodes.registerType('watson-discovery-v1-document-loader', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                environment_id: {value: ''},
                collection_id: {value: ''},
                filename: {value: ''},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/discovery/api'}
            },
            credentials: {
              username: {type:'text'},
              password: {type:'password'},
              apikey: {type:'password'}
            },
            color: 'rgb(230,140,10)',
            inputs: 1,
            outputs: 1,
            icon: 'discovery.png',
            paletteLabel: 'discovery document loader',
            label: function() {
                return this.name || 'discovery document loader';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-discovery-v1-document-loader">
    <p>This is the document loader Node for the V1 Watson Discovery service.</p>
    <p>The node needs an Environment ID and Collection ID as input.
    </p>
    <p>If a filename is not provided then one is automatically generated</p>
    <p>The collection being written to can be overridden by specifying the
    search ids in
    <code>msg.discoveryparams.environment_id</code>
    , <code>msg.discoveryparams.collection_id</code>
    and <code>msg.discoveryparams.filename</code>
    </p>
    <p>The document to be added should be passed in as a data buffer
    in <code>msg.payload</code>
    </p>

    <p>For more information about the Discovery service,
    read the service <a href="https://console.bluemix.net/docs/services/discovery/index.html">documentation</a>.</p>

</script>
<!-- --- [red-module:node-red-node-watson/watson-discovery-v1-query-builder] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-discovery-v1-query-builder">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div id="credentials-not-found" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Could not bind to service.
            </b> This node can not be further configured without a valid service.
            Try entering valid credentials?
        </div>
    </div>
    <div id="something-went-wrong" class="form-row">
        <div class="form-tips">
            <div>
                <input disabled type="text" id="node-input-errorwarning"/>
            </div>
        </div>
    </div>


    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/discovery/api">
    </div>

    <div class="form-row">
        <label for="node-input-environment"><i class="fa fa-book"></i> Environment</label>
        <select type="text" id="node-input-environment" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>
    <div>
        <input type="hidden" id="node-input-environmenthidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-collection"><i class="fa fa-book"></i> Collection</label>
        <select type="text" id="node-input-collection" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>
    <div>
        <input type="hidden" id="node-input-collectionhidden"/>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-passages" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-passages" style="width: 70%;"> Passages</label>
    </div>
    <div>
        <input type="hidden" id="node-input-passageshidden"/>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-nlp_query" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-nlp_query" style="width: 70%;"> Query in Plain Language</label>
    </div>
    <div>
        <input type="hidden" id="node-input-nlp_queryhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-querynlp"><i class="fa fa-book"></i> NLP Query </label>
        <input type="text" id="node-input-querynlp" placeholder="">
    </div>
    <div>
        <input type="hidden" id="node-input-querynlphidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-query1"><i class="fa fa-book"></i> Query Key 1</label>
        <select type="text" id="node-input-query1" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
        <input type="text" id="node-input-queryvalue1" placeholder="">
    </div>
    <div>
        <input type="hidden" id="node-input-query1hidden"/>
        <input type="hidden" id="node-input-queryvalue1hidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-query2"><i class="fa fa-book"></i> Query Key 2</label>
        <select type="text" id="node-input-query2" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
        <input type="text" id="node-input-queryvalue2" placeholder="">
    </div>
    <div>
        <input type="hidden" id="node-input-query2hidden"/>
        <input type="hidden" id="node-input-queryvalue2hidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-query3"><i class="fa fa-book"></i> Query Key 3</label>
        <select type="text" id="node-input-query3" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
        <input type="text" id="node-input-queryvalue3" placeholder="">
    </div>
    <div>
        <input type="hidden" id="node-input-query3hidden"/>
        <input type="hidden" id="node-input-queryvalue3hidden"/>
    </div>

</script>



<script type="text/javascript">

    // Need to simulate a namespace, so that some of the variables don't leak across nodes
    function DiscoveryQueryBuilderV1 () {}

    // This is the namespace for this version of this Node.
    var disQB = new DiscoveryQueryBuilderV1();
    disQB.environments = null;
    disQB.collections = {};
    disQB.schemas = {};

    // Initially assume that we dont have credentials and that neither system
    // nor local set have been provided.
    disQB.have_credentials = false;
    disQB.using_local_credentials = true;

    disQB.environment_selected = $('#node-input-environmenthidden').val();
    disQB.collection_selected = $('#node-input-collectionhidden').val();
    disQB.query1_selected = $('#node-input-query1hidden').val();
    disQB.query2_selected = $('#node-input-query2hidden').val();
    disQB.query3_selected = $('#node-input-query3hidden').val();
    disQB.passages_selected = $('#node-input-passageshidden').val();
    disQB.nlp_query_selected = $('#node-input-nlp_queryhidden').val();

    // Nothing is to be shown unless the values to show in the listCollections
    // can be obtained from the service.
    disQB.hideAll = function() {
      $('#credentials-not-found').show();
      //disQB.hideSelectedFields(fields);
      $('#something-went-wrong').hide();
      $('#node-input-environment').parent().hide();
      $('#node-input-collection').parent().hide();
      $('#node-input-querynlp').parent().hide();
      $('#node-input-query1').parent().hide();
      $('#node-input-query2').parent().hide();
      $('#node-input-query3').parent().hide();
    };

    disQB.showSelectedFields = function(fields) {
      for (i = 0; i < fields.length; i++) {
        $(fields[i]).parent().show();
      }
    }

    disQB.hideSelectedFields = function(fields) {
      for (i = 0; i < fields.length; i++) {
        $(fields[i]).parent().hide();
      }
    }

    // Set up listeners for the select lists to determine if the subsequent
    // list boxes need refreshing. ie. A change in selected Envionment, needs
    // the collection list to be revised. A change in selected collection, needs
    // the schema lists to be revised.
    disQB.UIListeners = function () {
      $('#node-input-username').change(function(val){
        disQB.getCredentials();
      });

      $('#node-input-password').change(function(val){
        disQB.getCredentials();
      });

      $('#node-input-apikey').change(function(val){
        disQB.getCredentials();
      });

      $('#node-input-environment').change(function (val) {
        disQB.environment_selected = $('#node-input-environment').val();
        if (disQB.environment_selected &&
              !disQB.collectionCheck()) {
          disQB.getCollections();
        }
        else if (disQB.environment_selected) {
          disQB.populateCollections();
        }
      });

      $('#node-input-collection').change(function (val) {
        disQB.collection_selected = $('#node-input-collection').val();
        if (disQB.collection_selected &&
              !disQB.schemaCheck()) {
          disQB.getSchemas();
        }
        else if (disQB.collection_selected) {
          disQB.populateSchemas();
        }
      });

      $('#node-input-query1').change(function (val) {
        disQB.query1_selected = $('#node-input-query1').val();
      });

      $('#node-input-query2').change(function (val) {
        disQB.query2_selected = $('#node-input-query2').val();
      });

      $('#node-input-query3').change(function (val) {
        disQB.query3_selected = $('#node-input-query3').val();
      });

      $('input#node-input-nlp_query').change(function () {
          var checked = $('input#node-input-nlp_query').prop('checked');
          if (checked) {
            $('#node-input-querynlp').parent().show();
            $('#node-input-query1').parent().hide();
            $('#node-input-query2').parent().hide();
            $('#node-input-query3').parent().hide();
          } else {
            $('#node-input-querynlp').parent().hide();
            $('#node-input-query1').parent().show();
            $('#node-input-query2').parent().show();
            $('#node-input-query3').parent().show();
          }
      });

      $('input#node-input-default-endpoint').change(function () {
          var checked = $('input#node-input-default-endpoint').prop('checked')
          if (checked) {
              $('#node-input-service-endpoint').parent().hide();
          } else {
              $('#node-input-service-endpoint').parent().show();
          }
      });

    }

    // The dialog is about to be shown.
    disQB.checkForPrepare = function () {
      disQB.hideAll();
      disQB.UIListeners();
    };

    // Search the cache for a collection
    disQB.collectionCheckForEnv = function (env) {
      var coll = null;
      if (disQB.collections && disQB.collections[env])
      {
        coll = disQB.collections[env];
      }
      return coll;
    }

    // Search the collection cache for the selected envrionment
    disQB.collectionCheck = function () {
      return disQB.collectionCheckForEnv(disQB.environment_selected);
    }

    // Search for a collection schema
    disQB.schemaCheckForCollection = function (coll) {
      var schema = null;
      if (disQB.schemas && disQB.schemas[coll])
      {
        schema = disQB.schemas[coll];
      }
      return schema;
    }

    // Search the schema cache for the selected collection.
    disQB.schemaCheck = function () {
      return disQB.schemaCheckForCollection(disQB.collection_selected);
    }

    // Fill up the Envrionment switch list
    disQB.populateEnvironments = function() {
      if (disQB.environments && disQB.environments.length) {
        $('select#node-input-environment').empty();

        disQB.environments.forEach(function(env) {
          var selectedText = '';
          if (disQB.environment_selected === env.environment_id) {
            selectedText = 'selected="selected"';
          }
          $('select#node-input-environment')
            .append('<option value='
                          + '"' + env.environment_id + '"'
                          + selectedText
                          + '>'
                          + env.name
                          + '</option>');
        });
        if (!disQB.collectionCheck()) {
          disQB.getCollections();
        }
      }
    };

    // Fill up the collection switch list
    disQB.populateCollections = function() {
      var coll = disQB.collectionCheck();
      if (coll && coll.length) {
        $('select#node-input-collection').empty();

        coll.forEach(function(c) {
          var selectedText = '';
          if (disQB.collection_selected === c.collection_id) {
            selectedText = 'selected="selected"';
          }
          $('select#node-input-collection')
            .append('<option value='
                          + '"' + c.collection_id + '"'
                          + selectedText
                          + '>'
                          + c.name
                          + '</option>');
        });
        if (!disQB.schemaCheck()) {
          disQB.getSchemas();
        }
      }
    };

    // Fill up the 3 schema switch lists
    disQB.populateSchemas = function() {
      var schema = disQB.schemaCheck();
      if (schema && schema.length) {
        $('select#node-input-query1').empty();
        $('select#node-input-query2').empty();
        $('select#node-input-query3').empty();

        schema.forEach(function(s) {
          var selected1Text = '';
          var selected2Text = '';
          var selected3Text = '';
          if (disQB.query1_selected === s) {
            selected1Text = 'selected="selected"';
          }
          if (disQB.query2_selected === s) {
            selected2Text = 'selected="selected"';
          }
          if (disQB.query3_selected === s) {
            selected3Text = 'selected="selected"';
          }
          $('select#node-input-query1')
            .append('<option value='
                          + '"' + s + '"'
                          + selected1Text
                          + '>'
                          + s
                          + '</option>');
          $('select#node-input-query2')
            .append('<option value='
                          + '"' + s + '"'
                          + selected2Text
                          + '>'
                          + s
                          + '</option>');
          $('select#node-input-query3')
            .append('<option value='
                          + '"' + s + '"'
                          + selected3Text
                          + '>'
                          + s
                          + '</option>');
        });
      }
    };


    // If we have a list of envrionments, then the
    // environment switch list can be shown.
    disQB.showEnvironments = function () {
      if (disQB.environments) {
        $('select#node-input-environment').parent().show();
        disQB.populateEnvironments();
      }
    }

    // If we have a collection for the envrionment, then the
    // collection switch list can be shown.
    disQB.showCollections = function () {
      if (disQB.collections && disQB.collectionCheck()) {
        $('select#node-input-collection').parent().show();
        disQB.populateCollections();
      }
    }

    // If we have a schema for the collection, then the
    // three query switch lists can be shown.
    disQB.showSchemas = function () {
      if (disQB.schemas && disQB.schemaCheck()) {
        var checked = $('input#node-input-nlp_query').prop('checked');
        if (!checked) {
          $('select#node-input-query1').parent().show();
          $('select#node-input-query2').parent().show();
          $('select#node-input-query3').parent().show();
        }
        disQB.populateSchemas();
      }
    }

    // Retrieve the available environments from the server, if data is returned, then
    // can enable the dynamic selection fields.
    disQB.getEnvironments = function () {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();

      var creds = {un: u, pwd: p, key: k};
      var eChecked = $('input#node-input-default-endpoint').prop('checked')
      if (!eChecked) {
        creds.endpoint = $('#node-input-service-endpoint').val();
      }

      $.getJSON('watson-discovery-v1-query-builder/environments', creds
      ).done(function (data) {
        $('#something-went-wrong').hide();
        if (data.error) {
          $('#something-went-wrong').show();
          $('input#node-input-errorwarning').val(data.error);
        }
        else {
          $('#credentials-not-found').hide();
          disQB.environments = data;
          disQB.have_credentials = true;
          disQB.showEnvironments();
        }
      }).fail(function (err) {
        var txt = 'Got server error ';
        if (err.status) {
          txt += '(' + err.status + ') '
        }
        txt += 'when trying to retrieve available envrionments';
        $('#something-went-wrong').show();
        $('input#node-input-errorwarning').val(txt);
      }).always(function () {
      });
    }

    // Retrieve the available collections in the selected envrionment from the server,
    // if data is returned, then can enable the dynamic selection fields.
    disQB.getCollections = function () {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();

      var creds = {un: u, pwd: p, key: k};
      var eChecked = $('input#node-input-default-endpoint').prop('checked')
      if (!eChecked) {
        creds.endpoint = $('#node-input-service-endpoint').val();
      }
      creds.environment_id = disQB.environment_selected;

      $.getJSON('watson-discovery-v1-query-builder/collections', creds
      ).done(function (data) {
        $('#something-went-wrong').hide();
        if (data.error) {
          $('#something-went-wrong').show();
          $('input#node-input-errorwarning').val(data.error);
        }
        else {
          disQB.collections[disQB.environment_selected] = data;
          disQB.showCollections();
        }
      }).fail(function (err) {
        var txt = 'Got server error ';
        if (err.status) {
          txt += '(' + err.status + ') '
        }
        txt += 'when trying to retrieve available collections';
        $('#something-went-wrong').show();
        $('input#node-input-errorwarning').val(txt);
      }).always(function () {
      });
    }

    // Retrieve the available collections in the selected envrionment from the server,
    // if data is returned, then can enable the dynamic selection fields.
    disQB.getSchemas = function () {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();

      var creds = {un: u, pwd: p, key: k};
      var eChecked = $('input#node-input-default-endpoint').prop('checked')
      if (!eChecked) {
        creds.endpoint = $('#node-input-service-endpoint').val();
      }
      creds.environment_id = disQB.environment_selected;
      creds.collection_id = disQB.collection_selected;

      $.getJSON('watson-discovery-v1-query-builder/schemas', creds
      ).done(function (data) {
        $('#something-went-wrong').hide();
        if (data.error) {
          $('#something-went-wrong').show();
          $('input#node-input-errorwarning').val(data.error);
        }
        else {
          disQB.schemas[disQB.collection_selected] = data;
          disQB.showSchemas();
        }
      }).fail(function (err) {
        var txt = 'Got server error ';
        if (err.status) {
          txt += '(' + err.status + ') '
        }
        txt += 'when trying to retrieve available schemas for collection';
        $('#something-went-wrong').show();
        $('input#node-input-errorwarning').val(txt);
      }).always(function () {
      });
    }


    // Simple check that is only invoked if the service is not bound into bluemix.
    // In this case the user has to provide credentials. Once there are credentials,
    // then the discovery environments are retrieved.
    disQB.getCredentials = function () {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();

      if ( (k && k.length) || (u && u.length && p) ) {
        if (!disQB.environments) {
          disQB.getEnvironments();
        }
      }
    }

    // The dynamic nature of the selection fields in this node has caused problems.
    // Whenever there is a fetch for the models, on a page refresh or applicaiton
    // restart, the settings for the dynamic fields are lost.
    // So hidden (text) fields are being used to squirrel away the values, so that
    // they can be restored.
    disQB.restoreHidden = function () {
      disQB.environment_selected = $('#node-input-environmenthidden').val();
      $('#node-input-environment').val(disQB.environment_selected);

      disQB.collection_selected = $('#node-input-collectionhidden').val();
      $('#node-input-collection').val(disQB.collection_selected);

      disQB.querynlp_selected = $('#node-input-querynlphidden').val();
      $('#node-input-querynlp').val(disQB.querynlp_selected);

      disQB.query1_selected = $('#node-input-query1hidden').val();
      $('#node-input-query1').val(disQB.query1_selected);

      disQB.queryvalue1_selected = $('#node-input-queryvalue1hidden').val();
      $('#node-input-queryvalue1').val(disQB.queryvalue1_selected);

      disQB.query2_selected = $('#node-input-query2hidden').val();
      $('#node-input-query2').val(disQB.query2_selected);

      disQB.queryvalue2_selected = $('#node-input-queryvalue2hidden').val();
      $('#node-input-queryvalue2').val(disQB.queryvalue2_selected);

      disQB.query3_selected = $('#node-input-query3hidden').val();
      $('#node-input-query3').val(disQB.query3_selected);

      disQB.queryvalue3_selected = $('#node-input-queryvalue3hidden').val();
      $('#node-input-queryvalue3').val(disQB.queryvalue3_selected);

      disQB.passages_selected = $('#node-input-passageshidden').val();
      $('#node-input-passages').val(disQB.passages_selected);

      disQB.nlp_query_selected = $('#node-input-nlp_queryhidden').val();
      $('#node-input-nlp_query').val(disQB.nlp_query_selected);
    }


    // This is the on edit prepare function, which will be invoked everytime the dialog is shown.
    function disQBoneditprepare() {
      disQB.hideAll();
      disQB.restoreHidden();

      disQB.checkForPrepare();
      if (!disQB.have_credentials) {
        $.getJSON('watson-discovery-v1-query-builder/vcap/')
          .done(function (service) {
            $('.credentials').toggle(!service);
            // for some reason the getJSON resets the vars so need to restoreHidden again
            // so again.
            disQB.have_credentials = true;
            disQB.restoreHidden();
            if (!service) {
              // no bound service, so check local settings to see if they are valid
              disQB.using_local_credentials = true;
              disQB.getCredentials();
            } else {
              // credentials are only valid if we can get hold of the models using them
              disQB.using_local_credentials = false;
              if (!disQB.environments) {disQB.getEnvironments();}
            }
          })
          .fail(function () {
            $('.credentials').show();
          }).always(function () {
            $('#credentials-check').hide();
          })
      }
      // credentials can be set during the disQBoneditprepare process, so check again.
      if (disQB.have_credentials || disQB.using_local_credentials)
      {
        $('#credentials-check').hide();
        if (disQB.have_credentials) {
          $('#credentials-not-found').hide();
        }
        if (disQB.using_local_credentials) {
          $('.credentials').show();
        }
        disQB.showEnvironments();
        disQB.showCollections();
        disQB.showSchemas();
      }
    }

    // Save the values in the dyanmic lists to the hidden fields.
    function disQoneditsave(){
      disQB.environment_selected = $('#node-input-environment').val();
      $('#node-input-environmenthidden').val(disQB.environment_selected);

      disQB.collection_selected = $('#node-input-collection').val();
      $('#node-input-collectionhidden').val(disQB.collection_selected);

      disQB.querynlp_selected = $('#node-input-querynlp').val();
      $('#node-input-querynlphidden').val(disQB.querynlp_selected);

      disQB.query1_selected = $('#node-input-query1').val();
      $('#node-input-query1hidden').val(disQB.query1_selected);

      disQB.queryvalue1_selected = $('#node-input-queryvalue1').val();
      $('#node-input-queryvalue1hidden').val(disQB.queryvalue1_selected);

      disQB.query2_selected = $('#node-input-query2').val();
      $('#node-input-query2hidden').val(disQB.query2_selected);

      disQB.queryvalue2_selected = $('#node-input-queryvalue2').val();
      $('#node-input-queryvalue2hidden').val(disQB.queryvalue2_selected);

      disQB.query3_selected = $('#node-input-query3').val();
      $('#node-input-query3hidden').val(disQB.query3_selected);

      disQB.queryvalue3_selected = $('#node-input-queryvalue3').val();
      $('#node-input-queryvalue3hidden').val(disQB.queryvalue3_selected);

      disQB.passages_selected = $('#node-input-passages').val();
      $('#node-input-passageshidden').val(disQB.passages_selected);

      disQB.nlp_query_selected = $('#node-input-nlp_query').val();
      $('#node-input-nlp_queryhidden').val(disQB.nlp_query_selected);
    }

    (function() {
        RED.nodes.registerType('watson-discovery-v1-query-builder', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                password: {value: ''},
                apikey: {type:'password'},
                environment: {value: ''},
                environmenthidden: {value: ''},
                collection: {value: ''},
                collectionhidden: {value: ''},
                nlp_query: {value: 'true'},
                nlp_queryhidden: {value: 'true'},
                querynlp: {value: ''},
                querynlphidden: {value: ''},
                query1: {value: ''},
                query1hidden: {value: ''},
                queryvalue1: {value: ''},
                queryvalue1hidden: {value: ''},
                query2: {value: ''},
                query2hidden: {value: ''},
                queryvalue2: {value: ''},
                queryvalue2hidden: {value: ''},
                query3: {value: ''},
                query3hidden: {value: ''},
                queryvalue3: {value: ''},
                queryvalue3hidden: {value: ''},
                passages: {value: false},
                passageshidden: {value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/discovery/api'}

            },
            credentials: {
              username: {type:"text"} //,
              // password: {type:"password"}
            },
            color: "rgb(200,140,80)",
            inputs: 1,
            outputs: 1,
            icon: "discovery.png",
            paletteLabel: "discovery query builder",
            label: function() {
                return this.name || "discovery query builder";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: disQBoneditprepare,
            oneditsave: disQoneditsave
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-discovery-v1-query-builder">
    <p>This is the Query Builder Node for the V1 Watson Discovery service.</p>
    <p>Use this node upflow of a Watson Discovery Node to build the query to be used
    by the Discovery Node</p>

    <p>The node fetches the searchable fields in the collection and allows you to
      set upto 3 query search items.
    </p>
    <p>The output from the Node is an object in <code>msg.discoveryparams</code>
    that the Watson Discovery Node uses as override settings.
    </p>

    <p>For more information about the Discovery service,
    read the service <a href="https://console.bluemix.net/docs/services/discovery/index.html">documentation</a>.</p>

</script>
<!-- --- [red-module:node-red-node-watson/watson-language-translator-v3] --- -->
<!--
  Copyright 2013,2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-translator">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div id="credentials-not-found" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Could not bind to service. </b> This node can not be further configured without a valid service. Try entering valid credentials?
        </div>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"/>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username"/>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password"/>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/language-translator/api">
    </div>

    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-cog"></i> Mode</label>
        <select type="text" id="node-input-action" style="display: inline-block; vertical-align:middle; width: 70%;">
            <option value="translate">Translate</option>
            <option value="custom">Customised Translate</option>
            <option value="train">Train</option>
            <option value="getstatus">Get status</option>
            <option value="delete">Delete</option>
        </select>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-neural" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-neural" style="width: 70%;"> Use Experimental Neural Translation</label>
    </div>

    <div class="form-row">
        <label for="node-input-domain"><i class="fa fa-book"></i> Domains</label>
        <select type="text" id="node-input-domain" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>

    <div>
        <input type="hidden" id="node-input-domainhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-custom"><i class="fa fa-book"></i> Customised Model</label>
        <select type="text" id="node-input-custom" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>

    <div>
        <input type="hidden" id="node-input-customhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-srclang"><i class="fa fa-comments-o"></i> Source</label>
        <select type="text" id="node-input-srclang" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>
    <div>
        <input type="hidden" id="node-input-srclanghidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-destlang"><i class="fa fa-comments-o"></i> Target</label>
        <select type="text" id="node-input-destlang" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>
    <div>
        <input type="hidden" id="node-input-destlanghidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-basemodel"><i class="fa fa-book"></i> Base model</label>
        <select type="text" id="node-input-basemodel" style="display: inline-block; vertical-align:middle; width: 70%;">
        </select>
    </div>
    <div>
        <input type="hidden" id="node-input-basemodelhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-filetype"><i class="fa fa-book"></i> File type</label>
        <select type="text" id="node-input-filetype" style="display: inline-block; vertical-align:middle; width: 70%;">
            <option value="forcedglossary" selected="selected">Forced glossary</option>
            <option value="parallelcorpus">Parallel corpus</option>
            <option value="monolingualcorpus">Monolingual corpus</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-trainid"><i class="fa fa-tag"></i> Model ID</label>
        <input type="text" id="node-input-trainid" placeholder="Model ID">
    </div>

    <div class="form-row">
       <label for="node-input-lgparams2"><i class="fa fa-cog"></i> Parameters Scope</label>
       <input type="checkbox" id="node-input-lgparams2" style="display: inline-block; width: auto; vertical-align: top;">
       <label for="node-input-lgparams2" style="width: 70%;"> Not using translation utility</label>
    </div>

    <div class="form-tips" id="languagetranslation-form-tips">
      <strong>Note:</strong> When <strong>not</strong> using the languge translation
      utility to set credentials then
      'Not using translation utility' must be checked, else credentials
      will not be found.<br>
    </div>

</script>



<script type="text/javascript">
  // Need to simulate a namespace, so that some of the variables don't leak across nodes
  function Translator () {
  }

  // This is the namespace for tts.
  var tor = new Translator();

  tor.models = null;
  tor.domains = null;
  tor.basemodels = null;
  tor.custommodels = null;
  tor.domain_type;
  tor.have_credentials = false;
  tor.using_local_credentials = false;
  tor.using_local_parameters2 = false;
  tor.using_gloabal_parameters2 = false;

  tor.action = $('#node-input-action').val();
  tor.domain_selected = $('#node-input-domainhidden').val();
  tor.custom_selected = $('#node-input-customhidden').val();
  tor.srclang_selected = $('#node-input-srclanghidden').val();
  tor.destlang_selected = $('#node-input-destlanghidden').val();
  tor.base_model_selected = $('#node-input-basemodelhidden').val();

  tor.LANGUAGES = { 'ar' : 'Arabic',
                    'arz': 'Spoken Arabic',
                    'en': 'English' ,
                    'es': 'Spanish',
                    'fr': 'French',
                    'it': 'Italian',
                    'de': 'German',
                    'ja': 'Japanese',
                    'pt': 'Portuguese',
                    'ko': 'Korean',
                    'nl': 'Dutch',
                    'pl': 'Polish',
                    'ru': 'Russian',
                    'tr': 'Turkish',
                    'zh': 'Chinese',
                    'zh-TW' : 'Taiwanese',
                    'zht': 'Traditional Chinese'
                  };

  // convert an id in the form it-ko into Italian - Korean for display
  tor.changeIdToText = function (id) {
    var txt = "";
    var langs = id.split('-');
    var first = true;

    langs.forEach(function(language){
      txt += (tor.LANGUAGES[language] ? tor.LANGUAGES[language] : language);
      if (first) {
        txt += ' - ';
        first = false;
      }
    })
    return txt;
  }

  // Function to be used at the start, as don't want to expose any fields, unless the model is
  // available. The model it self can only be fetched if the credentials are available.
  tor.hideAll = function () {
    if (!tor.models) {
        $('#credentials-not-found').show();
        $('#node-input-action').parent().hide();
        $('select#node-input-srclang, select#node-input-destlang').parent().hide();
        $('select#node-input-domain').parent().hide();
        $('select#node-input-custom').parent().hide();
        $('select#node-input-basemodel').parent().hide();
        $('select#node-input-filetype').parent().hide();
        $('input#node-input-trainid').parent().hide();
        $('input#node-input-lgparams2').parent().hide();
        $('input#node-input-neural').parent().hide();
        $('#languagetranslation-form-tips').show();
    }
  }

  // If we have models, then certain fields can be shown.
  // this is invoked in the process tha obtains the models, which may be
  // after the dialog is shown.
  // ie. all the fields are initially hidden, but once the credentials are valid and
  // the model has been retrieved then this function is invoked to update what fields
  // are shown without the user having to close the dialog.
  // Problem is that the onchange is only invoked when the user tabs to another field.
  tor.checkVisibility = function () {
    if (tor.models) {
      $('#node-input-action').parent().show();
      tor.checkActionSelected();
    }
  }

  // sorting functions
  tor.checkUnique = function (value, index, self) {
    return self.indexOf(value) === index;
  }

  // Flush the cache
  tor.flushModelCache = function () {
    tor.models = null;
    tor.domains = null;
    tor.basemodels = null;
    tor.custommodels = null;
    tor.checkModels();
  }

  // Retrieve the available models from the server, if data is returned, then
  // can enable the dynamic selection fields.
  tor.checkModels = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();
    var e = $('#node-input-service-endpoint').val();
    var creds = {un: u, pwd: p, key: k};

    if ($('#node-input-neural').prop('checked')) {
      creds.n = 'Y';
    }

    if (! $('#node-input-default-endpoint').prop('checked')) {
      creds.e = e;
    }

    $.getJSON('watson-translator/models/', creds)
    .done(function (data) {
      if (data.models) {
        tor.models = data.models;
        tor.have_credentials = true;
        tor.checkVisibility();
      }
    }).fail(function (err) {
      console.log(err);
    }).always(function () {});
  }

  // Simple check that is only invoked if the service is not bound into bluemix. In this case the
  // user has to provide credentials. Once there are credentials, then the models are retrieved.
  tor.getCredentials = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();

    if ( (k && k.length) || (u && u.length && p) ) {
      if (!tor.models) {
        tor.checkModels();
        if (tor.models) {$('#node-input-action').parent().show(); }
      }
    } else if (!tor.models) {
      $('#node-input-action').parent().hide();
    }
  }

  // function that is called when the domain or the source language is changed. In this case the
  // destination language selection field is dynamically repopulated, and reselected if the
  // previously selection is still in the new list.
  tor.langDestAvailable = function () {
    if (!tor.domain_type) { return; }

    var pair_lang = tor.domain_type.map(function (a) {
      return a.model_id;
    });

    // need to do an exact source language match to allow for variations
    // like ar and arz. if the input is ar, then don't want it to match with arz
    var available_destlang = pair_lang.filter(function (model_id) {
      return model_id.match('^' + tor.srclang_selected + '-');
    });

    // Flush out the list first
    $('select#node-input-destlang').empty();

    available_destlang.forEach(function (val) {
      // can now have languages like zh-TW, so simple split on -
      // no longer works.
      // var lang = val.split('-')[1];
      let lang = val.replace(tor.srclang_selected + '-', '');

      var selectedText = '';
      if (tor.destlang_selected === lang) {
        selectedText = 'selected="selected"';
      }
      $('select#node-input-destlang')
        .append('<option value='
                      + '"' + lang + '"'
                      + selectedText
                      + '>'
                      + (tor.LANGUAGES[lang] ? tor.LANGUAGES[lang] : lang)
                      + '</option>');
    });
    tor.destlang_selected = $('#node-input-destlang').val();
  }

  // Populates the domains selection field.
  // If domains have already been retrieved then no need to refetch them.
  tor.checkDomains = function () {
    if (!tor.domains) {
      tor.domains = tor.models.map(function (a) {
        return a.domain;
      });
    }
    if (tor.domains && tor.domains.length) {
      $('select#node-input-domain').empty();
      var unique_domains = tor.domains.filter(tor.checkUnique);

      unique_domains.forEach(function(domain) {
        var selectedText = '';
        if (tor.domain_selected === domain) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-domain')
          .append('<option value='
                        + '"' + domain + '"'
                        + selectedText
                        + '>'
                        + domain.charAt(0).toUpperCase()
                        + domain.slice(1)
                        + '</option>');
      });

    tor.checkDomainSelected();
    }
  }

  // Populates the base model field. These are the models that are available to be customised.
  tor.checkBaseModels = function () {
    if (!tor.basemodels && tor.models) {
      tor.basemodels = tor.models.filter(function (model) {
        return model.customizable === true;
      });
    }
    if (tor.basemodels) {
      $('select#node-input-basemodel').empty();
      tor.basemodels.forEach(function(base_model){
        var selectedText = '';
        if (tor.base_model_selected === base_model.model_id) {
            selectedText = 'selected="selected"';
        }
        $('select#node-input-basemodel')
            .append('<option value='
                          + '"' + base_model.model_id + '"'
                          + selectedText
                          + '>'
                          + tor.changeIdToText(base_model.model_id)
                          + '</option>');
      });
    }
  }

  // Populates the customised models field. These are the models that have been
  // customised. This control needs to be refreshed. Currently the only that that
  // will happen is by a page refresh. Need to have a trigger everytime the create
  // new model is triggerd, but that is a little complicated and needs to be done on
  // a clear mind.
  tor.checkCustomsAvailable = function () {
    if (!tor.custommodels && tor.models) {
      tor.custommodels = tor.models.filter(function (m) {
        return (m.base_model_id && ('' != m.base_model_id));
      });
    }
    if (tor.custommodels) {
      $('select#node-input-custom').empty();

      tor.custommodels.forEach(function(m){
        var selectedText = '';
        if (tor.custom_selected === m.model_id) {
            selectedText = 'selected="selected"';
        }
        $('select#node-input-custom')
            .append('<option value='
                        + '"' + m.model_id + '"'
                        + selectedText
                        + '>'
                        + m.model_id
                        + ' (' + m.domain + ' ' + m.base_model_id + ' ' + m.name + ')'
                        + '</option>');

      });
    }
  }


  // UI Handler for the Mode / switch.
  // Princliple function is to show / hide the appropriate fields.
  tor.checkActionSelected = function () {
    tor.action = $('#node-input-action').val();
    if (tor.models) {
      $('#credentials-not-found').hide();
      switch (tor.action) {
        case 'translate':
          $('select#node-input-srclang, select#node-input-destlang').parent().show();
          $('select#node-input-domain').parent().show();
          $('select#node-input-custom').parent().hide();
          $('select#node-input-basemodel, select#node-input-filetype').parent('').hide();
          $('input#node-input-trainid').parent('').hide();
          $('input#node-input-lgparams2').parent().show();
          $('input#node-input-neural').parent().show();
          $('#languagetranslation-form-tips').show();
          break;
        case 'custom':
          $('select#node-input-custom').parent().show();
          $('select#node-input-srclang, select#node-input-destlang').parent().hide();
          $('select#node-input-domain').parent().hide();
          $('select#node-input-basemodel, select#node-input-filetype').parent('').hide();
          $('input#node-input-trainid').parent('').hide();
          $('input#node-input-lgparams2').parent().show();
          $('input#node-input-neural').parent().hide();
          $('#languagetranslation-form-tips').show();
          break;
        case 'train':
          $('select#node-input-custom').parent().hide();
          $('select#node-input-srclang, select#node-input-destlang').parent().hide();
          $('select#node-input-domain').parent().hide();
          $('select#node-input-basemodel, select#node-input-filetype').parent('').show();
          $('input#node-input-trainid').parent('').hide();
          $('input#node-input-lgparams2').parent().show();
          $('input#node-input-neural').parent().hide();
          $('#languagetranslation-form-tips').show();
          break;
        case 'getstatus':
        case 'delete':
          $('select#node-input-custom').parent().hide();
          $('input#node-input-trainid').parent('').show();
          $('select#node-input-srclang, select#node-input-destlang').parent().hide();
          $('select#node-input-domain').parent().hide();
          $('select#node-input-basemodel, select#node-input-filetype').parent('').hide();
          $('input#node-input-lgparams2').parent().show();
          $('input#node-input-neural').parent().hide();
          $('#languagetranslation-form-tips').show();
          break;
      }
      tor.checkDomains();
      tor.checkBaseModels();
      tor.checkCustomsAvailable();
    } else {
      $('#credentials-not-found').show();
    }
  }

  // UI Handler for the Parameter scope switch: Local or Global
//  tor.checkParamScopeSelected = function (){
//    // Checkbox control
//    tor.lg_parameters_selected2 = $('input#node-input-lgparams2').prop('checked');
//    if (checked) {
//      tor.using_gloabal_parameters2 = true;
//      tor.using_local_parameters2 = false;
//    } else {
//      tor.using_gloabal_parameters2 = false;
//      tor.using_local_parameters2 = true;
//    }
//  }


  // UI Handler for the domain switch
  // Repopulate the source and languages based on the available translations for the domain
  tor.checkDomainSelected = function (){
    $('#node-input-srclang').empty();
    $('#node-input-destlang').empty();
    if (tor.models && tor.domains) {
      tor.domain_selected = $('#node-input-domain').val();
      tor.domain_type = tor.models.filter(function (model) {
        return model.domain === tor.domain_selected && model.status === 'available';
      });
      var input_lang = tor.domain_type.map(function (a) {
        return a.source;
      });
      var output_lang = tor.domain_type.map(function (a) {
        return a.target;
      });

      input_lang_unique = input_lang.filter(tor.checkUnique);
      output_lang_unique = output_lang.filter(tor.checkUnique);

      // Flush out the List before repopulating it.
      $('select#node-input-srclang').empty();

      input_lang_unique.forEach(function(lang){
        var selectedText = '';
        if (tor.srclang_selected === lang) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-srclang')
          .append('<option value='
                        + '"' + lang + '"'
                        + selectedText
                        + '>'
                        + (tor.LANGUAGES[lang] ? tor.LANGUAGES[lang] : lang)
                        + '</option>');
      });
      // Having repopulated the input language selection, the old selected item
      // may no longer be in the list, so refresh it.
      tor.srclang_selected = $('#node-input-srclang').val();
      tor.langDestAvailable();
    }
  }


  // Register the handlers for the fields
  tor.UIListeners = function () {
    $('#node-input-username').change(function(val){
      tor.getCredentials();
      if (tor.have_credentials) {
        tor.checkActionSelected();}
    });
    $('#node-input-password').change(function(val){
      tor.getCredentials();
      if (tor.have_credentials) {
        tor.checkActionSelected();
      }
    });
    $('#node-input-apikey').change(function(val){
      tor.getCredentials();
      if (tor.have_credentials) {
        tor.checkActionSelected();
      }
    });

    $('#node-input-action').change(function(val){
      tor.action = $('#node-input-action').val();
      tor.checkActionSelected();
    });

    $('#node-input-domain').change(function (val) {
      tor.domain_selected = $('#node-input-domain').val();
      tor.checkDomainSelected();
    });

    $('#node-input-custom').change(function () {
      tor.custom_selected = $('#node-input-custom').val();
    });

    $('#node-input-srclang').change(function () {
      tor.srclang_selected = $('#node-input-srclang').val();
      tor.langDestAvailable();
    });

    $('#node-input-destlang').change(function () {
      tor.destlang_selected = $('#node-input-destlang').val();
    });

    $('#node-input-basemodel').change(function (val) {
      tor.base_model_selected = $('#node-input-basemodel').val();
    });

    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });

    $('#node-input-neural').change(function () {
      tor.flushModelCache();
    });

  }

  // The dynamic nature of the selection fields in this node has caused problems.
  // Whenever there is a fetch for the models, on a page refresh or applicaiton
  // restart, the settings for the dynamic fields are lost.
  // So hidden (text) fields are being used to squirrel away the values, so that
  // they can be restored.
  tor.restoreHidden = function () {
    tor.domain_selected = $('#node-input-domainhidden').val();
    $('select#node-input-domain').val(tor.domain_selected);
    tor.srclang_selected = $('#node-input-srclanghidden').val();
    $('select#node-input-srslang').val(tor.srclang_selected);
    tor.destlang_selected = $('#node-input-destlanghidden').val();
    $('select#node-input-destlang').val(tor.destlang_selected);

    tor.base_model_selected = $('#node-input-basemodelhidden').val();
    $('select#node-input-basemodel').val(tor.base_model_selected);
    tor.custom_selected = $('#node-input-customhidden').val();
    $('select#node-input-custom').val(tor.custom_selected);

  }

  // This is the on edit prepare function, which will be invoked everytime the dialog is shown.
  function oneditprepare() {
    tor.hideAll();
    tor.restoreHidden();

    tor.UIListeners();
    // Look for VCAP Json file, done is called if found or not, with service indicating
    // if the translation service is actually bound into this application.
    if (!tor.have_credentials) {
      $.getJSON('watson-translator/vcap/')
        .done(function (service) {
          // for some reason the getJSON resets the vars so need to restoreHidden again
          // so again.
          tor.restoreHidden();
          $('.credentials').toggle(!service);
          if (!service) {
            // no bound service, so check local settings to see if they are valid
            tor.using_local_credentials = true;
            tor.getCredentials();
          } else {
            // credentials are only valid if we can get hold of the models using them
            tor.using_local_credentials = false;
            if (!tor.models) {tor.checkModels();}
          }
        }).fail(function () {
          $('.credentials').show();
        }).always(function () {
          $('#credentials-check').hide();
        });
    }
    // credentials can be set during the oneditprepare process, so check again.
    if (tor.have_credentials || tor.using_local_credentials)
    {
      $('#credentials-check').hide();
      if (tor.have_credentials) {
        $('#credentials-not-found').hide();
      }
      if (tor.using_local_credentials) {
        $('.credentials').show();
      }
      tor.checkActionSelected();
    }
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function oneditsave(){
    $('#node-input-domainhidden').val(tor.domain_selected);
    $('#node-input-srclanghidden').val(tor.srclang_selected);
    $('#node-input-destlanghidden').val(tor.destlang_selected);
    $('#node-input-basemodelhidden').val(tor.base_model_selected);
    $('#node-input-customhidden').val(tor.custom_selected);
  }

  // Define and run the function to register this node.
  (function() {
        RED.nodes.registerType('watson-translator', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                action: {value: 'translate'},
                basemodel: {value: ''},
                domain: {value: 'news'},
                srclang: {value: 'en'},
                destlang: {value: 'fr'},
                password: {value: ''},
                apikey: {value: ''},
                custom: {value: ''},
                domainhidden: {value: ''},
                srclanghidden: {value: ''},
                destlanghidden: {value: ''},
                basemodelhidden: {value: ''},
                customhidden: {value: ''},
                filetype: {value: 'forcedglossary'},
                trainid: {value: ''},
                lgparams2: {value: 'lparams'},
                neural: {value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/language-translator/api'}
            },
            credentials: {
              username: {type: 'text'}
              // password: {type: 'text'} << moved to keep track of previous data
            },
            color: "rgb(84,149,230)",
            inputs: 1,
            outputs: 1,
            icon: "LanguageTranslator25x25.png",
            paletteLabel: "language translator",
            label: function() {
                return this.name || "language translator";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: oneditprepare,
            oneditsave: oneditsave
        });
  })();

</script>
<script type="text/x-red" data-help-name="watson-translator">
    <p>The Watson Language Translator service enables you to translate text from one language to another and to add your own translation models.</p>
    <p></p>
    <p><b>Translation Mode</b>.</p>
    <p>The text to translate should be passed in on <code>msg.payload</code>.</p>
    <p>The translated text will be returned on <code>msg.payload</code>.</p>
    <p>The full response from the service will be returned on <code>msg.translation</code></p>
    <p>Source and destination language parameters can be configured through the editor panel or set
    dynamically using
    the language codes in the following properties, <code>msg.srclang</code>
    and <code>msg.destlang</code>. Set the values to either two or five character
    IETF language Codes,
    eg. <code>en</code> for English or <code>pt-BR</code> for Brazilian Portuguese
    Please see
    the documentation linked below for the currently supported source and destination
    languages translation permutations.</p>
    <p></p>
    <p><b>Customised Translation Mode</b>.</p>
    <p>In this mode you can select a translation model that you have customised through
    the training options.</p>
    <p>The text to translate should be passed in on <code>msg.payload</code>.</p>
    <p>The translated text will be returned on <code>msg.payload</code>.</p>
    <p>The full response from the service will be returned on <code>msg.translation</code></p>
    <p></p>
    <p><b>Training Mode</b>.</p>
    <p>This mode enables you to add your own customized model to the Watson Language Translator service. </p>
    <p>In <code>msg.payload</code>, (this can be through box, dropbox or a file-inject node.
       you must specify one of the following file options to customize the training:</p>
    <p>forced_glossary - A UTF-8 encoded TMX file that contains pairs of matching terms in the source and target language that are seen as absolute by the system. This file completely overwrites the original domain data.</p>
    <p>parallel_corpus - A UTF-8 encoded TMX file that contains matching phrases in the source and target language that serve as examples for Watson. Parallel corpora differ from glossaries because they do not overwrite the original domain data.</p>
    <p>monolingual_corpus - A UTF-8 encoded plain text file that contains a body of text in the target language that is related to what you are translating. A monolingual corpus helps improve literal translations to be more fluent and human.</p>
    <p>The Language Translator Node will return the ID of the created customized model.</p>
    <p<b>Note:</b>As the input file is expected on msg.payload, only one file can be specified. This is
    an enforced restriction by this Node. The service API allows more than one file to be specified.</p>
    <p></p>
    <p><b>Get Status Mode</b>.</p>
    <p>This mode allows you to get the status of a model sent to training by providing its ID.</p>
    <p>Values can be the followings:</p>
    <p>training - Training is still in progress.</p>
    <p>queued@<#> - Training has not yet started and the model is in the queue. The # indicates the number of your model in the queue.</p>
    <p>error - Training did not complete because of an error. if you want to see the reason behind the error
    this will be returned in <code>msg.translation</code></p>
    <p>available - Training is completed, and the service is now available to use with your custom translation model.</p>
    <p><b>Delete Mode</b>.</p>
    <p></p>
    <p>This mode allows you to delete a model by providing its ID</p>
    <p><b>Parameters Scope</b>.</p>
    <p>This parameter makes the language translation node to toogle using incoming parameters form the dashboard Dropdown list or locally.</p>
    <p>Values can be the followings:</p>
    <p><b>Local</b>  -  Local parametres if the node is used by its own (default value).</p>
    <p><b>Global</b> -  Global parametres if the node is used with the 'language translator util' and 'dropdown' node.
    Global parameters are set when <b>local in unchecked</b>.</p>
    <p>For more information about the Language Translator service, read the <a href="https://console.bluemix.net/docs/services/language-translator/index.html">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-language-translator-identify-v3] --- -->
<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-language-translator-identify">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-cwm-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-cwm-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/language-translator/api">
    </div>
</script>



<script type="text/javascript">

// This is the on edit prepare function, which will be invoked everytime the dialog
// is shown.
  function li2oneditprepare() {
    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });

    $.getJSON('watson-language-translator-identify/vcap/')
      .done(function (service) {
        $('.credentials').toggle(!service);
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
      });
  }

    (function() {
        RED.nodes.registerType('watson-language-translator-identify', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/language-translator/api'}
            },
            credentials: {
              username: {type:'text'},
              password: {type:'password'},
              apikey: {type: 'password'}
            },
            color: 'rgb(84,149,230)',
            inputs: 1,
            outputs: 1,
            icon: 'LanguageTranslator25x25.png',
            paletteLabel: 'language identify',
            label: function() {
                return this.name || 'language identify';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: li2oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-language-translator-identify">
    <p>Packaged in with release 0.7.0 of node-red-node-watson</p>
    <p>The Watson Language Translator service can be used to identify languages used in a text input. <p>
    <p>Node input : </p>
    <ul>
    <li><code>msg.payload</code> : The input text to identify language against in UTF-8 format</li>
    </ul>
    <p>Node output : </p>
    <ul>
    <li><code>msg.lang</code> : The identified language with the highest confidence level</li>
    <li><code>msg.languages</code> : array of identified languages with the language 5-letter ISO language code
    with the associated confidence score</li>
    </ul>
    <p>For more information about the Language Identification service,
    read the service <a href="https://console.bluemix.net/docs/services/language-translator/index.html">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-language-translator-util-v3] --- -->
<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-translator-util">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name (LTU)</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-cwm-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-cwm-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/language-translator/api">
    </div>

</script>




<script type="text/javascript">
    (function() {
        RED.nodes.registerType('watson-translator-util', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ""},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/language-translator/api'}
            },
            credentials: {
              username: {type:"text"},
              password: {type:"password"},
              apikey: {type: 'password'}
            },
            color: "rgb(84,149,230)",
            inputs: 1,
            outputs: 1,
            icon: "languageid.png",
            paletteLabel: "language translator util",
            label: function() {
                return this.name || "language translator util";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                $('#node-input-default-endpoint').change(function () {
                    var checked = $('#node-input-default-endpoint').prop('checked')
                    if (checked) {
                        $('#node-input-service-endpoint').parent().hide();
                    } else {
                        $('#node-input-service-endpoint').parent().show();
                    }
                });

                $.getJSON('watson-translator-util/vcap/')
                  .done(function (service) {
                    $('.credentials').toggle(!service);
                  })
                  .fail(function () {
                    $('.credentials').show();
                  }).always(function () {
                    $('#credentials-check').hide();
                  })
            }
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-translator-util">
    <p>The Language Translator Utility service enables you to set using dasboard utility functions
    the language translation to be used by the Language Translator Node.</p>
    <p></p>
    <p><b>Translator Mode Utility</b>.</p>
    <p>The regular Watson Translator credentials should be set through the UI.</p>
    <p>No input is needed for the node. The node fetches the information automatically.</p>
    <p></p>
    <p>When this node is used with the 'language translator' node, in the 'language translator' node the scope of variables should be set to global.</p>
    <p></p>
    <p>The node will return the following arrays:</p>
    <p>Message model_id (e.g.: en-fr-conversational)<code>msg.model_id</code>.</p>
    <p>Message Domains (e.g.: Conversational)<code>msg.domain</code>.</p>
    <p>Message Source Language (e.g.: English)<code>msg.source</code>.</p>
    <p>Message Target Language (e.g.: French)<code>msg.target</code>.</p>
    <p>For more information about the Language Translator service, read the <a href="https://console.bluemix.net/docs/services/language-translator/index.html">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-natural-language-classifier-v1] --- -->
<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-natural-language-classifier">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/natural-language-classifier/api">
    </div>

    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-question"></i> Mode</label>
        <select type="text" id="node-input-mode" style="display: inline-block; width: 70%;" >
            <option value="classify">Classify</option>
            <option value="create">Train</option>
			      <option value="remove">Remove</option>
		        <option value="list">List</option>
        </select>
    </div>
    <div class="form-row mode classify">
        <label for="node-input-classifier"><i class="fa fa-tag"></i> Classifier ID</label>
        <input type="text" id="node-input-classifier" placeholder="Classifier ID">
    </div>
    <div class="form-row mode create">
        <label for="node-input-language"><i class="fa fa-language"></i> Language</label>
        <select type="text" id="node-input-language" style="display: inline-block; width: 70%;" >
            <option value="ar">Arabic</option>
            <option value="en">English</option>
            <option value="de">German</option>
            <option value="fr">French</option>
            <option value="it">Italian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="pt">Portuguese</option>
            <option value="es">Spanish</option>
        </select>
    </div>
    <div class="form-row mode classify">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-collections-off" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-collections-off" style="width: 70%;"> Do not auto detect collections</label>
    </div>

</script>



<script type="text/javascript">
  // Need to simulate a namespace, so that some of the variables don't leak across nodes
  function NaturalLanguageClassifierV1 () {}

  // This is the namespace for this version of this Node.
  var nlcV1 = new NaturalLanguageClassifierV1();

  nlcV1.CreateIListener = function(listen, action, opp) {
    opp = typeof opp === 'undefined' ? false : opp;
    listen.change(function(val){
      var isSet = listen.prop('checked');
      if (opp) {
        isSet = !isSet;
      }
      nluV1.setVisibility(action, isSet);
    });
  }

  nlcV1.UIListeners = function () {
    $('#node-input-mode').change(function () {
      var mode = $('#node-input-mode').val();
      $('.form-row.mode.' + mode).show();
      $('.form-row.mode:not(.' + mode + ')').hide();
    });

    nlcV1.CreateIListener($('#node-input-default-endpoint'),
                                $('#node-input-service-endpoint'), true);
  };

  nlcV1.checkForPrepare = function () {
    nlcV1.UIListeners();
  };

  // This is the on edit prepare function, which will be
  //invoked everytime the dialog is shown.
  function nlconeditprepare() {


    nlcV1.checkForPrepare();
    $.getJSON('watson-natural-language-classifier/vcap/')
      .done(function (service) {
        $('.credentials').toggle(!service);
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
      })
  }


    (function() {
        RED.nodes.registerType('watson-natural-language-classifier', {
            category: 'IBM Watson',
            defaults: {
              name: {value: ""},
              mode: {value: "classify"},
              language: {value: "en"},
              classifier: {value: ""},
              'collections-off' :{value: true},
              'default-endpoint' :{value: true},
              'service-endpoint' :{value: 'https://gateway.watsonplatform.net/natural-language-classifier/api'}
            },
            credentials: {
              username: {type:"text"},
              password: {type:"password"}
            },
            color: "rgb(140, 198, 63)",
            inputs: 1,
            outputs: 1,
            icon: "NLClassifier.png",
            paletteLabel: "natural language classifier",
            label: function() {
                return this.name || "natural language classifier";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: nlconeditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-natural-language-classifier">
    <p>The Natural Language Classifier service uses machine learning algorithms to return the top matching predefined classes for short text inputs.</p>
    <p>The node can either train new classifiers or match text against existing classifiers.
       Use the drop-down menu in the node configuration window to select the mode.</p>
    <p></p>
    <p><b>Classifier Mode</b>.</p>
    <p>Set the classifier id in the node configuration window.</p>
    <p>The classifier can be overriden by setting msg.nlcparams.classifier_id</p>
    <p>The text to classify should be passed in on <code>msg.payload</code>.</p>

    <p> If <code>msg.payload</code> contains multiple sentences then the sentences will
    be split and the set will be classified as a collection. If there are no sentence
    terminators then it will not be recognised as a sentence.
    </p>
    <p> If <code>msg.payload</code> contains an array of strings, then each string will be
    treated as a separate sentence and the set treated as a collection. </p>
    <p>If <code>msg.payload</code> contains an array of objects, then there is a
    search for the <code>text</code> key in each object. Each text object will be
    treated as part of the collection.</p>

    <p>The returned classification and confidence values will be returned on <code>msg.payload</code>.</p>
    <p></p>
    <p><b>Training Mode</b>.</p>
    <p>Set the training data language in the node configuration window.</p>
    <p>The CSV training data should be passed in on <code>msg.payload</code> as a String or String Array. For more details on the training data format, see this <a href="https://console.bluemix.net/docs/services/natural-language-classifier/using-your-data.html">link</a></p>
    <p>The returned classification training status will be returned on <code>msg.payload</code>.</p>
	<p><b>List Mode</b>.</p>
    <p>Set the mode in the node configuration window.</p>
    <p>The request is triggered by a request to the input node
    <p>The returned list of classifiers will be returned on <code>msg.payload</code>.</p>
	<p><b>Remove Mode</b>.</p>
    <p>Set the mode in the node configuration window.</p>
    <p>The Classifier ID should be passed in on <code>msg.payload</code> as a String<p>
    <p>The status of the delete be returned on <code>msg.payload</code>.  It will contain {} if successful</p>
	<p><b>More Information</b>.</p>
    <p>For more information about the Natural Language Classifier service, read the <a href="http://www.ibm.com/watson/developercloud/natural-language-classifier/api/v1/">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-natural-language-understanding-v1] --- -->
<!--
  Copyright 2017 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="natural-language-understanding">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>

    <p style="width:100%; text-align:center;"><em>or</em></p>

    <div class="form-row credentials" style="display: none;">
      <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
      <input type="password" id="node-input-apikey" placeholder="API Key">
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/natural-language-understanding/api">
    </div>

    <div class="form-row">
        <label for="node-input-features" style="width: 100%"><i class="fa fa-book"></i> Extract the following features: </label>
          <div style="float: left;">

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-categories" />
              <label style="width: auto;" for="node-input-categories">Categories</label>
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-concepts" />
              <label style="width: auto;" for="node-input-concepts">Concepts</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-maxconcepts">Maximum Concepts</label>
              <input type="number" min="1"
                     id="node-input-maxconcepts" />
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-doc-emotion" />
              <label style="width: auto;" for="node-input-doc-emotion">Document Emotion</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-doc-emotion-target">Emotion Targets</label>
              <input type="text" id="node-input-doc-emotion-target" />
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-doc-sentiment" />
              <label style="width: auto;" for="node-input-doc-sentiment">Document Sentiment</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-doc-sentiment-target">Sentiment Targets</label>
              <input type="text" id="node-input-doc-sentiment-target" />
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-entity" />
              <label style="width: auto;" for="node-input-entity">Entities</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-entity-emotion" />
              <label style="width: auto;" for="node-input-entity-emotion">Entity Emotion</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-entity-sentiment" />
              <label style="width: auto;" for="node-input-entity-sentiment">Entity Sentiment</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-maxentities">Maximum Entities</label>
              <input type="number" min="1"
                     id="node-input-maxentities" />
            </div>

          </div>

          <div style="margin-left: -200px; float: right;">

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-keyword" />
              <label style="width: auto;" for="node-input-keyword">Keywords</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-keyword-emotion" />
              <label style="width: auto;" for="node-input-keyword-emotion">Keyword Emotion</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-keyword-sentiment" />
              <label style="width: auto;" for="node-input-keyword-sentiment">Keyword Sentiment</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-maxkeywords">Maximum Keywords</label>
              <input type="number" min="1"
                     id="node-input-maxkeywords" />
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-metadata" />
              <label style="width: auto;" for="node-input-metadata">Metadata</label>
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-relation" />
              <label style="width: auto;" for="node-input-relation">Relations</label>
            </div>

            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-semantic" />
              <label style="width: auto;" for="node-input-semantic">Semantic Roles</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-semantic-entities" />
              <label style="width: auto;" for="node-input-semantic-entities-">Semantic Entities</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;"
                     type="checkbox" id="node-input-semantic-keywords" />
              <label style="width: auto;" for="node-input-semantic-keywords">Semantic Keywords</label>
            </div>
            <div>
              <label style="width: auto;" for="node-input-maxsemantics">Maximum Semantic Roles</label>
              <input type="number" min="1"
                     id="node-input-maxsemantics" />
            </div>

          </div>

        </div>
    <div class="form-row" style="padding-top: 10px;">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>




<script type="text/javascript">
  // Need to simulate a namespace, so that some of the variables don't leak across nodes
  function NaturalLanguageUnderstandingV1 () {}

  // This is the namespace for this version of this Node.
  var nluV1 = new NaturalLanguageUnderstandingV1();

  nluV1.hideAll = function() {
    $('#node-input-maxconcepts').parent().hide();
    $('#node-input-doc-emotion-target').parent().hide();
    $('#node-input-doc-sentiment-target').parent().hide();
    $('#node-input-entity-emotion').parent().hide();
    $('#node-input-entity-sentiment').parent().hide();
    $('#node-input-maxentities').parent().hide();
    $('#node-input-keyword-emotion').parent().hide();
    $('#node-input-keyword-sentiment').parent().hide();
    $('#node-input-maxkeywords').parent().hide();
    $('#node-input-semantic-entities').parent().hide();
    $('#node-input-semantic-keywords').parent().hide();
    $('#node-input-maxsemantics').parent().hide();
  };

  nluV1.setVisibility = function(field, visible) {
    if (visible) {
      field.parent().show();
    } else {
      field.parent().hide();
    }
  };

  nluV1.CreateIListener = function(listen, action, opp) {
    opp = typeof opp === 'undefined' ? false : opp;
    listen.change(function(val){
      var isSet = listen.prop('checked');
      if (opp) {
        isSet = !isSet;
      }
      nluV1.setVisibility(action, isSet);
    });
  }

  nluV1.UIListeners = function () {
    nluV1.CreateIListener($('#node-input-concepts'),
                               $('#node-input-maxconcepts'));

    nluV1.CreateIListener($('#node-input-doc-emotion'),
                                $('#node-input-doc-emotion-target'));

    nluV1.CreateIListener($('#node-input-doc-sentiment'),
                                $('#node-input-doc-sentiment-target'));

    nluV1.CreateIListener($('#node-input-entity'),
                                $('#node-input-entity-emotion'
                                    + ', #node-input-entity-sentiment'
                                    + ', #node-input-maxentities'));

    nluV1.CreateIListener($('#node-input-keyword'),
                                $('#node-input-keyword-emotion'
                                    + ', #node-input-keyword-sentiment'
                                    + ', #node-input-maxkeywords'));

    nluV1.CreateIListener($('#node-input-semantic'),
                                $('#node-input-semantic-entities'
                                    + ', #node-input-semantic-keywords'
                                    + ', #node-input-maxsemantics'));


    nluV1.CreateIListener($('#node-input-default-endpoint'),
                                $('#node-input-service-endpoint'), true);

  }

  nluV1.checkForPrepare = function () {
    nluV1.hideAll();
    nluV1.UIListeners();
  };

  // This is the on edit prepare function, which will be
  //invoked everytime the dialog is shown.
  function nluoneditprepare() {
    nluV1.checkForPrepare();
    $.getJSON('natural-language-understanding/vcap/')
      .done(function (service) {
        $('.credentials').toggle(!service);
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
      })
  }

    (function() {
        RED.nodes.registerType('natural-language-understanding', {
            category: 'IBM Watson',
            defaults: {
              'name': {value: ''},
              'categories': {value: false},
              'concepts': {value: false},
              'maxconcepts': {value: '8'},
              'doc-emotion': {value: false},
              'doc-emotion-target': {value: ''},
              'doc-sentiment': {value: false},
              'doc-sentiment-target': {value: ''},
              'entity': {value: false},
              'entity-emotion': {value: false},
              'entity-sentiment': {value: false},
              'maxentities' :{value: '50'},
              'keyword': {value: false},
              'keyword-emotion': {value: false},
              'keyword-sentiment': {value: false},
              'maxkeywords' :{value: '50'},
              'metadata': {value: false},
              'relation': {value: false},
              'semantic': {value: false},
              'semantic-entities': {value: false},
              'semantic-keywords': {value: false},
              'maxsemantics' :{value: '50'},
              'default-endpoint' :{value: true},
              'service-endpoint' :{value: 'https://gateway.watsonplatform.net/natural-language-understanding/api'}
            },
            credentials: {
              username: {type:"text"},
              password: {type:"password"},
              apikey: {type:"password"}
            },
            color: '#00A2FF',
            inputs: 1,
            outputs: 1,
            icon: "NaturalLanguageUnderstanding.png",
            paletteLabel: "Natural Language Understanding",
            label: function() {
                return this.name || "Natural Language Understanding";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            } ,
            oneditprepare: nluoneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="natural-language-understanding">
    <p>Using the Watson Natural Language Understanding node, you can
    extract meta-data from content.
    You can analyse external URLs, HTML files or text content.</p>
    <p>The following features are available for analysis:</p>
    <ul>
        <li><b>Categories</b>, categorize content into a taxonomy.</li>
        <li><b>Concepts</b>, recognize high-level concepts.</li>
        <li><b>Document Emotion</b>, generate emotion scores.</li>
        <li><b>Emotion Targets</b>, optionally target the emotions scores to a
                                    comma seperated list eg.
                                    <code>apples,pears</code>.</li>
        <li><b>Document Sentiment</b>, generate sentiment scores.</li>
        <li><b>Sentiment Targets</b>, optionally target the sentiment scores to a
                                    comma seperated list eg.
                                    <code>dolphins,sharks</code>.</li>
        <li><b>Entities</b>, identify people, companies, organizations,
                            cities, geographic features, and other typed
                            entities.</li>
        <li><b>Keywords</b>, discover topic keywords for content.</li>
        <li><b>Metadata</b>, identify author name, title, RSS/ATOM feeds,
                                publication date, etc.</li>
        <li><b>Relations</b>, identify Subject-Action-Object relations.</li>
        <li><b>Semantic Roles</b>, parse out sentences into subject,
                                action, and object form.</li>

    </ul>
    <p>For full details on the feature details,
      please see the
      <a href="https://www.ibm.com/watson/services/natural-language-understanding/">
        service API documentation</a></p>
    <p>The content to be analysed should be passed in on <code>msg.payload</code>.</p>
    <p>Valid <code>msg.payload</code> types: URL, HTML or Text Content.</p>
    <br>
    <p>It is possible to send custom language and model settings on
      <code>msg.nlu_options</code>
      To override the default language detection set
      <code>msg.nlu_options.language</code> to a ISO 639-1 code.
      To override the model used for entities set
      <code>msg.nlu_options.entity_model</code>.
      To override the model used for relations set
      <code>msg.nlu_options.relations_model</code>.
    </p>
    <br>
    <p>Results from the API service will made available
      at <code>msg.features</code>. Each feature result will be a separate
      child property.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-personality-insights-v3] --- -->
<!--
  Copyright 2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-personality-insights-v3">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-cwm-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-cwm-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/personality-insights/api">
    </div>

    <div class="form-row">
        <label for="node-input-inputlang"><i class="fa fa-language"></i> Input Text Language</label>
        <select type="text" id="node-input-inputlang" style="display: inline-block; width: 70%;" >
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="ar">Arabic</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-outputlang"><i class="fa fa-language"></i> Language For Response</label>
        <select type="text" id="node-input-outputlang" style="display: inline-block; width: 70%;" >
            <option value="en">English</option>
            <option value="fr">French</option>
            <option value="it">Italian</option>
            <option value="de">German</option>
            <option value="pt-br">Braillian Portuguese</option>
            <option value="es">Spanish</option>
            <option value="ar">Arabic</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh-cn">Simplified Chinese</option>
            <option value="zh-tw">Traditional Chinese</option>
        </select>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-rawscores" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-rawscores" style="width: 70%;"> Raw Scores</label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-consumption" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-consumption" style="width: 70%;"> Consumption Preferences</label>
    </div>
</script>



<script type="text/javascript">
    (function() {
        RED.nodes.registerType('watson-personality-insights-v3', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ""},
                inputlang: {value: "en"},
                outputlang: {value: "en"},
                rawscores: {value: false},
                consumption: {value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/personality-insights/api'}
            },
            credentials: {
              username: {type:"text"},
              password: {type:"password"},
              apikey: {type: 'password'}
            },
            color: "rgb(0, 150, 200)",
            inputs: 1,
            outputs: 1,
            icon: "personality_insights.png",
            paletteLabel: "personality insights",
            label: function() {
                return this.name || "personality insights";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
                $('#node-input-default-endpoint').change(function () {
                  var checked = $('#node-input-default-endpoint').prop('checked')
                  if (checked) {
                    $('#node-input-service-endpoint').parent().hide();
                  } else {
                    $('#node-input-service-endpoint').parent().show();
                  }
                });

                $.getJSON('watson-personality-insights-v3/vcap/')
                  .done(function (service) {
                    $('.credentials').toggle(!service);
                  })
                  .fail(function () {
                    $('.credentials').show();
                  }).always(function () {
                    $('#credentials-check').hide();
                  })
            }
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-personality-insights-v3">
    <p>The Personality Insights V3 service uses
      linguistic analytics to infer personality characteristics from text.
      The service can infer consumption preferences based on the results of its analysis.
    </p>
    <p>The text (minimum of a hundred words) to analyse should be passed in on <code>msg.payload</code>.</p>
    <p>Input Text Language is the language of the input text.
      This setting can be overridden by setting <code>msg.piparams.inputlanguage</code> to a valid
      supported language iso code eg. 'es'.
    </p>
    <p>Language for Response is the language that the response will be returned in.
    <p>Input Text Language is the language of the input text.
      This setting can be overridden by setting <code>msg.piparams.responselanguage</code> to a valid
      supported language iso code eg. 'pt-br'.
    </p>
    </p>
    <p>Raw Scores indicates whether a raw score in addition to a normalized percentile is to be returned
      for each characteristic; raw scores are not compared with a sample population.
    </p>
    <p>Consumption Preferences indicates whether consumption preferences are to be returned
      with the results.
    </p>
    <p>The insights will be returned as a tree on <code>msg.insights</code>.</p>
    <p>For more information about the Personality Insights service,
      read the <a href="https://www.ibm.com/watson/services/personality-insights/">
      documentation</a>.
    </p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-speech-to-text-v1] --- -->
<!--
  Copyright 2016 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-speech-to-text">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div>
        <label id="node-label-message"><i class="fa fa-exclamation-triangle"></i></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"></input>
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://stream.watsonplatform.net/speech-to-text/api">
    </div>

    <div class="form-row">
        <label for="node-input-lang"><i class="fa fa-language"></i> Language</label>
        <select type="text" id="node-input-lang" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-langhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-langcustom"><i class="fa fa-language"></i> Language Customization</label>
        <select type="text" id="node-input-langcustom" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-langcustomhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-band"><i class="fa fa-audio-o"></i> Quality</label>
        <select type="text" id="node-input-band" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-bandhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-alternatives">Max Alternative Transcripts</label>
        <input type="number" min="1" max="5" id="node-input-alternatives" />
    </div>


    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-streaming-mode" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-streaming-mode" style="width: 70%;"> Streaming Mode</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-streaming-mute" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-streaming-mute" style="width: 70%;"> Mute in Streaming Mode</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-discard-listening" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-discard-listening" style="width: 70%;"> Discard Listening events from STT</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-auto-connect" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-auto-connect" style="width: 70%;"> Attempt auto connect on connection close</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-speakerlabels"style="display: inline-block; width: auto; vertical-align: top;"></input>
        <label for="node-input-speakerlabels" style="width: 70%;"><i class="fa fa-audio-o"></i> Speaker Labels</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-smartformatting"style="display: inline-block; width: auto; vertical-align: top;"></input>
        <label for="node-input-smartformatting" style="width: 70%;"><i class="fa fa-audio-o"></i> Smart Formatting</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-payload-response" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-payload-response" style="width: 70%;"> Place output on msg.payload</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-disable-precheck" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-disable-precheck" style="width: 70%;"> Disable Audio format pre-check</label>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="button" id="node-input-flushcache" value="Flush Config Cache"
                 style="display: inline-block; width: auto; vertical-align: top;">
    </div>

</script>



<script type="text/javascript">

  // Need to simulate a namespace, as some of the variables had started to leak across nodes
  function STT () {
  }


  // This is the namespace for stt. Currently only contains models, but more vars and functions may need to be
  // moved in if there is a clash with other nodes.
  var stt = new STT();
  stt.models = null;
  stt.languages = null;
  stt.customisations = null;
  stt.bands = null;
  stt.language_selected = '';
  stt.custom_selected = '';
  stt.band_selected = '';

  stt.LANGUAGES = { 'en-US': 'US English',
                    'pt-BR': 'Portuguese Braziilian',
                    'en-UK': 'UK English' ,
                    'en-GB': 'UK English' ,
                    'fr-FR': 'French',
                    'zh-CN': 'Mandarin',
                    'es-ES': 'Spanish',
                    'ar-AR': 'Arablic',
                    'ko-KR': 'Korean',
                    'ja-JP': 'Japanese'
                  };

  // sorting functions
  stt.onlyUnique = function (value, index, self) {
    return self.indexOf(value) === index;
  }

  stt.showSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().show();
    }
  }

  stt.hideSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().hide();
    }
  }


  // Function to be used at the start, as don't want to expose any fields, unless the models are
  // available. The models can only be fetched if the credentials are available.
  stt.hideEverything = function () {
    if (!stt.models) {
      var fields = [];
      $('#credentials-not-found').show();

      fields.push('#node-label-message'
                     + ', #node-input-alternatives'
                     + ', #node-input-speakerlabels'
                     + ', #node-input-smartformatting'
                     + ', #node-input-lang'
                     + ', #node-input-band'
                     + ', #node-input-langcustom');
      stt.hideSelectedFields(fields);
    }
  }

  // Check if there is a model then can show the fields.
  // available. The models can only be fetched if the credentials are available.
  stt.VisibilityCheck = function () {
    var showFields = [];
    var hideFields = [];
    if (stt.models) {
      showFields.push('#node-input-alternatives'
                     + ', #node-input-speakerlabels'
                     + ', #node-input-smartformatting'
                     + ', #node-input-lang'
                     + ', #node-input-band');

      hideFields.push('#node-label-message');
    } else {
      hideFields.push('#node-label-message'
                     + ', #node-input-alternatives'
                     + ', #node-input-speakerlabels'
                     + ', #node-input-smartformatting'
                     + ', #node-input-langcustom'
                     + ', #node-input-lang'
                     + ', #node-input-band');
    }
    stt.hideSelectedFields(hideFields);
    stt.showSelectedFields(showFields);
  }


  // Simple check that is only invoked if the service is not bound into bluemix. In this case the
  // user has to provide credentials. Once there are credentials, then the stt.models are retrieved.
  stt.checkCredentials = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();

    if ( (k && k.length) || (u && u.length && p) ) {
      if (!stt.models) {
        stt.getModels();
      }
    }
  }

  // Populate the quality select field
  stt.populateBands = function () {
    if (!stt.bands && stt.models) {
      stt.bands = stt.models.map(function(m) {
        return m.name.split('_')[1];
      });
      var unique_bands = stt.bands.filter(stt.onlyUnique);
      stt.bands = unique_bands;
    }

    if (stt.bands) {
      $('select#node-input-band').empty();

      stt.bands.forEach(function(b) {
        var selectedText = '';
        if (stt.band_selected === b) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-band')
          .append('<option value='
                        + '"' + b + '"'
                        + selectedText
                        + '>'
                        + b
                        + '</option>');
      });
    }
  }

  // Populate the customisations selection field
  // Need to check if we have customisations and if the
  // selected language and model have an entry.
  stt.populateCustoms = function() {
    var showit = false;

    $('select#node-input-langcustom').empty();

    if (stt.customisations) {
      stt.language_selected = stt.language_selected ?
                                  stt.language_selected :
                                  $('#node-input-langhidden').val();
      stt.band_selected = stt.band_selected ?
                                 stt.band_selected :
                                 $('#node-input-band').val();

      var compareValue = stt.language_selected + '_' + stt.band_selected;

      stt.customisations.forEach(function(c) {
        // Should really be checking against the cached values
        // stt.language_selected and stt.band_selected
        // but for some reason they are not always set.

        if (compareValue === c['base_model_name']) {
          showit = true;
          var selectedText = '';
          if (stt.custom_selected === c['customization_id']) {
            selectedText = ' selected="selected" ';
          }
          $('select#node-input-langcustom')
            .append('<option value='
                          + '"' + c['customization_id'] + '"'
                          + selectedText
                          + '>'
                          + c['name']
                          + '</option>');
        }
      });
    }

    // Add an option to not select
    $('select#node-input-langcustom')
      .append('<option value='
                    + 'NoCustomisationSetting'
                    + '' //showit ? '' : ' selected="selected" '
                    + '>'
                    + 'None'
                    + '</option>');


    if (showit) {
      $('select#node-input-langcustom').parent().show();
    } else {
      $('select#node-input-langcustom').parent().hide();
    }

  }

  stt.flushCache = function () {
    stt.models = null;
    stt.languages = null;
    stt.customisations = null;
    stt.bands = null;
    sttoneditprepare();
  }

  // Register the handlers for the fields
  stt.handlersUI = function () {
    $('#node-input-username').change(function(val){
      stt.checkCredentials();
    });
    $('#node-input-password').change(function(val){
      stt.checkCredentials();
    });
    $('#node-input-apikey').change(function(val){
      stt.checkCredentials();
    });

    $('#node-input-lang').change(function (val) {
      stt.language_selected = $('#node-input-lang').val();
      stt.populateBands();
      stt.populateCustoms();
    });

    $('#node-input-langcustom').change(function (val) {
      stt.custom_selected = $('#node-input-langcustom').val();
    });

    $('#node-input-band').change(function (val) {
      stt.band_selected = $('#node-input-band').val();
      stt.populateCustoms();
    });

    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });

    $('#node-input-streaming-mode').change(function () {
      var fields = [];
      fields.push('#node-input-streaming-mute'
                     + ', #node-input-discard-listening'
                     + ', #node-input-auto-connect');

      var checked = $('#node-input-streaming-mode').prop('checked')
      if (checked) {
        stt.showSelectedFields(fields);
      } else {
        stt.hideSelectedFields(fields);
      }
    });

    $('#node-input-flushcache').click(function () {
      stt.flushCache();
    });

  }

  // Function to fetch the customisations, should only be done once
  stt.fetchCustomisations = function() {
    if (!stt.customisations) {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();
      var e = $('#node-input-service-endpoint').val();
      var creds = {un: u, pwd: p, key: k};

      if (! $('#node-input-default-endpoint').prop('checked')) {
        creds.e = e;
      }

      $.getJSON('watson-speech-to-text/customs', creds)
      .done(function (data) {
        $('label#node-label-message').parent().hide();
        if (data.error) {
          $('label#node-label-message').parent().show();
          $('label#node-label-message').text(data.error);        }
        else {
          stt.customisations = data.customizations;
          stt.populateCustoms();
        }
      }).fail(function (err) {
        var txt = 'Got server error ';
        if (err.status) {
          txt += '(' + err.status + ') '
        }
        txt += 'when trying to retrieve available customisations';
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(txt);
      }).always(function () {
      });

    }
  }

  // Function called when either when the models have been retrieved, or
  // on dialog load, if the model has already been retrieved
  stt.postModelCheck = function () {
    stt.processModels();
    stt.VisibilityCheck();
    stt.fetchCustomisations();
  }

  // Retrieve the available models from the server, if data is returned, then
  // can enable the dynamic selection fields.
  stt.getModels = function (haveCredentials) {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();
    var e = $('#node-input-service-endpoint').val();
    var creds = {un: u, pwd: p, key: k};

    if (! $('#node-input-default-endpoint').prop('checked')) {
      creds.e = e;
    }

    $.getJSON('watson-speech-to-text/models/', creds)
    .done(function (data) {
      if (data.error) {
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(data.error);
      } else if (data.models) {
        stt.models = data.models;
        //have_credentials = true;
        stt.postModelCheck();
      }
    }).fail(function (err) {
      $('label#node-label-message').parent().show();
      $('label#node-label-message').text('Error trying to determine available service models');

    }).always(function () {});
  }

  // Called to complete the languages selection table
  stt.processSTTLanguages = function () {
    if (!stt.languages && stt.models) {
      stt.languages = stt.models.map(function(m) {
        return m.language;
      });
    }
    if (stt.languages) {
      $('select#node-input-lang').empty();
      var unique_langs = stt.languages.filter(stt.onlyUnique);

      unique_langs.forEach(function(l) {
        var selectedText = '';
        if (stt.language_selected === l) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-lang')
          .append('<option value='
                        + '"' + l + '"'
                        + selectedText
                        + '>'
                        + (stt.LANGUAGES[l] ? stt.LANGUAGES[l] : l)
                        + '</option>');
      });
    }
  }

  // Called to work through the models, completing the dyanmic selection fields.
  stt.processModels = function () {
    if (stt.models) {
      stt.processSTTLanguages();
      stt.populateBands();
    }
  }

  // The dynamic nature of the selection fields in this node has caused problems.
  // Whenever there is a fetch for the models, on a page refresh or applicaiton
  // restart, the settings for the dynamic fields are lost.
  // So hidden (text) fields are being used to squirrel away the values, so that
  // they can be restored.
  stt.restoreFromHidden = function () {
    stt.language_selected = $('#node-input-langhidden').val();
    $('select#node-input-lang').val(stt.language_selected);

    stt.band_selected = $('#node-input-bandhidden').val();
    $('select#node-input-band').val(stt.band_selected);

    stt.custom_selected = $('#node-input-langcustomhidden').val();
    $('select#node-input-langcustom').val(stt.custom_selected);
  }

  // This is the on edit prepare function, which will be invoked everytime the dialog
  // is shown.
  function sttoneditprepare() {
    stt.hideEverything();
    stt.restoreFromHidden();
    stt.handlersUI();

    $.getJSON('watson-speech-to-text/vcap/')
      // for some reason the getJSON resets the vars so need to restoreFromHidden again
      // so again.
      .done(function (service) {
        stt.restoreFromHidden();
        $('.credentials').toggle(!service);
        if (!stt.models) {stt.getModels(service);}
        else {stt.postModelCheck();}
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
     });
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function sttoneditsave(){
    $('#node-input-langhidden').val(stt.language_selected);
    $('#node-input-bandhidden').val(stt.band_selected);
    $('#node-input-langcustomhidden').val(stt.custom_selected);
  }

    (function() {
        RED.nodes.registerType('watson-speech-to-text', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                alternatives: {value: 1},
                speakerlabels: {value: true},
                smartformatting: {value: false},
                lang: {value: ''},
                langhidden: {value: ''},
                langcustom: {value: ''},
                langcustomhidden: {value: ''},
                band: {value: ''},
                bandhidden: {value: ''},
                password: {value: ''},
                apikey: {value: ''},
                'payload-response' :{value: false},
                'streaming-mode' :{value: false},
                'streaming-mute' :{value: true},
                'auto-connect' :{value: false},
                'discard-listening' :{value: false},
                'disable-precheck' :{value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://stream.watsonplatform.net/speech-to-text/api'}
            },
            credentials: {
              username: {type:'text'} //,
              // password: {type: 'password'}   - // Taken out because, was not being restored on dialog open.
            },
            color: 'rgb(140, 198, 63)',
            inputs: 1,
            outputs: 1,
            icon: 'speech_to_text.png',
            paletteLabel: 'speech to text',
            label: function() {
                return this.name || 'speech to text';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: sttoneditprepare,
            oneditsave: sttoneditsave
        });
    })();

</script>
<script type="text/x-red" data-help-name="watson-speech-to-text">
    <p>The Speech To Text converts the human voice into the written word. This service uses machine intelligence to
    combine information about grammar and language structure with knowledge of the composition of the audio signal to
    generate a more accurate transcription</p>
    <p>The audio file to be analysed should be passed in on <code>msg.payload</code>.</p>
    <p>Supported <code>msg.payload</code> types:</b>.</p>
    <ul>
        <li><b>String</b> URL to audio</li>
        <li><b>Buffer</b> Raw Audio Bytes</li>
    </ul>
    <p>Audio must be a <b>WAV, FLAC or OGG encoded file</b>.</p>
    <p>Speech To Text supports decoding speech from three languages: <b>English, Spanish, Japanese, Brazilian Portuguese
    and Mandarin Chinese</b>. This option can be modified in the configuration panel.</p>
    <p>Along with the language, you can also configure the source audio quality. The service supports two different
    source sampling rates, <b>Narrowband (8KHz) and Broadband (16Khz)</b>. Higher sample rates will be downsampled
    automatically but the is not true in reverse.</p>
    <p>Use the speaker label property to  identify which individuals spoke which words in a multi-participant exchange.
    </p>
    <p>Source language parameters can be configured through the editor panel or set dynamically using
    the language code in <code>msg.srclang</code> Please see
    the documentation linked below for the currently supported language codes. You can use the
    two character code from Language Indentification, but the language will default. eg. <code>en</code>
    will default to <code>en-US</code></p>
    <p></p>
    <p>The returned audio transcription will be returned on <code>msg.transcription</code>.</p>
    <p>The full response, including alternative transcriptions can be found on
    <code>msg.fullresult</code>.</p>

    <p>When streaming mode is selected the node makes use of a websocket connection
    to communicate with the Speech to Text service. Input to the node will be from
    a Node-RED websocket node. Output will be from a Node-RED websocket. WebSocket input
    is as per the WebSocket input for Speech To Text, with an action of either
    <code>start</code> or <code>stop</code> or an audio blob. No token is needed
    as the node takes care of that step.</p>
    <p>>The Mute option allows for the supression of session timeout messages.</p>
    <p>>The Discard Listening option allows for listening events from STT to be discarded.</p>
    <p>For more information about the Speech To Text service, read the <a href="https://www.ibm.com/watson/services/speech-to-text/">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-speech-to-text-corpus-builder-v1] --- -->
<!--
  Copyright 2017 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-speech-to-text-v1-query-builder">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div>
        <label id="node-label-message"><i class="fa fa-exclamation-triangle"></i></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"></input>
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://stream.watsonplatform.net/speech-to-text/api">
    </div>

    <div class="form-row">
        <label for="node-input-stt-custom-mode"><i class="fa fa-book"></i> Detect: </label>
        <select type="text" id="node-input-stt-custom-mode" style="display: inline-block; width: 70%;">
            <option value="createCustomisation">Create a custom language model</option>
            <option value="listCustomisations">List Customizations</option>
            <option value="getCustomisation">Get Customization</option>
            <option value="deleteCustomisation">Delete Customization</option>
            <option value="addCorpus">Add Corpus</option>
            <option value="getCorpora">Get Corpora</option>
            <option value="train">Train</option>
            <option value="listCustomWords">List Custom Words</option>
            <option value="addWords">Add Words</option>
            <option value="deleteCorpus">Delete Corpus</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-stt-custom-model-name"><i class="fa fa-book"></i> Custom Model Name</label>
        <input type="text" id="node-input-stt-custom-model-name" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-stt-base-model"><i class="fa fa-language"></i> Base Model</label>
        <select type="text" id="node-input-stt-base-model" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-base-model-hidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-stt-custom-model-description"><i class="fa fa-book"></i> Custom Model Description</label>
        <input type="text" id="node-input-stt-custom-model-description" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-stt-custom-id"><i class="fa fa-book"></i> Customization ID</label>
        <input type="text" id="node-input-stt-custom-id" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-stt-corpus-name"><i class="fa fa-book"></i> Corpus Name</label>
        <input type="text" id="node-input-stt-corpus-name" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-stt-allow-overwrite"><i class="fa fa-book"></i> Allow Overwrite</label>
        <input type="checkbox" id="node-input-stt-allow-overwrite" placeholder="">
    </div>


</script>



<script type="text/javascript">

  // Need to simulate a namespace, as some of the variables had started to leak across nodes
  function STTV1QBB () {
  }


  // This is the namespace for sttv1qbb. Currently only contains models, but more vars and functions may need to be
  // moved in if there is a clash with other nodes.
  var sttv1qbb = new STTV1QBB();
  sttv1qbb.models = null;
  sttv1qbb.mode_selected = null;
  sttv1qbb.model_selected = '';

  // Function to be used at the start, as don't want to expose any fields, unless the models are
  // available. The models can only be fetched if the credentials are available.
  sttv1qbb.hideEverything = function () {
    if (!sttv1qbb.models) {
      $('#credentials-not-found').show();
      $('label#node-label-message').parent().hide();
    }
    $('input#node-input-stt-custom-model-name').parent().hide();
    $('select#node-input-stt-base-model').parent().hide();
    $('input#node-input-stt-custom-model-description').parent().hide();
    $('input#node-input-stt-custom-id').parent().hide();
    $('input#node-input-stt-corpus-name').parent().hide();
    $('input#node-input-stt-allow-overwrite').parent().hide();
  }

  sttv1qbb.showSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().show();
    }
  }

  // The dynamic nature of the selection fields in this node has caused problems.
  // Whenever there is a fetch for the models, on a page refresh or applicaiton
  // restart, the settings for the dynamic fields are lost.
  // So hidden (text) fields are being used to squirrel away the values, so that
  // they can be restored.
  sttv1qbb.restoreFromHidden = function () {
    sttv1qbb.model_selected = $('#node-input-base-model-hidden').val();
    $('select#node-input-stt-base-model').val(stt.model_selected);
  }

  sttv1qbb.processSelectedMethod = function(method) {
    sttv1qbb.hideEverything();
    fields = [];
    switch (method) {
      case 'createCustomisation':
        fields.push('#node-input-stt-custom-model-name'
                        + ', #node-input-stt-base-model'
                        + ', #node-input-stt-custom-model-description');
        break;
      case 'getCustomisation':
      case 'deleteCustomisation':
      case 'getCorpora':
      case 'train':
      case 'listCustomWords':
      case 'addWords':
        fields.push('#node-input-stt-custom-id');
        break;
      case 'addCorpus':
        fields.push('#node-input-stt-custom-id'
                     + ', #node-input-stt-corpus-name'
                     + ', #node-input-stt-allow-overwrite');
        break;
      case 'deleteCorpus':
          fields.push('#node-input-stt-custom-id'
                         + ', #node-input-stt-corpus-name');
          break;
    }
    sttv1qbb.showSelectedFields(fields);
  }



  // Check if there is a model then can show the fields.
  // available. The models can only be fetched if the credentials are available.
  sttv1qbb.VisibilityCheck = function () {
    if (sttv1qbb.models) {
      $('label#node-label-message').parent().hide();
    } else {
      $('label#node-label-message').parent().hide();
    }
  }


  // Simple check that is only invoked if the service is not bound into bluemix. In this case the
  // user has to provide credentials. Once there are credentials, then the sttv1qbb.models are retrieved.
  sttv1qbb.checkCredentials = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();

    if ((k && k.length) || (u && u.length && p)) {
      if (!sttv1qbb.models) {
        sttv1qbb.getModels();
      }
    }
  }


  // Register the handlers for the fields
  sttv1qbb.handlersUI = function () {
    $('#node-input-username').change(function(val){
      sttv1qbb.checkCredentials();
    });
    $('#node-input-password').change(function(val){
      sttv1qbb.checkCredentials();
    });
    $('#node-input-apikey').change(function(val){
      sttv1qbb.checkCredentials();
    });

    $('#node-input-stt-custom-mode').change(function() {
      sttv1qbb.mode_selected = $('#node-input-stt-custom-mode').val();
      sttv1qbb.processSelectedMethod(sttv1qbb.mode_selected);
    });

    $('#node-input-stt-base-model').change(function (val) {
      sttv1qbb.model_selected = $('#node-input-stt-base-model').val();
    });

    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });
  }

  // Called to complete the models table
  sttv1qbb.populateModels = function () {

    // node-input-stt-base-model
    if (sttv1qbb.models) {
      $('select#node-input-stt-base-model').empty();
      //var unique_langs = stt.languages.filter(stt.onlyUnique);

      sttv1qbb.models.forEach(function(m) {
        var selectedText = '';

        if (sttv1qbb.model_selected === m.name) {
          selectedText = ' selected="selected" ';
        }

        $('select#node-input-stt-base-model')
          .append('<option value='
                        + m.name
                        + selectedText
                        + '>'
                        + m.description
                        + '</option>');
      });
    }

  }


  // Called to work through the models, completing the dyanmic selection fields.
  sttv1qbb.processModels = function () {
    if (sttv1qbb.models) {
      sttv1qbb.populateModels();
    }
  }


  // Function called when either when the models have been retrieved, or
  // on dialog load, if the model has already been retrieved
  sttv1qbb.postModelCheck = function () {
    sttv1qbb.processModels();
    sttv1qbb.VisibilityCheck();
  }

  // Retrieve the available models from the server, if data is returned, then
  // can enable the dynamic selection fields.
  sttv1qbb.getModels = function (haveCredentials) {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();
    var e = $('#node-input-service-endpoint').val();
    var creds = {un: u, pwd: p, key: k};

    if (! $('#node-input-default-endpoint').prop('checked')) {
      creds.e = e;
    }
    $.getJSON('watson-speech-to-text-v1-query-builder/models/', creds)
    .done(function (data) {
      if (data.error) {
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(data.error);
      } else if (data.models) {
        sttv1qbb.models = data.models;
        //have_credentials = true;
        sttv1qbb.postModelCheck();
      }
    }).fail(function (err) {
      $('label#node-label-message').parent().show();
      $('label#node-label-message').text('Error trying to determine available service models');

    }).always(function () {});
  }


  // This is the on edit prepare function, which will be invoked everytime the dialog
  // is shown.
  function sttv1qbboneditprepare() {
    sttv1qbb.hideEverything();
    sttv1qbb.restoreFromHidden();
    sttv1qbb.handlersUI();

    $.getJSON('watson-speech-to-text-v1-query-builder/vcap/')
      // for some reason the getJSON resets the vars so need to restoreFromHidden again
      // so again.
      .done(function (service) {
        sttv1qbb.restoreFromHidden();
        $('.credentials').toggle(!service);
        if (!sttv1qbb.models) {sttv1qbb.getModels(service);}
        else {sttv1qbb.postModelCheck();}
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
     });
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function sttv1qbboneditsave(){
    $('#node-input-base-model-hidden').val(sttv1qbb.model_selected);
  }

    (function() {
        RED.nodes.registerType('watson-speech-to-text-v1-query-builder', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                password: {value: ''},
                apikey: {value: ''},
                'stt-custom-mode': {value:"createCustomisation"},
                'stt-custom-model-name' : {value: ''},
                'stt-base-model' : {value: ''},
                'base-model-hidden' : {value: ''},
                'stt-custom-model-description' : {value: ''},
                'stt-custom-id' : {value: ''},
                'stt-corpus-name' : {value: ''},
                'stt-allow-overwrite' : {value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://stream.watsonplatform.net/speech-to-text/api'}
            },
            credentials: {
              username: {type:'text'} //,
              // password: {type: 'password'}   - // Taken out because, was not being restored on dialog open.
            },
            color: 'rgb(100, 120, 50)',
            inputs: 1,
            outputs: 1,
            icon: 'speech_to_text.png',
            paletteLabel: 'speech to text custom builder',
            label: function() {
                return this.name || 'speech to text custom builder';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: sttv1qbboneditprepare,
            oneditsave: sttv1qbboneditsave
        });
    })();

</script>
<script type="text/x-red" data-help-name="watson-speech-to-text-v1-query-builder">
    <p>The Speech To Text Custom Builder is used to create customisations
    for Speech to Text. It supports the following modes </p>
    <ul>
    <li>Create Custom Language Model
      <p>In this mode, a new empty custom model is created. The
        new customization id is returned on
        <code>msg.customization_id</code>
      </p>
    </li>
    <li>List Customizations
      <p>In this mode, a list of all customizations that you have
        created in returned on
        <code>msg.customizations</code>
      </p>
    </li>
    <li>Get Customization
      <p>In this mode, details for the specified customization
        is returned on
        <code>msg.customization</code>
      </p>
    </li>
    <li>Delete Customization
      <p>In this mode, the specified customization is deleted.
      </p>
    </li>
    <li>Add Corpus
      <p>In this mode, the specified customization content is
        created. The input corpus content should be provided as buffer
        on
        <code>msg.payload</code>
      </p>
    </li>
    <li>Get Corpora
      <p>In this mode, a list of all the corpora created for
        the specified customization
        is returned on
        <code>msg.corpora</code>
      </p>
    </li>
    <li>Train
      <p>In this mode, the custom model is prepared for use
        by the speech to text service.
      </p>
    </li>
    <li>List Custom Words
      <p>In this mode, a list of all the words from a custom model are
        retrieved.
      </p>
    </li>
    <li>Add Words
      <p>In this mode, the specified custom words are added to the
        customization. The input array of words should be passed in
        as <code>msg.payload</code> in form of
        <code>[{word: String, sounds_like: [String, ...], display_as: String}, ...]</code>
        <br/>EG.
        <code>
          [ {"word": "HHonors", "sounds_like": ["hilton honors", "h honors"],
                                "display_as": "HHonors"},
            {"word": "IEEE", "sounds_like": ["i triple e"]}
          ]
        </code>
      </p>
    </li>
    <li>Delete Corpus
      <p>In this mode, the specified corpus is deleted.
      </p>
    </li>
    </ul>

    <p>For more information about Speech To Text customisation,
    read the <a href="https://console.bluemix.net/docs/services/speech-to-text/custom.html">
    documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-text-to-speech-v1] --- -->
<!--
  Copyright 2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-text-to-speech">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div>
        <label id="node-label-message"><i class="fa fa-exclamation-triangle"></i></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://stream.watsonplatform.net/text-to-speech/api">
    </div>

    <div class="form-row">
        <label for="node-input-lang"><i class="fa fa-language"></i> Language</label>
        <select type="text" id="node-input-lang" style="display: inline-block; width: 70%;" >
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-langhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-langcustom"><i class="fa fa-language"></i> Customization</label>
        <select type="text" id="node-input-langcustom" style="display: inline-block; width: 70%;">
        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-langcustomhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-voice"><i class="fa fa-comment"></i> Voice</label>
        <select type="text" id="node-input-voice" style="display: inline-block; width: 70%;">
         </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-voicehidden"/>
    </div>
    <div class="form-row">
        <label for="node-input-format"><i class="fa fa-file-audio-o"></i> Format</label>
        <select type="text" id="node-input-format" style="display: inline-block; width: 70%;" >
            <option value="audio/wav">WAV</option>
            <option value="audio/flac">FLAC</option>
            <option value="audio/ogg; codecs=opus">OGG</option>
            <option value="audio/mp3">MP3</option>
            <option value="audio/mpeg">MPEG</option>
            <option value="audio/webm">WEBM</option>
            <option value="audio/basic">BASIC</option>
        </select>
    </div>

    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-payload-response" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-payload-response" style="width: 70%;"> Place output on msg.payload</label>
    </div>

</script>



<script type="text/javascript">

  // Need to simulate a namespace, so that some of the variables don't leak across nodes
  function TTS () {
  }

  // This is the namespace for tts.
  var tts = new TTS();
  tts.custom_selected = '';
  tts.customisations = null;

  //tts.language_selected = '';
  //tts.voice_selected = '';
  tts.LANGUAGES = { 'en-US': 'US English',
                    'en-GB': 'UK English',
                    'pt-BR': 'Portuguese Brazilian',
                    'fr-FR': 'French',
                    'it-IT': 'Italian',
                    'de-DE': 'German',
                    'zh-CN': 'Mandarin',
                    'es-ES': 'Spanish',
                    'es-LA': 'Latin American Spanish',
                    'es-US': 'US Spanish',
                    'ar-AR': 'Arablic',
                    'ja-JP': 'Japanese'
                  };

  // sorting functions
  tts.onlyUnique = function (value, index, self) {
    return self.indexOf(value) === index;
  }

  // Called to complete the languages selection table
  tts.processLanguages = function () {
    if (!tts.languages && tts.voices) {
      tts.languages = tts.voices.map(function(m) {
        return m.language;
      });
    }
    if (tts.languages) {
      $('select#node-input-lang').empty();
      var unique_langs = tts.languages.filter(tts.onlyUnique);

      unique_langs.forEach(function(l) {
        var selectedText = '';
        if (tts.language_selected === l) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-lang')
          .append('<option value='
                        + '"' + l + '"'
                        + selectedText
                         + '>'
                        + (tts.LANGUAGES[l] ? tts.LANGUAGES[l] : l)
                        + '</option>');
      });

    }
  }

 // Populate the Voices selection field
 tts.populateVoices = function () {
   if (!tts.voicenames && tts.voices) {
     tts.voicenames = tts.voices.map(function(m) {
       //return m.name.split('_')[1];
       return m.name;
     });
     var unique_voices = tts.voicenames.filter(tts.onlyUnique);
     tts.voicenames = unique_voices;
   }
   if (!tts.voicedata && tts.voicenames){
     tts.voicedata = [];
     tts.voicenames.forEach(function(a){
       var element = {};
       var bits = a.split('_');
       element.full = a;
       element.language = bits[0];
       element.person = bits[1].replace('Voice','');;
       tts.voicedata.push(element);
     });
   }

   if (tts.voicedata) {
     $('select#node-input-voice').empty();

     tts.voicedata.forEach(function(b) {
       var selectedText = '';
       if (tts.voice_selected === b.full) {
         selectedText = 'selected="selected"';
       }
       if (tts.language_selected === b.language) {
         $('select#node-input-voice')
           .append('<option value='
                         + '"' + b.full + '"'
                         + selectedText
                         + '>'
                         + b.person
                         + '</option>');
       }
     });
   }
 }


  // Called to work through the voices, completing the dyanmic selection fields.
  tts.processVoices = function () {
    if (tts.voices) {
      tts.processLanguages();
      tts.populateVoices();
    }
  }

  tts.visibilityCheck = function ()
  {
    if (tts.voices) {
      $('label#node-label-message').parent().hide();
      $('select#node-input-lang').parent().show();
      $('select#node-input-voice').parent().show();
    } else {
      $('label#node-label-message').parent().hide();
      $('select#node-input-lang').parent().hide();
      $('select#node-input-voice').parent().hide();
      $('select#node-input-langcustom').parent().hide();
    }
  }

  // Function to fetch the customisations, should only be done once
  tts.fetchCustomisations = function() {
    if (!tts.customisations) {
      var u = $('#node-input-username').val();
      var p = $('#node-input-password').val();
      var k = $('#node-input-apikey').val();
      var e = $('#node-input-service-endpoint').val();
      var creds = {un: u, pwd: p, key: k};

      if (! $('#node-input-default-endpoint').prop('checked')) {
        creds.e = e;
      }
      $.getJSON('watson-text-to-speech/customs', creds)
      .done(function (data) {
        $('label#node-label-message').parent().hide();
        if (data.error) {
          $('label#node-label-message').parent().show();
          $('label#node-label-message').text(data.error);
        }
        else {
          tts.customisations = data.customizations;
          tts.populateCustoms();
        }
      }).fail(function (err) {
        var txt = 'Got server error ';
        if (err.status) {
          txt += '(' + err.status + ') '
        }
        txt += 'when trying to retrieve available customisations';
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(txt);
      }).always(function () {
      });

    }
  }


  // Function called when either when the voices have been retrieved, or
  // on dialog load, if the voices has already been retrieved
  tts.postVoiceCheck = function (){
    tts.processVoices();
    tts.visibilityCheck();
    tts.fetchCustomisations();
  }

  // Retrieve the available voices from the server, if data is returned, then
  // can enable the dynamic selection fields.
  tts.getVoices = function (){
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();
    var e = $('#node-input-service-endpoint').val();
    var creds = {un: u, pwd: p, key: k};

    if (! $('#node-input-default-endpoint').prop('checked')) {
      creds.e = e;
    }

    $.getJSON('watson-text-to-speech/voices/', creds)
    .done(function (data) {
      if (data.error) {
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(data.error);
      } else if (data.voices) {
        tts.voices = data.voices;
        tts.postVoiceCheck();
      }
    }).fail(function (err) {
      $('label#node-label-message').parent().show();
      $('label#node-label-message').text('Error trying to determine available service voices');

    }).always(function () {});
  }


  // The dynamic nature of the selection fields in this node has caused problems.
  // Whenever there is a fetch for the models, on a page refresh or applicaiton
  // restart, the settings for the dynamic fields are lost.
  // So hidden (text) fields are being used to squirrel away the values, so that
  // they can be restored.
  tts.restoreFromHidden = function () {
    tts.language_selected = $('#node-input-langhidden').val();
    $('select#node-input-lang').val(tts.language_selected);

    tts.voice_selected = $('#node-input-voicehidden').val();
    $('select#node-input-voice').val(tts.voice_selected);

    tts.custom_selected = $('#node-input-langcustomhidden').val();
    $('select#node-input-langcustom').val(tts.custom_selected);

  }

  // Simple check that is only invoked if the service is not bound into bluemix. In this case the
  // user has to provide credentials. Once there are credentials, then the tts.voices are retrieved.
  tts.checkCredentials = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();

    if ( (k && k.length) || (u && u.length && p) ) {
      if (!tts.voices) {
        tts.getVoices();
      }
    }
  }

  // Language Setting has changed, modofy voice options appropriately
  tts.checkLanguage = function (){
    //var lang = $('#node-input-lang').val();
    //$('#node-input-voice option.' + lang).show();
    //$('#node-input-voice option:not(.' + lang + ')').hide();
    //var first = $('#node-input-voice option.' + lang + ':first').val();
    //$('#node-input-voice').val(first);

    tts.language_selected = $('#node-input-lang').val();
  }

  // Voice Setting has changed, modofy voice options appropriately
  tts.checkVoice = function (){
    tts.voice_selected = $('#node-input-voice').val();
  }

  // Populate the customisations selection field
  // Need to check if we have customisations and if the
  // selected language and model have an entry.
  tts.populateCustoms = function() {
    var showit = false;

    $('select#node-input-langcustom').empty();

    // Add an option to not select
    $('select#node-input-langcustom')
      .append('<option value='
                    + 'NoCustomisationSetting'
                    + '' //showit ? '' : ' selected="selected" '
                    + '>'
                    + 'None'
                    + '</option>');

    if (tts.customisations) {
      tts.language_selected = tts.language_selected ?
                                  tts.language_selected :
                                  $('#node-input-langhidden').val();

      tts.customisations.forEach(function(c) {
        // Should really be checking against the cached values
        // stt.language_selected and stt.band_selected
        // but for some reason they are not always set.

        if (tts.language_selected === c['language']) {
          showit = true;
          var selectedText = '';
          if (tts.custom_selected === c['customization_id']) {
            selectedText = ' selected="selected" ';
          }
          $('select#node-input-langcustom')
            .append('<option value='
                          + '"' + c['customization_id'] + '"'
                          + selectedText
                          + '>'
                          + c['name']
                          + '</option>');
        }
      });
    }


    if (showit) {
      $('select#node-input-langcustom').parent().show();
    } else {
      $('select#node-input-langcustom').parent().hide();
    }
  }

  // Register the onchange handlers
  tts.registerHandlers = function () {
    $('#node-input-username').change(function(val){
      tts.checkCredentials();
    });
    $('#node-input-password').change(function(val){
      tts.checkCredentials();
    });
    $('#node-input-apikey').change(function(val){
      tts.checkCredentials();
    });
    $('#node-input-lang').change(function () {
      tts.checkLanguage();
      tts.populateVoices();
      tts.populateCustoms();
    });
    $('#node-input-voice').change(function () {
      tts.checkVoice();
    });
    $('#node-input-langcustom').change(function (val) {
      tts.custom_selected = $('#node-input-langcustom').val();
    });
    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });
  }

  // Function to be used at the start, as don't want to expose any fields, unless the models are
  // available. The models can only be fetched if the credentials are available.
  tts.hideEverything = function () {
    if (!stt.models) {
      $('label#node-label-message').parent().hide();
      $('select#node-input-lang').parent().hide();
      $('select#node-input-voice').parent().hide();
      $('select#node-input-langcustom').parent().hide();
    }
  }

  // This is the on edit prepare function, which will be invoked everytime the dialog
  // is shown.
  function ttsoneditprepare() {
    tts.hideEverything();
    tts.restoreFromHidden();
    tts.registerHandlers();

    $.getJSON('watson-text-to-speech/vcap/')
     .done(function (service) {
       tts.restoreFromHidden();
        $('.credentials').toggle(!service);
        if (!tts.voices) {tts.getVoices();}
        else {tts.postVoiceCheck();}
      })
    .fail(function () {
      $('.credentials').show();
    }).always(function () {
      $('#credentials-check').hide();
    })
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function ttsoneditsave(){
    $('#node-input-langhidden').val(tts.language_selected);
    $('#node-input-voicehidden').val(tts.voice_selected);
    $('#node-input-langcustomhidden').val(tts.custom_selected);
  }

    (function() {
        RED.nodes.registerType('watson-text-to-speech', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ""},
                lang: {value: ""},
                langhidden: {value: ""},
                langcustom: {value: ''},
                langcustomhidden: {value: ''},
                voice: {value: ""},
                voicehidden: {value: ""},
                format: {value: "audio/wav"},
                password: {value: ''},
                apikey: {value: ''},
                'payload-response' :{value: false},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://stream.watsonplatform.net/text-to-speech/api'}
            },
            credentials: {
              username: {type:"text"},
              // password: {type:"password"}   - // Taken out because, was not being restored on dialog open.
            },
            color: "rgb(140, 198, 63)",
            inputs: 1,
            outputs: 1,
            icon: "text_to_speech.png",
            paletteLabel: "text to speech",
            label: function() {
                return this.name || "text to speech";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditsave: ttsoneditsave,
            oneditprepare: ttsoneditprepare
        });
     })();
</script>
<script type="text/x-red" data-help-name="watson-text-to-speech">
    <p>The Text To Speech service understands text and natural language to generate synthesized audio output complete
    with appropriate cadence and intonation.</p>
    <p>You can choose different voices for a range of languages:</b>.</p>
    <p>The text to be converted should be passed in on <code>msg.payload</code>.</p>
    <p><b>The source text must be in the language which matches the chosen voice, i.e. you cannot choose to a Spanish
    voice with English text.</b>.</p>
    <p>The returned audio transcription will be returned as a raw buffer containing the audio on <code>msg.speech</code>.</p>
    <p>For more information about the Text To Speech service, read the <a href="https://www.ibm.com/watson/services/text-to-speech/">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-text-to-speech-corpus-builder-v1] --- -->
<!--
  Copyright 2017 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-text-to-speech-v1-query-builder">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>

    <div>
        <label id="node-label-message"><i class="fa fa-exclamation-triangle"></i></label>
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name"></input>
    </div>

    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password"></input>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://stream.watsonplatform.net/text-to-speech/api">
    </div>

    <div class="form-row">
        <label for="node-input-tts-custom-mode"><i class="fa fa-book"></i> Detect: </label>
        <select type="text" id="node-input-tts-custom-mode" style="display: inline-block; width: 70%;">
            <option value="createCustomisation">Create a custom language model</option>
            <option value="listCustomisations">List Customizations</option>
            <option value="getCustomisation">Get Customization</option>
            <option value="getPronounce">Get Pronouncation</option>
            <option value="addWords">Add Words</option>
            <option value="getWords">Get Words</option>
            <option value="deleteWord">Delete Word</option>
          </select>
    </div>

    <div class="form-row">
        <label for="node-input-tts-custom-format"><i class="fa fa-book"></i> Format: </label>
        <select type="text" id="node-input-tts-custom-format" style="display: inline-block; width: 70%;">
            <option value="ipa">International Phonetic Alphabet</option>
            <option value="spr">IBM Symbolic Phonetic Representation</option>
          </select>
    </div>

    <div class="form-row">
        <label for="node-input-tts-voice-or-custom"><i class="fa fa-book"></i> Get Pronounciation: </label>
        <select type="text" id="node-input-tts-voice-or-custom" style="display: inline-block; width: 70%;">
            <option value="voice">by voice</option>
            <option value="custom">by customization</option>
          </select>
    </div>

    <div class="form-row">
        <label for="node-input-tts-lang"><i class="fa fa-language"></i> Language</label>
        <select type="text" id="node-input-tts-lang" style="display: inline-block; width: 70%;" >

        </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-tts-langhidden"/>
    </div>

    <div class="form-row">
        <label for="node-input-voice"><i class="fa fa-comment"></i> Voice</label>
        <select type="text" id="node-input-tts-voice" style="display: inline-block; width: 70%;">
         </select>
    </div>
    <div class="form-row">
        <input type="hidden" id="node-input-tts-voicehidden"/>
    </div>


    <div class="form-row">
        <label for="node-input-tts-custom-model-name"><i class="fa fa-book"></i> Custom Model Name</label>
        <input type="text" id="node-input-tts-custom-model-name" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-tts-custom-model-description"><i class="fa fa-book"></i> Custom Model Description</label>
        <input type="text" id="node-input-tts-custom-model-description" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-tts-custom-id"><i class="fa fa-book"></i> Customization ID</label>
        <input type="text" id="node-input-tts-custom-id" placeholder="">
    </div>

    <div class="form-row">
        <label for="node-input-tts-custom-word"><i class="fa fa-book"></i> Word</label>
        <input type="text" id="node-input-tts-custom-word" placeholder="">
    </div>

</script>



<script type="text/javascript">

  // Need to simulate a namespace, as some of the variables had started to leak across nodes
  function TTSV1QBB () {
  }


  // This is the namespace for ttsv1qbb. Currently only contains models, but more vars and functions may need to be
  // moved in if there is a clash with other nodes.
  var ttsv1qbb = new TTSV1QBB();
  ttsv1qbb.LANGUAGES = { 'en-US': 'US English',
                    'en-GB': 'UK English',
                    'pt-BR': 'Portuguese Brazilian',
                    'fr-FR': 'French',
                    'it-IT': 'Italian',
                    'de-DE': 'German',
                    'zh-CN': 'Mandarin',
                    'es-ES': 'Spanish',
                    'es-LA': 'Latin American Spanish',
                    'es-US': 'US Spanish',
                    'ar-AR': 'Arablic',
                    'ja-JP': 'Japanese'
                  };

  ttsv1qbb.voices = null;
  ttsv1qbb.languages = null;
  ttsv1qbb.language_selected = '';
  ttsv1qbb.voice_selected = '';
  ttsv1qbb.mode_selected = null;
  ttsv1qbb.voicenames = null;

  // sorting functions
  ttsv1qbb.onlyUnique = function (value, index, self) {
    return self.indexOf(value) === index;
  }

  // Simple check that is only invoked if the service is not bound into bluemix. In this case the
  // user has to provide credentials. Once there are credentials, then the
  // ttsv1qbb.??? are retrieved.
  ttsv1qbb.checkCredentials = function () {
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();

    if ( (k && k.length) || (u && u.length && p) ) {
      if (!ttsv1qbb.voices) {
        ttsv1qbb.getVoices();
      }
    }
  }

  ttsv1qbb.showSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().show();
    }
  }

  ttsv1qbb.hideSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().hide();
    }
  }


  ttsv1qbb.processPronounceSetting = function () {
    var vorc = $('#node-input-tts-voice-or-custom').val();
    var showfields = [];
    var hidefields = [];
    if ('custom' == vorc) {
      showfields.push('#node-input-tts-custom-id');
      hidefields.push('#node-input-tts-lang');
      hidefields.push('#node-input-tts-voice');
    } else {
      showfields.push('#node-input-tts-lang');
      showfields.push('#node-input-tts-voice');
      hidefields.push('#node-input-tts-custom-id');
    }
    ttsv1qbb.showSelectedFields(showfields);
    ttsv1qbb.hideSelectedFields(hidefields);
  }


  ttsv1qbb.processSelectedMethod = function(method) {
    ttsv1qbb.hideEverything();
    var fields = [];
    switch (method) {
      case 'createCustomisation':
        fields.push('#node-input-tts-custom-model-name'
                        + ', #node-input-tts-lang'
                        + ', #node-input-tts-custom-model-description');
        break;
      case 'deleteWord':
        fields.push('#node-input-tts-custom-word'
                        + ', #node-input-tts-custom-id');
        break;
      case 'getCustomisation':
      case 'addWords':
      case 'getWords':
        fields.push('#node-input-tts-custom-id');
        break;
      case 'getPronounce':
        fields.push('#node-input-tts-custom-word'
                        + ', #node-input-tts-custom-format'
                        + ', #node-input-tts-voice-or-custom');
        ttsv1qbb.processPronounceSetting();
        break;
    }
    ttsv1qbb.showSelectedFields(fields);
  }


  // Populate the Voices selection field
  ttsv1qbb.populateVoices = function () {
    if (!ttsv1qbb.voicenames && ttsv1qbb.voices) {
      ttsv1qbb.voicenames = ttsv1qbb.voices.map(function(m) {
        //return m.name.split('_')[1];
        return m.name;
      });
      var unique_voices = ttsv1qbb.voicenames.filter(ttsv1qbb.onlyUnique);
      ttsv1qbb.voicenames = unique_voices;
    }
    if (!ttsv1qbb.voicedata && ttsv1qbb.voicenames){
      ttsv1qbb.voicedata = [];
      ttsv1qbb.voicenames.forEach(function(a){
        var element = {};
        var bits = a.split('_');
        element.full = a;
        element.language = bits[0];
        element.person = bits[1].replace('Voice','');;
        ttsv1qbb.voicedata.push(element);
      });
    }

    if (ttsv1qbb.voicedata) {
      $('select#node-input-tts-voice').empty();

      ttsv1qbb.voicedata.forEach(function(b) {
        var selectedText = '';
        if (ttsv1qbb.voice_selected === b.full) {
          selectedText = 'selected="selected"';
        }
        if (ttsv1qbb.language_selected === b.language) {
          $('select#node-input-tts-voice')
            .append('<option value='
                          + '"' + b.full + '"'
                          + selectedText
                          + '>'
                          + b.person
                          + '</option>');
        }
      });
    }
  }


  // Register the handlers for the fields
  ttsv1qbb.handlersUI = function () {
    $('#node-input-username').change(function(val){
      ttsv1qbb.checkCredentials();
    });
    $('#node-input-password').change(function(val){
      ttsv1qbb.checkCredentials();
    });
    $('#node-input-apikey').change(function(val){
      ttsv1qbb.checkCredentials();
    });

    $('#node-input-tts-custom-mode').change(function() {
      ttsv1qbb.mode_selected = $('#node-input-tts-custom-mode').val();
      ttsv1qbb.processSelectedMethod(ttsv1qbb.mode_selected);
    });

    $('#node-input-tts-lang').change(function () {
      $('#node-input-tts-langhidden').val(ttsv1qbb.language_selected);
      ttsv1qbb.language_selected = $('#node-input-tts-lang').val();

      //tts.checkLanguage();
      ttsv1qbb.populateVoices();
    });

    $('#node-input-tts-voice').change(function () {
      $('#node-input-tts-voicehidden').val(ttsv1qbb.voice_selected);
      ttsv1qbb.voice_selected = $('#node-input-tts-voice').val();
    });


    $('#node-input-tts-voice-or-custom').change(function() {
      //console.log('voice or custom option is set to ', $('#node-input-tts-voice-or-custom').val());
      if ('getPronounce' == ttsv1qbb.mode_selected) {
        ttsv1qbb.processPronounceSetting();
      }
    });

    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });
  }

  // The dynamic nature of the selection fields in this node has caused problems.
  // Whenever there is a fetch for the models, on a page refresh or applicaiton
  // restart, the settings for the dynamic fields are lost.
  // So hidden (text) fields are being used to squirrel away the values, so that
  // they can be restored.
  ttsv1qbb.restoreFromHidden = function () {
    //ttsv1qbb.model_selected = $('#node-input-base-model-hidden').val();
    //$('select#node-input-tts-base-model').val(tts.model_selected);
    ttsv1qbb.language_selected = $('#node-input-tts-langhidden').val();
    $('select#node-input-tts-lang').val(ttsv1qbb.language_selected);

    ttsv1qbb.voice_selected = $('#node-input-tts-voicehidden').val();
    $('select#node-input-tts-voice').val(ttsv1qbb.voice_selected);
  }

  // Function to be used at the start, as don't want to expose any fields, unless the models are
  // available. The models can only be fetched if the credentials are available.
  ttsv1qbb.hideEverything = function () {
    var hidefields = [];

    if (!ttsv1qbb.voices) {
      $('#credentials-not-found').show();
      hidefields.push('#node-label-message');
    }
    hidefields.push('#node-input-tts-lang');
    hidefields.push('#node-input-tts-custom-model-name');
    hidefields.push('#node-input-tts-custom-model-description');
    hidefields.push('#node-input-tts-custom-id');
    hidefields.push('#node-input-tts-custom-word');
    hidefields.push('#node-input-tts-custom-format');
    hidefields.push('#node-input-tts-voice-or-custom');
    hidefields.push('#node-input-tts-voice');

    ttsv1qbb.hideSelectedFields(hidefields);
  }

  // Called to complete the languages selection table
  ttsv1qbb.processLanguages = function () {
    if (!ttsv1qbb.languages && ttsv1qbb.voices) {
      ttsv1qbb.languages = ttsv1qbb.voices.map(function(m) {
        return m.language;
      });
    }
    if (ttsv1qbb.languages) {
      $('select#node-input-tts-lang').empty();
      var unique_langs = ttsv1qbb.languages.filter(ttsv1qbb.onlyUnique);

      unique_langs.forEach(function(l) {
        var selectedText = '';
        if (ttsv1qbb.language_selected === l) {
          selectedText = 'selected="selected"';
        }
        $('select#node-input-tts-lang')
          .append('<option value='
                        + '"' + l + '"'
                        + selectedText
                         + '>'
                        + (ttsv1qbb.LANGUAGES[l] ? ttsv1qbb.LANGUAGES[l] : l)
                        + '</option>');
      });
    }
  }

  // Called to work through the voices, completing the dyanmic selection fields.
  ttsv1qbb.processVoices = function () {
    if (ttsv1qbb.voices) {
      ttsv1qbb.processLanguages();
      ttsv1qbb.populateVoices();
    }
  }

  ttsv1qbb.visibilityCheck = function ()
  {
    if (ttsv1qbb.voices) {
      $('label#node-label-message').parent().hide();
      //$('select#node-input-tts-lang').parent().show();
    } else {
      $('label#node-label-message').parent().hide();
      $('select#node-input-tts-lang').parent().hide();
    }
  }

  // Function called when either when the voices have been retrieved, or
  // on dialog load, if the voices has already been retrieved
  ttsv1qbb.postVoiceCheck = function (){
    ttsv1qbb.processVoices();
    ttsv1qbb.visibilityCheck();
  }

  ttsv1qbb.restoreFromHidden = function () {
    ttsv1qbb.language_selected = $('#node-input-tts-langhidden').val();
    $('select#node-input-tts-lang').val(ttsv1qbb.language_selected);
  }


  // Retrieve the available voices from the server, if data is returned, then
  // can enable the dynamic selection fields.
  ttsv1qbb.getVoices = function (){
    var u = $('#node-input-username').val();
    var p = $('#node-input-password').val();
    var k = $('#node-input-apikey').val();
    var e = $('#node-input-service-endpoint').val();
    var creds = {un: u, pwd: p, key: k};

    if (! $('#node-input-default-endpoint').prop('checked')) {
      creds.e = e;
    }
    $.getJSON('watson-text-to-speech-v1-query-builder/voices/',creds)
    .done(function (data) {
      if (data.error) {
        $('label#node-label-message').parent().show();
        $('label#node-label-message').text(data.error);
      } else if (data.voices) {
        ttsv1qbb.voices = data.voices;
        ttsv1qbb.postVoiceCheck();
      }
    }).fail(function (err) {
      $('label#node-label-message').parent().show();
      $('label#node-label-message').text('Error trying to determine available service voices');

    }).always(function () {});
  }


  // This is the on edit prepare function, which will be invoked everytime the dialog
  // is shown.
  function ttsv1qbboneditprepare() {
    ttsv1qbb.hideEverything();
    ttsv1qbb.restoreFromHidden();
    ttsv1qbb.handlersUI();

    $.getJSON('watson-text-to-speech-v1-query-builder/vcap/')
      // for some reason the getJSON resets the vars so need to restoreFromHidden again
      // so again.
      .done(function (service) {
        ttsv1qbb.restoreFromHidden();
        $('.credentials').toggle(!service);
        //if (!sttv1qbb.models) {sttv1qbb.getModels(service);}
        //else {sttv1qbb.postModelCheck();}
        if (!ttsv1qbb.voices) {ttsv1qbb.getVoices();}
        else {ttsv1qbb.postVoiceCheck();}
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
     });
  }

  // Save the values in the dyanmic lists to the hidden fields.
  function ttsv1qbboneditsave(){
    $('#node-input-tts-langhidden').val(ttsv1qbb.language_selected);
    $('#node-input-tts-voicehidden').val(ttsv1qbb.voice_selected);
  }

    (function() {
        RED.nodes.registerType('watson-text-to-speech-v1-query-builder', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ''},
                password: {value: ''},
                apikey: {value: ''},
                'tts-lang': {value: ""},
                'tts-langhidden': {value: ""},
                'tts-custom-mode': {value:"createCustomisation"},
                'tts-custom-model-name' : {value: ''},
                'tts-custom-model-description' : {value: ''},
                'tts-custom-id' : {value: ''},
                'tts-custom-word' : {value: ''},
                'tts-custom-format' : {value: ''},
                'tts-voice-or-custom' : {value: ''},
                'tts-voice': {value: ""},
                'tts-voicehidden': {value: ""},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://stream.watsonplatform.net/text-to-speech/api'}
            },
            credentials: {
              username: {type:'text'} //,
              // password: {type: 'password'}   - // Taken out because, was not being restored on dialog open.
            },
            color: 'rgb(100, 120, 50)',
            inputs: 1,
            outputs: 1,
            icon: 'text_to_speech.png',
            paletteLabel: 'text to speech custom builder',
            label: function() {
                return this.name || 'text to speech custom builder';
            },
            labelStyle: function() {
                return this.name ? 'node_label_italic' : '';
            },
            oneditprepare: ttsv1qbboneditprepare,
            oneditsave: ttsv1qbboneditsave
        });
    })();

</script>
<script type="text/x-red" data-help-name="watson-text-to-speech-v1-query-builder">
    <p>The Speech To Text Custom Builder is used to create customizations
    for Speech to Text. It supports the following modes </p>
    <ul>

    <li>Create Custom Language Model
      <p>In this mode, a new empty custom model is created. The
        new customization id is returned on
        <code>msg.customization_id</code>
      </p>
    </li>

    <li>List Customizations
      <p> Use this mode to list customizations such as the name and description
        for all custom voice models that you own for all languages.
        Data is returned on <code>msg.customizations</code>
      </p>
    </li>

    <li>Get Customization
      <p> Use this mode to list all information about a specifid
        custom voice model. The response includes the words in the model
        and their translations as defined in the model.
        Data is returned on <code>msg.customization</code>
      </p>
    </li>

    <li>Get Pronounciation
      <p> Use this mode to show the phonetic pronounciation of words
        for voices or customizations.
        Data is returned on <code>msg.pronunciation</code>
      </p>
    </li>

    <li>Add Words
      <p> Adds one or more words and their translations to the
        specified custom voice model. The input corpus content should be
        provided as buffer or JSoN Array of Words on
        <code>msg.payload</code>
      </p>
    </li>

    <li>Get Words
      <p> Lists all of the words and their translations for the specified
      custom voice model.
      Data is returned on <code>msg.words</code>
      </p>
    </li>

    <li>Delete Word
      <p> Deletes a single word from the specified custom voice model.
      </p>
    </li>

    </ul>

    <p>For more information about Speech To Text customization,
    read the <a href="https://console.bluemix.net/docs/services/text-to-speech/custom-using.html">
    documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-tone-analyzer-v3] --- -->
<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="watson-tone-analyzer-v3">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-input-username" placeholder="Username">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-password"><i class="fa fa-key"></i> Password</label>
        <input type="password" id="node-input-password" placeholder="Password">
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key"></input>
    </div>

    <div class="form-row credentials">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-default-endpoint" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-cwm-default-endpoint" style="width: 70%;"> Use Default Service Endpoint</label>
    </div>
    <div class="form-row">
        <label for="node-input-cwm-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <input type="text" id="node-input-service-endpoint" placeholder="https://gateway.watsonplatform.net/tone-analyzer/api">
    </div>

    <div class="form-row">
        <label for="node-input-tone-method"><i class="fa fa-book"></i> Method: </label>
        <select type="text" id="node-input-tone-method" style="display: inline-block; width: 70%;">
            <option value="generalTone">General Tone</option>
            <option value="customerEngagementTone">Customer Engagement Tone</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-interface-version"><i class="fa fa-history"></i> version_date: </label>
        <select type="text" id="node-input-interface-version" style="display: inline-block; width: 70%;">
            <option value="2016-05-19">Multiple Tones</option>
            <option value="2017-09-21">Dominant Tone</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-tones"><i class="fa fa-comments-o"></i> Tones</label>
        <select type="text" id="node-input-tones" style="display: inline-block; width: 70%;" >
            <option value="all">All</option>
            <option value="emotion">Emotion</option>
            <option value="language">Language</option>
            <option value="social">Social</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-sentences"><i class="fa fa-language"></i> Sentences</label>
        <select type="text" id="node-input-sentences" style="display: inline-block; width: 70%;" >
            <option value="true">True</option>
            <option value="false">False</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-contentType"><i class="fa fa-comments-o"></i> Content type</label>
        <select type="text" id="node-input-contentType" style="display: inline-block; width: 70%;" >
            <option value="false">Text</option>
            <option value="true">HTML</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-inputlang"><i class="fa fa-language"></i> Input Text Language</label>
        <select type="text" id="node-input-inputlang" style="display: inline-block; width: 70%;" >
            <option value="en">English</option>
            <option value="fr">French</option>
        </select>
    </div>

</script>



<script type="text/javascript">
  // Need to simulate a namespace, so that some of the variables don't leak across nodes
  function ToneAnalyzerV3 () {}

  // This is the namespace for this version of this Node.
  var ToneV3 = new ToneAnalyzerV3();

  ToneV3.showSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().show();
    }
  }

  ToneV3.hideSelectedFields = function(fields) {
    for (i = 0; i < fields.length; i++) {
      $(fields[i]).parent().hide();
    }
  }

  ToneV3.hideAll = function() {
    fields = [];
    fields.push('#node-input-tones');
    fields.push('#node-input-sentences');
    fields.push('#node-input-contentType');
    fields.push('#node-input-inputlang');
    ToneV3.hideSelectedFields(fields);
  };

  ToneV3.processSelectedMethod = function(method) {
    ToneV3.hideAll();
    fields = [];
    switch (method) {
      case 'generalTone':
        fields.push('#node-input-tones');
        fields.push('#node-input-sentences');
        fields.push('#node-input-contentType');
        fields.push('#node-input-inputlang');
        break;
    }
    ToneV3.showSelectedFields(fields);
  }

  ToneV3.processSelectedVersion = function(method, version) {
    if ('generalTone' == method)
    {
      fields = [];
      fields.push('#node-input-tones');
      if  ('2016-05-19' == version) {
        ToneV3.showSelectedFields(fields);
      } else {
        ToneV3.hideSelectedFields(fields);
      }
    }
  }

  ToneV3.UIListeners = function () {
    $('#node-input-tone-method').change(function(val){
      var method = $('#node-input-tone-method').val();
      ToneV3.processSelectedMethod(method);
    });

    $('#node-input-interface-version').change(function(val){
      var version = $('#node-input-interface-version').val();
      var method = $('#node-input-tone-method').val();
      ToneV3.processSelectedVersion(method, version);
    });

    $('#node-input-default-endpoint').change(function () {
      var checked = $('#node-input-default-endpoint').prop('checked')
      if (checked) {
        $('#node-input-service-endpoint').parent().hide();
      } else {
        $('#node-input-service-endpoint').parent().show();
      }
    });
  }

  ToneV3.checkForPrepare = function () {
    ToneV3.hideAll();
    ToneV3.UIListeners();
  };

  // This is the on edit prepare function, which will be invoked everytime the dialog is shown.
  function oneditprepare() {
    ToneV3.checkForPrepare();
    $.getJSON('watson-tone-analyzer/vcap/')
      .done(function (service) {
        $('.credentials').toggle(!service);
      })
      .fail(function () {
        $('.credentials').show();
      }).always(function () {
        $('#credentials-check').hide();
      })
  }

    (function() {
        RED.nodes.registerType('watson-tone-analyzer-v3', {
            category: 'IBM Watson',
            defaults: {
                name: {value: ""},
                tones: {value: "all"},
                sentences: {value: "true"},
                contentType: {value: "false"},
                "tone-method": {value:"generalTone"},
                "interface-version": {value:"generalTone"},
                name: {value: ""},
                inputlang: {value: "en"},
                'default-endpoint' :{value: true},
                'service-endpoint' :{value: 'https://gateway.watsonplatform.net/tone-analyzer/api'}
            },
            credentials: {
              username: {type:'text'},
              password: {type:'password'},
              apikey: {type: 'password'}
            },
            color: "rgb(84,149,230)",
            inputs: 1,
            outputs: 1,
            icon: "tone_analyzer.png",
            paletteLabel: "tone analyzer v3",
            label: function() {
                return this.name || "tone analyzer v3";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: oneditprepare
        });
    })();
</script>
<script type="text/x-red" data-help-name="watson-tone-analyzer-v3">
    <p>The Tone Analyzer service uses linguistic analysis to detect emotional tones, social propensities,
       and writing styles in written communication.</p>
    <p>The text to analyze should be passed in on <b>msg.payload</b>.</p>
    <p>The service response will be returned on <b>msg.response</b>.</p>
    <p>The tone and sentances can be programmaticaly set in <code>msg.tones</code>
    and <code>msg.sentences</code></p>
    <p>Usng the node editor dialog users can filter the results by tone (emotion, language or social) and
      whether to include sentence-level analysis.</p>
    <p>When running the Conversational Chat Tone, the input needs to follow the
    chat json format for utterences. </p>
    <p>For more information about the Tone Analyzer service, read the <a href="https://www.ibm.com/watson/services/tone-analyzer/">documentation</a>.</p>
</script>
<!-- --- [red-module:node-red-node-watson/watson-visual-recognition-v3] --- -->
<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="visual-recognition-v3">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key">
    </div>
    <div class="form-row credentials">
        <label for="node-input-vr-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <select type="text" id="node-input-vr-service-endpoint" style="display: inline-block; width: 70%;" >
            <option value="https://gateway-a.watsonplatform.net/visual-recognition/api">https://gateway-a.watsonplatform.net/visual-recognition/api</option>
            <option value="https://gateway.watsonplatform.net/visual-recognition/api">https://gateway.watsonplatform.net/visual-recognition/api</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-image-feature"><i class="fa fa-book"></i> Detect: </label>
        <select type="text" id="node-input-image-feature" style="display: inline-block; width: 70%;">
            <option selected="selected" value="classifyImage">Classify an image</option>
            <option value="detectFaces">Detect Faces</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row" id="lang-group">
        <label for="node-input-lang"><i class="fa fa-language"></i> Language</label>
        <select type="text" id="node-input-lang" style="display: inline-block; width: 70%;" >
            <option selected="selected" value="en">English</option>
            <option value="es">Spanish</option>
            <option value="de">German</option>
            <option value="fr">French</option>
            <option value="it">Italian</option>
            <option value="ar">Arabic</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
        </select>
    </div>
</script>


<script type="text/x-red" data-template-name="visual-recognition-util-v3">
    <div id="credentials-check" class="form-row">
        <div class="form-tips">
            <i class="fa fa-question-circle"></i><b> Please wait: </b> Checking for bound service credentials...
        </div>
    </div>
    <div class="form-row credentials" style="display: none;">
        <label for="node-input-apikey"><i class="fa fa-key"></i> API Key</label>
        <input type="password" id="node-input-apikey" placeholder="API Key">
    </div>
    <div class="form-row credentials">
        <label for="node-input-vr-service-endpoint"><i class="fa fa-tag"></i> Service Endpoint</label>
        <select type="text" id="node-input-vr-service-endpoint" style="display: inline-block; width: 70%;" >
            <option value="https://gateway-a.watsonplatform.net/visual-recognition/api">https://gateway-a.watsonplatform.net/visual-recognition/api</option>
            <option value="https://gateway.watsonplatform.net/visual-recognition/api">https://gateway.watsonplatform.net/visual-recognition/api</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-image-feature"><i class="fa fa-book"></i> Detect: </label>
        <select type="text" id="node-input-image-feature" style="display: inline-block; width: 70%;">
            <option value="createClassifier">Create a classifier</option>
            <option value="retrieveClassifiersList">Retrieve a list of classifiers</option>
            <option value="retrieveClassifierDetails">Retrieve Classifier Details</option>
            <option value="updateClassifier">Update a classifier</option>
            <option value="deleteClassifier">Delete a classifier</option>
            <option value="deleteAllClassifiers">Delete all classifiers</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>






<script type="text/javascript">

// Need to simulate a namespace, as some of the variables had started to leak across nodes
  function VISUALRECOGNITIONV3 () {
  }

  // This is the namespace for visualrecognitionv3. Currently only contains models, but more vars and functions may need to be
  // moved in if there is a clash with other nodes.
  var visualrecognitionv3 = new VISUALRECOGNITIONV3();
  visualrecognitionv3.language_selected = '';

  // Save the values in the dynamic lists to the hidden fields.
  function oneditsave(){
    visualrecognitionv3.language_selected = $('#node-input-lang').val();
  }

    (function() {
        RED.nodes.registerType('visual-recognition-v3', {
            category: 'IBM Watson',
            defaults: {
              name: {value: ""},
              apikey: {value: ""},
              'vr-service-endpoint' :{value: 'https://gateway-a.watsonplatform.net/visual-recognition/api'},
              "image-feature": {value: ""},
              "lang": {value: ""},
            },
            credentials: {
              apikey: {type:"password"}
            },
            color: 'rgb(228, 189, 255)',
            inputs: 1,
            outputs: 1,
            icon: "VR-v3-pink.png",
            paletteLabel: "visual recognition",
            label: function() {
                return this.name || "visual recognition";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
              var node = this;
              $.getJSON('watson-visual-recognition/vcap/')
                  .done(function (service) {
                    $('.credentials').toggle(!service);
                  })
                  .fail(function () {
                    $('.credentials').show();
                  })
                  .always(function () {
                    $('#credentials-check').hide();
                  });

              // Default the type of extraction, as its coming up blank,
              // which is confusing our users
              var currfeature = $('#node-input-image-feature').val();
              if (!currfeature) {
                $("#node-input-image-feature option[value='classifyImage']").prop('selected', true);
              }

              // update list of ruleset for the selected service when the service changes
              // The language is needed for the classifyImage, and if not set causes
              // problems downstream. So if it is not set will default to English.
              // Even though selected='selected' is set in the html for the dialog it
              // doesn't appear.
              $('#node-input-image-feature').change(function() {
                var selectedFeature = $('#node-input-image-feature');
                if (selectedFeature.val() == 'classifyImage') {
                    var currvalue = $('#node-input-lang').val();
                    if (!currvalue) {
                      if (!visualrecognitionv3.language_selected) {
                        visualrecognitionv3.language_selected = 'en';
                        $("#node-input-lang option[value='en']").prop('selected', true);
                      }
                    }
                    $('#lang-group').show();
                }
                else {
                    $('#lang-group').hide();
                }
              });
            },
            oneditsave: oneditsave
        });


        RED.nodes.registerType('visual-recognition-util-v3', {
            category: 'IBM Watson',
            defaults: {
              name: {value: ""},
              apikey: {value: ""},
              'vr-service-endpoint' :{value: 'https://gateway-a.watsonplatform.net/visual-recognition/api'},
              "image-feature": {value: ""}
            },
            credentials: {
              apikey: {type:"password"}
            },
            color: 'rgb(228, 189, 255)',
            inputs: 1,
            outputs: 1,
            icon: "VR-v3-pink.png",
            paletteLabel: "visual recognition util",
            label: function() {
                return this.name || "visual recognition util";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
              $.getJSON('watson-visual-recognition/vcap/')
                  .done(function (service) {
                    $('.credentials').toggle(!service);
                  })
                  .fail(function () {
                    $('.credentials').show();
                  })
                  .always(function () {
                    $('#credentials-check').hide();
                  })
            }
        });
    })();
</script>


<script type="text/x-red" data-help-name="visual-recognition-v3">
	<p>Using the Visual Recognition v3 node, you can use the Watson Visual Recognition service V3 to identify scenes, objects, faces, and text in images you upload to the service. You can create and train a custom classifier to identify subjects that suit your needs.</p>
    <p>The following features are available :</p>
    <ul>
        <li><b>Classify an image</b> Upload images or URLs to identify built-in classifiers by default. To identify custom classifiers, include the classifier_ids or owners parameters. Images must be in .jpeg, .jpg or .png format.</li>
        <li><b>Detect Faces</b> : analyze faces in images and get data about them, such as estimated age and gender. Images must be in .jpeg, .jpg or .png format.</li>
        <li><b>Recognize Text</b> : recognizes text in images. This is a beta function of the Visual Recognition service that supports only English language text identification</li>
    </ul>

    <p>All Results will made available at <code>msg.result</code></p>
    <p>Important : Maximum image size is 2 MB</p>
    <br/>

    <p><b>Classify an image</b></p>
    <p>This feature should be provided in input : </p>
    <ul>
    <li><code>msg.payload</code> : the URL or the Node.js Buffer of an image. Redirects are followed, so you can use shortened URLs. (Required)</li>
    <li><code>msg.params["detect_mode"]</code> : A setting of "classify" or "faces" indicating the visual recognition feature required. "Default" is "classify" (string) (Optional)</li>
    <li><code>msg.params["classifier_ids"]</code> : A comma-separated list of the classifier IDs used to classify the images. "Default" is the classifier_id of the built-in classifier. (string) (Optional)</li>
    <li><code>msg.params["owners"]</code> : A comma-separated list with the value(s) "IBM" and/or "me" to specify which classifiers to run. (string) (Optional)</li>
    <li><code>msg.params["threshold"]</code> : A floating value (in string format) that specifies the minimum score a class must have to be displayed in the response (Optional)</li>
    <li><code>msg.params["accept_language"]</code> : Specifies the language of the output class names. Can be 'en' (English as default), 'es' (Spanish), 'ar' (Arabic) or 'ja' (Japanese). Classes for which no translation is available are omitted. If specified, it overrides the language specified in the node configuration (Optional)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#classify_an_image">API documentation</a>.</p>

    <p><b>Detect Faces</b></p>
    <p>This feature should be provided in input : </p>
    <ul>
    <li><code>msg.payload</code> : the URL or the Node.js Buffer of an image. Redirects are followed, so you can use shortened URLs. (Required)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#detect_faces">API documentation</a>.</p>

    <p><b>Text Recognition</b></p>
    <p>This feature should be provided in input : </p>
    <ul>
    <li><code>msg.payload</code> : the URL or the Node.js Buffer of an image. Redirects are followed, so you can use shortened URLs. (Required)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#recognize_text">API documentation</a>.</p>

    <br/>
    <p>For full details on the feature details and response values, please see the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/">Watson Visual Recognition (v3) API documentation</a></p>

    <p>Check the sample Flow for this node on  <a href="https://github.com/watson-developer-cloud/node-red-bluemix-starter">Watson Node-RED Starter</a></p>
</script><script type="text/x-red" data-help-name="visual-recognition-util-v3">
	<p> This node enables you to use the training features of the Watson Visual Recognition service V3 that aims to identify scenes, objects, faces, and text in images you upload to the service. Using this node you can create and train a custom classifier to identify subjects that suit your needs.</p>
    <p>The following features are available :</p>
    <ul>
        <li><b>Create a classifier</b> </li>
        <li><b>Retrieve a list of custom classifier</b></li>
        <li><b>Retrieve classifier details</b></li>
        <li><b>Delete a classifier</b></li>
        <li><b>Delete all classifiers</b></li>
    </ul>

    <p>All Results will made available at <code>msg.result</code></p>

    <p><b>Create a Classifier</b></p>
    <p>this feature should be provided in input : </p>
    <ul>
    <li><code>msg.params["name"]</code> : a string name that will be used as prefix for the returned classifier_id (Required)</li>
    <li><code>msg.params["{classname}_positive_examples"]</code> : a Node.js binary Buffer of the ZIP that contains a minimum of 10 images. (Required)</li>
    <li><code>msg.params["negative_examples"]</code> : a Node.js binary Buffer of the ZIP that contains a minimum of 10 images.(Optional)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#create_a_classifier">API documentation</a>.</p>

    <p><b>Retrieve classifiers list</b></p>
    <p>this feature does not need input params.</p>

    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#retrieve_a_list_of_classifiers">API documentation</a>.</p>

    <p><b>Retrieve a classifier details</b></p>
    <p>this feature should be provided in input : </p>
    <ul>
    <li><code>msg.params["classifier_id"]</code> : the classifier_id (string) (Required)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#retrieve_classifier_details">API documentation</a>.</p>

    <p><b>Delete a classifier </b></p>
    <p>this feature should be provided in input : </p>
    <ul>
    <li><code>msg.params["classifier_id"]</code> : the classifier_id (string) (Required)</li>
    </ul>
    <p>More information on this <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/?curl#delete_a_classifier">API documentation</a>.</p>

    <p>For full details on the feature details and response values, please see the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/">Watson Visual Recognition (v3) API documentation</a></p>

    <p><b>Delete All Classifiers</b></p>
    <p>This feature simply delete all custom classifiers associated to the service instance. This feature does not need input params.</p>

    <br/>
    <p>For full details on the feature details and response values, please see the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/">Watson Visual Recognition (v3) API documentation</a></p>

    <p>Check the sample Flow for this node on  <a href="https://github.com/watson-developer-cloud/node-red-bluemix-starter">Watson Node-RED Starter</a></p>

</script>
<!-- --- [red-module:node-red-nodes-cf-sqldb-dashdb/sqldb-dashdb-cf] --- -->
<!--
  Copyright 2014 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="dashDB">
    <div class="form-row">
        <label for="node-config-input-hostname"><i class="fa fa-bookmark"></i> Hostname</label>
        <input class="input-append-left" type="text" id="node-config-input-hostname">
    </div>
    <div class="form-row">
        <label for="node-config-input-db"><i class="fa fa-user"></i> Database</label>
        <input type="text" id="node-config-input-db">
    </div>
    <div class="form-row">
        <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-config-input-username">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
        <input type="password" id="node-config-input-password">
    </div>
    <div class="form-row">
        <label for="node-config-input-port"><i class="fa fa-lock"></i> Port</label>
        <input type="text" id="node-config-input-port">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType("dashDB",{
        category: "config",
        color: "rgb(114, 199, 231)",
        defaults: {
            hostname: {value:"", required:true},
            db: {value:""},
            port: {value:"50000"},
            name: {value:""}
        },
        credentials: {
            username: {type:"text"},
            password: {type:"password"}
        },
        label: function() {
            return this.name || this.host;
        }
    });
</script>

<script type="text/x-red" data-template-name="dashDB out">

    <div class="form-row">
        <label for="node-input-service"><i class="fa fa-folder-close"></i> Service</label>
        <select id="node-input-service" style="width:68%;">
            <!-- <option value="" disabled></option> -->
            <option value="_ext_"> External dashDB or DB2 instance</option>
        </select>
    </div>

    <div class="form-row hide" id="node-input-external-details">
        <label for="node-input-dashDB"><i class="fa fa-bookmark"></i> Server</label>
        <input type="text" id="node-input-dashDB">
    </div>

    <div class="form-row">
        <label for="node-input-table"><i class="fa fa-briefcase"></i> Table</label>
        <input type="text" id="node-input-table" placeholder="table">
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="name">
    </div>

</script>

<script type="text/javascript">
    RED.nodes.registerType("dashDB out", {
        category: "storage-output",
        color: "rgb(153, 204, 153)",
        defaults: {
            dashDB: { type:"dashDB", validate:validateServer },
            service: { value: "", required: true },
            table: { value: "", required: true },
            name: { value: "" }
        },
        inputs: 1,
        outputs: 0,
        icon: "dashDB.png",
        align: "right",
        label: label,
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: oneditprepare
    });

    function oneditprepare() {
        var node = this;

        var serviceSelect  = $('#node-input-service');

        $.getJSON('dashDB/vcap/',function(data) {
            var last = serviceSelect.children().last();
            var opts = [];

            for (var i=0; i < data.length; i++) {
                var selected = node.service == data[i].name;
                opts.push(
                    '<option value="' + data[i].name + '"' + (selected ? " selected":"") + '>' +
                        data[i].name +
                    '</option>'
                );
            }

            if (opts.length == 0) {
                node.service = "_ext_";
                serviceSelect.find("option").filter(function() {
                    return $(this).val() == node.service;
                }).attr('selected', true);
            } else {
                last.before(opts.join(""));
            }
            serviceSelect.change();
        });

        serviceSelect.change(function() {
            var service = serviceSelect.val();
            if (service == "_ext_") {
                $("#node-input-external-details").show();
            } else {
                $("#node-input-external-details").hide();
            }
        });


    }

    function label() {
        return this.name || this.table || "dashDB";
    }

    function validateServer(v) {
       return this.service != "_ext_" || v != "_ADD_";
    }

</script>



<script type="text/x-red" data-template-name="dashDB in">
   <div class="form-row">
       <label for="node-input-service"><i class="fa fa-folder-close"></i> Service</label>
       <select id="node-input-service" style="width:68%;">
           <!-- <option value="" disabled></option> -->
           <option value="_ext_"> External dashDB or DB2 instance</option>
       </select>
   </div>

   <div class="form-row hide" id="node-input-external-details">
       <label for="node-input-dashDB"><i class="fa fa-bookmark"></i> Server</label>
       <input type="text" id="node-input-dashDB">
   </div>

    <div class="form-row">
        <label for="node-input-query"><i class="fa fa-briefcase"></i> Query</label>
        <textarea style="width:70%; height:75px" id="node-input-query">Type your SQL query here</textarea>
    </div>

    <div class="form-row">
        <label for="node-input-params"><i class="fa fa-briefcase"></i> Parameter Markers (optional)</label>
        <input type="text" id="node-input-params" placeholder="params">
    </div>

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="name">
    </div>

</script>

<script type="text/javascript">
    RED.nodes.registerType("dashDB in", {
        category: "storage-input",
        color: "rgb(153, 204, 153)",
        defaults: {
            dashDB: { type:"dashDB", validate:validateServer },
            service: { value: "", required: true },
            query: { value: "", required: false },
            params: { value: "", required: false },
            name: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "dashDB.png",
        label: label,
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: oneditprepare
    });

    function oneditprepare() {
        var node = this;

        var serviceSelect  = $('#node-input-service');

        $.getJSON('dashDB/vcap/',function(data) {
            var last = serviceSelect.children().last();
            var opts = [];

            for (var i=0; i < data.length; i++) {
                var selected = node.service == data[i].name;
                opts.push(
                    '<option value="' + data[i].name + '"' + (selected ? " selected":"") + '>' +
                        data[i].name +
                    '</option>'
                );
            }

            if (opts.length == 0) {
                node.service = "_ext_";
                serviceSelect.find("option").filter(function() {
                    return $(this).val() == node.service;
                }).attr('selected', true);
            } else {
                last.before(opts.join(""));
            }
            serviceSelect.change();
        });

        serviceSelect.change(function() {
            var service = serviceSelect.val();
            if (service == "_ext_") {
                $("#node-input-external-details").show();
            } else {
                $("#node-input-external-details").hide();
            }
        });

    }


    function label() {
        return this.name || "dashDB";
    }

    function validateServer(v) {
       return this.service != "_ext_" || v != "_ADD_";
    }

</script>


<script type="text/x-red" data-help-name="dashDB out">
   <p>
       A simple dashDB output node. Stores elements from the <b>msg.payload</b>
       into your dashDB service.  The msg.payload should include a value for
       each column in your table.  If you put a 'TIMESTAMP' string as one of the
       values, the node will replace it with the current timestamp in DB2 format.
   </p>
   <p>
       So for example, if you have a table with columns (TS, SCREENNAME, TWEET, SENTIMENT, LOCATION),
       then you might create a function node that flows into your sqldb output node
       with code that maps each of those columns to other values in the msg object, like this:
   </p>
       msg.payload =<br>
       {<br>
&nbsp;&nbsp;&nbsp;TS : 'TIMESTAMP',<br>
&nbsp;&nbsp;&nbsp;SCREENNAME : msg.tweet.user.screen_name,<br>
&nbsp;&nbsp;&nbsp;TWEET : msg.payload,<br>
&nbsp;&nbsp;&nbsp;SENTIMENT : msg.sentiment.score,<br>
&nbsp;&nbsp;&nbsp;LOCATION : msg.location<br>
       }<br>
       return msg;<br><br>
   <p>
       <b>Service</b> should point to your dashDB service.
   </p>
   <p>
       <b>Table</b> should point to the table you wish to insert the values into.
       This table needs to exist already in the database and needs to contain the
       same columns and datatypes that you are inserting through this node.
       The data needs to be in the format accepted by DB2 and within the appropriate
       ranges/parameters for that datatype.
   </p>
   <p>
      <b>Name:</b> Optionally give your node a name, otherwise the default will be the table name.
   </p>

</script><script type="text/x-red" data-help-name="dashDB in">
   <p>
       A simple dashDB node for executing queries. It executes a query on your dashDB service database
       and passes along the result set in the <b>msg</b> object, as msg.payload.  If there is an
       error during execution of the query, the msg.payload will be null and the error will be in
       msg.error.
   </p>
   <p>
       <b>Service</b> should point to your dashDB service.
   </p>
   <p>
       <b>Query</b> is the query you wish to execute on your dashDB service database.  If it is empty,
       it will look for the query in the msg.payload.
   </p>
   <p>
       <b>Parameter Markers</b> is a comma delimited set of json paths.  These will replace any question
       marks that you place in your query, in the order that they appear.
   </p>
   <p>
      <b>Name:</b> Optionally give your node a name, otherwise the default will be the table name.
   </p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_base] --- -->
<style>
    .nr-db-sb {
        position: absolute;
        top: 1px;
        bottom: 2px;
        left: 1px;
        right: 1px;
        overflow-y: scroll;
        padding: 10px;
    }
    .nr-db-sb .form-row label {
        display: block;
        width: auto;
    }
    .nr-db-sb .form-row input,
    .nr-db-sb .form-row select {
        width: calc(100% - 100px);
        margin-bottom:0;
    }
    .nr-db-sb .red-ui-editableList-container {
        padding: 0;
        min-height: 250px;
        height: auto;
    }
    .nr-db-sb-tab-list {
        min-height: 250px;
        height: auto;
    }
    .nr-db-sb-tab-list li {
        padding: 0;
    }
    .nr-db-sb-tab-list-item {
        border-radius: 4px;
        color: #333;
    }
    .nr-db-sb-list-header {
        cursor: pointer;
        position:relative;
        color: #666;
        padding:3px;
        white-space: nowrap;
    }
    .nr-db-sb-list-header:hover {
        color: #333;
    }
    .nr-db-sb-tab-list-header {
        background: #f3f3f3;
        padding:5px;
    }
    .nr-db-sb-group-list-header:hover,
    .nr-db-sb-widget-list-header:hover {
        background: #f9f9f9;
    }
    .nr-db-sb-list-chevron {
        width: 15px;
        text-align: center;
        margin: 3px 5px 3px 5px;
    }
    .nr-db-sb-tab-list-item .red-ui-editableList-container {
        border-radius: 0;
        border: none;
        height: auto !important;
        min-height: unset;
    }
    .nr-db-sb-list-handle {
        vertical-align: top;
        opacity: 0;
        cursor: move;
    }
    .nr-db-sb-list-header:hover>.nr-db-sb-list-handle,
    .nr-db-sb-list-header:hover>.nr-db-sb-list-header-button-group {
        opacity: 1;
    }
    .nr-db-sb-list-header-button-group {
        opacity: 0;
    }
    .nr-db-sb-list-handle  {
        color: #bbb;
        padding:5px;
    }
    .nr-db-sb-tab-list-header>.nr-db-sb-list-chevron  {
        margin-left: 0px;
        transition: transform 0.2s ease-in-out;
    }
    .nr-db-sb-group-list-header>.nr-db-sb-list-chevron {
        margin-left: 20px;
        transition: transform 0.2s ease-in-out;
    }
    .nr-db-sb-group-list {
        min-height: 10px;
    }
    .nr-db-sb-group-list li {
        border-bottom-color: #eee;
    }
    .nr-db-sb-group-list>li.ui-sortable-helper {
        border-top: 1px solid #eee;
    }
    .nr-db-sb-group-list>li:last-child {
        border-bottom: none;
    }
    .nr-db-sb-widget-list>li {
        border: none !important;
    }
    .nr-db-sb-group-list>li>.red-ui-editableList-item-handle {
        left: 10px;
    }
    .nr-db-sb-list-button-group {
        position: absolute;
        right: 3px;
        top: 0px;
        z-index: 2;
    }
    .nr-db-sb-list-header-button-group {
        position: absolute;
        right: 3px;
        top: 4px;
    }
    .nr-db-sb-list-header-button {
        margin-left: 5px;
    }
    .nr-db-sb li.ui-sortable-helper {
        opacity: 0.9;
    }
    .nr-db-sb-widget-icon {
        margin-left: 56px;
    }
    .nr-db-sb-icon {
        margin-right: 10px;
    }
    .nr-db-sb-link {
        display: inline-block;
        padding-left: 20px;
    }
    .nr-db-sb-link-name-container .fa-external-link {
      margin-right: 10px;
    }
    .nr-db-sb-link-url {
        font-size: 0.8em;
        color: #999;
    }
    span.nr-db-color-pick-container {
        max-width: 50px;
        border-radius: 3px;
        margin-left: 15px;
    }
    input.nr-db-field-themeColor {
        width: 60px !important;
        padding: 0px;
        height: 20px;
        border: none;
        box-shadow: none;
        position: absolute;
        right: 36px;
        border-radius: 3px !important;
        border: solid 1px #ccc;
        -webkit-appearance: none;
        font-size: smaller;
        text-align: center;
    }
    input.nr-db-field-themeColor::-webkit-color-swatch {
        border: none;
    }
    .red-ui-tabs {
        margin-bottom: 15px;
    }
    #dashboard-tabs-list li a:hover {
        cursor: pointer;
    }
    #dash-link-button {
        background: none;
        border: none;
        margin-top: 3px;
        display: inline-block;
        margin: 3px 0px 0px 3px;
        height: 32px;
        line-height: 29px;
        max-width: 200px;
        overflow: hidden;
        white-space: nowrap;
        position: relative;
        padding: 0px 7px 0px 7px;
    }
    /*#dash-link-button:hover {
        background-color: #eee;
    }*/
    ul.red-ui-dashboard-theme-styles {
        list-style: none;
    }
    ul.red-ui-dashboard-theme-styles li {
        margin-bottom: 10px;
    }
    .nr-db-resetIcon {
        margin: 3px 6px 0px 6px;
        float: right;
        color: grey;
        opacity: 0.8;
        display: block;
    }
    .nr-db-resetIcon:hover {
        cursor: pointer;
    }
    #nr-db-field-font {
        margin-left: 2em;
        width: calc(100% - 81px);
    }
    .nr-db-theme-label {
        font-weight: bold;
    }
    #custom-theme-library-container .btn-group {
        margin-bottom: 10px;
    }
</style>

<script type="text/javascript">
(function($) {
    var editSaveEventHandler;
    var nodesAddEventHandler;
    var nodesRemoveEventHandler;
    var uip = 'ui';
    var attemptedVendorLoad = false;
    var loadTinyColor = function(path) {
        $.ajax({ url: path,
            success: function (data) {
                var jsScript = document.createElement("script");
                jsScript.type = "application/javascript";
                jsScript.src = path;
                document.body.appendChild(jsScript);
                //console.log('Tiny Color Loaded:',path);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (xhr.status === 404 && !attemptedVendorLoad) {
                    loadTinyColor('/'+uip+'/vendor/tinycolor2/dist/tinycolor-min.js');
                    attemptedVendorLoad = true;
                }
            }
        });
    }

    // convert to i18 text
    function c_(x) {
        return RED._("node-red-dashboard/ui_base:ui_base."+x);
    }

    // Try to load dist version first
    // then if fails, load non dist version
    loadTinyColor('ui_base/js/tinycolor-min.js');
    //loadTinyColor('ui_base/tinycolor2/dist/tinycolor-min.js');

    RED.nodes.registerType('ui_base',{
            category: 'config',
            defaults: {
                name: {},
                theme: {},
                site: {}
            },
            hasUsers: false,
            paletteLabel: 'Dashboard',
            label: function() { return this.name || 'Node-RED Dashboard'; },
            labelStyle: function() { return this.name?"node_label_italic":""; },
            onpaletteremove: function() {
                RED.sidebar.removeTab("dashboard");
                RED.events.off("editor:save",editSaveEventHandler);
                RED.events.off("nodes:add",nodesAddEventHandler);
                RED.events.off("nodes:remove",nodesRemoveEventHandler);
            },
            onpaletteadd: function() {
                var globalDashboardNode = null;
                var editor;
                var baseStyles = ['base-color'];
                var configurableStyles = ['page-titlebar-backgroundColor', 'page-backgroundColor', 'page-sidebar-backgroundColor',
                'group-textColor', 'group-borderColor', 'group-backgroundColor',
                'widget-textColor', 'widget-backgroundColor','widget-borderColor'];
                var baseFontName = "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif";
                // tiny colour implementation
                var colours = {
                    leastReadable: function(base, colours) {
                        var least = tinycolor.readability(base, colours[0]);
                        var leastColor = colours[0];
                        for (var i=1; i<colours.length; i++) {
                            var readability = tinycolor.readability(base, colours[i]);
                            if (readability < least) {
                                least = readability;
                                leastColor = colours[i];
                            }
                        }
                        return leastColor;
                    },
                    whiteGreyMostReadable: function (base) {
                        var rgb = tinycolor(base).toRgb();
                        var level = ((rgb.r*299) + (rgb.g*587) + (rgb.b*114))/1000;
                        var readable = (level >= 128) ? '#111111' : '#eeeeee';
                        return readable;
                    },
                    whiteBlackLeastReadable: function(base) {
                        return this.leastReadable(base, ["#000000", "#ffffff"]);
                    },
                    calculate_page_backgroundColor: function(base) {
                        var pageBackground = "#fafafa";
                        var theme = "light";
                        if (globalDashboardNode && globalDashboardNode.hasOwnProperty("theme") && globalDashboardNode.theme.hasOwnProperty("name")) {
                            theme = globalDashboardNode.theme.name.split('-')[1];
                        }
                        if (theme === "dark") {
                            pageBackground = "#111111";
                        }
                        else if (theme === "custom") {
                            var whiteOrBlack = this.whiteBlackLeastReadable(base);
                            if (whiteOrBlack === "#000000") { pageBackground = "#111111"; }
                        }
                        return pageBackground;
                    },
                    calculate_page_sidebar_backgroundColor: function(base) {
                        return this.whiteBlackLeastReadable(base);
                    },
                    calculate_page_titlebar_backgroundColor: function(base) {
                        return base;
                    },
                    calculate_group_textColor: function(base) {
                        var groupTextColour = tinycolor(base).lighten(15).toHexString();
                        //if (this.whiteBlackLeastReadable(base) === "#ffffff") { groupTextColour = "#000000"; }
                        return groupTextColour;
                    },
                    calculate_group_backgroundColor: function(base) {
                        var groupBackground = "#ffffff";
                        var theme = "light";
                        if (globalDashboardNode && globalDashboardNode.hasOwnProperty("theme") && globalDashboardNode.theme.hasOwnProperty("name")) {
                            theme = globalDashboardNode.theme.name.split('-')[1];
                        }
                        if (theme === "dark") {
                            groupBackground = "#333333";
                        }
                        else if (theme === "custom") {
                            var whiteOrBlack = this.whiteBlackLeastReadable(base);
                            if (whiteOrBlack === "#000000") { groupBackground = "#333333"; }
                        }
                        return groupBackground;
                    },
                    calculate_group_borderColor: function(base) {
                        var groupBackground = this.calculate_group_backgroundColor(base);
                        return this.leastReadable(groupBackground, ["#ffffff", "#555555"]);
                    },
                    calculate_widget_textColor: function(base) {
                        //most readable against group background
                        var groupBackground = this.calculate_group_backgroundColor(base);
                        return tinycolor.mostReadable(groupBackground, ["#111111", "#eeeeee"]).toHexString();
                    },
                    calculate_widget_backgroundColor: function(base) {
                        //return tinycolor(base).darken(5).toHexString()
                        return tinycolor(base).toHexString();
                    },
                    calculate_widget_borderColor: function(base) {
                        var widgetBorder = "#ffffff";
                        var theme = "light";
                        if (globalDashboardNode && globalDashboardNode.hasOwnProperty("theme") && globalDashboardNode.theme.hasOwnProperty("name")) {
                            theme = globalDashboardNode.theme.name.split('-')[1];
                        }
                        if (theme === "dark") {
                            widgetBorder = "#333333";
                        }
                        else if (theme === "custom") {
                            var whiteOrBlack = this.whiteBlackLeastReadable(base);
                            if (whiteOrBlack === "#000000") { widgetBorder = "#333333"; }
                        }
                        return widgetBorder;
                    },
                    calculate_base_font: function(base) {
                        return baseFontName;
                    }
                }
                var sizes = {
                    sx: 48, // width of <1> grid square
                    sy: 48, // height of <1> grid square
                    gx: 6, // gap between groups
                    gy: 6, // gap between groups
                    cx: 6, // gap between components
                    cy: 6, // gap between components
                    px: 0, // padding of group's cards
                    py: 0  // padding of group's cards
                };

                function ensureDashboardNode(createMissing) {
                    if (globalDashboardNode !== null) {
                        // Check if it has been deleted beneath us
                        var n = RED.nodes.node(globalDashboardNode.id);
                        if (n === null) { globalDashboardNode = null; }
                    }

                    // Find the old dashboard node
                    if (globalDashboardNode === null) {
                        var bases = [];
                        RED.nodes.eachConfig(function(n) {
                            if (n.type === 'ui_base') { bases.push(n); }
                        });

                        // make sure we only have one ui_base node
                        // at the moment this will just use our existing one - deleting any new base node and theme
                        // at some point we may want to make this an option to select one or the other.
                        while (bases.length > 1) {
                            var n = bases.pop();
                            RED.nodes.remove(n.id);
                            RED.nodes.dirty(true);
                        }

                        if (bases.length === 1) { globalDashboardNode = bases[0]; }

                        // If there is no dashboard node, ensure we create it after
                        // initialising
                        var noDashboardNode = (globalDashboardNode === null);

                        // set up theme state
                        var themeState = {};
                        var baseColor = "#0094CE"
                        for (var i=0; i<baseStyles.length; i++) {
                            themeState[baseStyles[i]] = { default:baseColor, value:baseColor, edited:false };
                        }
                        for (var j = 0; j < configurableStyles.length; j++) {
                            var underscore = configurableStyles[j].split("-").join("_");
                            var colour = colours['calculate_'+underscore](baseColor);
                            themeState[configurableStyles[j]] = {value:colour, edited:false};
                        }
                        themeState["base-font"] = {value:baseFontName};

                        var missingFields = (!globalDashboardNode || !globalDashboardNode.theme || !globalDashboardNode.site || !globalDashboardNode.site.sizes );

                        if (missingFields && createMissing) {
                            var lightTheme = {
                                default: baseColor,
                                baseColor: baseColor,
                                baseFont: baseFontName,
                                edited: false
                            }
                            var darkTheme = {
                                default: "#097479",
                                baseColor: "#097479",
                                baseFont: baseFontName,
                                edited: false
                            }
                            var customTheme = {
                                name: 'Untitled Theme 1',
                                default: "#4B7930",
                                baseColor: "#4B7930",
                                baseFont: baseFontName
                            }
                            var oldThemeName;
                            if (globalDashboardNode && typeof(globalDashboardNode.theme === 'string')) { oldThemeName = globalDashboardNode.theme; }

                            var theme = {
                                name: oldThemeName || "theme-light",
                                lightTheme: lightTheme,
                                darkTheme: darkTheme,
                                customTheme: customTheme,
                                themeState: themeState
                            }

                            var site_name = c_("site.title");
                            var site_date_format = c_("site.date-format");
                            var site = { name:site_name, hideToolbar:"false", allowSwipe:"false", allowTempTheme:"true", dateFormat:site_date_format, sizes:sizes };
                            if (globalDashboardNode !== null) {
                                if (typeof globalDashboardNode.site !== "undefined") {
                                    site = {
                                        name: globalDashboardNode.site.name || globalDashboardNode.name,
                                        hideToolbar: globalDashboardNode.site.hideToolbar,
                                        allowSwipe: globalDashboardNode.site.allowSwipe,
                                        allowTempTheme: globalDashboardNode.site.allowTempTheme,
                                        dateFormat: globalDashboardNode.site.dateFormat,
                                        sizes: globalDashboardNode.site.sizes
                                    }
                                }
                            }

                            if (noDashboardNode) {
                                globalDashboardNode = {
                                    id: RED.nodes.id(),
                                    _def: RED.nodes.getType("ui_base"),
                                    type: "ui_base",
                                    site: site,
                                    theme: theme,
                                    users: []
                                }
                                RED.nodes.add(globalDashboardNode);
                            }
                            else {
                                globalDashboardNode["_def"] = RED.nodes.getType("ui_base");
                                globalDashboardNode.site = site;
                                globalDashboardNode.theme = theme;
                                delete globalDashboardNode.name;
                            }
                            $("#nr-db-field-font").val(baseFontName);
                            RED.nodes.dirty(true);
                        }
                    }
                }

                var content = $("<div>").css({"position":"relative","height":"100%"});
                var mainContent = $("<div>",{class:"nr-db-sb"}).appendTo(content);
                var form = $('<form class="dialog-form">').appendTo(mainContent);

                // Dashboard Tabs markup
                var divTab = $('<div class="red-ui-tabs">').appendTo(form);
                var ulDashboardTabs = $('<ul id="dashboard-tabs-list"></ul>').appendTo(divTab);
                var layout_label = c_("label.layout");
                var theme_label = c_("label.theme");
                var site_label = c_("label.site");
                var liLayoutTab = $('<li class="red-ui-tab" style="width:70px;"><a class="red-ui-tab-label" title="Layout"><span>'+layout_label+'</span></a></li>').appendTo(ulDashboardTabs);
                var liThemeTab = $('<li class="red-ui-tab" style="width:70px;"><a class="red-ui-tab-label" title="Theme" style="width:80px;"><span>'+theme_label+'</span></a></li>').appendTo(ulDashboardTabs);
                var liSiteTab = $('<li class="red-ui-tab" style="width:70px;"><a class="red-ui-tab-label" title="Site" style="width:60px;"><span>'+site_label+'</span></a></li>').appendTo(ulDashboardTabs);

                // Link out to dashboard
                $.getJSON('uisettings',function(data) {
                    if (data.hasOwnProperty("path")) { uip = data.path; }
                    var lnk = document.location.host+RED.settings.httpNodeRoot+"/"+uip;
                    var re = new RegExp('\/{1,}','g');
                    lnk = lnk.replace(re,'/');
                    if (!RED.hasOwnProperty("actions")) {
                        RED.keyboard.add("*",/* d */ 68,{ctrl:true, shift:true},function() { window.open(document.location.protocol+"//"+lnk) });
                    }
                    else {
                        RED.keyboard.add("*","ctrl-shift-d","dashboard:show-dashboard");
                        RED.actions.add("dashboard:show-dashboard",function() { window.open(document.location.protocol+"//"+lnk) });
                    }
                    $('<span id="dash-link-button" class="editor-button" style="position:absolute; right:0px;"><i class="fa fa-external-link"></i></span>')
                    .click(function(evt) {
                        window.open(document.location.protocol+"//"+lnk);
                        evt.preventDefault();
                    })
                    .appendTo(ulDashboardTabs);
                });

                // Dashboard Tab containers
                var layoutTab = $('<div id="dashboard-layout" style="height:calc(100% - 48px)">').appendTo(form);
                var themeTab = $('<div id="dashboard-theme" style="display:none;">').appendTo(form);
                var siteTab = $('<div id="dashboard-site" style="display:none;">').appendTo(form);

                ulDashboardTabs.children().first().addClass("active");

                // Tab logic
                var onTabClick = function() {
                    //Toggle tabs
                    ulDashboardTabs.children().removeClass("active");
                    ulDashboardTabs.children().css({"transition": "width 100ms"});
                    $(this).parent().addClass("active");

                    var selectedTab = $(this)[0].title;
                    if (selectedTab === 'Layout') {
                        themeTab.hide();
                        siteTab.hide();
                        layoutTab.show();
                    }
                    else if (selectedTab === 'Theme') {
                        layoutTab.hide();
                        siteTab.hide();
                        themeTab.show();
                        if ($("#nr-db-field-theme option:selected").val() === 'theme-custom') { themeSettingsContainer.show(); }
                        else { themeSettingsContainer.hide(); }
                    }
                    else {
                        layoutTab.hide();
                        themeTab.hide();
                        siteTab.show();
                    }
                }

                ulDashboardTabs.find("li.red-ui-tab a").on("click",onTabClick)

                // Site Tab
                var divTitle = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<div>').html('<b>'+c_("label.title")+'</b>').appendTo(divTitle);
                $('<input type="text" id="nr-db-field-title">').val(site_name).css("width","100%")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.site.name !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.site.name = $(this).val();
                        RED.nodes.dirty(true);
                    }
                })
                .appendTo(divTitle);

                var divHideToolbar = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<div>').html('<b>'+c_("label.options")+'</b>').appendTo(divHideToolbar);
                $('<select id="nr-db-field-hideToolbar">')
                .css("width","100%")
                .append($('<option>', { value:"false", text:c_("title-bar.show"), selected:true }))
                .append($('<option>', { value:"true", text:c_("title-bar.hide") }))
                .val("false")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.site.hideToolbar !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.site.hideToolbar = $(this).val();
                        RED.nodes.dirty(true);
                    }
                })
                .appendTo(divHideToolbar);

                var divAllowSwipe = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<select id="nr-db-field-allowSwipe">')
                .css("width","100%")
                .append($('<option>', { value:"false", text:c_("swipe.no-swipe"), selected:true }))
                .append($('<option>', { value:"true", text:c_("swipe.allow-swipe") }))
                .val("false")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.site.allowSwipe !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.site.allowSwipe = $(this).val();
                        RED.nodes.dirty(true);
                    }
                })
                .appendTo(divAllowSwipe);

                var divAllowTempTheme = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<select id="nr-db-field-allowTempTheme">')
                .css("width","100%")
                .append($('<option>', { value:"true", text:c_("temp.allow-theme"), selected:true }))
                .append($('<option>', { value:"false", text:c_("temp.no-theme") }))
                .val("true")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.site.allowTempTheme !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.site.allowTempTheme = $(this).val();
                        RED.nodes.dirty(true);
                    }
                })
                .appendTo(divAllowTempTheme);

                var site_name = c_("site.title");
                var site_date_format = c_("site.date-format");
                var divDateFormat = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<div">').html('<b>'+c_("label.date-format")+'</b>')
                .css("width","80%")
                .css("display","inline-block")
                .appendTo(divDateFormat);
                $('<div>').html("<a href='https://momentjs.com/docs/#/displaying/format/' target='_new'><i class='fa fa-info-circle' style='color:grey;'></i></a>")
                .css("display","inline-block")
                .css("margin-right","6px")
                .css("float","right")
                .appendTo(divDateFormat);
                $('<input type="text" id="nr-db-field-dateFormat">').val(site_date_format).css("width","100%")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.site.dateFormat !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.site.dateFormat = $(this).val();
                        RED.nodes.dirty(true);
                    }
                })
                .appendTo(divDateFormat);

                var divSetSizes = $('<div>',{class:"form-row"}).appendTo(siteTab);
                $('<span style="width:45%; display:inline-block">').html('<b>'+c_("label.sizes")+'</b>').appendTo(divSetSizes);
                $('<span style="width:25%; display:inline-block; font-size:smaller">').html(c_("label.horizontal")).appendTo(divSetSizes);
                $('<span style="width:20%; display:inline-block; font-size:smaller">').html(c_("label.vertical")).appendTo(divSetSizes);
                $('<i id="sizes-reset" class="fa fa-undo nr-db-resetIcon"></i>')
                .css({opacity:1.0})
                .click(function(e) {
                    $("#nr-db-field-sx").val(sizes.sx); globalDashboardNode.site.sizes.sx = sizes.sx;
                    $("#nr-db-field-sy").val(sizes.sy); globalDashboardNode.site.sizes.sy = sizes.sy;
                    $("#nr-db-field-px").val(sizes.px); globalDashboardNode.site.sizes.px = sizes.px;
                    $("#nr-db-field-py").val(sizes.py); globalDashboardNode.site.sizes.py = sizes.py;
                    $("#nr-db-field-gx").val(sizes.gx); globalDashboardNode.site.sizes.gx = sizes.gx;
                    $("#nr-db-field-gy").val(sizes.gy); globalDashboardNode.site.sizes.gy = sizes.gy;
                    $("#nr-db-field-cx").val(sizes.cx); globalDashboardNode.site.sizes.cx = sizes.cx;
                    $("#nr-db-field-cy").val(sizes.cy); globalDashboardNode.site.sizes.cy = sizes.cy;
                    RED.nodes.dirty(true);
                })
                .appendTo(divSetSizes);

                $('<br/><span style="width:45%; display:inline-block">').html(c_("label.widget-size")).appendTo(divSetSizes);
                $('<input type="number" name="sx" min="24" id="nr-db-field-sx">').val(48).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.sx=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);
                $('<span style="width:5%; display:inline-block">').text(' ').appendTo(divSetSizes);
                $('<input type="number" name="sy" min="24" id="nr-db-field-sy">').val(48).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.sy=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);

                $('<br/><span style="width:45%; display:inline-block">').html(c_("label.widget-spacing")).appendTo(divSetSizes);
                $('<input type="number" name="cx" min="0" id="nr-db-field-cx">').val(6).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.cx=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);
                $('<span style="width:5%; display:inline-block">').text(' ').appendTo(divSetSizes);
                $('<input type="number" name="cy" min="0" id="nr-db-field-cy">').val(6).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.cy=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);

                $('<br/><span style="width:45%; display:inline-block">').html(c_("label.group-padding")).appendTo(divSetSizes);
                $('<input type="number" name="px" min="0" id="nr-db-field-px">').val(0).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.px=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);
                $('<span style="width:5%; display:inline-block">').text(' ').appendTo(divSetSizes);
                $('<input type="number" name="py" min="0" id="nr-db-field-py">').val(0).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.py=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);

                $('<br/><span style="width:45%; display:inline-block">').html(c_("label.group-spacing")).appendTo(divSetSizes);
                $('<input type="number" name="gx" min="0" id="nr-db-field-gx">').val(6).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.gx=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);
                $('<span style="width:5%; display:inline-block">').text(' ').appendTo(divSetSizes);
                $('<input type="number" name="gy" min="0" id="nr-db-field-gy">').val(6).css("width","20%")
                .change(function() { ensureDashboardNode(true); globalDashboardNode.site.sizes.gy=Number($(this).val()); RED.nodes.dirty(true); } )
                .appendTo(divSetSizes);


                // Theme Tab
                // For all customisable styles, generate and apply the css
                var generateColours = function(base) {
                    var theme = globalDashboardNode.theme.name.split('-')[1];
                    if (!globalDashboardNode.theme.themeState.hasOwnProperty["base-font"]) {
                        if (globalDashboardNode.theme[theme+"Theme"].baseFont === "Helvetica Neue") {
                            globalDashboardNode.theme[theme+"Theme"].baseFont = baseFontName;
                        }
                        globalDashboardNode.theme.themeState["base-font"] = {value:globalDashboardNode.theme[theme+"Theme"].baseFont};
                        $("#nr-db-field-font").val(globalDashboardNode.theme[theme+"Theme"].baseFont);
                    }
                    for (var i=0; i<configurableStyles.length; i++) {
                        var styleID = configurableStyles[i];
                        var underscore = styleID.split("-").join("_");
                        if (!globalDashboardNode.theme.themeState.hasOwnProperty(styleID)) {
                            globalDashboardNode.theme.themeState[styleID] = {value:"#fff",edited:false};
                        }
                        if (!globalDashboardNode.theme.themeState[styleID].edited || globalDashboardNode.theme[theme+'Theme'].reset) {
                            var colour = colours['calculate_'+underscore](base);
                            globalDashboardNode.theme.themeState[styleID].value = colour;
                        }
                        setColourPickerColour(styleID, globalDashboardNode.theme.themeState[styleID].value, globalDashboardNode.theme.themeState[styleID].edited);
                    }
                    globalDashboardNode.theme[theme+'Theme'].reset = false;
                }

                var divThemeStyle = $('<div>',{class:"form-row"}).appendTo(themeTab);
                $('<label class="nr-db-theme-label">').html(c_("theme.style")).appendTo(divThemeStyle);
                var themeSelection = $('<select id="nr-db-field-theme">'+
                    '<option value="theme-light">'+c_("style.light")+'</option>'+
                    '<option value="theme-dark">'+c_("style.dark")+'</option>'+
                    '<option value="theme-custom">'+c_("style.custom")+'</option>'+
                    '</select>')
                .css("width","100%")
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.theme.name !== $(this).val()) {
                        ensureDashboardNode(true);
                        var theme = globalDashboardNode.theme.name.split('-')[1];
                        var baseColour = globalDashboardNode.theme[theme+'Theme'].baseColor;
                        var baseFont = globalDashboardNode.theme[theme+'Theme'].baseFont;
                        globalDashboardNode.theme.name = $(this).val();
                        theme = globalDashboardNode.theme.name.split('-')[1];
                        if (theme !== "custom") {
                            baseColour = globalDashboardNode.theme[theme+'Theme'].default;
                        }
                        else { baseColour = globalDashboardNode.theme[theme+'Theme'].baseColor; }
                        setColourPickerColour("base-color", baseColour);
                        globalDashboardNode.theme.themeState['base-color'].value = baseColour;
                        globalDashboardNode.theme.themeState['base-color'].default = baseColour;
                        globalDashboardNode.theme.themeState['base-font'] = {value:baseFont};
                        $("#nr-db-field-font").val(baseFont);
                        globalDashboardNode.theme[theme+'Theme'].reset = true;
                        //generate colours for all colour settings from base colour
                        generateColours(baseColour);
                        RED.nodes.dirty(true);
                    }
                    $('#base-color-reset').remove();
                    if ($(this).val() === 'theme-custom') {
                        $("#custom-theme-library-container").show(); //TODO undo this at some point
                        $("#custom-theme-settings").show();
                        //addResetButton('base-color', baseSettingsUl.children());
                    }
                    else {
                        $("#custom-theme-library-container").hide();
                        $("#custom-theme-settings").hide();
                        addLightAndDarkResetButton('base-color', baseSettingsUl.children().first());
                    }
                })
                .appendTo(divThemeStyle);

                var customThemeLibraryContainer = $('<div id="custom-theme-library-container">').appendTo(themeTab);
                $('<label class="nr-db-theme-label">').html(c_("theme.custom-profile")).appendTo(customThemeLibraryContainer);
                $('<input type="text" id="ui-sidebar-name" placeholder="profile name (not blank)">')
                .val(c_("theme.custom-profile-name"))
                .change(function() {
                    if (!globalDashboardNode || globalDashboardNode.theme.customTheme.name !== $(this).val()) {
                        ensureDashboardNode(true);
                        globalDashboardNode.theme.customTheme.name = $(this).val();
                        if (editor) {
                            editor.setValue(JSON.stringify({theme:globalDashboardNode.theme.themeState, site:globalDashboardNode.site}),1);
                            RED.nodes.dirty(true);
                        }
                    }
                })
                .keyup(function() {
                    if ($(this).val().length === 0) {
                        $("#custom-theme-library-container div").css("pointer-events","none");
                    }
                    else { $("#custom-theme-library-container div").css("pointer-events","inherit"); }
                })
                .appendTo(customThemeLibraryContainer);
                $('<input type="hidden" id="nr-db-field-format">').appendTo(customThemeLibraryContainer);
                $('<div style="display:none;" class="node-text-editor" id="nr-db-field-format-editor"></div>').appendTo(customThemeLibraryContainer);

                var baseThemeSettingsContainer = $('<div id="base-theme-settings">').appendTo(themeTab);

                var baseSettings = $('<div>',{class:"form-row"}).appendTo(baseThemeSettingsContainer);
                $('<label class="nr-db-theme-label">').html(c_("theme.base-settings")).appendTo(baseSettings);
                var baseSettingsUl = $('<ul id="base-settings-ul" class="red-ui-dashboard-theme-styles"></ul>').appendTo(baseSettings);

                var baseColourItem = $('<li class="red-ui-dashboard-theme-item"><span>'+c_("base.colour")+'</span></li>').appendTo(baseSettingsUl);
                var spanColorContainer = $('<span class="nr-db-color-pick-container"></span>').appendTo(baseColourItem);

                $('<input id="base-color" class="nr-db-field-themeColor" type="color" value="#ffffff"/>')
                .change(function() {
                    ensureDashboardNode(true);
                    var value = $(this).val();
                    var lightThemeMatch = globalDashboardNode.theme.lightTheme.baseColor === value;
                    var darkThemeMatch = globalDashboardNode.theme.darkTheme.baseColor === value;
                    var customThemeMatch = globalDashboardNode.theme.customTheme.baseColor === value;
                    if (!globalDashboardNode || !lightThemeMatch || !darkThemeMatch || !customThemeMatch) {
                        var theme = globalDashboardNode.theme.name.split('-')[1];
                        globalDashboardNode.theme[theme+'Theme'].baseColor = value;
                        if (globalDashboardNode.theme.name === 'theme-light' || globalDashboardNode.theme.name === 'theme-dark') {
                            //for light and dark themes, reset the colours
                            globalDashboardNode.theme[theme+'Theme'].reset = true;
                        }
                        generateColours(value);
                        editor.setValue(JSON.stringify({theme:globalDashboardNode.theme.themeState, site:globalDashboardNode.site}),1);
                        colourPickerChangeHandler($(this).attr('id'), value);
                    }
                })
                .appendTo(spanColorContainer);

                var baseFontItem = $('<li class="red-ui-dashboard-theme-item"><span>'+c_("base.font")+'</span></li>').appendTo(baseSettingsUl);
                var fontSelector = $('<select id="nr-db-field-font">'+
                    '<option value="'+baseFontName+'" style="font-family:'+baseFontName+'">'+c_("font.system")+'</option>'+
                    '<option value="Arial,Arial,Helvetica,sans-serif" style="font-family:Arial,Arial,Helvetica,sans-serif">Arial</option>'+
                    '<option value="Arial Black,Arial Black,Gadget,sans-serif" style="font-family:Arial Black,Arial Black,Gadget,sans-serif">Arial Black</option>'+
                    '<option value="Arial Narrow,Nimbus Sans L,sans-serif" style="font-family:Arial Narrow,Nimbus Sans L,sans-serif">Arial Narrow</option>'+
                    '<option value="Century Gothic,CenturyGothic,AppleGothic,sans-serif" style="font-family:Century Gothic,CenturyGothic,AppleGothic,sans-serif">Century Gothic</option>'+
                    '<option value="Copperplate,Copperplate Gothic Light,fantasy" style="font-family:Copperplate,Copperplate Gothic Light,fantasy;">Copperplate</option>'+
                    '<option value="Courier,monospace" style="font-family:Courier,monospace;">Courier</option>'+
                    '<option value="Georgia,Georgia,serif" style="font-family:Georgia,Georgia,serif">Georgia</option>'+
                    '<option value="Gill Sans,Geneva,sans-serif" style="font-family:Gill Sans,Geneva,sans-serif;">Gill Sans</option>'+
                    //'<option value="Helvetica Neue,Helvetica,sans-serif" style="font-family:Helvetica Neue,Helvetica,sans-serif">Helvetica Neue</option>'+
                    '<option value="Impact,Impact,Charcoal,sans-serif" style="font-family:Impact,Impact,Charcoal,sans-serif">Impact</option>'+
                    '<option value="Lucida Sans Typewriter,Lucida Console,Monaco,monospace" style="font-family:Lucida Console,Monaco,monospace">Lucida Console</option>'+
                    '<option value="Lucida Sans Unicode,Lucida Grande,sans-serif" style="font-family:Lucida Sans Unicode,Lucida Grande,sans-serif">Lucida Sans</option>'+
                    '<option value="Palatino Linotype,Palatino,Book Antiqua,serif" style="font-family:Palatino Linotype,Palatino,Book Antiqua,serif">Palatino Linotype</option>'+
                    '<option value="Tahoma,Geneva,sans-serif" style="font-family:Tahoma,Geneva,sans-serif">Tahoma</optionstyle="font-family:>'+
                    '<option value="Times New Roman,Times,serif" style="font-family:Times New Roman,Times,serif">Times New Roman</option>'+
                    '<option value="Trebuchet MS,Helvetica,sans-serif" style="font-family:Trebuchet MS,Helvetica,sans-serif">Trebuchet MS</option>'+
                    '<option value="Verdana,Verdana,Geneva,sans-serif" style="font-family:Verdana,Verdana,Geneva,sans-serif">Verdana</option>'+
                    '</select>')
                    .change(function() {
                        ensureDashboardNode(true);
                        var theme = globalDashboardNode.theme.name.split('-')[1];
                        globalDashboardNode.theme[theme+'Theme'].baseFont = $(this).val();
                        globalDashboardNode.theme.themeState['base-font'] = {value:$(this).val()};
                        RED.nodes.dirty(true);
                    })
                    .appendTo(baseFontItem);

                var themeSettingsContainer = $('<div id="custom-theme-settings">').appendTo(themeTab);

                // Markup
                // Page styles
                var divPageStyle = $('<div>',{class:"form-row"}).appendTo(themeSettingsContainer);
                $('<label class="nr-db-theme-label">').html(c_("theme.page-settings")).appendTo(divPageStyle);
                var pageStyles = $('<ul class="red-ui-dashboard-theme-styles"></ul>').appendTo(themeSettingsContainer);
                addCustomisableStyle('page-titlebar-backgroundColor', c_("theme.page.title"), pageStyles);
                addCustomisableStyle('page-backgroundColor', c_("theme.page.page"), pageStyles);
                addCustomisableStyle('page-sidebar-backgroundColor', c_("theme.page.side"), pageStyles);

                // Group styles
                var divGroupStyle = $('<div>',{class:"form-row"}).appendTo(themeSettingsContainer);
                $('<label class="nr-db-theme-label">').html(c_("theme.group-settings")).appendTo(divGroupStyle);
                var groupStyles = $('<ul class="red-ui-dashboard-theme-styles"></ul>').appendTo(themeSettingsContainer);
                addCustomisableStyle('group-textColor', c_("theme.group.text"), groupStyles);
                addCustomisableStyle('group-borderColor', c_("theme.group.border"), groupStyles);
                addCustomisableStyle('group-backgroundColor', c_("theme.group.background"), groupStyles);

                // Widget styles
                var divWidgetStyle = $('<div>',{class:"form-row"}).appendTo(themeSettingsContainer);
                $('<label class="nr-db-theme-label">').html(c_("theme.widget-settings")).appendTo(divWidgetStyle);
                var widgetStyles = $('<ul class="red-ui-dashboard-theme-styles"></ul>').appendTo(themeSettingsContainer);
                addCustomisableStyle('widget-textColor', c_("theme.widget.text"), widgetStyles);
                addCustomisableStyle('widget-backgroundColor', c_("theme.widget.colour"), widgetStyles);
                addCustomisableStyle('widget-borderColor', c_("theme.widget.background"), widgetStyles);

                function addCustomisableStyle(id, name, parentUl) {
                    var styleLi = $('<li class="red-ui-dashboard-theme-item"><span>'+name+'</span></li>').appendTo(parentUl);
                    var spanColorContainer = $('<span class="nr-db-color-pick-container"></span>').appendTo(styleLi);
                    $('<input id="'+id+'" class="nr-db-field-themeColor" type="color" value="#ffffff"/>')
                    .change(function() {
                        colourPickerChangeHandler($(this).attr('id'), $(this).val());
                    })
                    .appendTo(spanColorContainer);
                    addResetButton(id, styleLi);
                }

                function colourPickerChangeHandler(id, value) {
                    $("#"+id).css("background-color", value);
                    $("#"+id+"-reset").css({opacity:1});
                    globalDashboardNode.theme.themeState[id].edited = true;
                    globalDashboardNode.theme.themeState[id].value = value;
                    if (editor) {
                        editor.setValue(JSON.stringify({theme:globalDashboardNode.theme.themeState, site:globalDashboardNode.site}),1);
                    }
                    RED.nodes.dirty(true);
                }

                function addResetButton(id, parent) {
                    var resetToDefault = $('<i id="'+id+'-reset" class="fa fa-undo nr-db-resetIcon"></i>')
                    .css({opacity:0.2})
                    .click(function(e) { resetClick(e); })
                    .appendTo(parent);
                }

                function addLightAndDarkResetButton(id, parent) {
                    if ($("#" + id + "-reset").length === 0) {
                        var resetToDefault = $('<i id="'+id+'-reset" class="fa fa-undo nr-db-resetIcon"></i>')
                        .css({opacity:1})
                        .click(function(e) { lightAndDarkResetClick(e); })
                        .appendTo(parent);
                        globalDashboardNode.theme[globalDashboardNode.theme.name.split('-')[1] + 'Theme'].edited = true;
                    }
                }

                function lightAndDarkResetClick(e) {
                    var elementID = e.target.id.split('-reset')[0];
                    var key = globalDashboardNode.theme.name.split('-')[1] + 'Theme';
                    //sanity check - light and dark only allow base-color-reset
                    if (elementID === 'base-color') { // && globalDashboardNode.theme[key].edited) {
                        var defaultColor = globalDashboardNode.theme[key].default;
                        globalDashboardNode.theme[key].reset = true;
                        generateColours(defaultColor);
                        setColourPickerColour(elementID, defaultColor);
                        $("#"+elementID+"-reset").css({opacity:0.2});
                        globalDashboardNode.theme.themeState[elementID].value = defaultColor;
                        globalDashboardNode.theme[key].baseColor = defaultColor;
                        globalDashboardNode.theme[key].edited = false;
                        RED.nodes.dirty(true);
                    }
                }

                function resetClick(e) {
                    //take off -reset
                    var elementID = e.target.id.split('-reset')[0];
                    if (globalDashboardNode.theme.themeState[elementID].edited) {
                        var defaultColor = globalDashboardNode.theme.themeState['base-color'].value;
                        var colour;
                        //set colour
                        if (elementID === 'base-color') {
                            colour = defaultColor;
                            generateColours(colour);
                        }
                        else {
                            var underscore = elementID.split('-').join('_');
                            colour = colours['calculate_'+underscore](defaultColor);
                        }
                        setColourPickerColour(elementID, colour);
                        $("#"+elementID+"-reset").css({opacity:0.2});
                        globalDashboardNode.theme.themeState[elementID].edited = false;
                        globalDashboardNode.theme.themeState[elementID].value = colour;
                        RED.nodes.dirty(true);
                    }
                }

                function setColourPickerColour(id, val, ed) {
                    $("#"+id).val(val);
                    $("#"+id).css("background-color", val);
                    //call mostReadableGreyWhite to set text colour
                    var textColor = colours.whiteGreyMostReadable(val);
                    $("#"+id).css("color", textColor);
                    if (ed === true) { $("#"+id+"-reset").css({opacity:1}); }
                    else { $("#"+id+"-reset").css({opacity:0.2}); }
                }

                //Layout Tab
                var divTabs = $('<div>',{class:"form-row",style:"position:relative"}).appendTo(layoutTab);
                $('<label>').html('<b>'+c_("layout.tab-and-link")+'</b>').appendTo(divTabs);

                var buttonGroup = $('<div>',{class:"nr-db-sb-list-button-group"}).appendTo(divTabs);

                //Toggle expand buttons
                $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-angle-double-up"></i></a>')
                .click(function(evt) {
                    tabContainer.find(".nr-db-sb-group-list-container").slideUp().addClass('nr-db-sb-collapsed');
                    tabContainer.find(".nr-db-sb-tab-list-header>.nr-db-sb-list-chevron").css({"transform":"rotate(-90deg)"});
                    evt.preventDefault();
                })
                .appendTo(buttonGroup);
                $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-angle-double-down"></i></a>')
                .click(function(evt) {
                    tabContainer.find(".nr-db-sb-group-list-container").slideDown().removeClass('nr-db-sb-collapsed');
                    tabContainer.find(".nr-db-sb-tab-list-header>.nr-db-sb-list-chevron").css({"transform":""});
                    evt.preventDefault();
                })
                .appendTo(buttonGroup);

                //Add item button
                $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> '+c_("layout.tab")+'</a>')
                .click(function(evt) {
                    tabContainer.editableList('addItem',{type: 'ui_tab'});
                    evt.preventDefault();
                })
                .appendTo(buttonGroup);
                $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> '+c_("layout.link")+'</a>')
                .click(function(evt) {
                    tabContainer.editableList('addItem',{type: 'ui_link'});
                    evt.preventDefault();
                })
                .appendTo(buttonGroup);

                var tabLists = {};
                var groupLists = {};
                var linkNodes = {};

                // toggle slide tab group content
                var titleToggle = function (id,content,chevron) {
                    return function(evt) {
                        if (content.is(":visible")) {
                            content.slideUp();
                            chevron.css({"transform":"rotate(-90deg)"});
                            content.addClass('nr-db-sb-collapsed');
                            listStates[id] = false;
                        }
                        else {
                            content.slideDown();
                            chevron.css({"transform":""});
                            content.removeClass('nr-db-sb-collapsed');
                            listStates[id] = true;
                        }
                    };
                }

                var addTabOrLinkItem = function(container,i,item) {
                    // create node if needed
                    if (!item.node) {
                        var defaultItem = {
                            'ui_tab': {
                                _def: RED.nodes.getType('ui_tab'),
                                type: 'ui_tab',
                                users: [],
                                icon: 'dashboard',
                                name: 'Tab'
                            },
                            'ui_link': {
                                _def: RED.nodes.getType('ui_link'),
                                type: 'ui_link',
                                users: [],
                                icon: 'open_in_browser',
                                name: 'Link',
                                target: 'newtab'
                            }
                        }
                        item.node = defaultItem[item.type]
                        item.node.id = RED.nodes.id()
                        item.node.order = i+1
                        item.node.name += ' '+item.node.order
                        listElements[item.node.id] = container;
                        if (item.type === 'ui_tab') {
                            item.groups = [];
                        }
                        RED.nodes.add(item.node);
                        RED.nodes.dirty(true);
                    }
                    else if (item.type === undefined) {
                        item.type = item.node.type
                    }

                    listElements[item.node.id] = container;
                    if (RED.nodes.hasOwnProperty('updateConfigNodeUsers')) {
                        RED.nodes.updateConfigNodeUsers(item.node);
                    }

                    // title
                    var titleRow = $('<div>',{class:"nr-db-sb-list-header nr-db-sb-tab-list-header"}).appendTo(container);
                    switch (item.type) {
                        case 'ui_tab': {
                            container.addClass("nr-db-sb-tab-list-item");
                            $('<i class="nr-db-sb-list-handle nr-db-sb-tab-list-handle fa fa-bars"></i>').appendTo(titleRow);
                            var chevron = $('<i class="fa fa-angle-down nr-db-sb-list-chevron">',{style:"width:10px;"}).appendTo(titleRow);
                            $('<i class="nr-db-sb-icon nr-db-sb-tab-icon fa fa-file-o"></i>').appendTo(titleRow);
                            var title = $('<span class="nr-db-sb-title">').html(item.node.name||"").appendTo(titleRow);
                            break;
                        }
                        case 'ui_link': {
                            $('<i class="nr-db-sb-list-handle fa fa-bars"></i>').appendTo(titleRow);
                            var title = $('<div class="nr-db-sb-link">').appendTo(titleRow);
                            var nameContainer = $('<div class="nr-db-sb-link-name-container">').appendTo(title);
                            $('<i class="fa fa-external-link"></i>').appendTo(nameContainer);
                            $('<span class="nr-db-sb-link-name">').html(item.node.name||"untitled").appendTo(nameContainer);
                            $('<div class="nr-db-sb-link-url">').html(item.node.link||"http://").appendTo(title);
                            break;
                        }
                    }
                    // buttons
                    var buttonGroup = $('<div>',{class:"nr-db-sb-list-header-button-group"}).appendTo(titleRow);
                    if (item.type === 'ui_tab') {
                        var addGroupButton = $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-plus"></i> '+c_("layout.group")+'</a>').appendTo(buttonGroup);
                    }
                    var editButton = $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> '+c_("layout.edit")+'</a>').appendTo(buttonGroup);
                    editButton.on('click',function(evt) {
                        RED.editor.editConfig("", item.type, item.node.id);
                        evt.stopPropagation();
                        evt.preventDefault();
                    });

                    if (item.type === 'ui_tab') {
                        var content = $('<div>',{class:"nr-db-sb-group-list-container"}).appendTo(container);

                        // ui_tab group chevron
                        if (listStates.hasOwnProperty(item.node.id) && !listStates[item.node.id]) {
                            content.hide();
                            chevron.css({"transform":"rotate(-90deg)"});
                            content.addClass('nr-db-sb-collapsed');
                            listStates[item.node.id] = false;
                        }
                        else {
                            listStates[item.node.id] = true;
                        }
                        titleRow.click(titleToggle(item.node.id,content,chevron));

                        // ui_tab group list
                        var ol = $('<ol>',{class:"nr-db-sb-group-list"}).appendTo(content).editableList({
                            sortable:".nr-db-sb-group-list-header",
                            addButton: false,
                            height: 'auto',
                            connectWith: ".nr-db-sb-group-list",
                            addItem: function(container,i,group) {
                                if (!group.node) {
                                    group.node = {
                                        id: RED.nodes.id(),
                                        _def: RED.nodes.getType("ui_group"),
                                        type: "ui_group",
                                        users: [],
                                        tab: item.node.id,
                                        order: i+1,
                                        name: "Group "+(i+1),
                                        width: 6,
                                        disp: true
                                    };
                                    listElements[group.node.id] = container;
                                    RED.nodes.add(group.node);
                                    group.widgets = [];
                                    RED.nodes.dirty(true);
                                    if (RED.nodes.hasOwnProperty('updateConfigNodeUsers')) {
                                        RED.nodes.updateConfigNodeUsers(group.node);
                                    }
                                }
                                var groupNode = group.node;
                                elementParents[groupNode] = item.node.id;
                                var titleRow = $('<div>',{class:"nr-db-sb-list-header nr-db-sb-group-list-header"}).appendTo(container);
                                $('<i class="nr-db-sb-list-handle nr-db-sb-group-list-handle fa fa-bars"></i>').appendTo(titleRow);
                                var chevron = $('<i class="fa fa-angle-down nr-db-sb-list-chevron">',{style:"width:10px;"}).appendTo(titleRow);
                                $('<i class="nr-db-sb-icon nr-db-sb-group-icon fa fa-table"></i>').appendTo(titleRow);
                                var title = $('<span class="nr-db-sb-title">').html(groupNode.name||groupNode.id||"").appendTo(titleRow);
                                listElements[groupNode.id] = container;
                                var buttonGroup = $('<div>',{class:"nr-db-sb-list-header-button-group"}).appendTo(titleRow);
                                var editButton = $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> '+c_("layout.edit")+'</a>').appendTo(buttonGroup);
                                var content = $('<div>',{class:"nr-db-sb-widget-list-container"}).appendTo(container);
                                if (!listStates.hasOwnProperty(groupNode.id) || !listStates[groupNode.id]) {
                                    content.hide();
                                    chevron.css({"transform":"rotate(-90deg)"});
                                    content.addClass('nr-db-sb-collapsed');
                                    listStates[groupNode.id] = false;
                                }
                                else {
                                    listStates[groupNode.id] = true;
                                }

                                var ol = $('<ol>',{class:"nr-db-sb-widget-list"}).appendTo(content).editableList({
                                    sortable:".nr-db-sb-widget-list-header",
                                    addButton: false,
                                    height: 'auto',
                                    connectWith: ".nr-db-sb-widget-list",
                                    addItem: function(container,i,widgetNode) {
                                        elementParents[widgetNode.id] = groupNode.id;
                                        var titleRow = $('<div>',{class:"nr-db-sb-list-header nr-db-sb-widget-list-header"}).appendTo(container);
                                        $('<i class="nr-db-sb-list-handle nr-db-sb-widget-list-handle fa fa-bars"></i>').appendTo(titleRow);
                                        $('<i class="nr-db-sb-icon nr-db-sb-widget-icon fa fa-picture-o"></i>').appendTo(titleRow);
                                        var l = widgetNode._def.label;
                                        try {
                                            l = (typeof l === "function" ? l.call(widgetNode) : l)||"";
                                        }
                                        catch(err) {
                                            console.log("Definition error: "+d.type+".label",err);
                                            l = d.type;
                                        }
                                        var title = $('<span class="nr-db-sb-title">').html(l).appendTo(titleRow);
                                        listElements[widgetNode.id] = container;
                                        var buttonGroup = $('<div>',{class:"nr-db-sb-list-header-button-group"}).appendTo(titleRow);
                                        var editButton = $('<a href="#" class="editor-button editor-button-small nr-db-sb-list-header-button"><i class="fa fa-pencil"></i> '+c_("layout.edit")+'</a>').appendTo(buttonGroup);
                                        container.on('mouseover',function() {
                                            widgetNode.highlighted = true;
                                            widgetNode.dirty = true;
                                            RED.view.redraw();
                                        });
                                        container.on('mouseout',function() {
                                            widgetNode.highlighted = false;
                                            widgetNode.dirty = true;
                                            RED.view.redraw();
                                        });
                                        editButton.on('click',function(evt) {
                                            RED.editor.edit(widgetNode);
                                            evt.stopPropagation();
                                            evt.preventDefault();
                                        });
                                    },
                                    sortItems: function(items) {
                                        items.each(function(i,el) {
                                            var node = el.data('data');
                                            var changed = false;
                                            if (node.order !== i+1) {
                                                node.order = i+1;
                                                changed = true;
                                            }
                                            if (node.group !== group.node.id) {
                                                var oldGroupNode = RED.nodes.node(node.group);
                                                if (oldGroupNode) {
                                                    var index = oldGroupNode.users.indexOf(node);
                                                    oldGroupNode.users.splice(index,1);
                                                }
                                                node.group = group.node.id;
                                                group.node.users.push(node);
                                                changed = true;
                                            }
                                            if (changed) {
                                                node.dirty = true;
                                                node.changed = true;
                                            }
                                        })
                                        RED.nodes.dirty(true);
                                        RED.view.redraw();
                                    }
                                });
                                ol.css("min-height","5px");
                                if (groupNode.id) {
                                    groupLists[groupNode.id] = ol;
                                }
                                titleRow.click(titleToggle(groupNode.id,content,chevron));
                                editButton.on('click',function(evt) {
                                    RED.editor.editConfig("", groupNode.type, groupNode.id);
                                    evt.stopPropagation();
                                    evt.preventDefault();
                                });
                                group.widgets.forEach(function(widget) {
                                    ol.editableList('addItem',widget);
                                })
                            },
                            sortItems: function(items) {
                                items.each(function(i,el) {
                                    var groupData = el.data('data');
                                    var node = groupData.node;
                                    var changed = false;
                                    if (node.order !== i+1) {
                                        node.order = i+1;
                                        changed = true;
                                    }
                                    if (changed) {
                                        node.dirty = true;
                                        node.changed = true;
                                    }
                                    if (node.tab !== item.node.id) {
                                        var oldTabNode = RED.nodes.node(node.tab);
                                        if (oldTabNode) {
                                            var index = oldTabNode.users.indexOf(node);
                                            oldTabNode.users.splice(index,1);
                                        }
                                        node.tab = item.node.id;
                                        item.node.users.push(node);
                                        changed = true;
                                    }
                                })
                                RED.nodes.dirty(true);
                                RED.view.redraw();
                            }
                        })
                        tabLists[item.node.id] = ol;

                        addGroupButton.click(function(evt) {
                            ol.editableList('addItem',{});
                            evt.stopPropagation();
                            evt.preventDefault();
                        });
                        item.groups.forEach(function(group) {
                            ol.editableList('addItem',group);
                        });
                    }
                }

                var tabContainer = $('<ol>',{class:"nr-db-sb-tab-list"}).appendTo(divTabs).editableList({
                    sortable:".nr-db-sb-tab-list-header",
                    addButton: false,
                    addItem: addTabOrLinkItem,
                    sortItems: function(items) {
                        items.each(function(i,el) {
                            var itemData = el.data('data');
                            var node = itemData.node;
                            var changed = false;
                            if (node.order !== i+1) {
                                node.order = i+1;
                                changed = true;
                            }
                            if (changed) {
                                node.dirty = true;
                                node.changed = true;
                            }
                        })
                        RED.nodes.dirty(true);
                        RED.view.redraw();
                    }
                });

                var orphanedWidgets = $('<div>',{class:"form-row"}).appendTo(layoutTab);
                $('<span><i class="fa fa-info-circle"></i> There <span id="nr-db-missing-group-count"></span> not in a group. Click <a id="nr-db-add-missing-groups" href="#">here</a> to create the missing groups</span>').appendTo(orphanedWidgets);
                orphanedWidgets.find('a').click(function(event) {
                    var unknownGroups = {};
                    RED.nodes.eachNode(function(node) {
                        if (/^ui_/.test(node.type) && node.type !== 'ui_link' && node.type !== 'ui_toast' && node.type !== 'ui_ui_control') {
                            if (!RED.nodes.node(node.group)) {
                                var g = node.group || "_BLANK_";
                                unknownGroups[g] = unknownGroups[g] || [];
                                unknownGroups[g].push(node);
                            }
                        }
                    });
                    var tab = null;
                    var tabs = tabContainer.editableList('items');
                    tabs.first().each(function(i,el) {
                        var tabData = el.data('data');
                        tab = tabData.node;
                    });

                    if (tab === null) {
                        tab = {
                            id: RED.nodes.id(),
                            _def: RED.nodes.getType("ui_tab"),
                            type: "ui_tab",
                            users: [],
                            order: 0,
                            name: "Tab",
                            icon: "dashboard"
                        };
                        RED.nodes.add(tab);
                    }
                    for (var groupId in unknownGroups) {
                        if (unknownGroups.hasOwnProperty(groupId)) {
                            var groupNode = {
                                id: RED.nodes.id(),
                                _def: RED.nodes.getType("ui_group"),
                                type: "ui_group",
                                users: [],
                                tab: tab.id,
                                order: i+1,
                                name: (groupId==="_BLANK_"?"Group":groupId),
                                width: 6,
                                disp: true
                            };
                            RED.nodes.add(groupNode);
                            RED.editor.validateNode(groupNode);
                            if (RED.nodes.hasOwnProperty('updateConfigNodeUsers')) {
                                RED.nodes.updateConfigNodeUsers(groupNode);
                            }
                            var widgets = unknownGroups[groupId];
                            for (var i=0; i<widgets.length; i++) {
                                widgets[i].group = groupNode.id;
                                widgets[i].changed = true;
                                widgets[i].dirty = true;
                                if (RED.nodes.hasOwnProperty('updateConfigNodeUsers')) {
                                    RED.nodes.updateConfigNodeUsers(widgets[i]);
                                }
                                RED.editor.validateNode(widgets[i]);
                            }
                        }
                    }
                    RED.nodes.dirty(true);
                    refresh();
                    refreshOrphanedWidgets();
                    RED.view.redraw();
                    event.preventDefault();
                });


                var listElements = {};
                var dashboard = [];
                var listStates = {};
                var elementParents = {};
                var awaitingGroups = {};
                var awaitingTabs = {};

                function getCurrentList() {
                    var currentList = [];
                    var tabs = tabContainer.editableList('items');
                    var open = false;
                    tabs.each(function(i,el) {
                        var tabData = el.data('data');
                        var tab = [];
                        var groups = el.find('.nr-db-sb-group-list').editableList('items');
                        groups.each(function(j,el) {
                            var group = [];
                            var groupData = el.data('data');
                            var widgets = el.find('.nr-db-sb-widget-list').editableList('items');
                            widgets.each(function(k,el) {
                                var widgetData = el.data('data');
                                group.push(widgetData.id);
                            })
                            tab.push({id:groupData.node.id, widgets:group});
                        });
                        currentList.push({id:tabData.node.id,groups:tab});
                    });
                    return currentList;
                }
                function refreshOrphanedWidgets() {
                    var unknownGroups = {};
                    var count = 0;
                    RED.nodes.eachNode(function(node) {
                        if (/^ui_/.test(node.type) && node.type !== 'ui_link' && node.type !== 'ui_toast' && node.type !== 'ui_ui_control' && (node.type === 'ui_template' && node.templateScope !== 'global')) {
                            if (!RED.nodes.node(node.group)) {
                                var g = node.group || "_BLANK_";
                                unknownGroups[g] = unknownGroups[g] || [];
                                unknownGroups[g].push(node);
                                count++;
                            }
                        }
                    });

                    if (count > 0) {
                        orphanedWidgets.show();
                        $("#nr-db-missing-group-count").text((count===1?"is ":"are ")+count+" widget"+(count === 1?"":"s"))
                    }
                    else {
                        orphanedWidgets.hide();
                    }
                }

                function refresh() {
                    var currentList = getCurrentList();
                    dashboard = [];
                    var tabs = {};
                    var groups = {};
                    var elements = [];
                    var groupElements = {};
                    var tabGroups = {};
                    var groupId;
                    var group;
                    var tabId;
                    var tab;
                    var unknownGroups = 0;
                    // Find all the tabs and groups
                    RED.nodes.eachConfig(function(node) {
                        switch (node.type) {
                            case 'ui_tab':
                            case 'ui_link': {
                                tabs[node.id] = node;
                                //tabContainer.editableList('addItem',node);
                                break;
                            }
                            case 'ui_group': {
                                groups[node.id] = node;
                                break;
                            }
                        }
                    });
                    for (groupId in groups) {
                        if (groups.hasOwnProperty(groupId)) {
                            group = groups[groupId];
                            if (tabs.hasOwnProperty(group.tab)) {
                                // This group belongs to a tab
                                tabGroups[group.tab] = tabGroups[group.tab]||[];
                                tabGroups[group.tab].push(group);
                            }
                            else {
                                unknownGroups++;
                            }
                        }
                    }
                    // Find all ui widgets - list them by their group id
                    RED.nodes.eachNode(function(node) {
                        if (/^ui_/.test(node.type)) {
                            if (groups.hasOwnProperty(node.group)) {
                                groupElements[node.group] = groupElements[node.group]||[];
                                groupElements[node.group].push(node);
                            }
                            else if ((node.type !== 'ui_toast')&&(node.type !== 'ui_ui_control')&&(node.type === 'ui_template' && node.templateScope !== 'global')) {
                                unknownGroups++;
                            }
                        }
                    });
                    if (unknownGroups > 0) {
                        $("#nr-db-missing-group-count").text((unknownGroups===1?"is ":"are ")+unknownGroups+" widget"+(unknownGroups === 1?"":"s"))
                        orphanedWidgets.show();
                    }
                    else {
                        orphanedWidgets.hide();
                    }
                    // Sort each group's array of widgets
                    for (groupId in groupElements) {
                        if (groupElements.hasOwnProperty(groupId)) {
                            group = groupElements[groupId];
                            groupElements[groupId] = group.map(function(v,i) { return {n:v,i:i} }).sort(function(A,B) {
                                if (A.n.order < B.n.order) { return A.n.order!==0?-1:1;}
                                if (A.n.order > B.n.order) { return B.n.order!==0?1:-1;}
                                return A.i - B.i;
                            }).map(function(v) { return v.n})
                        }
                    }
                    // Sort each tabs's array of groups
                    for (tabId in tabGroups) {
                        if (tabGroups.hasOwnProperty(tabId)) {
                            tab = tabGroups[tabId];
                            tabGroups[tabId] = tab.map(function(v,i) { return {n:v,i:i} }).sort(function(A,B) {
                                if (A.n.order < B.n.order) { return -1;}
                                if (A.n.order > B.n.order) { return 1;}
                                return A.i - B.i;
                            }).map(function(v) { return v.n})
                        }
                    }
                    var tabIds = Object.keys(tabs).map(function(v,i) { return {n:tabs[v],i:i} }).sort(function(A,B) {
                        if (A.n.order < B.n.order) { return -1;}
                        if (A.n.order > B.n.order) { return 1;}
                        return A.i - B.i;
                    }).map(function(v) { return v.n.id});
                    tabIds.forEach(function(tabId) {
                        var tab = {node:tabs[tabId],groups:[]};
                        if (tabGroups[tabId]) {
                            tabGroups[tabId].forEach(function(groupNode) {
                                var group = {node:groupNode,widgets:[]};
                                if (groupElements[groupNode.id]) {
                                    group.widgets = groupElements[groupNode.id];
                                }
                                tab.groups.push(group);
                            });
                        }
                        dashboard.push(tab);
                    });
                    var newList = dashboard.map(function(t) {
                        return {
                            id: t.node.id,
                            groups: t.groups.map(function(g) {
                                return {
                                    id: g.node.id,
                                    widgets: g.widgets.map(function(w) {
                                        return w.id;
                                    })
                                }
                            })
                        }
                    });
                    if (JSON.stringify(newList)!=JSON.stringify(currentList)) {
                        listElements = {};
                        groupLists = {};
                        tabLists = {};
                        tabs = {};
                        groups = {};
                        elementParents = {};
                        tabContainer.empty();
                        dashboard.forEach(function(tab) {
                            tabContainer.editableList('addItem',tab);
                        });
                    }
                    ensureDashboardNode(true);
                    if (globalDashboardNode) {
                        $("#nr-db-field-title").val(globalDashboardNode.site.name);
                        $("#nr-db-field-allowSwipe").val(globalDashboardNode.site.allowSwipe || "false");
                        $("#nr-db-field-allowTempTheme").val(globalDashboardNode.site.allowTempTheme || "true");
                        $("#nr-db-field-hideToolbar").val(globalDashboardNode.site.hideToolbar || "false");
                        $("#nr-db-field-dateFormat").val(globalDashboardNode.site.dateFormat);

                        if (typeof globalDashboardNode.site.sizes !== "object") {
                            globalDashboardNode.site.sizes = sizes;
                        }
                        $("#nr-db-field-sx").val(globalDashboardNode.site.sizes.sx);
                        $("#nr-db-field-sy").val(globalDashboardNode.site.sizes.sy);
                        $("#nr-db-field-px").val(globalDashboardNode.site.sizes.px);
                        $("#nr-db-field-py").val(globalDashboardNode.site.sizes.py);
                        $("#nr-db-field-cx").val(globalDashboardNode.site.sizes.cx);
                        $("#nr-db-field-cy").val(globalDashboardNode.site.sizes.cy);
                        $("#nr-db-field-gx").val(globalDashboardNode.site.sizes.gx);
                        $("#nr-db-field-gy").val(globalDashboardNode.site.sizes.gy);

                        $("#nr-db-field-theme").val(globalDashboardNode.theme.name);
                        $("#ui-sidebar-name").val(globalDashboardNode.theme.customTheme.name);
                        if (globalDashboardNode.theme.name === 'theme-custom') {
                            $("#custom-theme-library-container").show();
                            $("#custom-theme-settings").show();
                        }
                        else {
                            $("#custom-theme-library-container").hide();
                            $("#custom-theme-settings").hide();
                        }

                        //set colour start
                        if (typeof globalDashboardNode.theme.name !== "string") {
                            globalDashboardNode.theme.name = "theme-light";
                        }
                        var currentTheme = globalDashboardNode.theme.name.split("-")[1];
                        var startingValue = globalDashboardNode.theme[currentTheme+"Theme"].baseColor;
                        setColourPickerColour("base-color", startingValue);
                        $("#nr-db-field-font").val(globalDashboardNode.theme[currentTheme+"Theme"].baseFont);
                        generateColours(startingValue);
                        if (globalDashboardNode.theme.name === 'theme-light' || globalDashboardNode.theme.name === 'theme-dark') {
                            addLightAndDarkResetButton('base-color', $('#base-settings-ul').children().first());
                        }

                        if (editor === undefined) {
                            editor = RED.editor.createEditor({
                                id: 'nr-db-field-format-editor',
                                mode: 'ace/mode/javascript',
                                value: JSON.stringify({theme:globalDashboardNode.theme.themeState, site:globalDashboardNode.site})
                            });

                            RED.library.create({
                                url:"themes", // where to get the data from
                                type:"theme", // the type of object the library is for
                                editor: editor, // the field name the main text body goes to
                                mode:"ace/mode/javascript",
                                fields:['name'],
                                elementPrefix:"ui-sidebar-"
                            });
                        }

                        editor.on('input', function() {
                            // Check for any changes on the editor object
                            // i.e. has the theme been customised compared
                            // to what is stored
                            var editorObject = JSON.parse(editor.getValue());
                            // var objectsEqual = true;
                            // var keysEqual = true;
                            // var editorKeys = Object.keys(editorObject);
                            // var themeKeys = Object.keys(editorObject.theme);
                            // var siteKeys = Object.keys(editorObject.site);
                            // var dashNodeKeys = Object.keys(globalDashboardNode.theme.themeState);

                            // // Test equality
                            // for (var i=0; i<themeKeys.length; i++) {
                            //     if (themeKeys[i] !== dashNodeKeys[i]) {
                            //         keysEqual = false;
                            //         break;
                            //     }
                            // }
                            // if (keysEqual) {
                            //     for (var j=0; j<themeKeys.length; j++) {
                            //         var key = themeKeys[j];
                            //         if (editorObject.theme[key] !== globalDashboardNode.theme.themeState[key]) {
                            //             objectsEqual = false;
                            //             break;
                            //         }
                            //     }
                            // }
                            //
                            // if (!objectsEqual) {
                            //     globalDashboardNode.theme.themeState = editorObject.theme;
                            // }
                            //
                            // //If custom theme is chosen, update the elements and current state
                            // if (globalDashboardNode.theme.name === 'theme-custom') {
                            //     //globalDashboardNode.theme.customTheme.baseColor = globalDashboardNode.theme.themeState['base-color'].default;
                            //     generateColours(globalDashboardNode.theme.customTheme.baseColor);
                            //     //setColourPickerColour("base-color", globalDashboardNode.theme.customTheme.baseColor);
                            //     if (!objectsEqual) { RED.nodes.dirty(true); }
                            // }

                            //Update theme object if necessary
                            if (JSON.stringify(editorObject.theme) !== JSON.stringify(globalDashboardNode.theme.themeState)) {
                                globalDashboardNode.theme.themeState = editorObject.theme;
                                if ($("#ui-sidebar-name").val() !== globalDashboardNode.theme.customTheme.name) {
                                    globalDashboardNode.theme.customTheme.name = $("#ui-sidebar-name").val();
                                    globalDashboardNode.theme.customTheme.baseColor = globalDashboardNode.theme.themeState["base-color"].value;
                                    setColourPickerColour("base-color", globalDashboardNode.theme.customTheme.baseColor);
                                    generateColours(globalDashboardNode.theme.themeState["base-color"].value);
                                    RED.nodes.dirty(true);
                                }
                            }

                            //Update site object if necessary
                            if (JSON.stringify(editorObject.site) !== JSON.stringify(globalDashboardNode.site)) {
                                globalDashboardNode.site = editorObject.site;
                                $("#nr-db-field-title").val(globalDashboardNode.site.name);
                                $("#nr-db-field-hideToolbar").val(globalDashboardNode.site.hideToolbar);
                                $("#nr-db-field-allowSwipe").val(globalDashboardNode.site.allowSwipe);
                                $("#nr-db-field-allowTempTheme").val(globalDashboardNode.site.allowTempTheme);
                                $("#nr-db-field-dateFormat").val(globalDashboardNode.site.dateFormat);
                                $("#nr-db-field-sx").val(globalDashboardNode.site.sizes.sx);
                                $("#nr-db-field-sy").val(globalDashboardNode.site.sizes.sy);
                                $("#nr-db-field-px").val(globalDashboardNode.site.sizes.px);
                                $("#nr-db-field-py").val(globalDashboardNode.site.sizes.py);
                                $("#nr-db-field-gx").val(globalDashboardNode.site.sizes.gx);
                                $("#nr-db-field-gy").val(globalDashboardNode.site.sizes.gy);
                                $("#nr-db-field-cx").val(globalDashboardNode.site.sizes.cx);
                                $("#nr-db-field-cy").val(globalDashboardNode.site.sizes.cy);
                                RED.nodes.dirty(true);
                            }
                        });

                    }
                    awaitingGroups = {};
                    awaitingTabs = {};
                }

                RED.sidebar.addTab({
                    id: "dashboard",
                    label: c_("label.dashboard"),
                    name: "Dashboard",
                    content: content,
                    closeable: true,
                    pinned: true,
                    iconClass: "fa fa-bar-chart",
                    disableOnEdit: true,
                    onchange: function() { refresh(); }
                });
                editSaveEventHandler = function(node) {
                    if (/^ui_/.test(node.type)) {
                        if (node.type === "ui_tab" || node.type === "ui_group") {
                            if (listElements[node.id]) {
                                // Existing element
                                listElements[node.id].children(".nr-db-sb-list-header").find(".nr-db-sb-title").html(node.name||node.id);
                                if (node.type === "ui_group") {
                                    refresh();
                                }
                            }
                            else if (node.type === "ui_tab") {
                                // Adding a tab
                                tabContainer.editableList('addItem',{node:node,groups:[]})
                            }
                            else {
                                // Adding a group
                                if (tabLists[node.tab]) {
                                    tabLists[node.tab].editableList('addItem',{node:node,widgets:[]})
                                }
                            }
                        }
                        else if (node.type === "ui_link") {
                            if (listElements[node.id]) {
                                var container = listElements[node.id];
                                container.find(".nr-db-sb-link-name").html(node.name||"untitled");
                                container.find(".nr-db-sb-link-url").html(node.link);
                            }
                        }
                        else {
                            refreshOrphanedWidgets();
                            if (listElements[node.id]) {
                                if (node.group != elementParents[node.id]) {
                                    // Moved to a different group
                                    if (groupLists[elementParents[node.id]]) {
                                        groupLists[elementParents[node.id]].editableList('removeItem',listElements[node.id].data('data'))
                                    }
                                    if (groupLists[node.group]) {
                                        groupLists[node.group].editableList('addItem',node);
                                    }
                                }
                                else {
                                    var l = node._def.label;
                                    try {
                                        l = (typeof l === "function" ? l.call(node) : l)||"";
                                    }
                                    catch(err) {
                                        console.log("Definition error: "+d.type+".label",err);
                                        l = d.type;
                                    }
                                    listElements[node.id].children(".nr-db-sb-list-header").find(".nr-db-sb-title").html(l);
                                }
                            }
                            else {
                                if (groupLists[node.group]) {
                                    groupLists[node.group].editableList('addItem',node)
                                }
                            }
                        }
                    }
                };

                RED.events.on("editor:save",editSaveEventHandler);

                var pendingAdd = [];
                var pendingAddTimer = null;

                function handlePendingAdds() {
                    var hasTabs = false;
                    var hasGroups = false;
                    pendingAdd.sort(function(A,B) {
                        hasTabs = hasTabs || A.type === "ui_tab" || B.type === "ui_tab";
                        hasGroups = hasGroups || A.type === "ui_group" || B.type === "ui_group";
                        if (A.type === B.type) {
                            return 0;
                        }
                        if (A.type === "ui_tab") {
                            return -1;
                        }
                        else if (B.type === "ui_tab") {
                            return 1;
                        }
                        else if (A.type === "ui_group") {
                            return -1;
                        }
                        else if (B.type === "ui_group") {
                            return 1;
                        }
                        return 0
                    });
                    for (var i=0; i<pendingAdd.length; i++) {
                        var node = pendingAdd[i];
                        if (node.type === "ui_tab") {
                            tabContainer.editableList('addItem',{node:node,groups:[]});
                        }
                        else {
                            if (hasTabs) {
                                // We've added some tabs, need to give jquery time to add the lists
                                pendingAdd = pendingAdd.slice(i);
                                pendingAddTimer = setTimeout(handlePendingAdds,50);
                                return;
                            }
                            if (node.type === "ui_group") {
                                if (tabLists[node.tab]) {
                                    tabLists[node.tab].editableList('addItem',{node:node,widgets:[]});
                                }
                            }
                            else {
                                if (hasGroups) {
                                    // We've added some tabs, need to give jquery time to add the lists
                                    pendingAdd = pendingAdd.slice(i);
                                    pendingAddTimer = setTimeout(handlePendingAdds,50);
                                    return;
                                }
                                if (groupLists[node.group]) {
                                    groupLists[node.group].editableList('addItem',node)
                                }
                                else {
                                    refreshOrphanedWidgets();
                                }
                            }
                        }
                    }
                    pendingAdd = [];
                }

                nodesAddEventHandler = function(node) {
                    if (/^ui_/.test(node.type) && !listElements[node.id]) {
                        pendingAdd.push(node);
                        clearTimeout(pendingAddTimer);
                        pendingAddTimer = setTimeout(handlePendingAdds,100);
                    }
                };
                RED.events.on("nodes:add", nodesAddEventHandler);

                nodesRemoveEventHandler = function(node) {
                    if (/^ui_/.test(node.type)) {
                        if (node.type === "ui_tab" || node.type === "ui_link") {
                            if (listElements[node.id]) {
                                tabContainer.editableList('removeItem',listElements[node.id].data('data'));
                                delete tabLists[node.id];
                            }
                        }
                        else if (node.type === "ui_group") {
                            if (tabLists[node.tab] && listElements[node.id]) {
                                tabLists[node.tab].editableList('removeItem',listElements[node.id].data('data'));
                            }
                            delete groupLists[node.id];
                        }
                        else {
                            if (groupLists[node.group]) {
                                groupLists[node.group].editableList('removeItem',node)
                            }
                        }
                        refreshOrphanedWidgets();
                        delete listElements[node.id];
                    }
                };

                RED.events.on("nodes:remove", nodesRemoveEventHandler);
            }
        });

    $.widget("nodereddashboard.elementSizerByNum", {
        _create: function() {
            var that = this;
            var has_height = this.options.has_height;
            var pos = this.options.pos;
            var c_width = has_height ? '15%' : '6%';
            var container = $('<div>').css({
                position: 'absolute',
                background: 'white',
                padding: '10px 10px 10px 10px',
                border: '1px solid grey',
                zIndex: '20',
                borderRadius: "4px",
                display:"none",
                width: c_width
            }).appendTo(document.body);
            var box0 = $("<div>").css({
                fontSize: '13px',
                color: '#aaa',
                float: 'left',
                paddingTop: '1px'
            }).appendTo(container);

            var width = $(this.options.width).val();
            var height = has_height ? $(this.options.height).val() : undefined;
            var max_w = '';
            var groupNode = this.options.groupNode;
            if(groupNode) {
                max_w = 'max="'+groupNode.width+'"';
            }
            width = (width > 0) ? width : 1;
            height = (height > 0) ? height : 1;
            var in0 = $('<input type="number" min="1" '+max_w+'>')
                .css("width", has_height ? "45%" : "100%")
                .val(width)
                .appendTo(box0);
            if(has_height) {
                var pad = $('<span>')
                    .html(" x ")
                    .appendTo(box0);
                var in1 = $('<input type="number" min="1">')
                    .css("width", "45%")
                    .val(height)
                    .appendTo(box0);
            }
            var closeTimer;
            var closeFunc = function() {
                var w = in0.val();
                var h = has_height ? in1.val() : undefined;
                var label = that.options.label;
                label.html(w+(has_height ? (' x '+h) : ''));
                $(that.options.width).val(w).change();
                if(has_height) {
                    $(that.options.height).val(h).change();
                }
                that.destroy();
            };
            container.keypress(function(e) {
                if(e.which === 13) { // pressed ENTER
                    container.fadeOut(100, closeFunc);
                }
            });
            container.on('mouseleave', function(e) {
                closeTimer = setTimeout(function() {
                    container.fadeOut(200, closeFunc);
                }, 100);
            });
            container.on('mouseenter', function(e) {
                clearTimeout(closeTimer);
            });
            container.css({
                top: (pos.top -10)+"px",
                left: (pos.left +10)+"px"
            });
            container.fadeIn(200);
        }
    });

    $.widget( "nodereddashboard.elementSizer", {
        _create: function() {
            var that = this;
            var gridWidth = 6;
            var width = parseInt($(this.options.width).val()||0);
            var height = parseInt(this.options.hasOwnProperty('height')?$(this.options.height).val():"1")||0;
            var hasAuto = (!this.options.hasOwnProperty('auto') || this.options.auto);

            this.element.css({
                minWidth: this.element.height()+4
            });
            var auto_text = c_("auto");
            var sizeLabel = (width === 0 && height === 0)?auto_text:width+(this.options.hasOwnProperty('height')?" x "+height:"");
            this.element.html(sizeLabel).on('mousedown',function(evt) {
                evt.stopPropagation();
                evt.preventDefault();

                var width = parseInt($(that.options.width).val()||0);
                var height = parseInt(that.options.hasOwnProperty('height')?$(that.options.height).val():"1")||0;
                var maxWidth = 0;
                var maxHeight;
                var fixedWidth = false;
                var fixedHeight = false;
                var group = $(that.options.group).val();
                if (group) {
                    var groupNode = RED.nodes.node(group);
                    if (groupNode) {
                        gridWidth = Math.max(6,groupNode.width,+width);
                        maxWidth = groupNode.width || gridWidth;
                        fixedWidth = true;
                    }
                    maxHeight = Math.max(6,+height+1);
                }
                else {
                    gridWidth = Math.max(12,+width);
                    maxWidth = gridWidth;
                    maxHeight = 1;
                    fixedHeight = true;
                }

                var pos = $(this).offset();
                var container = $('<div>').css({
                    position: 'absolute',
                    background: 'white',
                    padding: '5px 10px 10px 10px',
                    border: '1px solid grey',
                    zIndex: '20',
                    borderRadius: "4px",
                    display:"none"
                }).appendTo(document.body);
                var closeTimer;

                container.on('mouseleave',function(evt) {
                    closeTimer = setTimeout(function() {
                        container.fadeOut(200, function() { $(this).remove(); });
                    },100)
                });
                container.on('mouseenter',function() {
                    clearTimeout(closeTimer);
                })

                var label = $("<div>").css({
                    fontSize: '13px',
                    color: '#aaa',
                    float: 'left',
                    paddingTop: '1px'
                }).appendTo(container).html((width === 0 && height === 0)?auto_text:(width+(that.options.hasOwnProperty('height')?" x "+height:"")));
                label.hover(function() {
                    $(this).css('text-decoration', 'underline');
                }, function() {
                    $(this).css('text-decoration', 'none');
                });
                label.click(function(e) {
                    var group = $(that.options.group).val();
                    var groupNode = null;
                    if(group) {
                        groupNode = RED.nodes.node(group);
                        if(groupNode === null) {
                            return;
                        }
                    }
                    $(that).elementSizerByNum({
                        width: that.options.width,
                        height: that.options.height,
                        groupNode: groupNode,
                        pos: pos,
                        label: that.element,
                        has_height: that.options.hasOwnProperty('height')
                    });
                    closeTimer = setTimeout(function() {
                        container.fadeOut(200, function() {
                            $(this).remove();
                        });
                    },100)
               });

                var buttonRow = $('<div>',{style:"text-align:right; height:25px;"}).appendTo(container);

                if (hasAuto) {
                    var button = $('<a>',{href:"#",class:"editor-button editor-button-small",style:"margin-bottom:5px"})
                    .html(auto_text)
                    .appendTo(buttonRow)
                    .on('mouseup',function(evt) {
                        that.element.html(auto_text)
                        $(that.options.width).val(0).change();
                        $(that.options.height).val(0).change();
                        evt.preventDefault();
                        container.fadeOut(200, function() { $(this).remove(); });
                    });
                }

                var cellBorder = "1px dashed lightGray";
                var cellBorderExisting = "1px solid gray";
                var cellBorderHighlight = "1px dashed black";
                var rows = [];
                function addRow(i) {
                    var row = $('<div>').css({padding:0,margin:0,height:"25px","box-sizing":"border-box"}).appendTo(container);
                    rows.push(row);
                    cells.push([])
                    for (var j=0; j<gridWidth; j++) {
                        addCell(i,j);
                    }
                }
                function addCell(i,j) {
                    var row = rows[i];
                    var cell = $('<div>').css({
                        display:"inline-block",
                        width: "25px",
                        height: "25px",
                        borderRight: (j===(width-1)&&i<height)?cellBorderExisting:cellBorder,
                        borderBottom: (i===(height-1)&&j<width)?cellBorderExisting:cellBorder,
                        boxSizing: "border-box",
                        cursor:"pointer",
                        background: (j<maxWidth)?"#fff":"#eee"
                    }).appendTo(row);
                    cells[i].push(cell);
                    if (j===0) {
                        cell.css({borderLeft:((i<=height-1)?cellBorderExisting:cellBorder)});
                    }
                    if (i===0) {
                        cell.css({borderTop:((j<=width-1)?cellBorderExisting:cellBorder)});
                    }
                    if (j<maxWidth) {
                        cell.data("w",j);
                        cell.data("h",i);
                        cell.on("mouseup",function() {
                            that.element.html(($(this).data("w")+1)+(that.options.hasOwnProperty('height')?" x "+($(this).data("h")+1):""))
                            $(that.options.width).val($(this).data("w")+1).change();
                            $(that.options.height).val($(this).data("h")+1).change();
                            container.fadeOut(200, function() { $(this).remove(); });
                        });
                        cell.on("mouseover",function() {
                            var w = $(this).data("w");
                            var h = $(this).data("h");
                            label.html((w+1)+(that.options.hasOwnProperty('height')?" x "+(h+1):""));
                            for (var y = 0; y<maxHeight; y++) {
                                for (var x = 0; x<maxWidth; x++) {
                                    cells[y][x].css({
                                        background: (y<=h && x<=w)?'#ddd':'#fff',
                                        borderLeft: (x===0&&y<=h)?cellBorderHighlight:(x===0)?((y<=height-1)?cellBorderExisting:cellBorder):'',
                                        borderTop: (y===0&&x<=w)?cellBorderHighlight:(y===0)?((x<=width-1)?cellBorderExisting:cellBorder):'',
                                        borderRight: (x===w&&y<=h)?cellBorderHighlight:((x===width-1&&y<=height-1)?cellBorderExisting:cellBorder),
                                        borderBottom: (y===h&&x<=w)?cellBorderHighlight:((y===height-1&&x<=width-1)?cellBorderExisting:cellBorder)
                                    })
                                }
                            }
                            if (!fixedHeight && h === maxHeight-1) {
                                addRow(maxHeight++)
                            }
                            if (!fixedWidth && w === maxWidth-1) {
                                maxWidth++;
                                gridWidth++;
                                for (var r=0; r<maxHeight; r++) {
                                    addCell(r,maxWidth-1);
                                }
                            }
                        })
                    }
                }
                var cells = [];
                for (var i=0; i<maxHeight; i++) {
                    addRow(i);
                }
                container.css({
                    top:(pos.top)+"px",
                    left:(pos.left)+"px"
                });
                container.fadeIn(200);
            })
        }
    });
})(jQuery);
</script>

<script type="text/x-red" data-template-name="ui_base">
    <div class='form-row'>
        <a href="#" onclick="RED.sidebar.show('dashboard'); $('#node-config-dialog-cancel').click(); return false" class="editor-button">Open dashboard sidebar</a>
    </div>
</script>


<script type="text/x-red" data-help-name="ui_base">
</script>
<!-- --- [red-module:node-red-dashboard/ui_button] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_button',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: false},
            label: {value: 'button'},
            color: {value: ''},
            bgcolor: {value: ''},
            icon: {value: ''},
            payload: {value: '',validate: (RED.validators.hasOwnProperty('typedInput')?RED.validators.typedInput('payloadType'):function(v) { return true})},
            payloadType: { value: 'str'},
            topic: {value: ''}
        },
        inputs:1,
        outputs:1,
        icon: "ui_button.png",
        paletteLabel: 'button',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'button'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
            $('#node-input-payload').typedInput({
                default: 'str',
                typeField: $("#node-input-payloadType"),
                types:['str','num','bool','json','date','flow','global']
            })
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_button">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-icon"><i class="fa fa-picture-o"></i> Icon</label>
        <input type="text" id="node-input-icon" placeholder="optional icon ">
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label" placeholder="optional label">
    </div>
    <div class="form-row">
        <label for="node-input-color"><i class="fa fa-tint"></i>  Colour</label>
        <input type="text" id="node-input-color" placeholder="optional text/icon color">
    </div>
    <div class="form-row">
        <label for="node-input-bgcolor"><i class="fa fa-tint"></i>  Background</label>
        <input type="text" id="node-input-bgcolor" placeholder="optional background color">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-payload"><i class="fa fa-envelope-o"></i> When clicked, send:</label>
    </div>
    <div class="form-row">
        <label for="node-input-payload" style="padding-left: 25px; margin-right: -25px">Payload</label>
        <input type="text" id="node-input-payload" style="width:70%">
        <input type="hidden" id="node-input-payloadType">
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left: 25px; margin-right: -25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_button">
    <p>Adds a button to the user interface.</p>
    <p>Clicking the button generates a message with <code>msg.payload</code> set to the <b>Payload</b> field.
    If no payload is specified, the node id is used.</p>
	<p>The <b>Size</b> defaults to  3 by 1.</p>
	<p>The <b>Icon</b> can be defined, as either a <a href="https://design.google.com/icons/" target="_blank">Material Design icon</a>
    <i>(e.g. 'check', 'close')</i> or a <a href="https://fontawesome.com/v4.7.0/icons/" target="_blank">Font Awesome icon</a>
    <i>(e.g. 'fa-fire')</i>.</p>
    <p>The colours of the text and background may be set. They can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.background}}</code>.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>The <b>Topic</b> field can be used to set the <code>msg.topic</code> property that is output.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the button.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_dropdown] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_dropdown',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: ''},
            place: {value: 'Select option'},
            group: {type: 'ui_group', required:true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            options: {value:[{value: '', label : ''}], validate:function(value) { return value.length > 0; }},
            payload: {value: ''},
            topic: {value: ''}
        },
        inputs:1,
        outputs:1,
        icon: "ui_dropdown.png",
        paletteLabel: 'dropdown',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'dropdown'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });

            this.resizeRule = function(option,newWidth) {
                option.find(".node-input-option-label").width(newWidth);
                option.find(".node-input-option-value").width(newWidth);
            }

            function generateOption(i, option) {
                var container = $('<li></li>',{style:"background: #fff; margin:0; padding:8px 0px 0px; border-bottom: 1px solid #ccc;"});
                var row = $('<div></div>').appendTo(container);
                var row2 = $('<div></div>',{style:"padding-top:5px; padding-left:175px;"}).appendTo(container);
                var row3 = $('<div></div>',{style:"padding-top:5px; padding-left:120px;"}).appendTo(container);

                $('<i style="color:#eee; cursor:move; margin-left:3px;" class="node-input-option-handle fa fa-bars"></i>').appendTo(row);

                var valueField = $('<input/>',{class:"node-input-option-value",type:"text",style:"margin-left:7px; min-width:calc(50% - 32px);", placeholder: 'Value',value:option.value}).appendTo(row).typedInput({default:option.type||'str',types:['str','num','bool']});
                var labelField = $('<input/>',{class:"node-input-option-label",type:"text",style:"margin-left:7px; min-width:calc(50% - 32px);", placeholder: 'Label', value:option.label}).appendTo(row);

                var finalspan = $('<span></span>',{style:"float:right; margin-right:8px;"}).appendTo(row);
                var deleteButton = $('<a></a>',{href:"#",class:"editor-button editor-button-small", style:"margin-top:7px; margin-left:5px;"}).appendTo(finalspan);
                $('<i></i>',{class:"fa fa-remove"}).appendTo(deleteButton);

                deleteButton.click(function() {
                    container.css({"background":"#fee"});
                    container.fadeOut(300, function() {
                        $(this).remove();
                    });
                });

                $("#node-input-option-container").append(container);
            }

            $("#node-input-add-option").click(function() {
                generateOption($("#node-input-option-container").children().length+1, {});
                $("#node-input-option-container-div").scrollTop($("#node-input-option-container-div").get(0).scrollHeight);
            });

            for (var i=0; i<this.options.length; i++) {
                var option = this.options[i];
                generateOption(i+1,option);
            }

            $( "#node-input-option-container" ).sortable({
                axis: "y",
                handle:".node-input-option-handle",
                cursor: "move"
            });
        },
        oneditsave: function() {
            var options = $("#node-input-option-container").children();
            var node = this;
            node.options = [];
            options.each(function(i) {
                var option = $(this);
                var o = {
                    label: option.find(".node-input-option-label").val(),
                    value: option.find(".node-input-option-value").typedInput('value'),
                    type: option.find(".node-input-option-value").typedInput('type')
                };
                if (option.find(".node-input-option-value").typedInput('type') === "num") {
                    o.value = Number(o.value);
                }
                if (option.find(".node-input-option-value").typedInput('type') === "bool") {
                    o.value = (o.value == "true");
                }
                node.options.push(o);
            });
        },
        oneditresize: function() {
            var options = $("#node-input-option-container").children();
            var newWidth = ($("#node-input-option-container").width() - 175)/2;
            var node = this;
            options.each(function(i) {
                node.resizeRule($(this),newWidth);
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_dropdown">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-tag"></i> Label</label>
        <input type="text" id="node-input-label" placeholder="optional label">
    </div>
    <div class="form-row">
        <label for="node-input-place"><i class="fa fa-tag"></i> Placeholder</label>
        <input type="text" id="node-input-place" placeholder="optional placeholder">
    </div>
    <div class="form-row node-input-option-container-row" style="margin-bottom: 0px;width: 100%">
        <label for="node-input-width" style="vertical-align:top"><i class="fa fa-list-alt"></i> Options</label>
        <div id="node-input-option-container-div" style="box-sizing: border-box; border-radius: 5px; height: 257px; padding: 5px; border: 1px solid #ccc; overflow-y:scroll;display: inline-block; width: calc(70% + 15px);">
            <ol id="node-input-option-container" style=" list-style-type:none; margin: 0;"></ol>
        </div>
    </div>
    <div class="form-row">
        <a href="#" class="editor-button editor-button-small" id="node-input-add-option" style="margin-top: 4px; margin-left: 103px;"><i class="fa fa-plus"></i> <span>option</span></a>
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="optional msg.topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_dropdown">
    <p>Adds a dropdown select box to the user interface.</p>
    <p>Multiple value / label pairs can be added as required. If the label is not specified the
    value will be used for both.</p>
    <p>The configured value of the selected item will be returned as <code>msg.payload</code>.</p>
    <p>Setting <code>msg.payload</code> to the value will set the pre-selected choice in the dropdown.</p>
    <p>Optionally the <b>Topic</b> field can be used to set the <code>msg.topic</code> property.</p>
    <p>The Options may be configured by inputting <code>msg.options</code> containing an array.
    If just text then the value will be the same as the label, otherwise you can specify both by
    using an object of <code>"label":"value"</code> pairs :</p>
    <code>[ "Choice 1", "Choice 2", {"Choice 3":"3"} ]</code>
</script>
<!-- --- [red-module:node-red-dashboard/ui_switch] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_switch',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: 'switch'},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            decouple: {value: "false"},
            topic: {value: ''},
            style: {value: ''},
            onvalue: {value: true, required:true, validate: (RED.validators.hasOwnProperty('typedInput')?RED.validators.typedInput('onvalueType'):function(v) { return true})},
            onvalueType: {value: 'bool'},
            onicon: {value: '' },
            oncolor: {value: ''},
            offvalue: {value: false, required:true, validate: (RED.validators.hasOwnProperty('typedInput')?RED.validators.typedInput('offvalueType'):function(v) { return true})},
            offvalueType: {value: 'bool'},
            officon: {value: ''},
            offcolor: {value: ''},
        },
        inputs:1,
        outputs:1,
        icon: "ui_switch.png",
        paletteLabel: 'switch',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'switch'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
            $('#node-input-custom-icons').change(function() {
                var v = $(this).val();
                if (v === "default") {
                    $(".form-row-custom-icons").hide();
                }
                else {
                    $(".form-row-custom-icons").show();
                }
            });

            if (this.onicon !== "" || this.oncolor !== "" || this.officon !=="" || this.offcolor !== "") {
                $('#node-input-custom-icons').val('custom');
            }
            else {
                $('#node-input-custom-icons').change();
            }

            $('#node-input-onvalue').typedInput({
                default: 'str',
                typeField: $("#node-input-onvalueType"),
                types: ['flow','global','str','num','bool','json','date']
            });
            $('#node-input-offvalue').typedInput({
                default: 'str',
                typeField: $("#node-input-offvalueType"),
                types: ['flow','global','str','num','bool','json','date']
            });

            $('#node-input-passthru').change(function() {
                if (this.checked) {
                    $('.form-row-decouple').hide();
                    $('#node-input-decouple').val("false");
                }
                else {
                    $('.form-row-decouple').show();
                }
            });

        },
        oneditsave: function() {
            if ($('#node-input-custom-icons').val() === 'default') {
                $('#node-input-onicon').val('');
                $('#node-input-officon').val('');
                $('#node-input-oncolor').val('');
                $('#node-input-offcolor').val('');
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_switch">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-custom-icons"><i class="fa fa-picture-o"></i> Icon</label>
        <select id="node-input-custom-icons">
            <option value="default">Default</option>
            <option value="custom">Custom</option>
        </select>
    </div>
    <div class="form-row form-row-custom-icons">
        <label for="node-input-onicon" style="text-align:right;"><i class="fa fa-toggle-on"></i> On Icon</label>
        <input type="text" id="node-input-onicon" style="width:120px">
        <label for="node-input-oncolor" style="width:50px; text-align:right;">Colour</label>
        <input type="text" id="node-input-oncolor" style="width:120px">
    </div>
    <div class="form-row form-row-custom-icons">
        <label for="node-input-officon" style="text-align:right;"><i class="fa fa-toggle-off"></i> Off Icon</label>
        <input type="text" id="node-input-officon" style="width:120px">
        <label for="node-input-offcolor" style="width:50px; text-align:right;">Colour</label>
        <input type="text" id="node-input-offcolor" style="width:120px">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row form-row-decouple">
        <label for="node-input-decouple"><i class="fa fa-toggle-on"></i> Indicator</label>
        <select id="node-input-decouple" style="display: inline-block; vertical-align: middle; width:70%;">
            <option value="false">Switch icon shows state of the output</option>
            <option value="true">Switch icon shows state of the input</option>
        </select>
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-onvalue"><i class="fa fa-envelope-o"></i> When clicked, send:</label>
    </div>
    <div class="form-row">
        <label for="node-input-onvalue" style="padding-left:25px; margin-right:-25px">On Payload</label>
        <input type="text" id="node-input-onvalue" style="width:70%">
        <input type="hidden" id="node-input-onvalueType">
    </div>
    <div class="form-row">
        <label for="node-input-offvalue" style="padding-left:25px; margin-right:-25px">Off Payload</label>
        <input type="text" id="node-input-offvalue" style="width:70%">
        <input type="hidden" id="node-input-offvalueType">
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left:25px; margin-right:-25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_switch">
    <p>Adds a switch to the user interface.</p>
	<p>Each change in the state of the switch will generate
    a <code>msg.payload</code> with the specified <b>On</b> and <b>Off</b> values.</p>
    <p>The <b>On/Off Color</b> and <b>On/Off Icon</b> are optional fields. If they are all present, the default
    toggle switch will be replaced with the relevant icons and their respective colors.</p>
    <p>The <b>On/Off Icon</b> field can be either <a href="https://design.google.com/icons/" target="_blank">Material Design icons</a>
    <i>(e.g. 'check', 'close')</i> or <a href="https://fontawesome.com/v4.7.0/icons/" target="_blank">Font Awesome icons</a> <i>(e.g. 'fa-fire')</i>.</p>
    <p>The widget can be updated by an incoming <code>msg.payload</code> with the specified values,
    that must also match the type of the input (number, string, etc).</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>If a <b>Topic</b> is specified, it will be added to the output as <code>msg.topic</code>.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the switch widget.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_slider] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_slider',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: 'slider'},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            topic: {value: ''},
            min: {value: 0, required:true, validate:RED.validators.number()},
            max: {value: 10, required:true, validate:RED.validators.number()},
            step: {value: 1}
        },
        inputs:1,
        outputs:1,
        icon: "ui_slider.png",
        paletteLabel: 'slider',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'slider'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_slider">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-min">Range</label>
        <span for="node-input-min">min</span>
        <input type="text" id="node-input-min" style="width:60px">
        <span for="not-input-max" style="margin-left:22px;">max</span>
        <input type="text" id="node-input-max" style="width:60px">
        <span for="not-input-step" style="margin-left:22px;">step</span>
        <input type="text" id="node-input-step" style="width:60px">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-payload"><i class="fa fa-envelope-o"></i> When changed, send:</label>
    </div>
    <div class="form-row">
        <label style="padding-left:25px; margin-right:-25px">Payload</label>
        <label style="width:auto">Current value</label>
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left:25px; margin-right:-25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_slider">
    <p>Adds a slider widget to the user interface.</p>
	<p>The user can change its value between the limits (<b>min</b> and <b>max</b>). Each value change
    will generate a message with the value set as <b>payload</b>.</p>
    <p>If a <b>Topic</b> is specified, it will be added as <code>msg.topic</code>.</p>
    <p>Input messages will be converted to a number. The <b>min</b> value will be used if conversion fails,
    and it will update the user interface. If the value changes, it will also be passed to the output.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the slider output.</p>
    <p>Note: An input msg to the slider node will not change the status information displayed unless the slider
    node output is connected to another node.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_numeric] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_numeric',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: 'numeric'},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            topic: {value: ''},
            format: {value: '{{value}}'},
            min: {value: 0, required: true, validate: RED.validators.number()},
            max: {value: 10, required: true, validate: RED.validators.number()},
            step: {value: 1}
        },
        inputs:1,
        outputs:1,
        icon: "ui_numeric.png",
        paletteLabel: 'numeric',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'numeric'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_numeric">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-format"><i class="fa fa-i-cursor"></i> Value Format</label>
        <input type="text" id="node-input-format" placeholder="{{value}}">
    </div>
    <div class="form-row">
        <label for="node-input-min">Range</label>
        <span for="node-input-min">min</span>
        <input type="text" id="node-input-min" style="width:60px">
        <span for="not-input-max" style="margin-left:22px;">max</span>
        <input type="text" id="node-input-max" style="width:60px">
        <span for="not-input-step" style="margin-left:22px;">step</span>
        <input type="text" id="node-input-step" style="width:60px">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-payload"><i class="fa fa-envelope-o"></i> When changed, send:</label>
    </div>
    <div class="form-row">
        <label style="padding-left:25px; margin-right:-25px">Payload</label>
        <label style="width:auto">Current value</label>
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left:25px; margin-right:-25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_numeric">
    <p>Adds a numeric input widget to the user interface.</p>
	<p>The user can set the value between
    the limits (<b>min</b> and <b>max</b>). Each value change will generate a <code>msg.payload</code>.</p>
    <p>If <b>Topic</b> is specified, it will be added as <code>msg.topic</code>.<p>
    <p>Any input messages will be converted to a number, the <b>min</b> value will be used if conversion fails,
    and it will update the user interface. If the value changes, it will also be passed to the output.</p>
    <p>The <b>Value Format</b> field can be used to change the displayed format. For example, a <b>Value Format</b>
    of <code>{{value}} %</code>
    with a value of <b>23</b> will show <b>23 %</b> on the user interface. The <b>Value Format</b> field can contain
    HTML or Angular filters to format the output (eg: <code>&amp;deg;</code> will show the degree symbol).</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the widget putput.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_text_input] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_text_input',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: ''},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            mode: {value: 'text', required: true},
            delay: {value: 300, validate: RED.validators.number()},
            topic: {value: ''}
        },
        inputs:1,
        outputs:1,
        icon: "ui_text.png",
        paletteLabel: 'text input',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || this.mode+' input'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_text_input">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-mode"><i class="fa fa-keyboard-o"></i> Mode</label>
        <select style="width:128px" id="node-input-mode">
            <option value="text">text input</option>
            <option value="email">email address</option>
            <option value="password">password</option>
            <option value="number">number</option>
            <option value="tel">telephone input</option>
            <option value="color">color picker</option>
            <option value="time">time picker</option>
            <option value="week">week picker</option>
            <option value="month">month picker</option>
        </select>
        <label for="node-input-delay" style="text-align:right; width:100px"><i class="fa fa-clock-o"></i> Delay (ms)</label>
        <input type="text" style="width:58px" id="node-input-delay">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-payload"><i class="fa fa-envelope-o"></i> When changed, send:</label>
    </div>
    <div class="form-row">
        <label style="padding-left: 25px; margin-right: -25px">Payload</label>
        <label style="width:auto">Current value</label>
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left: 25px; margin-right: -25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
    <div class="form-tips">Setting <b>Delay</b> to 0 waits for Enter or Tab key, to send input.</span></div>
</script>


<script type="text/x-red" data-help-name="ui_text_input">
  <p>Adds a text input field to the user interface. Mode can be regular text, email or color picker.</p>
  <p>Any input is sent as <code>msg.payload</code> automatically. You can also
  preset the text of the input field by sending in a <code>msg.payload</code>.</p>
  <p>The <b>Delay</b> <i>(default : 300ms)</i> sets the amount of time in milliseconds before the output is sent.
  Setting to <code>0</code> waits for "Enter" or "Tab" key to send.</p>
  <p>The email mode will color in red if it is not a valid address and will return undefined.</p>
  <p>The time input type returns a number of milliseconds from midnight.</p>
  <p>Not all browsers support the <i>week</i> and <i>month</i> input types, and may return <i>undefined</i>.
  Please test your target browser(s) before use.</p>
  <p>If a <b>Topic</b> is specified, it will be added as <code>msg.topic</code>.</p>
  <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the input.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_date_picker] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_date_picker',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: 'date'},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            topic: {value: ''}
        },
        inputs:1,
        outputs:1,
        icon: "ui_date_picker.png",
        paletteLabel: 'date picker',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'date picker'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_date_picker">
	<div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output: </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-payload"><i class="fa fa-envelope-o"></i> When changed, send:</label>
    </div>
    <div class="form-row">
        <label style="padding-left:25px; margin-right:-25px">Payload</label>
        <label style="width:auto">Current value</label>
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left:25px; margin-right:-25px">Topic</label>
        <input type="text" id="node-input-topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_date_picker">
    <p>Adds a date picker widget to the user interface.</p>
    <p>The date display can be formatted in the Dashboard - Site tab using <a href="https://momentjs.com/docs/#/displaying/">
    moment.js</a> formatting. For example <code>MM/DD/YYYY</code>, <code>Do MMM YYYY</code> or <code>YYYY-MM-DD</code>.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the input.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_colour_picker] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_colour_picker',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: ''},
            group: {type: 'ui_group', required: true},
            format: {value: 'hex'},
            outformat: {value: 'string'},
            showSwatch: {value: true},
            showPicker: {value: false},
            showValue: {value: false},
            showHue: {value: false},
            showAlpha: {value: false},
            showLightness: {value: true},
            dynOutput: {value: "false"},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            passthru: {value: true},
            topic: {value: ''}
        },
        inputs:1,
        outputs:1,
        icon: "ui_colour_picker.png",
        paletteLabel: 'colour picker',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'colour picker'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
            $("#node-input-format").change(function() {
                if ($(this).val() === "hex") {
                    $("#node-alpha-control").hide();
                }
                else {
                    $("#node-alpha-control").show();
                }
            });
        },
        oneditsave: function() {
            if (!$("#node-input-showPicker").is(':checked') && !$("#node-input-showValue").is(':checked')) {
                $("#node-input-showSwatch").prop('checked', true);
                this.showSwatch = true;
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_colour_picker">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-format"><i class="fa fa-keyboard-o"></i> Format</label>
        <select id="node-input-format" style="width:156px;">
            <option value="hex">hex</option>
            <option value="hex8">hex8</option>
            <option value="hsl">hsl</option>
            <option value="hsv">hsv</option>
            <option value="rgb">rgb</option>
        </select>
    </div>
    <div class="form-row">
        <label>&nbsp;</label> Show hue slider : <input type="checkbox" id="node-input-showHue" style="display:inline-block; width:auto; vertical-align:baseline;">
        <br/>
        <label>&nbsp;</label> Show lightness slider : <input type="checkbox" id="node-input-showLightness" style="display:inline-block; width:auto; vertical-align:baseline;">
        <br/>
        <span id="node-alpha-control"><label>&nbsp;</label> Show transparency slider : <input type="checkbox" id="node-input-showAlpha" style="display:inline-block; width:auto; vertical-align:baseline;"></span>
    </div>
    <div class="form-row">
        If width is 4 or greater:<br/>
        <label>&nbsp;</label>
        Always show swatch : <input type="checkbox" checked id="node-input-showSwatch" style="display:inline-block; width:auto; vertical-align:top;">
        <br/>
        <label>&nbsp;</label>
        Always show picker : <input type="checkbox" checked id="node-input-showPicker" style="display:inline-block; width:auto; vertical-align:top;">
        <br/>
        <label>&nbsp;</label>
        Always show value field : <input type="checkbox" checked id="node-input-showValue" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label style="width:auto" for="node-input-passthru"><i class="fa fa-arrow-right"></i> If <code>msg</code> arrives on input, pass through to output : </label>
        <input type="checkbox" checked id="node-input-passthru" style="display:inline-block; width:auto; vertical-align:top;">
    </div>
    <div class="form-row">
        <label for="node-input-dynOutput"><i class="fa fa-envelope-o"></i> Send</label>
        <select id="node-input-dynOutput" style="width:60%">
            <option value="false">one value when released/closed</option>
            <option value="true">multiple values during editing</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-outformat" style="padding-left: 25px; margin-right: -25px">Payload</label>
        <select id="node-input-outformat" style="width:60%">
            <option value="string">current value as a string</option>
            <option value="object">current value as an object</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-topic" style="padding-left: 25px; margin-right: -25px">Topic</label>
        <input type="text" id="node-input-topic" placeholder="optional topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_colour_picker">
    <p>Adds a colour picker to the dashboard.</p>
    <p>If the group width is 4 or greater then the picker can be set to be visible at all times.</p>
    <p><b>Format</b> can be rgb, hex, hex8, hsv, or hsl. Transparency is supported for all except hex.</p>
    <p>If a <b>Topic</b> is specified, it will be added as <code>msg.topic</code>.</p>
    <p>Setting <code>msg.enabled</code> to <code>false</code> will disable the input.</p>
    <p>This node will take an input of any colour format available as <b>Format</b>, and convert it accordingly.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_form] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_form',{
        category: 'dashboard',
        color: 'rgb(176, 223, 227)',
        defaults: {
            name: {value: ''},
            label: {value: ''},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            options: {value:[{value:'', label :'', type:'', required:true}], validate:function(value) {
                    if (value.length ) {
                        for (var i = 0; i < value.length; i++) {
                            if (!value[i].value) {
                                return false;
                            }
                        }
                    }
                    else {
                        return false;
                    }
                    return true;
                }, required:true},
            formValue:{value:{}},
            payload: {value: ''},
            submit: {value: "submit"},
            cancel: {value: "cancel"},
            topic: {value: ''}
        },
        inputs:0,
        outputs:1,
        icon: "ui_form.png",
        paletteLabel: 'form',
        label: function() { return this.name || this.label || 'form'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });

            this.resizeRule = function(option,newWidth) {
                //option.find(".node-input-option-type").width(newWidth);
                //  option.find(".node-input-option-label").width(newWidth);
                //  option.find(".node-input-option-value").width(newWidth);
            }

            function generateOption(i, option) {
                var container = $('<li></li>',{style:"background: #fff; margin:0; padding:8px 0px 0px; border-bottom: 1px solid #ccc;"});
                var row = $('<div></div>').appendTo(container);
                var row2 = $('<div></div>',{style:"padding-top:5px; padding-left:175px;"}).appendTo(container);
                var row3 = $('<div></div>',{style:"padding-top:5px; padding-left:120px;"}).appendTo(container);

                $('<i style="color:#eee; cursor:move; margin-left:3px;" class="node-input-option-handle fa fa-bars"></i>').appendTo(row);

                var labelField = $('<input/>',{class:"node-input-option-label",type:"text",style:"margin-left:7px; width:19%;", placeholder: 'e.g. Name', value:option.label}).appendTo(row);//.typedInput({default:'str',types:['str', 'num']});
                var valueClass ="node-input-option-value"
                if (!option.value) { valueClass ="node-input-option-value input-error"; }
                var valueField = $('<input/>',{class:valueClass,type:"text",style:"margin-left: 7px; width: 19%;", placeholder: 'e.g. name',value:option.value}).appendTo(row);//.typedInput({default:'str',types:['str','num','bool']});
                valueField.keyup(function() {
                    if ($(this).val() && $(this).hasClass('input-error')) {
                        $(this).removeClass('input-error')
                    }
                    else {
                        if (!$(this).val()) {
                            $(this).addClass('input-error')
                        }
                    }

                });
                // var typeField = $('<input/>',{class:"node-input-option-type",type:"text",style:"margin-left: 7px; width: 135px;", placeholder: 'Type', value:option.type}).appendTo(row).typedInput({default:'str',types:['str', 'num']});
                var typeField = $('<select></select>',{class:"node-input-option-type",type:"text",style:"margin-left:7px; width:19%"}).appendTo(row);//.typedInput({default:'str',types:['str', 'num']});

                var arr = [
                  {val : "text", text: 'Text'},
                  {val : "number", text: 'Number'},
                  {val : "email", text: 'E-mail'},
                  {val : "password", text: 'Password'},
                  {val : "checkbox", text: 'Checkbox'},
                  {val : "switch", text: 'Switch'}//,
                  //{val : "radio", text: 'Radio'}//,
                  //{val : "date", text: 'Date'}
                ];

                //var sel = $('<select>').appendTo('body');
                $(arr).each(function() {
                    var isSelected= false;
                    if (option.type == this.val) {
                        isSelected = true;
                    }
                    typeField.append($("<option>").attr('value',this.val).text(this.text).prop('selected',isSelected));
                });

                //var labelForRequried = $('<span></span>',{style:"margin: 10px;"}).text('Required').appendTo(row);
                var requiredContainer= $('<div></div>',{style:"display:inline-block; height:34px; margin-left:7px; width:18%;"}).appendTo(row);
                var requiredInnerContainer= $('<div></div>',{style:"left:35%; position:relative; width:30px"}).appendTo(requiredContainer);
                var reqRow=$("<label ></label>",{class:"switch",style:"top:10px; width:30px;"}).appendTo(requiredInnerContainer);
                //var required = $('<input/>',{class:"node-input-option-required",style:"margin: 5px;width:19%",type:"checkbox", checked:option.required}).appendTo(row);//labelForRequried);//.typedInput({default:'str',types:['str', 'num']});
                var required = $('<input/>',{class:"node-input-option-required",type:"checkbox", checked:option.required}).appendTo(reqRow);//labelForRequried);//.typedInput({default:'str',types:['str', 'num']});
                var reqDiv=$("<div  ></div>",{class:"slider round"}).appendTo(reqRow);

                var finalspan = $('<div></div>',{style:"display:inline-block; width:5%;"}).appendTo(row);
                var deleteButton = $('<a></a>',{href:"#",class:"editor-button editor-button-small", style:"left:45%; position:relative;"}).appendTo(finalspan);
                $('<i></i>',{class:"fa fa-remove"}).appendTo(deleteButton);

                deleteButton.click(function() {
                    container.find(".node-input-option-value").removeAttr('required')
                    container.css({"background":"#fee"});
                    container.fadeOut(300, function() {
                        $(this).remove();
                    });
                });

                $("#node-input-option-container").append(container);
            }

            $("#node-input-add-option").click(function() {
                generateOption($("#node-input-option-container").children().length+1, {});
                $("#node-input-option-container-div").scrollTop($("#node-input-option-container-div").get(0).scrollHeight);
            });

            for (var i=0; i<this.options.length; i++) {
                var option = this.options[i];
                generateOption(i+1,option);
            }

            $( "#node-input-option-container" ).sortable({
                axis: "y",
                handle:".node-input-option-handle",
                cursor: "move"
            });
        },
        oneditsave: function() {
            var options = $("#node-input-option-container").children();
            var node = this;
            node.options = [];
            node.formValue = {};
            options.each(function(i) {
                var option = $(this);
                var o = {
                    label: option.find(".node-input-option-label").val(),//typedInput('value'),
                    value: option.find(".node-input-option-value").val(),//typedInput('value'),
                    type: option.find(".node-input-option-type").val(),//typedInput('value')
                    required: option.find(".node-input-option-required").is(':checked')
                };
                // o.value= o.value||o.label||(o.type+"_"+i);
                node.formValue[o.value]= o.type == "checkbox" || o.type == "switch" ? false : "";
                node.options.push(o);
            });
        },
        oneditresize: function() {
            var options = $("#node-input-option-container").children();
            var newWidth = ($("#node-input-option-container").width() - 175)/2;
            var node = this;
            options.each(function(i) {
                node.resizeRule($(this),newWidth);
            });
        }
    });
</script>
<script type="text/x-red" data-template-name="ui_form">

<style>
.switch {
    position: relative;
    display: inline-block;
    width: 30px;
    height: 18px;
}

.switch input {display:none;}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    -webkit-transition: .4s;
    transition: .4s;
}

.slider:before {
    position: absolute;
    content: "";
    height: 15px;
    width: 15px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
}

input:checked + .slider {
    background-color: #910000;
}

input:focus + .slider {
    box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
    -webkit-transform: translateX(11px);
    -ms-transform: translateX(11px);
    transform: translateX(11px);
}

/* Rounded sliders */
.slider.round {
    border-radius: 34px;
}

.slider.round:before {
    border-radius: 50%;
}
</style>

    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-tag"></i> Label</label>
        <input type="text" id="node-input-label" placeholder="optional label">
    </div>
    <div class="form-row node-input-option-container-row" style="margin-bottom:0px; width:100%; min-width:520px">
        <label style="vertical-align:top;"><i class="fa fa-list-alt"></i> Form elements</label>
        <div style="display:inline-block; width:78%; border:1px solid #ccc; border-radius:5px; box-sizing:border-box;">
          <div style="width:100%; display: inline-block; background-color:#f3f3f3; padding-top:10px; padding-buttom:10px; border-top:0px solid; border-radius:5px 5px 0 0; border-bottom:1px solid #ccc;">
              <div style="width:94%; display:inline-block; margin-left:32px">
                <div style="width:19%; text-align:center; float:left;">Label</div>
                <div style="width:19%; text-align:center; float:left;">Name</div>
                <div style="margin-left:7px; width:19%; text-align:center; float:left;">Type</div>
                <div style="width:20%; text-align:center; float:left;">Required</div>
                <div style="width:16%; text-align:center; float:left;">Remove</div>
              </div>
          </div>
          <div id="node-input-option-container-div" style=" height: 257px; padding: 5px; overflow-y:scroll;">
            <ol id="node-input-option-container" style=" list-style-type:none; margin: 0;"></ol>
          </div>
        </div>
    </div>
    <div class="form-row">
        <a href="#" class="editor-button editor-button-small" id="node-input-add-option" style="margin-top: 4px; margin-left: 103px;"><i class="fa fa-plus"></i> <span>element</span></a>
    </div>
    <div class="form-row">
        <label for="node-input-submit"><i class="fa fa-square"></i> Buttons</label>
        <i class="fa fa-thumbs-o-up"></i> <input type="text" id="node-input-submit" placeholder="submit button text" style="width:35%;">
        <span style="margin-left:16px"><i class="fa fa-thumbs-o-down"></i></span>
        <input type="text" id="node-input-cancel" placeholder="cancel button text" style="width:35%;">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="optional msg.topic">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_form">
    <p>Adds a form to user interface.</p>
    <p>Helps to collect multiple value from the user on submit button click as an object in <code> msg.payload</code> </p>
    <p>Multiple input elements can be added using add elements button</p>
    <p>Each element contains following components:</p>
    <ul>
        <li> <b>Label</b> : Value that will be the label of the element in the user interface</li>
        <li> <b>Name</b> : Represents the key (variable name) in the <code>msg.payload</code> in which the value of the corresponding element present</li>
        <li> <b>Type</b> : Drop drown option to select the type of input element</li>
        <li> <b>Required</b> : On switching on the user has to supply the value before submitting</li>
        <li> <b>Delete</b> : To remove the current element form the form</li>
    </ul>
    <p>Optionally the <b>Topic</b> field can be used to set the <code>msg.topic</code> property.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_text] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_text',{
        category: 'dashboard',
        color: 'rgb(119, 198, 204)',
        defaults: {
            group: {type: 'ui_group', required:true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            name: {value: ''},
            label: {value: 'text'},
            format: {value: '{{msg.payload}}'},
            layout: {value:'row-spread'}
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "ui_text.png",
        paletteLabel: 'text',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'text'; },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });

            $(".nr-db-text-layout-"+(this.layout||'row-spread')).addClass('selected');

            [ ".nr-db-text-layout-row-left",".nr-db-text-layout-row-center",".nr-db-text-layout-row-right",
              ".nr-db-text-layout-row-spread",".nr-db-text-layout-col-center"].forEach(function(id) {
                    $(id).click(function(e) {
                        $(".nr-db-text-layout").removeClass('selected');
                        $(this).addClass('selected');
                        $('#node-input-layout').val(id.substring(".nr-db-text-layout-".length));
                        e.preventDefault();
                    })
                })
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_text">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label">
    </div>
    <div class="form-row">
        <label for="node-input-format"><i class="fa fa-i-cursor"></i> Value format</label>
        <input type="text" id="node-input-format" placeholder="{{msg.payload}}">
    </div>
    <div class="form-row">
        <label style="vertical-align: top"><i class="fa fa-th-large"></i> Layout</label>
        <div style="display:inline-block">
        <input type="hidden" id="node-input-layout"><input type="hidden" id="node-input-layoutAlign">
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-left">
                <span class="nr-db-text-layout-label">label</span>
                <span class="nr-db-text-layout-value">value</span>
                <div class="nr-db-text-layout-checkbox"></div>
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-center">
                <span class="nr-db-text-layout-label">label</span>
                <span class="nr-db-text-layout-value">value</span>
                <div class="nr-db-text-layout-checkbox"></div>
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-right">
                <span class="nr-db-text-layout-label">label</span>
                <span class="nr-db-text-layout-value">value</span>
                <div class="nr-db-text-layout-checkbox"></div>
            </a>
        </div>
        <div>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-row nr-db-text-layout-row-spread">
                <span class="nr-db-text-layout-label">label</span>
                <span class="nr-db-text-layout-value">value</span>
                <div class="nr-db-text-layout-checkbox"></div>
            </a>
            <a href="#" class="nr-db-text-layout nr-db-text-layout-col nr-db-text-layout-col-center">
                <span class="nr-db-text-layout-label">label</span>
                <span class="nr-db-text-layout-value">value</span>
                <div class="nr-db-text-layout-checkbox"></div>
            </a>
        </div>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>


</script>
<style>
    .nr-db-text-layout {
        position:relative;
        display: inline-block;
        width: 90px;
        height: 60px;
        border-radius:3px;
        border:1px solid #bbb;
        cursor:pointer;
        color: #666;
        margin-right: 10px;
        margin-bottom: 10px;
    }
    .nr-db-text-layout.selected, .nr-db-text-layout:hover {
        border-color: #333;
        color: #333;
    }
    .nr-db-text-layout span {
        position: absolute;
    }
    .nr-db-text-layout-value {
        font-weight: bold;
    }
    .nr-db-text-layout-row span { top: 20px; }
    .nr-db-text-layout-row-left .nr-db-text-layout-label { left: 2px; }
    .nr-db-text-layout-row-left .nr-db-text-layout-value { left: 34px; }
    .nr-db-text-layout-row-spread .nr-db-text-layout-label { left: 2px; }
    .nr-db-text-layout-row-spread .nr-db-text-layout-value { right: 2px; }
    .nr-db-text-layout-row-center .nr-db-text-layout-label { left: 11px; }
    .nr-db-text-layout-row-center .nr-db-text-layout-value { right: 11px; }
    .nr-db-text-layout-row-right .nr-db-text-layout-label { right: 40px; }
    .nr-db-text-layout-row-right .nr-db-text-layout-value { right: 2px; }

    .nr-db-text-layout-col span { width: 90px;  text-align: center; left: 0px;}
    .nr-db-text-layout-col-center .nr-db-text-layout-label { top: 12px; }
    .nr-db-text-layout-col-center .nr-db-text-layout-value { top: 26px; }
    .nr-db-text-layout-checkbox {
        display: none;
        width: 10px;
        height: 10px;
        border-radius: 10px;
        border: 1px solid #bbb;
        position: absolute;
        right: -5px;
        top: -5px;
        background: #fff;
    }
    .nr-db-text-layout.selected .nr-db-text-layout-checkbox {
        display:inline-block;
        box-shadow: inset 0px 0px 0px 2px #fff;
        background: #333;
        border-color: #333;
    }

</style>

<script type="text/x-red" data-help-name="ui_text">
    <p>Will display a non-editable text field on the user interface.</p>
    <p>Each received <code>msg.payload</code> will update the text based on the provided <b>Value Format</b>.</p>
    <p>The <b>Value Format</b> field can be used to change the displayed format and can contain valid HTML and
    <a href="https://scotch.io/tutorials/all-about-the-built-in-angularjs-filters" target="_blank">Angular filters</a>.</p>
    <p>For example: <code>{{value | uppercase}} &amp;deg;</code> will uppercase the payload text and add the degree symbol.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_gauge] --- -->
<style>
    input.gauge-color {
        width: 100px;
        text-align: center;
    }
    input.gauge-color::-webkit-color-swatch {
        border: none;
    }
</style>
<script type="text/javascript">
    RED.nodes.registerType('ui_gauge',{
        category: 'dashboard',
        color: 'rgb(119, 198, 204)',
        defaults: {
            name: {value: ''},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v || 0;
                    var currentGroup = $('#node-input-group').val() || this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }
            },
            height: {value: 0},
            gtype: {value: 'gage'},
            title: {value: 'gauge'},
            label: {value: 'units'},
            format: {value: '{{value}}'},
            min: {value: 0, required: true, validate: RED.validators.number()},
            max: {value: 10, required: true, validate: RED.validators.number()},
            colors: {value: ["#00B500","#E6E600","#CA3838"]},
            seg1: {value: ""},
            seg2: {value: ""}
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "ui_gauge.png",
        paletteLabel: 'gauge',
        label: function() { return this.name || (~this.title.indexOf("{{") ? null : this.title) || ((this.gtype === "gage") ? "gauge" : this.gtype) || 'gauge'; },
        oneditprepare: function() {
            var setColour = function(id, value) {
                $(id).val(value);
                $(id).css("background-color", value);
                var rgb = tinycolor(value).toRgb();
                var level = ((rgb.r*299) + (rgb.g*587) + (rgb.b*114))/1000;
                var textColor = (level >= 128) ? '#111111' : '#eeeeee';
                $(id).css("color", textColor);
            }
            $(".gauge-color").change(function() {
                setColour("#"+$(this).attr("id"), $(this).val());
            });

            var defaultColors = ['#00B500', '#E6E600', '#CA3838'];

            if (this.colors) {
                for (var i=0; i<this.colors.length; i++) {
                    var value = this.colors[i] || defaultColors[i];
                    setColour("#node-input-color"+(i+1), value);
                }
            }
            else {
                for (var j=0; j<defaultColors.length; j++) {
                    setColour("#node-input-color"+(j+1), defaultColors[j]);
                }
            }
            if (this.gtype === undefined) {
                this.gtype = "gage";
                $("#node-input-gtype").val("gage");
            }
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
            $("#node-input-gtype").change(function() {
                if ($(this).val() === "wave") {
                    $("#ui-gauge-format").hide();
                }
                else {
                    $("#ui-gauge-format").show();
                }
                if (($(this).val() === "compass") || ($(this).val() === "wave")) {
                    $("#ui-gauge-colours").hide();
                    $("#ui-gauge-segments").hide();
                }
                else {
                    $("#ui-gauge-colours").show();
                    $("#ui-gauge-segments").show();
                }
            });
            $("#node-input-min").change(function() {
                $("#seg-min").text($(this).val());
            });
            $("#node-input-max").change(function() {
                $("#seg-max").text($(this).val());
            });
        },
        oneditsave: function() {
            this.colors = [$("#node-input-color1").val(),$("#node-input-color2").val(),$("#node-input-color3").val()];
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_gauge">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-gtype"><i class="fa fa-list"></i> Type</label>
        <select id="node-input-gtype" style="width:200px !important">
            <option value="gage">Gauge</option>
            <option value="donut">Donut</option>
            <option value="compass">Compass</option>
            <option value="wave">Level</option>
        </select>
    </div>
    <div id="ui-gauge-labels">
        <div class="form-row">
            <label for="node-input-title"><i class="fa fa-i-cursor"></i> Label</label>
            <input type="text" id="node-input-title">
        </div>
        <div class="form-row" id="ui-gauge-format">
            <label for="node-input-format"><i class="fa fa-i-cursor"></i> Value format</label>
            <input type="text" id="node-input-format" placeholder="{{value}}">
        </div>
        <div class="form-row" id="ui-gauge-units">
            <label for="node-input-label"><i class="fa fa-i-cursor"></i> Units</label>
            <input type="text" id="node-input-label" placeholder="optional sub-label">
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-min">Range</label>
        <span for="node-input-min">min</span>
        <input type="text" id="node-input-min" style="width:80px">
        <span for="node-input-max" style="margin-left:20px;">max</span>
        <input type="text" id="node-input-max" style="width:80px">
    </div>
    <div class="form-row" id="ui-gauge-colours">
        <label for="node-input-color1">Colour gradient</label>
        <input type="color" id="node-input-color1" class="gauge-color"/>
        <input type="color" id="node-input-color2" class="gauge-color"/>
        <input type="color" id="node-input-color3" class="gauge-color"/>
    </div>
    <div class="form-row" id="ui-gauge-segments">
        <label>Sectors</label>
        <span id="seg-min" style="display:inline-block; width:40px;">0</span>...
        <input type="text" id="node-input-seg1" style="text-align:center; width:87px;" placeholder="optional"> ...
        <input type="text" id="node-input-seg2" style="text-align:center; width:87px;" placeholder="optional"> ...
        <span id="seg-max" style="display:inline-block; width:40px; text-align:right">10</span>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_gauge">
    <p>Adds a gauge type widget to the user interface.</p>
    <p>The <code>msg.payload</code> is searched for a numeric <i>value</i> and is formatted in accordance with
    the defined <b>Value Format</b>, which can then be formatted using
    <a href="https://scotch.io/tutorials/all-about-the-built-in-angularjs-filters" target="_blank">Angular filters</a>.</p>
    <p>For example : <code>{{value | number:1}}%</code> will round the value to one decimal place and append a % sign.</p>
    <p>The colours of each of 3 sectors can be specified and the gauge will blend between them.
    The colours should be specified in hex (#rrggbb) format.</p>
    <p>If you specify numbers for the sectors then the colours changes per sector.
    If not specified the colours are blended across the total range.</p>
    <p>The gauge has several modes. Regular gauge, donut, compass and wave.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_chart] --- -->
<style>
    input.series-color {
        width: 100px;
        text-align: center;
    }
    input.series-color::-webkit-color-swatch {
        border: none;
    }
</style>
<script type="text/javascript">
    RED.nodes.registerType('ui_chart',{
        category: 'dashboard',
        color: 'rgb(119, 198, 204)',
        defaults: {
            name: {value: ''},
            group: {type: 'ui_group', required: true},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var width = v||0;
                    var currentGroup = $('#node-input-group').val()||this.group;
                    var groupNode = RED.nodes.node(currentGroup);
                    var valid = !groupNode || +width <= +groupNode.width;
                    $("#node-input-size").toggleClass("input-error",!valid);
                    return valid;
                }},
            height: {value: 0},
            label: {value: 'chart'},
            chartType: {value: 'line'},
            legend: {value: 'false'},
            xformat: {value: 'HH:mm:ss'},
            interpolate: {value: 'linear', required:true},
            nodata: {value: ''},
            dot: {value: false},
            ymin: {value: '', validate:function(value) { return value === '' || RED.validators.number(); }},
            ymax: {value: '', validate:function(value) { return value === '' || RED.validators.number(); }},
            removeOlder: {value: 1, validate:RED.validators.number(), required:true},
            removeOlderPoints: {value: '', validate:function(value) { return value === '' || RED.validators.number(); }},
            removeOlderUnit: {value: '3600', required:true},
            cutout: {value: 0},
            useOneColor: {value: false},
            colors: {value: ['#1F77B4', '#AEC7E8', '#FF7F0E', '#2CA02C', '#98DF8A', '#D62728', '#FF9896', '#9467BD', '#C5B0D5']},
            useOldStyle: {value: false}
        },
        inputs:1,
        outputs:2,
        outputLabels: ["chart state","(deprecated)"],
        align: "right",
        icon: "ui_chart.png",
        paletteLabel: 'chart',
        label: function() { return this.name || (~this.label.indexOf("{{") ? null : this.label) || 'chart'; },
        oneditprepare: function() {
            if (!$("#node-input-chartType").val()) {
                $("#node-input-chartType").val("line");
            }
            if (this.useOldStyle === undefined) {
                $("#node-input-useOldStyle").prop('checked', true);
            }
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });
            $("#node-input-chartType").change(function() {
                if ($(this).val() === "horizontalBar") {
                    $("#y-label-show").hide();
                    $("#x-label-show").show();
                }
                else {
                    $("#y-label-show").show();
                    $("#x-label-show").hide();
                }
                if ($(this).val() === "line") {
                    $("#x-axis-show").show();
                    $("#x-axis-label-show").show();
                    $("#interpolate-show").show();
                    $("#legend-show").show();
                    $("#y-axis-show").show();
                    $("#hole-size-show").hide();
                    $("#show-dot-field").show();
                    $("#show-useOneColor").hide();
                }
                else {
                    $("#x-axis-show").hide();
                    $("#x-axis-label-show").hide();
                    $("#interpolate-show").hide();
                    $("#show-dot-field").hide();
                    if (($(this).val() === "bar")||($(this).val() === "horizontalBar")) {
                        $("#show-useOneColor").show();
                    }
                    else {
                        $("#show-useOneColor").hide();
                    }
                    if ($(this).val() === "pie") {
                        $("#y-axis-show").hide();
                        $("#legend-show").show();
                        $("#hole-size-show").show();
                    }
                    else {
                        $("#y-axis-show").show();
                        $("#legend-show").hide();
                        $("#hole-size-show").hide();
                    }
                }
            });
            var setColour = function(id, value) {
                $(id).val(value);
                $(id).css("background-color", value);
                var rgb = tinycolor(value).toRgb();
                var level = ((rgb.r*299) + (rgb.g*587) + (rgb.b*114))/1000;
                var textColor = (level >= 128) ? '#111111' : '#eeeeee';
                $(id).css("color", textColor);
            }
            $(".series-color").change(function() {
                setColour("#"+$(this).attr("id"), $(this).val());
            });
            var oval = $("#node-input-xformat").val();
            if (!oval) { $("#node-input-xformat").val("HH:mm:ss"); }
            var odef = 'custom';
            if (oval === "HH:mm:ss") { odef = oval; }
            if (oval === "HH:mm") { odef = oval; }
            if (oval === "Y-M-D") { odef = oval; }
            if (oval === "D/M") { odef = oval; }
            if (oval === "dd HH:mm") { odef = oval; }
            if (oval === "auto") { odef = oval; }
            var ohms = {value:"HH:mm:ss", label:"HH:mm:ss", hasValue:false};
            var ohm = {value:"HH:mm", label:"HH:mm", hasValue:false};
            var oymd = {value:"Y-M-D", label:"Year-Month-Date", hasValue:false};
            var odm = {value:"D/M", label:"Date/Month", hasValue:false};
            var oahm = {value:"dd HH:mm", label:"Day HH:mm", hasValue:false};
            var ocus = {value:"custom", label:"custom", icon:"red/images/typedInput/az.png"};
            var oaut = {value:"auto", label:"automatic", hasValue:false};
            $("#node-input-xformat").typedInput({
                default: odef,
                types:[ ohms, ohm, oahm, odm, oymd, ocus, oaut ]
            });
            var defaultColors = ['#1F77B4', '#AEC7E8', '#FF7F0E', '#2CA02C', '#98DF8A', '#D62728', '#FF9896', '#9467BD', '#C5B0D5'];

            if (this.colors) {
                for (var i=0; i<this.colors.length; i++) {
                    var value = this.colors[i] || defaultColors[i];
                    setColour("#node-input-color"+(i+1), value);
                }
            }
            else {
                for (var c=0; c<defaultColors.length; c++) {
                    setColour("#node-input-color"+(c+1), defaultColors[c]);
                }
            }

        },
        oneditsave: function() {
            if ($("#node-input-xformat").typedInput('type') !== 'custom') {
                $("#node-input-xformat").val($("#node-input-xformat").typedInput('type'));
            }
            this.colors = [$("#node-input-color1").val(),$("#node-input-color2").val(),$("#node-input-color3").val(),
            $("#node-input-color4").val(),$("#node-input-color5").val(),$("#node-input-color6").val(),
            $("#node-input-color7").val(),$("#node-input-color8").val(),$("#node-input-color9").val()];

        }
    });
</script>

<script type="text/x-red" data-template-name="ui_chart">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label" placeholder="optional chart title">
    </div>
    <div class="form-row">
        <label for="node-input-removeOlder"><i class="fa fa-line-chart"></i> Type</label>
        <select id="node-input-chartType" style="width:159px; font-family:'FontAwesome','Helvetica Neue', Helvetica, Arial, sans-serif">
            <option value="line"> &#xf201; Line chart</option>
            <option value="bar"> &#xf080; Bar chart</option>
            <option value="horizontalBar"> &#xf080; Bar chart (H)</option>
            <option value="pie"> &#xf200; Pie chart</option>
            <option value="polar-area"> &#xf200; Polar area chart</option>
            <option value="radar"> &#xf200; Radar chart</option>
        </select>
        <div id="show-dot-field" style="display:inline-block;">
            <input type="checkbox" id="node-input-dot" style="display:inline-block; width:auto; vertical-align:baseline; margin-left:40px; margin-right:5px;">enlarge points
        </div>
    </div>
    <div class="form-row" id="x-axis-show">
        <label for="node-input-removeOlder">X-axis</label>
        <label for="node-input-removeOlder" style="width: auto">last</label>
        <input type="text" id="node-input-removeOlder" style="width:50px;">
        <select id="node-input-removeOlderUnit" style="width:80px;">
            <option value="1">seconds</option>
            <option value="60">minutes</option>
            <option value="3600">hours</option>
            <option value="86400">days</option>
            <option value="604800">weeks</option>
        </select>
        <label for="node-input-removeOlderPoints" style="width: auto; margin-left: 10px; margin-right: 10px;">OR</label>
        <input type="text" id="node-input-removeOlderPoints" style="width:60px;" placeholder="1000">
        <span style="margin-left: 5px;">points</span>
    </div>
    <div class="form-row" id="x-axis-label-show">
        <label for="node-input-xformat">X-axis Label</label>
        <input type="text" id="node-input-xformat" style="width:268px;">
    </div>
    <div class="form-row" id="y-axis-show">
        <label id="y-label-show" for="node-input-ymin">Y-axis</label>
        <label id="x-label-show" for="node-input-ymin">X-axis</label>
        <label for="node-input-ymin" style="width:auto">min</label>
        <input type="text" id="node-input-ymin" style="width:80px">
        <label for="not-input-ymax" style="width:auto; margin-left: 20px;">max</label>
        <input type="text" id="node-input-ymax" style="width:80px">
    </div>
    <div class="form-row" id="legend-show">
        <label for="node-input-legend">Legend</label>
        <select id="node-input-legend" style="width:120px;">
            <option value="false">None</option>
            <option value="true">Show</option>
        </select>
        <span id="interpolate-show">&nbsp;&nbsp;&nbsp;&nbsp;Interpolate
            <select id="node-input-interpolate" style="width:120px;">
                <option value="linear">linear</option>
                <option value="step">step</option>
                <option value="bezier">bezier</option>
            </select>
        </span>
        <span id="hole-size-show">&nbsp;&nbsp;&nbsp;&nbsp;Cutout
        <input type="text" id="node-input-cutout" style="width:35px"> %
        </span>
    </div>
    <div id="show-useOneColor" style="display:none;">
        <input type="checkbox" id="node-input-useOneColor" style="display:inline-block; width:auto; vertical-align:baseline; margin-left:105px; margin-right:5px;">Use first colour for all bars
    </div>
    <div class="form-row" id="ui-chart-colours">
        <label for="node-input-color1">Series Colours</label>
        <input type="color" id="node-input-color1" class="series-color"/>
        <input type="color" id="node-input-color2" class="series-color"/>
        <input type="color" id="node-input-color3" class="series-color"/>
        <div style="margin-top: 5px; margin-left: 104px;">
            <input type="color" id="node-input-color4" class="series-color"/>
            <input type="color" id="node-input-color5" class="series-color"/>
            <input type="color" id="node-input-color6" class="series-color"/>
        </div>
        <div style="margin-top: 5px; margin-left: 104px;">
            <input type="color" id="node-input-color7" class="series-color"/>
            <input type="color" id="node-input-color8" class="series-color"/>
            <input type="color" id="node-input-color9" class="series-color"/>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-nodata">Blank label</label>
        <input type="text" id="node-input-nodata" placeholder="display this text before valid data arrives">
    </div>
    <div class="form-row">
        <input type="checkbox" id="node-input-useOldStyle" style="display:inline-block; width:auto; vertical-align:baseline; margin-left:105px; margin-right:5px;">Use deprecated (pre 2.5.0) data format.
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_chart">
    <p>Plots the input values on a chart. This can either be a time based line chart, a bar chart (vertical or horizontal),
    or a pie chart.</p>
    <p>Each input <code>msg.payload</code> value will be converted to a number. If the
    conversion fails, the message is ignored.</p>
    <p>Minimum and Maximum <b>Y</b> axis values are optional. The graph will auto-scale to any values received.</p>
    <p>Multiple series can be shown on the same chart by using a different <code>msg.topic</code>
    value on each input message. Multiple bars of the same series can be shown by using the <code>msg.label</code> property.</p>
    <p>The <b>X</b> axis defines a time window or a maximum number of points to display. Older data will be automatically removed from the graph.
    The axis labels can be formatted using a <a href="https://momentjs.com/docs/#/displaying/format/" target="_blank">
    Moment.js time formatted</a> string.</p>
    <p>Inputting a <code>msg.payload</code> containing a blank array <code>[]</code> will clear the chart.</p>
    <p>See <b><a href="https://github.com/node-red/node-red-dashboard/blob/master/Charts.md" target="_new">this information</a></b>
    for how to pre-format data to be passed in as a complete chart.</p>
    <p>The <b>Blank label</b> field can be used to display some text before any valid data is received.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>The node output contains an array of the chart state that can be persisted if needed. This can be passed
    into the chart node to re-display the persisted data.
    The node second output should no longer be used and will be removed in a future release. Use the
    <code>ui_control</code> node to trigger a restore if needed.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_audio] --- -->


<script type="text/javascript">
(function() {
    var myvoice = 0;
    var voices;
    RED.nodes.registerType('ui_audio',{
        category: 'dashboard',
        paletteLabel: 'audio out',
        color: 'rgb(119, 198, 204)',
        defaults: {
            name: {value:""},
            group: {type: 'ui_group', required: true},
            voice: {value:""},
            always: {value:""}
        },
        inputs:1,
        outputs:0,
        icon: "feed.png",
        align: "right",
        label: function() {
            return this.name||"audio out";
        },
        onpaletteadd: function() {
            if ('speechSynthesis' in window) { voices = window.speechSynthesis.getVoices(); }
        },
        oneditprepare: function() {
            if ('speechSynthesis' in window) {
                voices = window.speechSynthesis.getVoices();
                for (i = 0; i < voices.length ; i++) {
                    //console.log(i,voices[i].name,voices[i].lang,voices[i].voiceURI,voices[i].default);
                    var option = document.createElement('option');
                    option.textContent = i + " : " + voices[i].name + ' (' + voices[i].lang + ')';
                    if (voices[i].default) { option.textContent += ' -- DEFAULT'; }
                    option.setAttribute('value', voices[i].lang);
                    document.getElementById("node-input-voice").appendChild(option);
                }
                $('#node-input-voice').val(this.voice || 0);
            }
            else {
                $('#voice-input-row').hide();
            }

            $("#node-input-voice").change(function() {
                myvoice = this.voice = $("#node-input-voice").val();
            });
        }
    });
})();
</script>

<script type="text/x-red" data-template-name="ui_audio">
    <div class="form-row">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row" id="voice-input-row">
        <label for="node-input-voice"><i class="fa fa-language"></i> TTS Voice</label>
        <select id="node-input-voice" style="width:70%"></select>
    </div>
    <div class="form-row">
        <label for="node-input-always"></label>
        <input type="checkbox" checked id="node-input-always" style="display:inline-block; width:auto; vertical-align:top;">
        Play audio when window not in focus.
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_audio">
    <p>Plays audio or text to speech (TTS) in the dashboard.</p>
    <p>To work the dashboard web page must be open.</p>
    <p>Expects <code>msg.payload</code> to contain a buffer of a <b>wav</b> or <b>mp3</b> file.</p>
    <p>If your browser has native support for Text-to-Speech then a <code>msg.payload</code>
    can also be a <b>string</b> to be read aloud.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_toast] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_toast', {
        category: 'dashboard',
        color: 'rgb(119, 198, 204)',
        defaults: {
            position: {value: 'top right'},
            displayTime: {value: '3'},
            highlight: {value: ''},
            outputs: {value: 0},
            ok: {value: 'OK', required: true},
            cancel: {value: ''},
            topic: {value: ''},
            name: {value: ''}
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "ui_toast.png",
        paletteLabel: 'notification',
        label: function() { return this.name || (this.position==="dialog" ? "show dialog" : "show notification"); },
        oneditprepare: function() {
            $("#node-input-position").change(function() {
                if ($("#node-input-position option:selected").val() === 'dialog') {
                    $("#node-toast-displaytime").hide();
                    $("#node-toast-highlightcolor").hide();
                    $("#node-dialog-displayok").show();
                    $("#node-dialog-displaycancel").show();
                    $("#node-dialog-topic").show();
                }
                else {
                    $("#node-toast-displaytime").show();
                    $("#node-toast-highlightcolor").show();
                    $("#node-dialog-displayok").hide();
                    $("#node-dialog-displaycancel").hide();
                    $("#node-dialog-topic").show();
                }
            });
        },
        oneditsave: function() {
            if ($("#node-input-position option:selected").val() === 'dialog') { this.outputs = 1; }
            else { this.outputs = 0; }
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_toast">
    <div class="form-row">
        <label for="node-input-position"><i class="fa fa-th-large"></i> Layout</label>
        <select type="text" id="node-input-position" style="display:inline-block; width:70%; vertical-align:top;">
            <option value="top right">Top Right</option>
            <option value="bottom right">Bottom Right</option>
            <option value="top left">Top Left</option>
            <option value="bottom left">Bottom Left</option>
            <option value="dialog">OK / Cancel Dialog</option>
        </select>
    </div>
    <div class="form-row" id="node-toast-displaytime">
        <label for="node-input-displayTime"><i class="fa fa-clock-o"></i> Timeout (S)</label>
        <input type="text" id="node-input-displayTime" placeholder="e.g. 3 seconds">
    </div>
    <div class="form-row" id="node-toast-highlightcolor">
        <label for="node-input-highlight"><i class="fa fa-square-o"></i> Border</label>
        <input type="text" id="node-input-highlight" placeholder="(optional) border highlight colour">
    </div>
    <div class="form-row" id="node-dialog-displayok">
        <label for="node-input-ok"><i class="fa fa-check"></i> Default action label</label>
        <input type="text" id="node-input-ok" placeholder="label for OK button">
    </div>
    <div class="form-row" id="node-dialog-displaycancel">
        <label for="node-input-cancel"><i class="fa fa-times"></i> Secondary action label</label>
        <input type="text" id="node-input-cancel" placeholder="(optional label for Cancel button)">
    </div>
    <div class="form-row" id="node-dialog-topic">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> Topic</label>
        <input type="text" id="node-input-topic" placeholder="(optional msg.topic)">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_toast">
    <p>Shows <code>msg.payload</code> as a popup notification or OK / Cancel dialog
    message on the user interface.</p>
    <p>If a <code>msg.topic</code> is available it will be used as the title.</p>
    <p>If you do not set an optional border highlight colour, then it can be set dynamically by <code>msg.highlight</code>.</p>
    <p>You may also configure the position and duration of the notification.</p>
    <p>The dialog returns a <code>msg.payload</code> string of whatever you configure
    the button label(s) to be. The second (cancel) button is optional, as is the return
    value of <code>msg.topic</code>.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_ui_control] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_ui_control', {
        category: 'dashboard',
        color: 'rgb( 63, 173, 181)',
        defaults: {
            name: {value:""}
        },
        inputs:1,
        outputs:1,
        align: "right",
        icon: "ui_link.png",
        paletteLabel: 'ui control',
        label: function() { return this.name || "ui control"; },
        labelStyle: function() { return this.name?"node_label_italic":""; }
    });
</script>

<script type="text/x-red" data-template-name="ui_ui_control">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_ui_control">
    <p>Allows dynamic control of the Dashboard.</p>
    <p>The default function is to change the currently displayed tab. <code>msg.payload</code>
    should either be an object of the form <code>{tab:"my_tab_name"}</code>, or just be the <b>tab name</b>
    or <b>numeric index</b> (from 0) of the tab or link to be displayed.</p>
    <p>Sending a blank tab name "" will refresh the current page.
    You can also send "+1" for next tab and "-1" for previous tab.</p>
    <p>Visibility of individual groups of widgets can controlled by a payload like
    <code>{group:{hide:["tab_name_group_name_with_underscores"], show:["reveal_another_group"], focus:true}}</code>
    where <b>focus</b> is optional and will cause the screen to scroll to show that group if required. The group
    names are the IDs of the groups and are typically formed from the <i>tab name</i> plus <i>group name</i> joined with
    underscores replacing all spaces.</p>
    <p>When any browser client connects or loses connection this node will emit a <code>msg</code> containing:</p>
    <ul>
    <li><code>payload</code> - <i>connect</i> or <i>lost</i>.
    <li><code>socketid</code> - the ID of the socket (this will change every time the browser reloads the page).
    <li><code>socketip</code> - the ip address from where the connection originated.
    </ul>
</script>
<!-- --- [red-module:node-red-dashboard/ui_template] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_template',{
        category: 'dashboard',
        color: 'rgb( 63, 173, 181)',
        defaults: {
            group: {type: 'ui_group', required:false},
            name: {value: ''},
            order: {value: 0},
            width: {value: 0, validate: function(v) {
                    var valid = true
                    if (this.templateScope !== 'global') {
                        var width = v||0;
                        var currentGroup = $('#node-input-group').val()||this.group;
                        var groupNode = RED.nodes.node(currentGroup);
                        valid = !groupNode || +width <= +groupNode.width;
                        $("#node-input-size").toggleClass("input-error",!valid);
                    }
                    return valid;
                }},
            height: {value: 0},
            format: {value: '<div ng-bind-html="msg.payload"></div>'},
            storeOutMessages: {value: true},
            fwdInMessages: {value: true},
            templateScope: {value: 'local'}
        },
        inputs:1,
        outputs:1,
        icon: "ui_template.png",
        paletteLabel: 'template',
        label: function() { return this.name || 'template'; },
        oneditprepare: function() {
            var that = this;
            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                group: "#node-input-group"
            });

            if (typeof this.storeOutMessages === 'undefined') {
                this.storeOutMessages = true;
                $('#node-input-storeOutMessages').prop('checked', true);
            }

            if (typeof this.fwdInMessages === 'undefined') {
                this.fwdInMessages = true;
                $('#node-input-fwdInMessages').prop('checked', true);
            }

            if (typeof this.templateScope === 'undefined') {
                this.templateScope = 'local';
                $('#node-input-templateScope').val(this.templateScope);
            }

            $('#node-input-templateScope').on('change', function() {
                if ($('#node-input-templateScope').val() === 'global') {
                    $('#template-row-group, #template-row-size, #template-pass-store').hide();
                    that._def.defaults.group.required = false;
                }
                else {
                    $('#template-row-group, #template-row-size, #template-pass-store').show();
                    that._def.defaults.group.required = true;
                }

                var rows = $("#dialog-form>div:not(.node-text-editor-row)");
                var height = $("#dialog-form").height();
                for (var i=0; i<rows.size(); i++) {
                    height = height - $(rows[i]).outerHeight(true);
                }
                if ($('#node-input-templateScope').val() === "global") { height += 240; }
                var editorRow = $("#dialog-form>div.node-text-editor-row");
                height -= (parseInt(editorRow.css("marginTop")) + parseInt(editorRow.css("marginBottom")));
                $(".node-text-editor").css("height",height+"px");
                if (this.editor) { this.editor.resize(); }
            })

            this.editor = RED.editor.createEditor({
                id: 'node-input-format-editor',
                mode: 'ace/mode/html',
                value: $("#node-input-format").val()
            });

            RED.library.create({
                url:"uitemplates", // where to get the data from
                type:"ui_template", // the type of object the library is for
                editor:this.editor, // the field name the main text body goes to
                mode:"ace/mode/html",
                fields:['name']
            });

            this.editor.focus();
        },
        oneditsave: function() {
            var annot = this.editor.getSession().getAnnotations();
            this.noerr = 0;
            $("#node-input-noerr").val(0);
            for (var k=0; k < annot.length; k++) {
                if (annot[k].type === "error") {
                    $("#node-input-noerr").val(annot.length);
                    this.noerr = annot.length;
                }
            }
            $("#node-input-format").val(this.editor.getValue());
            this.editor.destroy();
            delete this.editor;
        },
        oneditcancel: function() {
            this.editor.destroy();
            delete this.editor;
        },
        oneditresize: function(size) {
            var rows = $("#dialog-form>div:not(.node-text-editor-row)");
            var height = $("#dialog-form").height();
            for (var i=0; i<rows.size(); i++) {
                height = height - $(rows[i]).outerHeight(true);
            }
            if ($('#node-input-templateScope').val() === "global") { height += 232; }
            var editorRow = $("#dialog-form>div.node-text-editor-row");
            height -= (parseInt(editorRow.css("marginTop")) + parseInt(editorRow.css("marginBottom")));
            $(".node-text-editor").css("height",height+"px");
            this.editor.resize();
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_template">
  <div class="form-row">
      <label for="node-input-format">Template type</label>
      <select style="width:76%" id="node-input-templateScope">
          <option value="local">Widget in group</option>
          <option value="global">Added to site &lt;head&gt; section</option>
      </select>
  </div>
	<div class="form-row" id="template-row-group">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group">
    </div>
    <div class="form-row" id="template-row-size">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width">
        <input type="hidden" id="node-input-height">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
    <div id="template-pass-store">
    <div class="form-row" style="margin-bottom:0px;">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-fwdInMessages" style="display:inline-block; width:auto; vertical-align:top;">
        <label for="node-input-fwdInMessages" style="width:70%;"> Pass through messages from input.</label>
    </div>
    <div class="form-row" style="margin-bottom:0px;">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-storeOutMessages" style="display:inline-block; width:auto; vertical-align:top;">
        <label for="node-input-storeOutMessages" style="width:70%;"> Add output messages to stored state.</label>
    </div>
    </div>
    <div class="form-row" style="margin-bottom:0px;">
        <label for="node-input-format"><i class="fa fa-copy"></i> Template</label>
        <input type="hidden" id="node-input-format">
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height:250px; min-height:100px" class="node-text-editor" id="node-input-format-editor" ></div>
    </div>
</script>


<script type="text/x-red" data-help-name="ui_template">
    <p>The template widget can contain any valid html and Angular/Angular-Material directives.</p>
    <p>This node can be used to create a dynamic user interface element that changes its appearence
    based on the input message and can send back messages to Node-RED.</p>
    <p><b>For example:</b><br>
    <pre style="font-size:smaller;">&lt;div layout=&quot;row&quot; layout-align=&quot;space-between&quot;&gt;
&lt;p&gt;The number is&lt;/p&gt;
&lt;p ng-style=&quot;{color: (msg.payload || 0) % 2 === 0 ? 'green' : 'red'}&quot;&gt;
  {{(msg.payload || 0) % 2 === 0 ? 'even' : 'odd'}}
&lt;/p&gt;
&lt;/div&gt;</pre>
    Will display if the number received as <code>msg.payload</code> is even or odd. It will also
    change the color of the text to green if the number is even or red if odd.<br/>
    The next example shows how to set a unique id for your template, pick up the default theme colour,
    and watch for any incoming message.</p>
    <pre style="font-size:smaller;">
&lt;div id="{{'my_'+$id}}" style="{{'color:'+theme.base_color}}"&gt;Some text&lt;/div&gt;
&lt;script&gt;
(function(scope) {
  scope.$watch('msg', function(msg) {
    if (msg) {
      // Do something when msg arrives
      $("#my_"+scope.$id).html(msg.payload);
    }
  });
})(scope);
&lt;/script&gt;</pre>
    <p>Templates made in this way can be copied and remain independent of each other.</p>
    <p><b>Sending a message:</b><br>
    <pre style="font-size:smaller;">
&lt;script&gt;
var value = "hello world";
// or overwrite value in your callback function ...
this.scope.action = function() { return value; }
&lt;/script&gt;
&lt;md-button ng-click=&quot;send({payload:action()})&quot;&gt;
    Click me to send a hello world
&lt;/md-button&gt;</pre>
    Will display a button that when clicked will send a message with the payload <code>'Hello world'</code>.</p>
    <p><b>Using <code>msg.template</code>:</b><br>
    You can also define the template content via <code>msg.template</code>, so you can use external files for example.<br>
    Template will be reloaded on input if it has changed.<br>
    Code written in the Template field will be ignored when <code>msg.template</code> is present.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_link] --- -->
<script type="text/javascript">
    RED.nodes.registerType('ui_link',{
        category: 'config',
        color: 'rgb( 63, 173, 181)',
        defaults: {
            name: {value: 'Google'},
            link: {value: 'https://www.google.com'},
            icon: {value: 'open_in_browser'},
            target: {value: 'newtab', validate :function() { return true; }},
            order: {value: 0}
        },
        inputs:0,
        outputs:0,
        hasUsers: false,
        align: "right",
        icon: "ui_link.png",
        paletteLabel: 'link',
        label: function() { return this.name || 'link'; },
        oneditprepare: function() {
            document.getElementById('node-config-input-target-opentab').checked = (this.target === 'newtab');
            document.getElementById('node-config-input-target-openiframe').checked = (this.target === 'iframe');
        },
        oneditsave : function () {
            this.target = document.getElementById('node-config-input-target-opentab').checked ? 'newtab' : 'iframe';
        },
        onadd: function() {
            //console.log("PING");
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_link">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="ui_link.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-link"><i class="fa fa-link"></i> <span data-i18n="ui_link.label.link"></span></label>
        <input type="text" id="node-config-input-link">
    </div>
    <div class="form-row">
        <label for="node-config-input-icon"><i class="fa fa-image"></i> <span data-i18n="ui_link.label.icon"></span></label>
        <input type="text" id="node-config-input-icon">
    </div>
    <div class="form-row">
        <label><i class="fa fa-link"></i> <span data-i18n="ui_link.label.open-in"></span></label>
        <input type="radio" id="node-config-input-target-opentab" name="open-link-method" style="width: 20px;margin-top: 0px; margin-bottom: 5px" checked>
        <label for="node-config-input-target-opentab" data-i18n="ui_link.label.new-tab"></label>
        <input type="radio" id="node-config-input-target-openiframe" name="open-link-method" style="width: 20px;margin-top: 0px; margin-bottom: 5px">
        <label for="node-config-input-target-openiframe" data-i18n="ui_link.label.iframe"></label>
    </div>
</script>


<script type="text/x-red" data-help-name="ui_link">
    <p>Adds a web link to the left side menu of the user interface.</p>
    <p>The <b>Icon</b> field can be either <a href="https://design.google.com/icons/" target="_blank">Material Design icons</a> <i>(e.g. 'check', 'close')</i> or <a href="https://fontawesome.com/v4.7.0/icons/" target="_blank">Font Awesome icons</a> <i>(e.g. 'fa-fire')</i>.</p>
    <p>The <b>Open in</b> field controls whether the link opens in a <i>New Tab</i>, or if the link is opened within an <i>iframe</i> on the same page. Some sites, including Google, do not allow the rendering of their page inside an iframe. If you select the <i>iframe</i> option and the site does not show, this is simply because that site forbids the use of it inside an iframe.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_tab] --- -->
<script type="text/javascript">
    // convert to i18 text
    function c_(x) {
        return RED._("node-red-dashboard/ui_tab:ui_tab."+x);
    }

    RED.nodes.registerType('ui_tab',{
        category: 'config',
        defaults: {
            name: {value: c_("label.home")},
            icon: {value: 'dashboard'},
            order: {value: 0}
        },
        paletteLabel: 'dashboard tab',
        label: function() { return this.name || c_("label.tab"); },
        sort: function(A,B) {
            return A.order - B.order;
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_tab">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="ui_tab.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-icon"><i class="fa fa-file-image-o"></i> <span data-i18n="ui_tab.label.icon"></span></label>
        <input type="text" id="node-config-input-icon">
    </div>
</script>


<script type="text/x-red" data-help-name="ui_tab">
    <p>Tab configuration for Dashboard</p>
    <p>The <b>Icon</b> field can be either
    <a href="https://design.google.com/icons/" target="_blank">Material Design icons</a> <i>(e.g. 'check', 'close')</i>
    or <a href="https://fontawesome.com/v4.7.0/icons/" target="_blank">Font Awesome icons</a> <i>(e.g. 'fa-fire')</i>.</p>
</script>
<!-- --- [red-module:node-red-dashboard/ui_group] --- -->
<script type="text/javascript">
    // convert to i18 text
    function c_(x) {
        return RED._("node-red-dashboard/ui_group:ui_group."+x);
    }

    RED.nodes.registerType('ui_group',{
        category: 'config',
        defaults: {
            name: {value: c_("label.default")},
            tab: {type:"ui_tab", required: true },
            order: {value: 0},
            disp: {value: true},
            width: {value: 6},
            collapse: {value: false}
        },
        sort: function(A,B) {
            if (A.tab !== B.tab) {
                var tabA = RED.nodes.node(A.tab);
                var tabB = RED.nodes.node(B.tab);
                if (!tabA && tabB) {
                    return -1;
                }
                else if (tabA && !tabB) {
                    return 1;
                }
                else {
                    return tabA.order - tabB.order;
                }
            }
            return A.order - B.order;
        },
        paletteLabel: 'dashboard group',
        label: function() {
            var tabNode = RED.nodes.node(this.tab);
            if (tabNode) {
                return (this.name||c_("label.group"))+ " ["+(tabNode.name||c_("label.tab"))+"]"
            }
            return (this.name || c_("label.group"))+" ["+c_("label.unassigned")+"]";
        },
        oneditprepare: function() {
            $("#node-input-size").elementSizer({
                width: "#node-config-input-width",
                auto: false
            });
            $("#node-config-input-disp").change(function() {
                if ($("#node-config-input-disp").is(":checked")) {
                    $("#group-collapse-flag").show();
                }
                else {
                    $("#group-collapse-flag").hide();
                    $("#node-config-input-collapse").prop("checked",false);
                }
            });
        }
    });
</script>

<script type="text/x-red" data-template-name="ui_group">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> <span data-i18n="ui_group.label.name"></span></label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-tab"><i class="fa fa-table"></i> <span data-i18n="ui_group.label.tab"></span></label>
        <input type="text" id="node-config-input-tab">
    </div>
    <div class="form-row">
        <label for="node-config-input-width"><i class="fa fa-arrows-h"></i> <span data-i18n="ui_group.label.width"></span></label>
        <input type="hidden" id="node-config-input-width">
        <button class="editor-button" id="node-input-size"></button>
    </div>
    <div class="form-row">
        <input style="margin:8px 0 10px 102px; width:20px;" type="checkbox" checked id="node-config-input-disp"> <label style="width:auto" for="node-config-input-disp"><span data-i18n="ui_group.display-name"></span></label>
    </div>
    <div class="form-row" id="group-collapse-flag">
        <input style="margin:8px 0 10px 102px; width:20px;" type="checkbox" id="node-config-input-collapse"> <label style="width:auto" for="node-config-input-collapse"><span data-i18n="ui_group.collapse-name"></span></label>
    </div>
</script>


<script type="text/x-red" data-help-name="ui_group">
    <p>Group</p>
</script><script type="application/javascript" src="./Node-RED _ smartfactory00.mybluemix.net_files/tinycolor-min.js.download"></script><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-lookup" aria-labelledby="ui-id-3" style="display: none; position: absolute;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-3" class="ui-dialog-title">theme library</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-lookup" class="hide ui-dialog-content ui-widget-content" style="display: block;">
    <form class="form-horizontal">
        <div class="form-row">
            <ul id="node-dialog-library-breadcrumbs" class="breadcrumb">
                <li class="active"><a href="https://smartfactory00.mybluemix.net/red/#" data-i18n="[append]library.breadcrumb">Library</a></li>
            </ul>
        </div>
        <div class="form-row">
            <div style="vertical-align: top; display: inline-block; height: 100%; width: 30%; padding-right: 20px;">
                <div id="node-select-library" style="border: 1px solid #999; width: 100%; height: 100%; overflow:scroll;"><ul></ul></div>
            </div>
            <div style="vertical-align: top; display: inline-block;width: 65%; height: 100%;">
                <div style="height: 100%; width: 95%;" class="node-text-editor ace_editor ace-tomorrow" id="node-select-library-text"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0;"></textarea><div class="ace_gutter" aria-hidden="true"><div class="ace_layer ace_gutter-layer ace_folding-enabled"></div><div class="ace_gutter-active-line" style="display: none;"></div></div><div class="ace_scroller"><div class="ace_content"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 4px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors" style="opacity: 0;"><div class="ace_cursor"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px;"><div class="ace_scrollbar-inner" style="width: 22px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px;"><div class="ace_scrollbar-inner" style="height: 22px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div>
            </div>
        </div>
    </form>
</div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Load</span></button></div></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-save-confirm" aria-labelledby="ui-id-4" style="display: none; position: absolute;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-4" class="ui-dialog-title">Save to Library...</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-save-confirm" class="hide ui-dialog-content ui-widget-content" style="display: block;">
    <form class="form-horizontal">
        <div style="text-align: center; padding-top: 30px;" id="node-dialog-library-save-content">
        </div>
    </form>
</div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Save</span></button></div></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable" tabindex="-1" role="dialog" aria-describedby="node-dialog-library-save" aria-labelledby="ui-id-5" style="display: none; position: absolute;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-5" class="ui-dialog-title">Save to Library...</span><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close"><span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span></button></div><div id="node-dialog-library-save" class="hide ui-dialog-content ui-widget-content" style="display: block;">
    <form class="form-horizontal">
        <div class="form-row">
            <label for="node-dialog-library-save-folder" data-i18n="[append]library.folder"><i class="fa fa-folder-open"></i> Folder</label>
            <input type="text" id="node-dialog-library-save-folder" data-i18n="[placeholder]library.folderPlaceholder" placeholder="a/b">
        </div>
        <div class="form-row">
            <label for="node-dialog-library-save-filename" data-i18n="[append]library.filename"><i class="fa fa-file"></i> Filename</label>
            <input type="text" id="node-dialog-library-save-filename" data-i18n="[placeholder]library.filenamePlaceholder" placeholder="file">
        </div>
    </form>
</div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button><button type="button" class="primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Save</span></button></div></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div></div></body></html>